import{H as _f}from"../chunks/control.c2cf8273.js";import{s as Nc,f as ci,a as qi,g as ui,h as nr,A as Jr,c as Xi,d as $e,j as pi,k as Ol,B as xf,i as Ii,x as fi,C as fp,D as Kn,y as Wh,E as Dp,F as Vc,G as bf,l as Gc,m as qc,H as wo,n as Xc,I as Fs,J as wf,e as mp,K as Sf,o as Tf,p as Uc}from"../chunks/scheduler.a412805e.js";import{S as Wc,i as Hc,b as gp,d as yp,m as vp,a as _p,t as xp,e as bp}from"../chunks/index.b386f462.js";import{b as wp}from"../chunks/paths.b61304ef.js";function Hh(ve){return(ve==null?void 0:ve.length)!==void 0?ve:Array.from(ve)}function kf(ve,se){return new _f(ve,se)}new TextEncoder;function Cf(ve,se){if(!ve)return"Insufficient Data";if(se==="dollars"){const X=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}),te=Math.round(ve);return X.format(te)}if(se=="integer"){const X=new Intl.NumberFormat("en-US",{minimumFractionDigits:0}),te=Math.round(ve);return X.format(te)}if(se=="percent")return ve.toFixed(1)+"%";if(se=="index")return ve.toFixed(3)}var Op=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bp(ve){return ve&&ve.__esModule&&Object.prototype.hasOwnProperty.call(ve,"default")?ve.default:ve}var Rp={exports:{}};(function(ve){(function(se,X){ve.exports?(X.default=X,ve.exports=se&&se.document?X(se):X):(se.Highcharts&&se.Highcharts.error(16,!0),se.Highcharts=X(se))})(typeof window<"u"?window:Op,function(se){var X={};function te(Et,At,l,Zt){Et.hasOwnProperty(At)||(Et[At]=Zt.apply(null,l),typeof CustomEvent=="function"&&se.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:At,module:Et[At]}})))}return te(X,"Core/Globals.js",[],function(){var Et,At;return(At=Et||(Et={})).SVG_NS="http://www.w3.org/2000/svg",At.product="Highcharts",At.version="11.3.0",At.win=se!==void 0?se:{},At.doc=At.win.document,At.svg=At.doc&&At.doc.createElementNS&&!!At.doc.createElementNS(At.SVG_NS,"svg").createSVGRect,At.userAgent=At.win.navigator&&At.win.navigator.userAgent||"",At.isChrome=At.userAgent.indexOf("Chrome")!==-1,At.isFirefox=At.userAgent.indexOf("Firefox")!==-1,At.isMS=/(edge|msie|trident)/i.test(At.userAgent)&&!At.win.opera,At.isSafari=!At.isChrome&&At.userAgent.indexOf("Safari")!==-1,At.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(At.userAgent),At.isWebKit=At.userAgent.indexOf("AppleWebKit")!==-1,At.deg2rad=2*Math.PI/360,At.hasBidiBug=At.isFirefox&&4>parseInt(At.userAgent.split("Firefox/")[1],10),At.hasTouch=!!At.win.TouchEvent,At.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],At.noop=function(){},At.supportsPassiveEvents=function(){let l=!1;if(!At.isMS){let Zt=Object.defineProperty({},"passive",{get:function(){l=!0}});At.win.addEventListener&&At.win.removeEventListener&&(At.win.addEventListener("testPassive",At.noop,Zt),At.win.removeEventListener("testPassive",At.noop,Zt))}return l}(),At.charts=[],At.composed=[],At.dateFormats={},At.seriesTypes={},At.symbolSizes={},At.chartCount=0,Et}),te(X,"Core/Utilities.js",[X["Core/Globals.js"]],function(Et){let At,{charts:l,doc:Zt,win:dt}=Et;function Nt(g,v,y,T){let k=v?"Highcharts error":"Highcharts warning";g===32&&(g=`${k}: Deprecated member`);let E=at(g),w=E?`${k} #${g}: www.highcharts.com/errors/${g}/`:g.toString();if(T!==void 0){let R="";E&&(w+="?"),rt(T,function(J,wt){R+=`
 - ${wt}: ${J}`,E&&(w+=encodeURI(wt)+"="+encodeURI(J))}),w+=R}C(Et,"displayError",{chart:y,code:g,message:w,params:T},function(){if(v)throw Error(w);dt.console&&Nt.messages.indexOf(w)===-1&&console.warn(w)}),Nt.messages.push(w)}function Lt(g,v){return parseInt(g,v||10)}function kt(g){return typeof g=="string"}function ut(g){let v=Object.prototype.toString.call(g);return v==="[object Array]"||v==="[object Array Iterator]"}function Rt(g,v){return!!g&&typeof g=="object"&&(!v||!ut(g))}function Z(g){return Rt(g)&&typeof g.nodeType=="number"}function lt(g){let v=g&&g.constructor;return!!(Rt(g,!0)&&!Z(g)&&v&&v.name&&v.name!=="Object")}function at(g){return typeof g=="number"&&!isNaN(g)&&g<1/0&&g>-1/0}function W(g){return g!=null}function q(g,v,y){let T,k=kt(v)&&!W(y),E=(w,R)=>{W(w)?g.setAttribute(R,w):k?(T=g.getAttribute(R))||R!=="class"||(T=g.getAttribute(R+"Name")):g.removeAttribute(R)};return kt(v)?E(y,v):rt(v,E),T}function $(g){return ut(g)?g:[g]}function U(g,v){let y;for(y in g||(g={}),v)g[y]=v[y];return g}function j(){let g=arguments,v=g.length;for(let y=0;y<v;y++){let T=g[y];if(T!=null)return T}}function et(g,v){Et.isMS&&!Et.svg&&v&&W(v.opacity)&&(v.filter=`alpha(opacity=${100*v.opacity})`),U(g.style,v)}function _t(g){return Math.pow(10,Math.floor(Math.log(g)/Math.LN10))}function mt(g,v){return g>1e14?g:parseFloat(g.toPrecision(v||14))}(Nt||(Nt={})).messages=[],Math.easeInOutSine=function(g){return-.5*(Math.cos(Math.PI*g)-1)};let V=Array.prototype.find?function(g,v){return g.find(v)}:function(g,v){let y,T=g.length;for(y=0;y<T;y++)if(v(g[y],y))return g[y]};function rt(g,v,y){for(let T in g)Object.hasOwnProperty.call(g,T)&&v.call(y||g[T],g[T],T,g)}function I(g,v,y){function T(w,R){let J=g.removeEventListener;J&&J.call(g,w,R,!1)}function k(w){let R,J;g.nodeName&&(v?(R={})[v]=!0:R=w,rt(R,function(wt,ot){if(w[ot])for(J=w[ot].length;J--;)T(ot,w[ot][J].fn)}))}let E=typeof g=="function"&&g.prototype||g;if(Object.hasOwnProperty.call(E,"hcEvents")){let w=E.hcEvents;if(v){let R=w[v]||[];y?(w[v]=R.filter(function(J){return y!==J.fn}),T(v,y)):(k(w),w[v]=[])}else k(w),delete E.hcEvents}}function C(g,v,y,T){let k;if(y=y||{},Zt.createEvent&&(g.dispatchEvent||g.fireEvent&&g!==Et))(k=Zt.createEvent("Events")).initEvent(v,!0,!0),y=U(k,y),g.dispatchEvent?g.dispatchEvent(y):g.fireEvent(v,y);else if(g.hcEvents){y.target||U(y,{preventDefault:function(){y.defaultPrevented=!0},target:g,type:v});let E=[],w=g,R=!1;for(;w.hcEvents;)Object.hasOwnProperty.call(w,"hcEvents")&&w.hcEvents[v]&&(E.length&&(R=!0),E.unshift.apply(E,w.hcEvents[v])),w=Object.getPrototypeOf(w);R&&E.sort((J,wt)=>J.order-wt.order),E.forEach(J=>{J.fn.call(g,y)===!1&&y.preventDefault()})}T&&!y.defaultPrevented&&T.call(g,y)}rt({map:"map",each:"forEach",grep:"filter",reduce:"reduce",some:"some"},function(g,v){Et[v]=function(y){return Nt(32,!1,void 0,{[`Highcharts.${v}`]:`use Array.${g}`}),Array.prototype[g].apply(y,[].slice.call(arguments,1))}});let z=function(){let g=Math.random().toString(36).substring(2,9)+"-",v=0;return function(){return"highcharts-"+(At?"":g)+v++}}();return dt.jQuery&&(dt.jQuery.fn.highcharts=function(){let g=[].slice.call(arguments);if(this[0])return g[0]?(new Et[kt(g[0])?g.shift():"Chart"](this[0],g[0],g[1]),this):l[q(this[0],"data-highcharts-chart")]}),{addEvent:function(g,v,y,T={}){let k=typeof g=="function"&&g.prototype||g;Object.hasOwnProperty.call(k,"hcEvents")||(k.hcEvents={});let E=k.hcEvents;Et.Point&&g instanceof Et.Point&&g.series&&g.series.chart&&(g.series.chart.runTrackerClick=!0);let w=g.addEventListener;w&&w.call(g,v,y,!!Et.supportsPassiveEvents&&{passive:T.passive===void 0?v.indexOf("touch")!==-1:T.passive,capture:!1}),E[v]||(E[v]=[]);let R={fn:y,order:typeof T.order=="number"?T.order:1/0};return E[v].push(R),E[v].sort((J,wt)=>J.order-wt.order),function(){I(g,v,y)}},arrayMax:function(g){let v=g.length,y=g[0];for(;v--;)g[v]>y&&(y=g[v]);return y},arrayMin:function(g){let v=g.length,y=g[0];for(;v--;)g[v]<y&&(y=g[v]);return y},attr:q,clamp:function(g,v,y){return g>v?g<y?g:y:v},clearTimeout:function(g){W(g)&&clearTimeout(g)},correctFloat:mt,createElement:function(g,v,y,T,k){let E=Zt.createElement(g);return v&&U(E,v),k&&et(E,{padding:"0",border:"none",margin:"0"}),y&&et(E,y),T&&T.appendChild(E),E},css:et,defined:W,destroyObjectProperties:function(g,v){rt(g,function(y,T){y&&y!==v&&y.destroy&&y.destroy(),delete g[T]})},diffObjects:function(g,v,y,T){let k={};return function E(w,R,J,wt){let ot=y?R:w;rt(w,function(it,Q){if(!wt&&T&&T.indexOf(Q)>-1&&R[Q]){it=$(it),J[Q]=[];for(let A=0;A<Math.max(it.length,R[Q].length);A++)R[Q][A]&&(it[A]===void 0?J[Q][A]=R[Q][A]:(J[Q][A]={},E(it[A],R[Q][A],J[Q][A],wt+1)))}else Rt(it,!0)&&!it.nodeType?(J[Q]=ut(it)?[]:{},E(it,R[Q]||{},J[Q],wt+1),Object.keys(J[Q]).length!==0||Q==="colorAxis"&&wt===0||delete J[Q]):(w[Q]!==R[Q]||Q in w&&!(Q in R))&&(J[Q]=ot[Q])})}(g,v,k,0),k},discardElement:function(g){g&&g.parentElement&&g.parentElement.removeChild(g)},erase:function(g,v){let y=g.length;for(;y--;)if(g[y]===v){g.splice(y,1);break}},error:Nt,extend:U,extendClass:function(g,v){let y=function(){};return y.prototype=new g,U(y.prototype,v),y},find:V,fireEvent:C,getClosestDistance:function(g,v){let y,T,k,E=!v;return g.forEach(w=>{if(w.length>1)for(k=w.length-1;k>0;k--)(T=w[k]-w[k-1])<0&&!E?(v==null||v(),v=void 0):T&&(y===void 0||T<y)&&(y=T)}),y},getMagnitude:_t,getNestedProperty:function(g,v){let y=g.split(".");for(;y.length&&W(v);){let T=y.shift();if(T===void 0||T==="__proto__")return;if(T==="this"){let E;return Rt(v)&&(E=v["@this"]),E??v}let k=v[T];if(!W(k)||typeof k=="function"||typeof k.nodeType=="number"||k===dt)return;v=k}return v},getStyle:function g(v,y,T){let k;if(y==="width"){let w=Math.min(v.offsetWidth,v.scrollWidth),R=v.getBoundingClientRect&&v.getBoundingClientRect().width;return R<w&&R>=w-1&&(w=Math.floor(R)),Math.max(0,w-(g(v,"padding-left",!0)||0)-(g(v,"padding-right",!0)||0))}if(y==="height")return Math.max(0,Math.min(v.offsetHeight,v.scrollHeight)-(g(v,"padding-top",!0)||0)-(g(v,"padding-bottom",!0)||0));let E=dt.getComputedStyle(v,void 0);return E&&(k=E.getPropertyValue(y),j(T,y!=="opacity")&&(k=Lt(k))),k},inArray:function(g,v,y){return Nt(32,!1,void 0,{"Highcharts.inArray":"use Array.indexOf"}),v.indexOf(g,y)},insertItem:function(g,v){let y,T=g.options.index,k=v.length;for(y=g.options.isInternal?k:0;y<k+1;y++)if(!v[y]||at(T)&&T<j(v[y].options.index,v[y]._i)||v[y].options.isInternal){v.splice(y,0,g);break}return y},isArray:ut,isClass:lt,isDOMElement:Z,isFunction:function(g){return typeof g=="function"},isNumber:at,isObject:Rt,isString:kt,keys:function(g){return Nt(32,!1,void 0,{"Highcharts.keys":"use Object.keys"}),Object.keys(g)},merge:function(){let g,v=arguments,y={},T=function(E,w){return typeof E!="object"&&(E={}),rt(w,function(R,J){J!=="__proto__"&&J!=="constructor"&&(!Rt(R,!0)||lt(R)||Z(R)?E[J]=w[J]:E[J]=T(E[J]||{},R))}),E};v[0]===!0&&(y=v[1],v=Array.prototype.slice.call(v,2));let k=v.length;for(g=0;g<k;g++)y=T(y,v[g]);return y},normalizeTickInterval:function(g,v,y,T,k){let E,w=g;y=j(y,_t(g));let R=g/y;for(!v&&(v=k?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],T===!1&&(y===1?v=v.filter(function(J){return J%1==0}):y<=.1&&(v=[1/y]))),E=0;E<v.length&&(w=v[E],(!k||!(w*y>=g))&&(k||!(R<=(v[E]+(v[E+1]||v[E]))/2)));E++);return mt(w*y,-Math.round(Math.log(.001)/Math.LN10))},objectEach:rt,offset:function(g){let v=Zt.documentElement,y=g.parentElement||g.parentNode?g.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:y.top+(dt.pageYOffset||v.scrollTop)-(v.clientTop||0),left:y.left+(dt.pageXOffset||v.scrollLeft)-(v.clientLeft||0),width:y.width,height:y.height}},pad:function(g,v,y){return Array((v||2)+1-String(g).replace("-","").length).join(y||"0")+g},pick:j,pInt:Lt,pushUnique:function(g,v){return 0>g.indexOf(v)&&!!g.push(v)},relativeLength:function(g,v,y){return/%$/.test(g)?v*parseFloat(g)/100+(y||0):parseFloat(g)},removeEvent:I,splat:$,stableSort:function(g,v){let y,T,k=g.length;for(T=0;T<k;T++)g[T].safeI=T;for(g.sort(function(E,w){return(y=v(E,w))===0?E.safeI-w.safeI:y}),T=0;T<k;T++)delete g[T].safeI},syncTimeout:function(g,v,y){return v>0?setTimeout(g,v,y):(g.call(0,y),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},uniqueKey:z,useSerialIds:function(g){return At=j(g,At)},wrap:function(g,v,y){let T=g[v];g[v]=function(){let k=arguments,E=this;return y.apply(this,[function(){return T.apply(E,arguments.length?arguments:k)}].concat([].slice.call(arguments)))}}}}),te(X,"Core/Chart/ChartDefaults.js",[],function(){return{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"}}),te(X,"Core/Color/Palettes.js",[],function(){return{colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"]}}),te(X,"Core/Time.js",[X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At){let{win:l}=Et,{defined:Zt,error:dt,extend:Nt,isNumber:Lt,isObject:kt,merge:ut,objectEach:Rt,pad:Z,pick:lt,splat:at,timeUnits:W}=At,q=Et.isSafari&&l.Intl&&l.Intl.DateTimeFormat.prototype.formatRange,$=Et.isSafari&&l.Intl&&!l.Intl.DateTimeFormat.prototype.formatRange;return class{constructor(U){this.options={},this.useUTC=!1,this.variableTimezone=!1,this.Date=l.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(U)}get(U,j){if(this.variableTimezone||this.timezoneOffset){let et=j.getTime(),_t=et-this.getTimezoneOffset(j);j.setTime(_t);let mt=j["getUTC"+U]();return j.setTime(et),mt}return this.useUTC?j["getUTC"+U]():j["get"+U]()}set(U,j,et){if(this.variableTimezone||this.timezoneOffset){if(U==="Milliseconds"||U==="Seconds"||U==="Minutes"&&this.getTimezoneOffset(j)%36e5==0)return j["setUTC"+U](et);let _t=this.getTimezoneOffset(j),mt=j.getTime()-_t;j.setTime(mt),j["setUTC"+U](et);let V=this.getTimezoneOffset(j);return mt=j.getTime()+V,j.setTime(mt)}return this.useUTC||q&&U==="FullYear"?j["setUTC"+U](et):j["set"+U](et)}update(U={}){let j=lt(U.useUTC,!0);this.options=U=ut(!0,this.options,U),this.Date=U.Date||l.Date||Date,this.useUTC=j,this.timezoneOffset=j&&U.timezoneOffset||void 0,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=j&&!!(U.getTimezoneOffset||U.timezone)}makeTime(U,j,et,_t,mt,V){let rt,I,C;return this.useUTC?(rt=this.Date.UTC.apply(0,arguments),I=this.getTimezoneOffset(rt),rt+=I,I!==(C=this.getTimezoneOffset(rt))?rt+=C-I:I-36e5!==this.getTimezoneOffset(rt-36e5)||$||(rt-=36e5)):rt=new this.Date(U,j,lt(et,1),lt(_t,0),lt(mt,0),lt(V,0)).getTime(),rt}timezoneOffsetFunction(){let U=this,j=this.options,et=j.getTimezoneOffset;return this.useUTC?j.timezone?_t=>{try{let[mt,V,rt,I,C=0]=Intl.DateTimeFormat("en",{timeZone:j.timezone,timeZoneName:"shortOffset"}).format(_t).split(/(GMT|:)/).map(Number),z=-(36e5*(rt+C/60));if(Lt(z))return z}catch{dt(34)}return 0}:this.useUTC&&et?_t=>6e4*et(_t.valueOf()):()=>6e4*(U.timezoneOffset||0):_t=>6e4*new Date(_t.toString()).getTimezoneOffset()}dateFormat(U,j,et){if(!Zt(j)||isNaN(j))return Et.defaultOptions.lang&&Et.defaultOptions.lang.invalidDate||"";U=lt(U,"%Y-%m-%d %H:%M:%S");let _t=this,mt=new this.Date(j),V=this.get("Hours",mt),rt=this.get("Day",mt),I=this.get("Date",mt),C=this.get("Month",mt),z=this.get("FullYear",mt),S=Et.defaultOptions.lang,g=S&&S.weekdays,v=S&&S.shortWeekdays,y=Nt({a:v?v[rt]:g[rt].substr(0,3),A:g[rt],d:Z(I),e:Z(I,2," "),w:rt,b:S.shortMonths[C],B:S.months[C],m:Z(C+1),o:C+1,y:z.toString().substr(2,2),Y:z,H:Z(V),k:V,I:Z(V%12||12),l:V%12||12,M:Z(this.get("Minutes",mt)),p:V<12?"AM":"PM",P:V<12?"am":"pm",S:Z(this.get("Seconds",mt)),L:Z(Math.floor(j%1e3),3)},Et.dateFormats);return Rt(y,function(T,k){for(;U.indexOf("%"+k)!==-1;)U=U.replace("%"+k,typeof T=="function"?T.call(_t,j):T)}),et?U.substr(0,1).toUpperCase()+U.substr(1):U}resolveDTLFormat(U){return kt(U,!0)?U:{main:(U=at(U))[0],from:U[1],to:U[2]}}getTimeTicks(U,j,et,_t){let mt,V,rt,I,C=this,z=C.Date,S=[],g={},v=new z(j),y=U.unitRange,T=U.count||1;if(_t=lt(_t,1),Zt(j)){C.set("Milliseconds",v,y>=W.second?0:T*Math.floor(C.get("Milliseconds",v)/T)),y>=W.second&&C.set("Seconds",v,y>=W.minute?0:T*Math.floor(C.get("Seconds",v)/T)),y>=W.minute&&C.set("Minutes",v,y>=W.hour?0:T*Math.floor(C.get("Minutes",v)/T)),y>=W.hour&&C.set("Hours",v,y>=W.day?0:T*Math.floor(C.get("Hours",v)/T)),y>=W.day&&C.set("Date",v,y>=W.month?1:Math.max(1,T*Math.floor(C.get("Date",v)/T))),y>=W.month&&(C.set("Month",v,y>=W.year?0:T*Math.floor(C.get("Month",v)/T)),V=C.get("FullYear",v)),y>=W.year&&(V-=V%T,C.set("FullYear",v,V)),y===W.week&&(I=C.get("Day",v),C.set("Date",v,C.get("Date",v)-I+_t+(I<_t?-7:0))),V=C.get("FullYear",v);let k=C.get("Month",v),E=C.get("Date",v),w=C.get("Hours",v);j=v.getTime(),(C.variableTimezone||!C.useUTC)&&Zt(et)&&(rt=et-j>4*W.month||C.getTimezoneOffset(j)!==C.getTimezoneOffset(et));let R=v.getTime();for(mt=1;R<et;)S.push(R),y===W.year?R=C.makeTime(V+mt*T,0):y===W.month?R=C.makeTime(V,k+mt*T):rt&&(y===W.day||y===W.week)?R=C.makeTime(V,k,E+mt*T*(y===W.day?1:7)):rt&&y===W.hour&&T>1?R=C.makeTime(V,k,E,w+mt*T):R+=y*T,mt++;S.push(R),y<=W.hour&&S.length<1e4&&S.forEach(function(J){J%18e5==0&&C.dateFormat("%H%M%S%L",J)==="000000000"&&(g[J]="day")})}return S.info=Nt(U,{higherRanks:g,totalRange:y*T}),S}getDateFormat(U,j,et,_t){let mt=this.dateFormat("%m-%d %H:%M:%S.%L",j),V="01-01 00:00:00.000",rt={millisecond:15,second:12,minute:9,hour:6,day:3},I="millisecond",C=I;for(I in W){if(U===W.week&&+this.dateFormat("%w",j)===et&&mt.substr(6)===V.substr(6)){I="week";break}if(W[I]>U){I=C;break}if(rt[I]&&mt.substr(rt[I])!==V.substr(rt[I]))break;I!=="week"&&(C=I)}return this.resolveDTLFormat(_t[I]).main}}}),te(X,"Core/Defaults.js",[X["Core/Chart/ChartDefaults.js"],X["Core/Globals.js"],X["Core/Color/Palettes.js"],X["Core/Time.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt){let{isTouchDevice:Nt,svg:Lt}=At,{merge:kt}=dt,ut={colors:l.colors,symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{},time:{Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},chart:Et,title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:"",align:"center",widthAdjust:-44},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:Lt,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %e %b, %H:%M:%S.%L",second:"%A, %e %b, %H:%M:%S",minute:"%A, %e %b, %H:%M",hour:"%A, %e %b, %H:%M",day:"%A, %e %b %Y",week:"Week from %A, %e %b %Y",month:"%B %Y",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,shape:"callout",shared:!1,snap:Nt?25:10,headerFormat:'<span style="font-size: 0.8em">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,shadow:!0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}};ut.chart.styledMode=!1;let Rt=new Zt(ut.time);return{defaultOptions:ut,defaultTime:Rt,getOptions:function(){return ut},setOptions:function(Z){return kt(!0,ut,Z),(Z.time||Z.global)&&(At.time?At.time.update(kt(ut.global,ut.time,Z.global,Z.time)):At.time=Rt),ut}}}),te(X,"Core/Color/Color.js",[X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At){let{isNumber:l,merge:Zt,pInt:dt}=At;class Nt{static parse(kt){return kt?new Nt(kt):Nt.None}constructor(kt){let ut,Rt,Z,lt;this.rgba=[NaN,NaN,NaN,NaN],this.input=kt;let at=Et.Color;if(at&&at!==Nt)return new at(kt);if(typeof kt=="object"&&kt.stops!==void 0)this.stops=kt.stops.map(W=>new Nt(W[1]));else if(typeof kt=="string"){if(this.input=kt=Nt.names[kt.toLowerCase()]||kt,kt.charAt(0)==="#"){let W=kt.length,q=parseInt(kt.substr(1),16);W===7?Rt=[(16711680&q)>>16,(65280&q)>>8,255&q,1]:W===4&&(Rt=[(3840&q)>>4|(3840&q)>>8,(240&q)>>4|240&q,(15&q)<<4|15&q,1])}if(!Rt)for(Z=Nt.parsers.length;Z--&&!Rt;)(ut=(lt=Nt.parsers[Z]).regex.exec(kt))&&(Rt=lt.parse(ut))}Rt&&(this.rgba=Rt)}get(kt){let ut=this.input,Rt=this.rgba;if(typeof ut=="object"&&this.stops!==void 0){let Z=Zt(ut);return Z.stops=[].slice.call(Z.stops),this.stops.forEach((lt,at)=>{Z.stops[at]=[Z.stops[at][0],lt.get(kt)]}),Z}return Rt&&l(Rt[0])?kt!=="rgb"&&(kt||Rt[3]!==1)?kt==="a"?`${Rt[3]}`:"rgba("+Rt.join(",")+")":"rgb("+Rt[0]+","+Rt[1]+","+Rt[2]+")":ut}brighten(kt){let ut=this.rgba;if(this.stops)this.stops.forEach(function(Rt){Rt.brighten(kt)});else if(l(kt)&&kt!==0)for(let Rt=0;Rt<3;Rt++)ut[Rt]+=dt(255*kt),ut[Rt]<0&&(ut[Rt]=0),ut[Rt]>255&&(ut[Rt]=255);return this}setOpacity(kt){return this.rgba[3]=kt,this}tweenTo(kt,ut){let Rt=this.rgba,Z=kt.rgba;if(!l(Rt[0])||!l(Z[0]))return kt.input||"none";let lt=Z[3]!==1||Rt[3]!==1;return(lt?"rgba(":"rgb(")+Math.round(Z[0]+(Rt[0]-Z[0])*(1-ut))+","+Math.round(Z[1]+(Rt[1]-Z[1])*(1-ut))+","+Math.round(Z[2]+(Rt[2]-Z[2])*(1-ut))+(lt?","+(Z[3]+(Rt[3]-Z[3])*(1-ut)):"")+")"}}return Nt.names={white:"#ffffff",black:"#000000"},Nt.parsers=[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(Lt){return[dt(Lt[1]),dt(Lt[2]),dt(Lt[3]),parseFloat(Lt[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(Lt){return[dt(Lt[1]),dt(Lt[2]),dt(Lt[3]),1]}}],Nt.None=new Nt(""),Nt}),te(X,"Core/Animation/Fx.js",[X["Core/Color/Color.js"],X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At,l){let{parse:Zt}=Et,{win:dt}=At,{isNumber:Nt,objectEach:Lt}=l;class kt{constructor(Rt,Z,lt){this.pos=NaN,this.options=Z,this.elem=Rt,this.prop=lt}dSetter(){let Rt=this.paths,Z=Rt&&Rt[0],lt=Rt&&Rt[1],at=this.now||0,W=[];if(at!==1&&Z&&lt)if(Z.length===lt.length&&at<1)for(let q=0;q<lt.length;q++){let $=Z[q],U=lt[q],j=[];for(let et=0;et<U.length;et++){let _t=$[et],mt=U[et];Nt(_t)&&Nt(mt)&&!(U[0]==="A"&&(et===4||et===5))?j[et]=_t+at*(mt-_t):j[et]=mt}W.push(j)}else W=lt;else W=this.toD||[];this.elem.attr("d",W,void 0,!0)}update(){let Rt=this.elem,Z=this.prop,lt=this.now,at=this.options.step;this[Z+"Setter"]?this[Z+"Setter"]():Rt.attr?Rt.element&&Rt.attr(Z,lt,null,!0):Rt.style[Z]=lt+this.unit,at&&at.call(Rt,lt,this)}run(Rt,Z,lt){let at=this,W=at.options,q=function(j){return!q.stopped&&at.step(j)},$=dt.requestAnimationFrame||function(j){setTimeout(j,13)},U=function(){for(let j=0;j<kt.timers.length;j++)kt.timers[j]()||kt.timers.splice(j--,1);kt.timers.length&&$(U)};Rt!==Z||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=Rt,this.end=Z,this.unit=lt,this.now=this.start,this.pos=0,q.elem=this.elem,q.prop=this.prop,q()&&kt.timers.push(q)===1&&$(U)):(delete W.curAnim[this.prop],W.complete&&Object.keys(W.curAnim).length===0&&W.complete.call(this.elem))}step(Rt){let Z,lt,at=+new Date,W=this.options,q=this.elem,$=W.complete,U=W.duration,j=W.curAnim;return q.attr&&!q.element?Z=!1:Rt||at>=U+this.startTime?(this.now=this.end,this.pos=1,this.update(),j[this.prop]=!0,lt=!0,Lt(j,function(et){et!==!0&&(lt=!1)}),lt&&$&&$.call(q),Z=!1):(this.pos=W.easing((at-this.startTime)/U),this.now=this.start+(this.end-this.start)*this.pos,this.update(),Z=!0),Z}initPath(Rt,Z,lt){let at=Rt.startX,W=Rt.endX,q=lt.slice(),$=Rt.isArea,U=$?2:1,j,et,_t,mt,V=Z&&Z.slice();if(!V)return[q,q];function rt(C,z){for(;C.length<et;){let S=C[0],g=z[et-C.length];if(g&&S[0]==="M"&&(g[0]==="C"?C[0]=["C",S[1],S[2],S[1],S[2],S[1],S[2]]:C[0]=["L",S[1],S[2]]),C.unshift(S),$){let v=C.pop();C.push(C[C.length-1],v)}}}function I(C,z){for(;C.length<et;){let S=C[Math.floor(C.length/U)-1].slice();if(S[0]==="C"&&(S[1]=S[5],S[2]=S[6]),$){let g=C[Math.floor(C.length/U)].slice();C.splice(C.length/2,0,S,g)}else C.push(S)}}if(at&&W&&W.length){for(_t=0;_t<at.length;_t++){if(at[_t]===W[0]){j=_t;break}if(at[0]===W[W.length-at.length+_t]){j=_t,mt=!0;break}if(at[at.length-1]===W[W.length-at.length+_t]){j=at.length-_t;break}}j===void 0&&(V=[])}return V.length&&Nt(j)&&(et=q.length+j*U,mt?(rt(V,q),I(q)):(rt(q,V),I(V))),[V,q]}fillSetter(){kt.prototype.strokeSetter.apply(this,arguments)}strokeSetter(){this.elem.attr(this.prop,Zt(this.start).tweenTo(Zt(this.end),this.pos),void 0,!0)}}return kt.timers=[],kt}),te(X,"Core/Animation/AnimationUtilities.js",[X["Core/Animation/Fx.js"],X["Core/Utilities.js"]],function(Et,At){let{defined:l,getStyle:Zt,isArray:dt,isNumber:Nt,isObject:Lt,merge:kt,objectEach:ut,pick:Rt}=At;function Z(at){return Lt(at)?kt({duration:500,defer:0},at):{duration:at?500:0,defer:0}}function lt(at,W){let q=Et.timers.length;for(;q--;)Et.timers[q].elem!==at||W&&W!==Et.timers[q].prop||(Et.timers[q].stopped=!0)}return{animate:function(at,W,q){let $,U="",j,et,_t;Lt(q)||(_t=arguments,q={duration:_t[2],easing:_t[3],complete:_t[4]}),Nt(q.duration)||(q.duration=400),q.easing=typeof q.easing=="function"?q.easing:Math[q.easing]||Math.easeInOutSine,q.curAnim=kt(W),ut(W,function(mt,V){lt(at,V),et=new Et(at,q,V),j=void 0,V==="d"&&dt(W.d)?(et.paths=et.initPath(at,at.pathArray,W.d),et.toD=W.d,$=0,j=1):at.attr?$=at.attr(V):($=parseFloat(Zt(at,V))||0,V!=="opacity"&&(U="px")),j||(j=mt),typeof j=="string"&&j.match("px")&&(j=j.replace(/px/g,"")),et.run($,j,U)})},animObject:Z,getDeferredAnimation:function(at,W,q){let $=Z(W),U=q?[q]:at.series,j=0,et=0;return U.forEach(mt=>{let V=Z(mt.options.animation);j=Lt(W)&&l(W.defer)?$.defer:Math.max(j,V.duration+V.defer),et=Math.min($.duration,V.duration)}),at.renderer.forExport&&(j=0),{defer:Math.max(0,j-et),duration:Math.min(j,et)}},setAnimation:function(at,W){W.renderer.globalAnimation=Rt(at,W.options.chart.animation,!0)},stop:lt}}),te(X,"Core/Renderer/HTML/AST.js",[X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At){let{SVG_NS:l,win:Zt}=Et,{attr:dt,createElement:Nt,css:Lt,error:kt,isFunction:ut,isString:Rt,objectEach:Z,splat:lt}=At,{trustedTypes:at}=Zt,W=at&&ut(at.createPolicy)&&at.createPolicy("highcharts",{createHTML:j=>j}),q=W?W.createHTML(""):"",$=function(){try{return!!new DOMParser().parseFromString(q,"text/html")}catch{return!1}}();class U{static filterUserAttributes(et){return Z(et,(_t,mt)=>{let V=!0;U.allowedAttributes.indexOf(mt)===-1&&(V=!1),["background","dynsrc","href","lowsrc","src"].indexOf(mt)!==-1&&(V=Rt(_t)&&U.allowedReferences.some(rt=>_t.indexOf(rt)===0)),V||(kt(33,!1,void 0,{"Invalid attribute in config":`${mt}`}),delete et[mt]),Rt(_t)&&et[mt]&&(et[mt]=_t.replace(/</g,"&lt;"))}),et}static parseStyle(et){return et.split(";").reduce((_t,mt)=>{let V=mt.split(":").map(I=>I.trim()),rt=V.shift();return rt&&V.length&&(_t[rt.replace(/-([a-z])/g,I=>I[1].toUpperCase())]=V.join(":")),_t},{})}static setElementHTML(et,_t){et.innerHTML=U.emptyHTML,_t&&new U(_t).addToDOM(et)}constructor(et){this.nodes=typeof et=="string"?this.parseMarkup(et):et}addToDOM(et){return function _t(mt,V){let rt;return lt(mt).forEach(function(I){let C,z=I.tagName,S=I.textContent?Et.doc.createTextNode(I.textContent):void 0,g=U.bypassHTMLFiltering;if(z)if(z==="#text")C=S;else if(U.allowedTags.indexOf(z)!==-1||g){let v=z==="svg"?l:V.namespaceURI||l,y=Et.doc.createElementNS(v,z),T=I.attributes||{};Z(I,function(k,E){E!=="tagName"&&E!=="attributes"&&E!=="children"&&E!=="style"&&E!=="textContent"&&(T[E]=k)}),dt(y,g?T:U.filterUserAttributes(T)),I.style&&Lt(y,I.style),S&&y.appendChild(S),_t(I.children||[],y),C=y}else kt(33,!1,void 0,{"Invalid tagName in config":z});C&&V.appendChild(C),rt=C}),rt}(this.nodes,et)}parseMarkup(et){let _t,mt=[];if(et=et.trim().replace(/ style=(["'])/g," data-style=$1"),$)_t=new DOMParser().parseFromString(W?W.createHTML(et):et,"text/html");else{let rt=Nt("div");rt.innerHTML=et,_t={body:rt}}let V=(rt,I)=>{let C=rt.nodeName.toLowerCase(),z={tagName:C};C==="#text"&&(z.textContent=rt.textContent||"");let S=rt.attributes;if(S){let g={};[].forEach.call(S,v=>{v.name==="data-style"?z.style=U.parseStyle(v.value):g[v.name]=v.value}),z.attributes=g}if(rt.childNodes.length){let g=[];[].forEach.call(rt.childNodes,v=>{V(v,g)}),g.length&&(z.children=g)}I.push(z)};return[].forEach.call(_t.body.childNodes,rt=>V(rt,mt)),mt}}return U.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","dx","dy","disabled","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","markerHeight","markerWidth","offset","opacity","orient","padding","paddingLeft","paddingRight","patternUnits","r","refX","refY","role","scope","slope","src","startOffset","stdDeviation","stroke","stroke-linecap","stroke-width","style","tableValues","result","rowspan","summary","target","tabindex","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],U.allowedReferences=["https://","http://","mailto:","/","../","./","#"],U.allowedTags=["a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feDropShadow","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feOffset","feMerge","feMergeNode","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","text","textPath","thead","title","tbody","tspan","td","th","tr","u","ul","#text"],U.emptyHTML=q,U.bypassHTMLFiltering=!1,U}),te(X,"Core/Templating.js",[X["Core/Defaults.js"],X["Core/Utilities.js"]],function(Et,At){let{defaultOptions:l,defaultTime:Zt}=Et,{extend:dt,getNestedProperty:Nt,isArray:Lt,isNumber:kt,isObject:ut,isString:Rt,pick:Z,pInt:lt}=At,at={add:($,U)=>$+U,divide:($,U)=>U!==0?$/U:"",eq:($,U)=>$==U,each:function($){let U=arguments[arguments.length-1];return!!Lt($)&&$.map((j,et)=>W(U.body,dt(ut(j)?j:{"@this":j},{"@index":et,"@first":et===0,"@last":et===$.length-1}))).join("")},ge:($,U)=>$>=U,gt:($,U)=>$>U,if:$=>!!$,le:($,U)=>$<=U,lt:($,U)=>$<U,multiply:($,U)=>$*U,ne:($,U)=>$!=U,subtract:($,U)=>$-U,unless:$=>!$};function W($="",U,j){let et=/\{([a-zA-Z0-9\:\.\,;\-\/<>%_@"'= #\(\)]+)\}/g,_t=/\(([a-zA-Z0-9\:\.\,;\-\/<>%_@"'= ]+)\)/g,mt=[],V=/f$/,rt=/\.([0-9])/,I=l.lang,C=j&&j.time||Zt,z=j&&j.numberFormatter||q,S=(k="")=>{let E;return k==="true"||k!=="false"&&((E=Number(k)).toString()===k?E:Nt(k,U))},g,v,y=0,T;for(;(g=et.exec($))!==null;){let k=_t.exec(g[1]);k&&(g=k,T=!0),v&&v.isBlock||(v={ctx:U,expression:g[1],find:g[0],isBlock:g[1].charAt(0)==="#",start:g.index,startInner:g.index+g[0].length,length:g[0].length});let E=g[1].split(" ")[0].replace("#","");at[E]&&(v.isBlock&&E===v.fn&&y++,v.fn||(v.fn=E));let w=g[1]==="else";if(v.isBlock&&v.fn&&(g[1]===`/${v.fn}`||w))if(y)!w&&y--;else{let R=v.startInner,J=$.substr(R,g.index-R);v.body===void 0?(v.body=J,v.startInner=g.index+g[0].length):v.elseBody=J,v.find+=J+g[0],w||(mt.push(v),v=void 0)}else v.isBlock||mt.push(v);if(k&&!(v!=null&&v.isBlock))break}return mt.forEach(k=>{let E,w,{body:R,elseBody:J,expression:wt,fn:ot}=k;if(ot){let it=[k],Q=wt.split(" ");for(w=at[ot].length;w--;)it.unshift(S(Q[w+1]));E=at[ot].apply(U,it),k.isBlock&&typeof E=="boolean"&&(E=W(E?R:J,U))}else{let it=wt.split(":");if(E=S(it.shift()||""),it.length&&typeof E=="number"){let Q=it.join(":");if(V.test(Q)){let A=parseInt((Q.match(rt)||["","-1"])[1],10);E!==null&&(E=z(E,A,I.decimalPoint,Q.indexOf(",")>-1?I.thousandsSep:""))}else E=C.dateFormat(Q,E)}}$=$.replace(k.find,Z(E,""))}),T?W($,U,j):$}function q($,U,j,et){let _t,mt;$=+$||0,U=+U;let V=l.lang,rt=($.toString().split(".")[1]||"").split("e")[0].length,I=$.toString().split("e"),C=U;U===-1?U=Math.min(rt,20):kt(U)?U&&I[1]&&I[1]<0&&((mt=U+ +I[1])>=0?(I[0]=(+I[0]).toExponential(mt).split("e")[0],U=mt):(I[0]=I[0].split(".")[0]||0,$=U<20?(I[0]*Math.pow(10,I[1])).toFixed(U):0,I[1]=0)):U=2;let z=(Math.abs(I[1]?I[0]:$)+Math.pow(10,-Math.max(U,rt)-1)).toFixed(U),S=String(lt(z)),g=S.length>3?S.length%3:0;return j=Z(j,V.decimalPoint),et=Z(et,V.thousandsSep),_t=($<0?"-":"")+(g?S.substr(0,g)+et:""),0>+I[1]&&!C?_t="0":_t+=S.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+et),U&&(_t+=j+z.slice(-U)),I[1]&&+_t!=0&&(_t+="e"+I[1]),_t}return{dateFormat:function($,U,j){return Zt.dateFormat($,U,j)},format:W,helpers:at,numberFormat:q}}),te(X,"Core/Renderer/RendererUtilities.js",[X["Core/Utilities.js"]],function(Et){var At;let{clamp:l,pick:Zt,pushUnique:dt,stableSort:Nt}=Et;return(At||(At={})).distribute=function Lt(kt,ut,Rt){let Z=kt,lt=Z.reducedLen||ut,at=(z,S)=>z.target-S.target,W=[],q=kt.length,$=[],U=W.push,j,et,_t,mt=!0,V,rt,I=0,C;for(j=q;j--;)I+=kt[j].size;if(I>lt){for(Nt(kt,(z,S)=>(S.rank||0)-(z.rank||0)),_t=(C=kt[0].rank===kt[kt.length-1].rank)?q/2:-1,et=C?_t:q-1;_t&&I>lt;)V=kt[j=Math.floor(et)],dt($,j)&&(I-=V.size),et+=_t,C&&et>=kt.length&&(_t/=2,et=_t);$.sort((z,S)=>S-z).forEach(z=>U.apply(W,kt.splice(z,1)))}for(Nt(kt,at),kt=kt.map(z=>({size:z.size,targets:[z.target],align:Zt(z.align,.5)}));mt;){for(j=kt.length;j--;)V=kt[j],rt=(Math.min.apply(0,V.targets)+Math.max.apply(0,V.targets))/2,V.pos=l(rt-V.size*V.align,0,ut-V.size);for(j=kt.length,mt=!1;j--;)j>0&&kt[j-1].pos+kt[j-1].size>kt[j].pos&&(kt[j-1].size+=kt[j].size,kt[j-1].targets=kt[j-1].targets.concat(kt[j].targets),kt[j-1].align=.5,kt[j-1].pos+kt[j-1].size>ut&&(kt[j-1].pos=ut-kt[j-1].size),kt.splice(j,1),mt=!0)}return U.apply(Z,W),j=0,kt.some(z=>{let S=0;return(z.targets||[]).some(()=>(Z[j].pos=z.pos+S,Rt!==void 0&&Math.abs(Z[j].pos-Z[j].target)>Rt?(Z.slice(0,j+1).forEach(g=>delete g.pos),Z.reducedLen=(Z.reducedLen||ut)-.1*ut,Z.reducedLen>.1*ut&&Lt(Z,ut,Rt),!0):(S+=Z[j].size,j++,!1)))}),Nt(Z,at),Z},At}),te(X,"Core/Renderer/SVG/SVGElement.js",[X["Core/Animation/AnimationUtilities.js"],X["Core/Color/Color.js"],X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt){let{animate:dt,animObject:Nt,stop:Lt}=Et,{deg2rad:kt,doc:ut,noop:Rt,svg:Z,SVG_NS:lt,win:at}=l,{addEvent:W,attr:q,createElement:$,css:U,defined:j,erase:et,extend:_t,fireEvent:mt,isArray:V,isFunction:rt,isObject:I,isString:C,merge:z,objectEach:S,pick:g,pInt:v,syncTimeout:y,uniqueKey:T}=Zt;class k{_defaultGetter(w){let R=g(this[w+"Value"],this[w],this.element?this.element.getAttribute(w):null,0);return/^[\-0-9\.]+$/.test(R)&&(R=parseFloat(R)),R}_defaultSetter(w,R,J){J.setAttribute(R,w)}add(w){let R,J=this.renderer,wt=this.element;return w&&(this.parentGroup=w),this.textStr!==void 0&&this.element.nodeName==="text"&&J.buildText(this),this.added=!0,(!w||w.handleZ||this.zIndex)&&(R=this.zIndexSetter()),R||(w?w.element:J.box).appendChild(wt),this.onAdd&&this.onAdd(),this}addClass(w,R){let J=R?"":this.attr("class")||"";return(w=(w||"").split(/ /g).reduce(function(wt,ot){return J.indexOf(ot)===-1&&wt.push(ot),wt},J?[J]:[]).join(" "))!==J&&this.attr("class",w),this}afterSetters(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)}align(w,R,J){let wt,ot,it,Q,A,B={},K=this.renderer,pt=K.alignedObjects;w?(this.alignOptions=w,this.alignByTranslate=R,(!J||C(J))&&(this.alignTo=it=J||"renderer",et(pt,this),pt.push(this),J=void 0)):(w=this.alignOptions,R=this.alignByTranslate,it=this.alignTo),J=g(J,K[it],it==="scrollablePlotBox"?K.plotBox:void 0,K);let _=w.align,P=w.verticalAlign;return wt=(J.x||0)+(w.x||0),ot=(J.y||0)+(w.y||0),_==="right"?Q=1:_==="center"&&(Q=2),Q&&(wt+=(J.width-(w.width||0))/Q),B[R?"translateX":"x"]=Math.round(wt),P==="bottom"?A=1:P==="middle"&&(A=2),A&&(ot+=(J.height-(w.height||0))/A),B[R?"translateY":"y"]=Math.round(ot),this[this.placed?"animate":"attr"](B),this.placed=!0,this.alignAttr=B,this}alignSetter(w){let R={left:"start",center:"middle",right:"end"};R[w]&&(this.alignValue=w,this.element.setAttribute("text-anchor",R[w]))}animate(w,R,J){let wt=Nt(g(R,this.renderer.globalAnimation,!0)),ot=wt.defer;return ut.hidden&&(wt.duration=0),wt.duration!==0?(J&&(wt.complete=J),y(()=>{this.element&&dt(this,w,wt)},ot)):(this.attr(w,void 0,J||wt.complete),S(w,function(it,Q){wt.step&&wt.step.call(this,it,{prop:Q,pos:1,elem:this})},this)),this}applyTextOutline(w){let R=this.element;w.indexOf("contrast")!==-1&&(w=w.replace(/contrast/g,this.renderer.getContrast(R.style.fill)));let wt=w.split(" "),ot=wt[wt.length-1],it=wt[0];if(it&&it!=="none"&&l.svg){this.fakeTS=!0,it=it.replace(/(^[\d\.]+)(.*?)$/g,function(pt,_,P){return 2*Number(_)+P}),this.removeTextOutline();let Q=ut.createElementNS(lt,"tspan");q(Q,{class:"highcharts-text-outline",fill:ot,stroke:ot,"stroke-width":it,"stroke-linejoin":"round"});let A=R.querySelector("textPath")||R;[].forEach.call(A.childNodes,pt=>{let _=pt.cloneNode(!0);_.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach(P=>_.removeAttribute(P)),Q.appendChild(_)});let B=0;[].forEach.call(A.querySelectorAll("text tspan"),pt=>{B+=Number(pt.getAttribute("dy"))});let K=ut.createElementNS(lt,"tspan");K.textContent="​",q(K,{x:Number(R.getAttribute("x")),dy:-B}),Q.appendChild(K),A.insertBefore(Q,A.firstChild)}}attr(w,R,J,wt){let ot=this.element,it=k.symbolCustomAttribs,Q,A,B=this,K;return typeof w=="string"&&R!==void 0&&(Q=w,(w={})[Q]=R),typeof w=="string"?B=(this[w+"Getter"]||this._defaultGetter).call(this,w,ot):(S(w,function(pt,_){K=!1,wt||Lt(this,_),this.symbolName&&it.indexOf(_)!==-1&&(A||(this.symbolAttr(w),A=!0),K=!0),this.rotation&&(_==="x"||_==="y")&&(this.doTransform=!0),K||(this[_+"Setter"]||this._defaultSetter).call(this,pt,_,ot)},this),this.afterSetters()),J&&J.call(this),B}clip(w){if(w&&!w.clipPath){let R=T()+"-",J=this.renderer.createElement("clipPath").attr({id:R}).add(this.renderer.defs);_t(w,{clipPath:J,id:R,count:0}),w.add(J)}return this.attr("clip-path",w?`url(${this.renderer.url}#${w.id})`:"none")}crisp(w,R){R=R||w.strokeWidth||0;let J=Math.round(R)%2/2;return w.x=Math.floor(w.x||this.x||0)+J,w.y=Math.floor(w.y||this.y||0)+J,w.width=Math.floor((w.width||this.width||0)-2*J),w.height=Math.floor((w.height||this.height||0)-2*J),j(w.strokeWidth)&&(w.strokeWidth=R),w}complexColor(w,R,J){let wt=this.renderer,ot,it,Q,A,B,K,pt,_,P,D,Y=[],G;mt(this.renderer,"complexColor",{args:arguments},function(){if(w.radialGradient?it="radialGradient":w.linearGradient&&(it="linearGradient"),it){if(Q=w[it],B=wt.gradients,K=w.stops,P=J.radialReference,V(Q)&&(w[it]=Q={x1:Q[0],y1:Q[1],x2:Q[2],y2:Q[3],gradientUnits:"userSpaceOnUse"}),it==="radialGradient"&&P&&!j(Q.gradientUnits)&&(A=Q,Q=z(Q,wt.getRadialAttr(P,A),{gradientUnits:"userSpaceOnUse"})),S(Q,function(xt,Ct){Ct!=="id"&&Y.push(Ct,xt)}),S(K,function(xt){Y.push(xt)}),B[Y=Y.join(",")])D=B[Y].attr("id");else{Q.id=D=T();let xt=B[Y]=wt.createElement(it).attr(Q).add(wt.defs);xt.radAttr=A,xt.stops=[],K.forEach(function(Ct){Ct[1].indexOf("rgba")===0?(pt=(ot=At.parse(Ct[1])).get("rgb"),_=ot.get("a")):(pt=Ct[1],_=1);let Dt=wt.createElement("stop").attr({offset:Ct[0],"stop-color":pt,"stop-opacity":_}).add(xt);xt.stops.push(Dt)})}G="url("+wt.url+"#"+D+")",J.setAttribute(R,G),J.gradient=Y,w.toString=function(){return G}}})}css(w){let R=this.styles,J={},wt=this.element,ot,it=!R;if(R&&S(w,function(Q,A){R&&R[A]!==Q&&(J[A]=Q,it=!0)}),it){R&&(w=_t(R,J)),w.width===null||w.width==="auto"?delete this.textWidth:wt.nodeName.toLowerCase()==="text"&&w.width&&(ot=this.textWidth=v(w.width)),this.styles=w,ot&&!Z&&this.renderer.forExport&&delete w.width;let Q=z(w);wt.namespaceURI===this.SVG_NS&&(["textOutline","textOverflow","width"].forEach(A=>Q&&delete Q[A]),Q.color&&(Q.fill=Q.color)),U(wt,Q)}return this.added&&(this.element.nodeName==="text"&&this.renderer.buildText(this),w.textOutline&&this.applyTextOutline(w.textOutline)),this}dashstyleSetter(w){let R,J=this["stroke-width"];if(J==="inherit"&&(J=1),w=w&&w.toLowerCase()){let wt=w.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(R=wt.length;R--;)wt[R]=""+v(wt[R])*g(J,NaN);w=wt.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",w)}}destroy(){var A;let w=this,R=w.element||{},J=w.renderer,wt=R.ownerSVGElement,ot=R.nodeName==="SPAN"&&w.parentGroup||void 0,it,Q;if(R.onclick=R.onmouseout=R.onmouseover=R.onmousemove=R.point=null,Lt(w),w.clipPath&&wt){let B=w.clipPath;[].forEach.call(wt.querySelectorAll("[clip-path],[CLIP-PATH]"),function(K){K.getAttribute("clip-path").indexOf(B.element.id)>-1&&K.removeAttribute("clip-path")}),w.clipPath=B.destroy()}if(w.connector=(A=w.connector)==null?void 0:A.destroy(),w.stops){for(Q=0;Q<w.stops.length;Q++)w.stops[Q].destroy();w.stops.length=0,w.stops=void 0}for(w.safeRemoveChild(R);ot&&ot.div&&ot.div.childNodes.length===0;)it=ot.parentGroup,w.safeRemoveChild(ot.div),delete ot.div,ot=it;w.alignTo&&et(J.alignedObjects,w),S(w,function(B,K){w[K]&&w[K].parentGroup===w&&w[K].destroy&&w[K].destroy(),delete w[K]})}dSetter(w,R,J){V(w)&&(typeof w[0]=="string"&&(w=this.renderer.pathToSegments(w)),this.pathArray=w,w=w.reduce((wt,ot,it)=>ot&&ot.join?(it?wt+" ":"")+ot.join(" "):(ot||"").toString(),"")),/(NaN| {2}|^$)/.test(w)&&(w="M 0 0"),this[R]!==w&&(J.setAttribute(R,w),this[R]=w)}fillSetter(w,R,J){typeof w=="string"?J.setAttribute(R,w):w&&this.complexColor(w,R,J)}hrefSetter(w,R,J){J.setAttributeNS("http://www.w3.org/1999/xlink",R,w)}getBBox(w,R){let J,wt,ot,it,Q,{alignValue:A,element:B,renderer:K,styles:pt,textStr:_}=this,{cache:P,cacheKeys:D}=K,Y=B.namespaceURI===this.SVG_NS,G=g(R,this.rotation,0),xt=K.styledMode?B&&k.prototype.getStyle.call(B,"font-size"):pt&&pt.fontSize;if(j(_)&&((Q=_.toString()).indexOf("<")===-1&&(Q=Q.replace(/[0-9]/g,"0")),Q+=["",K.rootFontSize,xt,G,this.textWidth,A,pt&&pt.textOverflow,pt&&pt.fontWeight].join(",")),Q&&!w&&(J=P[Q]),!J){if(Y||K.forExport){try{it=this.fakeTS&&function(Ct){let Dt=B.querySelector(".highcharts-text-outline");Dt&&U(Dt,{display:Ct})},rt(it)&&it("none"),J=B.getBBox?_t({},B.getBBox()):{width:B.offsetWidth,height:B.offsetHeight,x:0,y:0},rt(it)&&it("")}catch{}(!J||J.width<0)&&(J={x:0,y:0,width:0,height:0})}else J=this.htmlGetBBox();if(wt=J.width,ot=J.height,Y&&(J.height=ot={"11px,17":14,"13px,20":16}[`${xt||""},${Math.round(ot)}`]||ot),G){let Ct=Number(B.getAttribute("y")||0)-J.y,Dt={right:1,center:.5}[A||0]||0,jt=G*kt,Kt=(G-90)*kt,ee=wt*Math.cos(jt),le=wt*Math.sin(jt),ht=Math.cos(Kt),st=Math.sin(Kt),Tt=J.x+Dt*(wt-ee),Mt=J.y+Ct-Dt*le,Ht=Tt+Ct*ht,Vt=Ht+ee,re=Vt-ot*ht,Jt=re-ee,ye=Mt+Ct*st,ze=ye+le,ge=ze-ot*st,be=ge-le;J.x=Math.min(Ht,Vt,re,Jt),J.y=Math.min(ye,ze,ge,be),J.width=Math.max(Ht,Vt,re,Jt)-J.x,J.height=Math.max(ye,ze,ge,be)-J.y}}if(Q&&(_===""||J.height>0)){for(;D.length>250;)delete P[D.shift()];P[Q]||D.push(Q),P[Q]=J}return J}getStyle(w){return at.getComputedStyle(this.element||this,"").getPropertyValue(w)}hasClass(w){return(""+this.attr("class")).split(" ").indexOf(w)!==-1}hide(){return this.attr({visibility:"hidden"})}htmlGetBBox(){return{height:0,width:0,x:0,y:0}}constructor(w,R){this.onEvents={},this.opacity=1,this.SVG_NS=lt,this.element=R==="span"?$(R):ut.createElementNS(this.SVG_NS,R),this.renderer=w,mt(this,"afterInit")}on(w,R){let{onEvents:J}=this;return J[w]&&J[w](),J[w]=W(this.element,w,R),this}opacitySetter(w,R,J){let wt=Number(Number(w).toFixed(3));this.opacity=wt,J.setAttribute(R,wt)}removeClass(w){return this.attr("class",(""+this.attr("class")).replace(C(w)?RegExp(`(^| )${w}( |$)`):w," ").replace(/ +/g," ").trim())}removeTextOutline(){let w=this.element.querySelector("tspan.highcharts-text-outline");w&&this.safeRemoveChild(w)}safeRemoveChild(w){let R=w.parentNode;R&&R.removeChild(w)}setRadialReference(w){let R=this.element.gradient&&this.renderer.gradients[this.element.gradient];return this.element.radialReference=w,R&&R.radAttr&&R.animate(this.renderer.getRadialAttr(w,R.radAttr)),this}setTextPath(w,R){R=z(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},R);let J=this.renderer.url,wt=this.text||this,ot=wt.textPath,{attributes:it,enabled:Q}=R;if(w=w||ot&&ot.path,ot&&ot.undo(),w&&Q){let A=W(wt,"afterModifyTree",B=>{if(w&&Q){let K=w.attr("id");K||w.attr("id",K=T());let pt={x:0,y:0};j(it.dx)&&(pt.dx=it.dx,delete it.dx),j(it.dy)&&(pt.dy=it.dy,delete it.dy),wt.attr(pt),this.attr({transform:""}),this.box&&(this.box=this.box.destroy());let _=B.nodes.slice(0);B.nodes.length=0,B.nodes[0]={tagName:"textPath",attributes:_t(it,{"text-anchor":it.textAnchor,href:`${J}#${K}`}),children:_}}});wt.textPath={path:w,undo:A}}else wt.attr({dx:0,dy:0}),delete wt.textPath;return this.added&&(wt.textCache="",this.renderer.buildText(wt)),this}shadow(w){var ot;let{renderer:R}=this,J=z(((ot=this.parentGroup)==null?void 0:ot.rotation)===90?{offsetX:-1,offsetY:-1}:{},I(w)?w:{}),wt=R.shadowDefinition(J);return this.attr({filter:w?`url(${R.url}#${wt})`:"none"})}show(w=!0){return this.attr({visibility:w?"inherit":"visible"})}"stroke-widthSetter"(w,R,J){this[R]=w,J.setAttribute(R,w)}strokeWidth(){if(!this.renderer.styledMode)return this["stroke-width"]||0;let w=this.getStyle("stroke-width"),R=0,J;return w.indexOf("px")===w.length-2?R=v(w):w!==""&&(q(J=ut.createElementNS(lt,"rect"),{width:w,"stroke-width":0}),this.element.parentNode.appendChild(J),R=J.getBBox().width,J.parentNode.removeChild(J)),R}symbolAttr(w){let R=this;k.symbolCustomAttribs.forEach(function(J){R[J]=g(w[J],R[J])}),R.attr({d:R.renderer.symbols[R.symbolName](R.x,R.y,R.width,R.height,R)})}textSetter(w){w!==this.textStr&&(delete this.textPxLength,this.textStr=w,this.added&&this.renderer.buildText(this))}titleSetter(w){let R=this.element,J=R.getElementsByTagName("title")[0]||ut.createElementNS(this.SVG_NS,"title");R.insertBefore?R.insertBefore(J,R.firstChild):R.appendChild(J),J.textContent=String(g(w,"")).replace(/<[^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">")}toFront(){let w=this.element;return w.parentNode.appendChild(w),this}translate(w,R){return this.attr({translateX:w,translateY:R})}updateTransform(w="transform"){let{element:R,matrix:J,rotation:wt=0,scaleX:ot,scaleY:it,translateX:Q=0,translateY:A=0}=this,B=["translate("+Q+","+A+")"];j(J)&&B.push("matrix("+J.join(",")+")"),wt&&B.push("rotate("+wt+" "+g(this.rotationOriginX,R.getAttribute("x"),0)+" "+g(this.rotationOriginY,R.getAttribute("y")||0)+")"),(j(ot)||j(it))&&B.push("scale("+g(ot,1)+" "+g(it,1)+")"),B.length&&!(this.text||this).textPath&&R.setAttribute(w,B.join(" "))}visibilitySetter(w,R,J){w==="inherit"?J.removeAttribute(R):this[R]!==w&&J.setAttribute(R,w),this[R]=w}xGetter(w){return this.element.nodeName==="circle"&&(w==="x"?w="cx":w==="y"&&(w="cy")),this._defaultGetter(w)}zIndexSetter(w,R){let J=this.renderer,wt=this.parentGroup,ot=wt||J,it=ot.element||J.box,Q=this.element,A=it===J.box,B,K,pt,_=!1,P,D=this.added,Y;if(j(w)?(Q.setAttribute("data-z-index",w),w=+w,this[R]===w&&(D=!1)):j(this[R])&&Q.removeAttribute("data-z-index"),this[R]=w,D){for((w=this.zIndex)&&wt&&(wt.handleZ=!0),Y=(B=it.childNodes).length-1;Y>=0&&!_;Y--)P=!j(pt=(K=B[Y]).getAttribute("data-z-index")),K!==Q&&(w<0&&P&&!A&&!Y?(it.insertBefore(Q,B[Y]),_=!0):(v(pt)<=w||P&&(!j(w)||w>=0))&&(it.insertBefore(Q,B[Y+1]),_=!0));_||(it.insertBefore(Q,B[A?3:0]),_=!0)}return _}}return k.symbolCustomAttribs=["anchorX","anchorY","clockwise","end","height","innerR","r","start","width","x","y"],k.prototype.strokeSetter=k.prototype.fillSetter,k.prototype.yGetter=k.prototype.xGetter,k.prototype.matrixSetter=k.prototype.rotationOriginXSetter=k.prototype.rotationOriginYSetter=k.prototype.rotationSetter=k.prototype.scaleXSetter=k.prototype.scaleYSetter=k.prototype.translateXSetter=k.prototype.translateYSetter=k.prototype.verticalAlignSetter=function(E,w){this[w]=E,this.doTransform=!0},k}),te(X,"Core/Renderer/RendererRegistry.js",[X["Core/Globals.js"]],function(Et){var At,l;let Zt;return(l=At||(At={})).rendererTypes={},l.getRendererType=function(dt=Zt){return l.rendererTypes[dt]||l.rendererTypes[Zt]},l.registerRendererType=function(dt,Nt,Lt){l.rendererTypes[dt]=Nt,(!Zt||Lt)&&(Zt=dt,Et.Renderer=Nt)},At}),te(X,"Core/Renderer/SVG/SVGLabel.js",[X["Core/Renderer/SVG/SVGElement.js"],X["Core/Utilities.js"]],function(Et,At){let{defined:l,extend:Zt,isNumber:dt,merge:Nt,pick:Lt,removeEvent:kt}=At;class ut extends Et{constructor(Z,lt,at,W,q,$,U,j,et,_t){let mt;super(Z,"g"),this.paddingLeftSetter=this.paddingSetter,this.paddingRightSetter=this.paddingSetter,this.textStr=lt,this.x=at,this.y=W,this.anchorX=$,this.anchorY=U,this.baseline=et,this.className=_t,this.addClass(_t==="button"?"highcharts-no-tooltip":"highcharts-label"),_t&&this.addClass("highcharts-"+_t),this.text=Z.text(void 0,0,0,j).attr({zIndex:1}),typeof q=="string"&&((mt=/^url\((.*?)\)$/.test(q))||this.renderer.symbols[q])&&(this.symbolKey=q),this.bBox=ut.emptyBBox,this.padding=3,this.baselineOffset=0,this.needsBox=Z.styledMode||mt,this.deferredAttr={},this.alignFactor=0}alignSetter(Z){let lt={left:0,center:.5,right:1}[Z];lt!==this.alignFactor&&(this.alignFactor=lt,this.bBox&&dt(this.xSetting)&&this.attr({x:this.xSetting}))}anchorXSetter(Z,lt){this.anchorX=Z,this.boxAttr(lt,Math.round(Z)-this.getCrispAdjust()-this.xSetting)}anchorYSetter(Z,lt){this.anchorY=Z,this.boxAttr(lt,Z-this.ySetting)}boxAttr(Z,lt){this.box?this.box.attr(Z,lt):this.deferredAttr[Z]=lt}css(Z){if(Z){let lt={};Z=Nt(Z),ut.textProps.forEach(at=>{Z[at]!==void 0&&(lt[at]=Z[at],delete Z[at])}),this.text.css(lt),"fontSize"in lt||"fontWeight"in lt?this.updateTextPadding():("width"in lt||"textOverflow"in lt)&&this.updateBoxSize()}return Et.prototype.css.call(this,Z)}destroy(){kt(this.element,"mouseenter"),kt(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),Et.prototype.destroy.call(this)}fillSetter(Z,lt){Z&&(this.needsBox=!0),this.fill=Z,this.boxAttr(lt,Z)}getBBox(){this.textStr&&this.bBox.width===0&&this.bBox.height===0&&this.updateBoxSize();let Z=this.padding,lt=Lt(this.paddingLeft,Z);return{width:this.width||0,height:this.height||0,x:this.bBox.x-lt,y:this.bBox.y-Z}}getCrispAdjust(){return this.renderer.styledMode&&this.box?this.box.strokeWidth()%2/2:(this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2}heightSetter(Z){this.heightSetting=Z}onAdd(){this.text.add(this),this.attr({text:Lt(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&l(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})}paddingSetter(Z,lt){dt(Z)?Z!==this[lt]&&(this[lt]=Z,this.updateTextPadding()):this[lt]=void 0}rSetter(Z,lt){this.boxAttr(lt,Z)}strokeSetter(Z,lt){this.stroke=Z,this.boxAttr(lt,Z)}"stroke-widthSetter"(Z,lt){Z&&(this.needsBox=!0),this["stroke-width"]=Z,this.boxAttr(lt,Z)}"text-alignSetter"(Z){this.textAlign=Z}textSetter(Z){Z!==void 0&&this.text.attr({text:Z}),this.updateTextPadding()}updateBoxSize(){let Z,lt=this.text,at={},W=this.padding,q=this.bBox=(!dt(this.widthSetting)||!dt(this.heightSetting)||this.textAlign)&&l(lt.textStr)?lt.getBBox():ut.emptyBBox;this.width=this.getPaddedWidth(),this.height=(this.heightSetting||q.height||0)+2*W;let $=this.renderer.fontMetrics(lt);if(this.baselineOffset=W+Math.min((this.text.firstLineMetrics||$).b,q.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-$.h)/2),this.needsBox&&!lt.textPath){if(!this.box){let U=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect();U.addClass((this.className==="button"?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),U.add(this)}Z=this.getCrispAdjust(),at.x=Z,at.y=(this.baseline?-this.baselineOffset:0)+Z,at.width=Math.round(this.width),at.height=Math.round(this.height),this.box.attr(Zt(at,this.deferredAttr)),this.deferredAttr={}}}updateTextPadding(){let Z=this.text;if(!Z.textPath){this.updateBoxSize();let lt=this.baseline?0:this.baselineOffset,at=Lt(this.paddingLeft,this.padding);l(this.widthSetting)&&this.bBox&&(this.textAlign==="center"||this.textAlign==="right")&&(at+={center:.5,right:1}[this.textAlign]*(this.widthSetting-this.bBox.width)),(at!==Z.x||lt!==Z.y)&&(Z.attr("x",at),Z.hasBoxWidthChanged&&(this.bBox=Z.getBBox(!0)),lt!==void 0&&Z.attr("y",lt)),Z.x=at,Z.y=lt}}widthSetter(Z){this.widthSetting=dt(Z)?Z:void 0}getPaddedWidth(){let Z=this.padding,lt=Lt(this.paddingLeft,Z),at=Lt(this.paddingRight,Z);return(this.widthSetting||this.bBox.width||0)+lt+at}xSetter(Z){this.x=Z,this.alignFactor&&(Z-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(Z),this.attr("translateX",this.xSetting)}ySetter(Z){this.ySetting=this.y=Math.round(Z),this.attr("translateY",this.ySetting)}}return ut.emptyBBox={width:0,height:0,x:0,y:0},ut.textProps=["color","direction","fontFamily","fontSize","fontStyle","fontWeight","lineHeight","textAlign","textDecoration","textOutline","textOverflow","whiteSpace","width"],ut}),te(X,"Core/Renderer/SVG/Symbols.js",[X["Core/Utilities.js"]],function(Et){let{defined:At,isNumber:l,pick:Zt}=Et;function dt(kt,ut,Rt,Z,lt){let at=[];if(lt){let W=lt.start||0,q=Zt(lt.r,Rt),$=Zt(lt.r,Z||Rt),U=.001>Math.abs((lt.end||0)-W-2*Math.PI),j=(lt.end||0)-.001,et=lt.innerR,_t=Zt(lt.open,U),mt=Math.cos(W),V=Math.sin(W),rt=Math.cos(j),I=Math.sin(j),C=Zt(lt.longArc,j-W-Math.PI<.001?0:1),z=["A",q,$,0,C,Zt(lt.clockwise,1),kt+q*rt,ut+$*I];z.params={start:W,end:j,cx:kt,cy:ut},at.push(["M",kt+q*mt,ut+$*V],z),At(et)&&((z=["A",et,et,0,C,At(lt.clockwise)?1-lt.clockwise:0,kt+et*mt,ut+et*V]).params={start:j,end:W,cx:kt,cy:ut},at.push(_t?["M",kt+et*rt,ut+et*I]:["L",kt+et*rt,ut+et*I],z)),_t||at.push(["Z"])}return at}function Nt(kt,ut,Rt,Z,lt){return lt&&lt.r?Lt(kt,ut,Rt,Z,lt):[["M",kt,ut],["L",kt+Rt,ut],["L",kt+Rt,ut+Z],["L",kt,ut+Z],["Z"]]}function Lt(kt,ut,Rt,Z,lt){let at=(lt==null?void 0:lt.r)||0;return[["M",kt+at,ut],["L",kt+Rt-at,ut],["A",at,at,0,0,1,kt+Rt,ut+at],["L",kt+Rt,ut+Z-at],["A",at,at,0,0,1,kt+Rt-at,ut+Z],["L",kt+at,ut+Z],["A",at,at,0,0,1,kt,ut+Z-at],["L",kt,ut+at],["A",at,at,0,0,1,kt+at,ut],["Z"]]}return{arc:dt,callout:function(kt,ut,Rt,Z,lt){let at=Math.min(lt&&lt.r||0,Rt,Z),W=at+6,q=lt&&lt.anchorX,$=lt&&lt.anchorY||0,U=Lt(kt,ut,Rt,Z,{r:at});if(!l(q)||q<Rt&&q>0&&$<Z&&$>0)return U;if(kt+q>Rt-W)if($>ut+W&&$<ut+Z-W)U.splice(3,1,["L",kt+Rt,$-6],["L",kt+Rt+6,$],["L",kt+Rt,$+6],["L",kt+Rt,ut+Z-at]);else if(q<Rt){let j=$<ut+W,et=j?ut:ut+Z;U.splice(j?2:5,0,["L",q,$],["L",kt+Rt-at,et])}else U.splice(3,1,["L",kt+Rt,Z/2],["L",q,$],["L",kt+Rt,Z/2],["L",kt+Rt,ut+Z-at]);else if(kt+q<W)if($>ut+W&&$<ut+Z-W)U.splice(7,1,["L",kt,$+6],["L",kt-6,$],["L",kt,$-6],["L",kt,ut+at]);else if(q>0){let j=$<ut+W,et=j?ut:ut+Z;U.splice(j?1:6,0,["L",q,$],["L",kt+at,et])}else U.splice(7,1,["L",kt,Z/2],["L",q,$],["L",kt,Z/2],["L",kt,ut+at]);else $>Z&&q<Rt-W?U.splice(5,1,["L",q+6,ut+Z],["L",q,ut+Z+6],["L",q-6,ut+Z],["L",kt+at,ut+Z]):$<0&&q>W&&U.splice(1,1,["L",q-6,ut],["L",q,ut-6],["L",q+6,ut],["L",Rt-at,ut]);return U},circle:function(kt,ut,Rt,Z){return dt(kt+Rt/2,ut+Z/2,Rt/2,Z/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(kt,ut,Rt,Z){return[["M",kt+Rt/2,ut],["L",kt+Rt,ut+Z/2],["L",kt+Rt/2,ut+Z],["L",kt,ut+Z/2],["Z"]]},rect:Nt,roundedRect:Lt,square:Nt,triangle:function(kt,ut,Rt,Z){return[["M",kt+Rt/2,ut],["L",kt+Rt,ut+Z],["L",kt,ut+Z],["Z"]]},"triangle-down":function(kt,ut,Rt,Z){return[["M",kt,ut],["L",kt+Rt,ut],["L",kt+Rt/2,ut+Z],["Z"]]}}}),te(X,"Core/Renderer/SVG/TextBuilder.js",[X["Core/Renderer/HTML/AST.js"],X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At,l){let{doc:Zt,SVG_NS:dt,win:Nt}=At,{attr:Lt,extend:kt,fireEvent:ut,isString:Rt,objectEach:Z,pick:lt}=l;return class{constructor(at){let W=at.styles;this.renderer=at.renderer,this.svgElement=at,this.width=at.textWidth,this.textLineHeight=W&&W.lineHeight,this.textOutline=W&&W.textOutline,this.ellipsis=!!(W&&W.textOverflow==="ellipsis"),this.noWrap=!!(W&&W.whiteSpace==="nowrap")}buildSVG(){let at=this.svgElement,W=at.element,q=at.renderer,$=lt(at.textStr,"").toString(),U=$.indexOf("<")!==-1,j=W.childNodes,et=!at.added&&q.box,_t=[$,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,at.getStyle("font-size"),this.width].join(",");if(_t!==at.textCache){at.textCache=_t,delete at.actualWidth;for(let mt=j.length;mt--;)W.removeChild(j[mt]);if(U||this.ellipsis||this.width||at.textPath||$.indexOf(" ")!==-1&&(!this.noWrap||/<br.*?>/g.test($))){if($!==""){et&&et.appendChild(W);let mt=new Et($);this.modifyTree(mt.nodes),mt.addToDOM(W),this.modifyDOM(),this.ellipsis&&(W.textContent||"").indexOf("…")!==-1&&at.attr("title",this.unescapeEntities(at.textStr||"",["&lt;","&gt;"])),et&&et.removeChild(W)}}else W.appendChild(Zt.createTextNode(this.unescapeEntities($)));Rt(this.textOutline)&&at.applyTextOutline&&at.applyTextOutline(this.textOutline)}}modifyDOM(){let at,W=this.svgElement,q=Lt(W.element,"x");for(W.firstLineMetrics=void 0;(at=W.element.firstChild)&&/^[\s\u200B]*$/.test(at.textContent||" ");)W.element.removeChild(at);[].forEach.call(W.element.querySelectorAll("tspan.highcharts-br"),(et,_t)=>{et.nextSibling&&et.previousSibling&&(_t===0&&et.previousSibling.nodeType===1&&(W.firstLineMetrics=W.renderer.fontMetrics(et.previousSibling)),Lt(et,{dy:this.getLineHeight(et.nextSibling),x:q}))});let $=this.width||0;if(!$)return;let U=(et,_t)=>{let mt=et.textContent||"",V=mt.replace(/([^\^])-/g,"$1- ").split(" "),rt=!this.noWrap&&(V.length>1||W.element.childNodes.length>1),I=this.getLineHeight(_t),C=0,z=W.actualWidth;if(this.ellipsis)mt&&this.truncate(et,mt,void 0,0,Math.max(0,$-.8*I),(S,g)=>S.substring(0,g)+"…");else if(rt){let S=[],g=[];for(;_t.firstChild&&_t.firstChild!==et;)g.push(_t.firstChild),_t.removeChild(_t.firstChild);for(;V.length;)V.length&&!this.noWrap&&C>0&&(S.push(et.textContent||""),et.textContent=V.join(" ").replace(/- /g,"-")),this.truncate(et,void 0,V,C===0&&z||0,$,(v,y)=>V.slice(0,y).join(" ").replace(/- /g,"-")),z=W.actualWidth,C++;g.forEach(v=>{_t.insertBefore(v,et)}),S.forEach(v=>{_t.insertBefore(Zt.createTextNode(v),et);let y=Zt.createElementNS(dt,"tspan");y.textContent="​",Lt(y,{dy:I,x:q}),_t.insertBefore(y,et)})}},j=et=>{[].slice.call(et.childNodes).forEach(mt=>{mt.nodeType===Nt.Node.TEXT_NODE?U(mt,et):(mt.className.baseVal.indexOf("highcharts-br")!==-1&&(W.actualWidth=0),j(mt))})};j(W.element)}getLineHeight(at){let W=at.nodeType===Nt.Node.TEXT_NODE?at.parentElement:at;return this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(W||this.svgElement.element).h}modifyTree(at){let W=(q,$)=>{let{attributes:U={},children:j,style:et={},tagName:_t}=q,mt=this.renderer.styledMode;if(_t==="b"||_t==="strong"?mt?U.class="highcharts-strong":et.fontWeight="bold":(_t==="i"||_t==="em")&&(mt?U.class="highcharts-emphasized":et.fontStyle="italic"),et&&et.color&&(et.fill=et.color),_t==="br"){U.class="highcharts-br",q.textContent="​";let V=at[$+1];V&&V.textContent&&(V.textContent=V.textContent.replace(/^ +/gm,""))}else _t==="a"&&j&&j.some(V=>V.tagName==="#text")&&(q.children=[{children:j,tagName:"tspan"}]);_t!=="#text"&&_t!=="a"&&(q.tagName="tspan"),kt(q,{attributes:U,style:et}),j&&j.filter(V=>V.tagName!=="#text").forEach(W)};at.forEach(W),ut(this.svgElement,"afterModifyTree",{nodes:at})}truncate(at,W,q,$,U,j){let et,_t,mt=this.svgElement,{renderer:V,rotation:rt}=mt,I=[],C=q?1:0,z=(W||q||"").length,S=z,g=function(v,y){let T=y||v,k=at.parentNode;if(k&&I[T]===void 0&&k.getSubStringLength)try{I[T]=$+k.getSubStringLength(0,q?T+1:T)}catch{}return I[T]};if(mt.rotation=0,$+(_t=g(at.textContent.length))>U){for(;C<=z;)S=Math.ceil((C+z)/2),q&&(et=j(q,S)),_t=g(S,et&&et.length-1),C===z?C=z+1:_t>U?z=S-1:C=S;z===0?at.textContent="":W&&z===W.length-1||(at.textContent=et||j(W||q,S))}q&&q.splice(0,S),mt.actualWidth=_t,mt.rotation=rt}unescapeEntities(at,W){return Z(this.renderer.escapes,function(q,$){W&&W.indexOf(q)!==-1||(at=at.toString().replace(RegExp(q,"g"),$))}),at}}}),te(X,"Core/Renderer/SVG/SVGRenderer.js",[X["Core/Renderer/HTML/AST.js"],X["Core/Color/Color.js"],X["Core/Globals.js"],X["Core/Renderer/RendererRegistry.js"],X["Core/Renderer/SVG/SVGElement.js"],X["Core/Renderer/SVG/SVGLabel.js"],X["Core/Renderer/SVG/Symbols.js"],X["Core/Renderer/SVG/TextBuilder.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt,Nt,Lt,kt,ut){let Rt,{charts:Z,deg2rad:lt,doc:at,isFirefox:W,isMS:q,isWebKit:$,noop:U,SVG_NS:j,symbolSizes:et,win:_t}=l,{addEvent:mt,attr:V,createElement:rt,css:I,defined:C,destroyObjectProperties:z,extend:S,isArray:g,isNumber:v,isObject:y,isString:T,merge:k,pick:E,pInt:w,uniqueKey:R}=ut;class J{constructor(ot,it,Q,A,B,K,pt){let _,P,D=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),Y=D.element;pt||D.css(this.getStyle(A||{})),ot.appendChild(Y),V(ot,"dir","ltr"),ot.innerHTML.indexOf("xmlns")===-1&&V(Y,"xmlns",this.SVG_NS),this.box=Y,this.boxWrapper=D,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(at.createTextNode("Created with Highcharts 11.3.0")),this.defs=this.createElement("defs").add(),this.allowHTML=K,this.forExport=B,this.styledMode=pt,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.rootFontSize=D.getStyle("font-size"),this.setSize(it,Q,!1),W&&ot.getBoundingClientRect&&((_=function(){I(ot,{left:0,top:0}),P=ot.getBoundingClientRect(),I(ot,{left:Math.ceil(P.left)-P.left+"px",top:Math.ceil(P.top)-P.top+"px"})})(),this.unSubPixelFix=mt(_t,"resize",_))}definition(ot){return new Et([ot]).addToDOM(this.defs.element)}getReferenceURL(){if((W||$)&&at.getElementsByTagName("base").length){if(!C(Rt)){let ot=R(),it=new Et([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:ot},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":`url(#${ot})`,fill:"rgba(0,0,0,0.001)"}}]}]),Q=it.addToDOM(at.body);I(Q,{position:"fixed",top:0,left:0,zIndex:9e5});let A=at.elementFromPoint(6,6);Rt=(A&&A.id)==="hitme",at.body.removeChild(Q)}if(Rt)return _t.location.href.split("#")[0].replace(/<[^>]*>/g,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20")}return""}getStyle(ot){return this.style=S({fontFamily:"Helvetica, Arial, sans-serif",fontSize:"1rem"},ot),this.style}setStyle(ot){this.boxWrapper.css(this.getStyle(ot))}isHidden(){return!this.boxWrapper.getBBox().width}destroy(){let ot=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),z(this.gradients||{}),this.gradients=null,this.defs=ot.destroy(),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null}createElement(ot){return new this.Element(this,ot)}getRadialAttr(ot,it){return{cx:ot[0]-ot[2]/2+(it.cx||0)*ot[2],cy:ot[1]-ot[2]/2+(it.cy||0)*ot[2],r:(it.r||0)*ot[2]}}shadowDefinition(ot){let it=[`highcharts-drop-shadow-${this.chartIndex}`,...Object.keys(ot).map(A=>`${A}-${ot[A]}`)].join("-").toLowerCase().replace(/[^a-z0-9\-]/g,""),Q=k({color:"#000000",offsetX:1,offsetY:1,opacity:.15,width:5},ot);return this.defs.element.querySelector(`#${it}`)||this.definition({tagName:"filter",attributes:{id:it,filterUnits:Q.filterUnits},children:[{tagName:"feDropShadow",attributes:{dx:Q.offsetX,dy:Q.offsetY,"flood-color":Q.color,"flood-opacity":Math.min(5*Q.opacity,1),stdDeviation:Q.width/2}}]}),it}buildText(ot){new kt(ot).buildSVG()}getContrast(ot){let it=At.parse(ot).rgba.map(A=>{let B=A/255;return B<=.03928?B/12.92:Math.pow((B+.055)/1.055,2.4)}),Q=.2126*it[0]+.7152*it[1]+.0722*it[2];return 1.05/(Q+.05)>(Q+.05)/.05?"#FFFFFF":"#000000"}button(ot,it,Q,A,B={},K,pt,_,P,D){let Y,G,xt,Ct=this.label(ot,it,Q,P,void 0,void 0,D,void 0,"button"),Dt=this.styledMode,jt=B.states||{},Kt=0;B=k(B),delete B.states;let ee=k({color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},B.style);delete B.style;let le=Et.filterUserAttributes(B);return Ct.attr(k({padding:8,r:2},le)),Dt||(le=k({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1},le),Y=(K=k(le,{fill:"#e6e6e6"},Et.filterUserAttributes(K||jt.hover||{}))).style,delete K.style,G=(pt=k(le,{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},Et.filterUserAttributes(pt||jt.select||{}))).style,delete pt.style,xt=(_=k(le,{style:{color:"#cccccc"}},Et.filterUserAttributes(_||jt.disabled||{}))).style,delete _.style),mt(Ct.element,q?"mouseover":"mouseenter",function(){Kt!==3&&Ct.setState(1)}),mt(Ct.element,q?"mouseout":"mouseleave",function(){Kt!==3&&Ct.setState(Kt)}),Ct.setState=function(ht){if(ht!==1&&(Ct.state=Kt=ht),Ct.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][ht||0]),!Dt){Ct.attr([le,K,pt,_][ht||0]);let st=[ee,Y,G,xt][ht||0];y(st)&&Ct.css(st)}},!Dt&&(Ct.attr(le).css(S({cursor:"default"},ee)),D&&Ct.text.css({pointerEvents:"none"})),Ct.on("touchstart",ht=>ht.stopPropagation()).on("click",function(ht){Kt!==3&&A.call(Ct,ht)})}crispLine(ot,it,Q="round"){let A=ot[0],B=ot[1];return C(A[1])&&A[1]===B[1]&&(A[1]=B[1]=Math[Q](A[1])-it%2/2),C(A[2])&&A[2]===B[2]&&(A[2]=B[2]=Math[Q](A[2])+it%2/2),ot}path(ot){let it=this.styledMode?{}:{fill:"none"};return g(ot)?it.d=ot:y(ot)&&S(it,ot),this.createElement("path").attr(it)}circle(ot,it,Q){let A=y(ot)?ot:ot===void 0?{}:{x:ot,y:it,r:Q},B=this.createElement("circle");return B.xSetter=B.ySetter=function(K,pt,_){_.setAttribute("c"+pt,K)},B.attr(A)}arc(ot,it,Q,A,B,K){let pt;y(ot)?(it=(pt=ot).y,Q=pt.r,A=pt.innerR,B=pt.start,K=pt.end,ot=pt.x):pt={innerR:A,start:B,end:K};let _=this.symbol("arc",ot,it,Q,Q,pt);return _.r=Q,_}rect(ot,it,Q,A,B,K){let pt=y(ot)?ot:ot===void 0?{}:{x:ot,y:it,r:B,width:Math.max(Q||0,0),height:Math.max(A||0,0)},_=this.createElement("rect");return this.styledMode||(K!==void 0&&(pt["stroke-width"]=K,S(pt,_.crisp(pt))),pt.fill="none"),_.rSetter=function(P,D,Y){_.r=P,V(Y,{rx:P,ry:P})},_.rGetter=function(){return _.r||0},_.attr(pt)}roundedRect(ot){return this.symbol("roundedRect").attr(ot)}setSize(ot,it,Q){this.width=ot,this.height=it,this.boxWrapper.animate({width:ot,height:it},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:E(Q,!0)?void 0:0}),this.alignElements()}g(ot){let it=this.createElement("g");return ot?it.attr({class:"highcharts-"+ot}):it}image(ot,it,Q,A,B,K){let pt={preserveAspectRatio:"none"};v(it)&&(pt.x=it),v(Q)&&(pt.y=Q),v(A)&&(pt.width=A),v(B)&&(pt.height=B);let _=this.createElement("image").attr(pt),P=function(D){_.attr({href:ot}),K.call(_,D)};if(K){_.attr({href:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="});let D=new _t.Image;mt(D,"load",P),D.src=ot,D.complete&&P({})}else _.attr({href:ot});return _}symbol(ot,it,Q,A,B,K){let pt,_,P,D,Y=this,G=/^url\((.*?)\)$/,xt=G.test(ot),Ct=!xt&&(this.symbols[ot]?ot:"circle"),Dt=Ct&&this.symbols[Ct];if(Dt)typeof it=="number"&&(_=Dt.call(this.symbols,Math.round(it||0),Math.round(Q||0),A||0,B||0,K)),pt=this.path(_),Y.styledMode||pt.attr("fill","none"),S(pt,{symbolName:Ct||void 0,x:it,y:Q,width:A,height:B}),K&&S(pt,K);else if(xt){P=ot.match(G)[1];let jt=pt=this.image(P);jt.imgwidth=E(K&&K.width,et[P]&&et[P].width),jt.imgheight=E(K&&K.height,et[P]&&et[P].height),D=Kt=>Kt.attr({width:Kt.width,height:Kt.height}),["width","height"].forEach(Kt=>{jt[`${Kt}Setter`]=function(ee,le){this[le]=ee;let{alignByTranslate:ht,element:st,width:Tt,height:Mt,imgwidth:Ht,imgheight:Vt}=this,re=le==="width"?Ht:Vt,Jt=1;K&&K.backgroundSize==="within"&&Tt&&Mt&&Ht&&Vt?(Jt=Math.min(Tt/Ht,Mt/Vt),V(st,{width:Math.round(Ht*Jt),height:Math.round(Vt*Jt)})):st&&re&&st.setAttribute(le,re),!ht&&Ht&&Vt&&this.translate(((Tt||0)-Ht*Jt)/2,((Mt||0)-Vt*Jt)/2)}}),C(it)&&jt.attr({x:it,y:Q}),jt.isImg=!0,C(jt.imgwidth)&&C(jt.imgheight)?D(jt):(jt.attr({width:0,height:0}),rt("img",{onload:function(){let Kt=Z[Y.chartIndex];this.width===0&&(I(this,{position:"absolute",top:"-999em"}),at.body.appendChild(this)),et[P]={width:this.width,height:this.height},jt.imgwidth=this.width,jt.imgheight=this.height,jt.element&&D(jt),this.parentNode&&this.parentNode.removeChild(this),Y.imgCount--,Y.imgCount||!Kt||Kt.hasLoaded||Kt.onload()},src:P}),this.imgCount++)}return pt}clipRect(ot,it,Q,A){return this.rect(ot,it,Q,A,0)}text(ot,it,Q,A){let B={};if(A&&(this.allowHTML||!this.forExport))return this.html(ot,it,Q);B.x=Math.round(it||0),Q&&(B.y=Math.round(Q)),C(ot)&&(B.text=ot);let K=this.createElement("text").attr(B);return A&&(!this.forExport||this.allowHTML)||(K.xSetter=function(pt,_,P){let D=P.getElementsByTagName("tspan"),Y=P.getAttribute(_);for(let G=0,xt;G<D.length;G++)(xt=D[G]).getAttribute(_)===Y&&xt.setAttribute(_,pt);P.setAttribute(_,pt)}),K}fontMetrics(ot){let it=w(dt.prototype.getStyle.call(ot,"font-size")||0),Q=it<24?it+3:Math.round(1.2*it),A=Math.round(.8*Q);return{h:Q,b:A,f:it}}rotCorr(ot,it,Q){let A=ot;return it&&Q&&(A=Math.max(A*Math.cos(it*lt),4)),{x:-ot/3*Math.sin(it*lt),y:A}}pathToSegments(ot){let it=[],Q=[],A={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2};for(let B=0;B<ot.length;B++)T(Q[0])&&v(ot[B])&&Q.length===A[Q[0].toUpperCase()]&&ot.splice(B,0,Q[0].replace("M","L").replace("m","l")),typeof ot[B]=="string"&&(Q.length&&it.push(Q.slice(0)),Q.length=0),Q.push(ot[B]);return it.push(Q.slice(0)),it}label(ot,it,Q,A,B,K,pt,_,P){return new Nt(this,ot,it,Q,A,B,K,pt,_,P)}alignElements(){this.alignedObjects.forEach(ot=>ot.align())}}return S(J.prototype,{Element:dt,SVG_NS:j,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:Lt,draw:U}),Zt.registerRendererType("svg",J,!0),J}),te(X,"Core/Renderer/HTML/HTMLElement.js",[X["Core/Globals.js"],X["Core/Renderer/SVG/SVGElement.js"],X["Core/Utilities.js"]],function(Et,At,l){let{composed:Zt}=Et,{css:dt,defined:Nt,extend:Lt,pushUnique:kt,pInt:ut}=l;class Rt extends At{static compose(lt){if(kt(Zt,this.compose)){let at=Rt.prototype,W=lt.prototype;W.getSpanCorrection=at.getSpanCorrection,W.htmlCss=at.htmlCss,W.htmlGetBBox=at.htmlGetBBox,W.htmlUpdateTransform=at.htmlUpdateTransform,W.setSpanRotation=at.setSpanRotation}return lt}getSpanCorrection(lt,at,W){this.xCorr=-lt*W,this.yCorr=-at}htmlCss(lt){let at,{element:W}=this,q=W.tagName==="SPAN"&&lt&&"width"in lt,$=q&&lt.width;return q&&(delete lt.width,this.textWidth=ut($)||void 0,at=!0),(lt==null?void 0:lt.textOverflow)==="ellipsis"&&(lt.whiteSpace="nowrap",lt.overflow="hidden"),Lt(this.styles,lt),dt(W,lt),at&&this.htmlUpdateTransform(),this}htmlGetBBox(){let{element:lt}=this;return{x:lt.offsetLeft,y:lt.offsetTop,width:lt.offsetWidth,height:lt.offsetHeight}}htmlUpdateTransform(){if(!this.added){this.alignOnAdd=!0;return}let{element:lt,renderer:at,rotation:W,styles:q,textAlign:$="left",textWidth:U,translateX:j=0,translateY:et=0,x:_t=0,y:mt=0}=this,V={left:0,center:.5,right:1}[$],rt=q==null?void 0:q.whiteSpace;if(dt(lt,{marginLeft:`${j}px`,marginTop:`${et}px`}),lt.tagName==="SPAN"){let I=[W,$,lt.innerHTML,U,this.textAlign].join(","),C,z=!1;if(U!==this.oldTextWidth){let S=this.textPxLength?this.textPxLength:(dt(lt,{width:"",whiteSpace:rt||"nowrap"}),lt.offsetWidth),g=U||0;(g>this.oldTextWidth||S>g)&&(/[ \-]/.test(lt.textContent||lt.innerText)||lt.style.textOverflow==="ellipsis")&&(dt(lt,{width:S>g||W?U+"px":"auto",display:"block",whiteSpace:rt||"normal"}),this.oldTextWidth=U,z=!0)}this.hasBoxWidthChanged=z,I!==this.cTT&&(C=at.fontMetrics(lt).b,Nt(W)&&(W!==(this.oldRotation||0)||$!==this.oldAlign)&&this.setSpanRotation(W,V,C),this.getSpanCorrection(!Nt(W)&&this.textPxLength||lt.offsetWidth,C,V)),dt(lt,{left:_t+(this.xCorr||0)+"px",top:mt+(this.yCorr||0)+"px"}),this.cTT=I,this.oldRotation=W,this.oldAlign=$}}setSpanRotation(lt,at,W){dt(this.element,{transform:`rotate(${lt}deg)`,transformOrigin:`${100*at}% ${W}px`})}}return Rt}),te(X,"Core/Renderer/HTML/HTMLRenderer.js",[X["Core/Renderer/HTML/AST.js"],X["Core/Globals.js"],X["Core/Renderer/SVG/SVGElement.js"],X["Core/Renderer/SVG/SVGRenderer.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt){let{composed:Nt}=At,{attr:Lt,createElement:kt,extend:ut,pick:Rt,pushUnique:Z}=dt;class lt extends Zt{static compose(W){if(Z(Nt,this.compose)){let q=lt.prototype,$=W.prototype;$.html=q.html}return W}html(W,q,$){let U=this.createElement("span"),j=U.element,et=U.renderer,_t=function(mt,V){["opacity","visibility"].forEach(function(rt){mt[rt+"Setter"]=function(I,C,z){let S=mt.div?mt.div.style:V;l.prototype[rt+"Setter"].call(this,I,C,z),S&&(S[C]=I)}}),mt.addedSetters=!0};return U.textSetter=function(mt){mt!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,Et.setElementHTML(this.element,Rt(mt,"")),this.textStr=mt,U.doTransform=!0)},_t(U,U.element.style),U.xSetter=U.ySetter=U.alignSetter=U.rotationSetter=function(mt,V){V==="align"?U.alignValue=U.textAlign=mt:U[V]=mt,U.doTransform=!0},U.afterSetters=function(){this.doTransform&&(this.htmlUpdateTransform(),this.doTransform=!1)},U.attr({text:W,x:Math.round(q),y:Math.round($)}).css({position:"absolute"}),et.styledMode||U.css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize}),j.style.whiteSpace="nowrap",U.css=U.htmlCss,U.add=function(mt){let V,rt,I=et.box.parentNode,C=[];if(this.parentGroup=mt,mt){if(!(V=mt.div)){for(rt=mt;rt;)C.push(rt),rt=rt.parentGroup;C.reverse().forEach(function(z){var S;let g=Lt(z.element,"class"),v=z.css;function y(E,w){z[w]=E,w==="translateX"?k.left=E+"px":k.top=E+"px",z.doTransform=!0}let T=z.styles||{};V=z.div=z.div||kt("div",g?{className:g}:void 0,{position:"absolute",left:(z.translateX||0)+"px",top:(z.translateY||0)+"px",display:z.display,opacity:z.opacity,visibility:z.visibility},V||I);let k=V.style;ut(z,{classSetter:(S=V,function(E){this.element.setAttribute("class",E),S.className=E}),css:function(E){return v.call(z,E),["cursor","pointerEvents"].forEach(w=>{E[w]&&(k[w]=E[w])}),z},on:function(){return C[0].div&&U.on.apply({element:C[0].div,onEvents:z.onEvents},arguments),z},translateXSetter:y,translateYSetter:y}),z.addedSetters||_t(z),z.css(T)})}}else V=I;return V.appendChild(j),U.added=!0,U.alignOnAdd&&U.htmlUpdateTransform(),U},U}}return lt}),te(X,"Core/Axis/AxisDefaults.js",[],function(){var Et,At;return(At=Et||(Et={})).xAxis={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%H:%M:%S.%L",range:!1},second:{main:"%H:%M:%S",range:!1},minute:{main:"%H:%M",range:!1},hour:{main:"%H:%M",range:!1},day:{main:"%e %b"},week:{main:"%e %b"},month:{main:"%b '%y"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotationLimit:80,distance:15,enabled:!0,indentation:10,overflow:"justify",padding:5,reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,zIndex:7,style:{color:"#333333",cursor:"default",fontSize:"0.8em"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minorTicksPerMajor:5,minPadding:.01,offset:void 0,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",useHTML:!1,x:0,y:0,style:{color:"#666666",fontSize:"0.8em"}},type:"linear",uniqueNames:!0,visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#333333",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#333333"},At.yAxis={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:void 0},startOnTick:!0,title:{text:"Values"},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){let{numberFormatter:l}=this.axis.chart;return l(this.total||0,-1)},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},Et}),te(X,"Core/Foundation.js",[X["Core/Utilities.js"]],function(Et){var At;let{addEvent:l,isFunction:Zt,objectEach:dt,removeEvent:Nt}=Et;return(At||(At={})).registerEventOptions=function(Lt,kt){Lt.eventOptions=Lt.eventOptions||{},dt(kt.events,function(ut,Rt){Lt.eventOptions[Rt]!==ut&&(Lt.eventOptions[Rt]&&(Nt(Lt,Rt,Lt.eventOptions[Rt]),delete Lt.eventOptions[Rt]),Zt(ut)&&(Lt.eventOptions[Rt]=ut,l(Lt,Rt,ut,{order:0})))})},At}),te(X,"Core/Axis/Tick.js",[X["Core/Templating.js"],X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At,l){let{deg2rad:Zt}=At,{clamp:dt,correctFloat:Nt,defined:Lt,destroyObjectProperties:kt,extend:ut,fireEvent:Rt,isNumber:Z,merge:lt,objectEach:at,pick:W}=l;return class{constructor(q,$,U,j,et){this.isNew=!0,this.isNewLabel=!0,this.axis=q,this.pos=$,this.type=U||"",this.parameters=et||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,Rt(this,"init"),U||j||this.addLabel()}addLabel(){let q=this,$=q.axis,U=$.options,j=$.chart,et=$.categories,_t=$.logarithmic,mt=$.names,V=q.pos,rt=W(q.options&&q.options.labels,U.labels),I=$.tickPositions,C=V===I[0],z=V===I[I.length-1],S=(!rt.step||rt.step===1)&&$.tickInterval===1,g=I.info,v=q.label,y,T,k,E=this.parameters.category||(et?W(et[V],mt[V],V):V);_t&&Z(E)&&(E=Nt(_t.lin2log(E))),$.dateTime&&(g?y=(T=j.time.resolveDTLFormat(U.dateTimeLabelFormats[!U.grid&&g.higherRanks[V]||g.unitName])).main:Z(E)&&(y=$.dateTime.getXDateFormat(E,U.dateTimeLabelFormats||{}))),q.isFirst=C,q.isLast=z;let w={axis:$,chart:j,dateTimeLabelFormat:y,isFirst:C,isLast:z,pos:V,tick:q,tickPositionInfo:g,value:E};Rt(this,"labelFormat",w);let R=ot=>rt.formatter?rt.formatter.call(ot,ot):rt.format?(ot.text=$.defaultLabelFormatter.call(ot,ot),Et.format(rt.format,ot,j)):$.defaultLabelFormatter.call(ot,ot),J=R.call(w,w),wt=T&&T.list;wt?q.shortenLabel=function(){for(k=0;k<wt.length;k++)if(ut(w,{dateTimeLabelFormat:wt[k]}),v.attr({text:R.call(w,w)}),v.getBBox().width<$.getSlotWidth(q)-2*rt.padding)return;v.attr({text:""})}:q.shortenLabel=void 0,S&&$._addedPlotLB&&q.moveLabel(J,rt),Lt(v)||q.movedLabel?v&&v.textStr!==J&&!S&&(!v.textWidth||rt.style.width||v.styles.width||v.css({width:null}),v.attr({text:J}),v.textPxLength=v.getBBox().width):(q.label=v=q.createLabel(J,rt),q.rotation=0)}createLabel(q,$,U){let j=this.axis,et=j.chart,_t=Lt(q)&&$.enabled?et.renderer.text(q,U==null?void 0:U.x,U==null?void 0:U.y,$.useHTML).add(j.labelGroup):void 0;return _t&&(et.styledMode||_t.css(lt($.style)),_t.textPxLength=_t.getBBox().width),_t}destroy(){kt(this,this.axis)}getPosition(q,$,U,j){let et=this.axis,_t=et.chart,mt=j&&_t.oldChartHeight||_t.chartHeight,V={x:q?Nt(et.translate($+U,void 0,void 0,j)+et.transB):et.left+et.offset+(et.opposite?(j&&_t.oldChartWidth||_t.chartWidth)-et.right-et.left:0),y:q?mt-et.bottom+et.offset-(et.opposite?et.height:0):Nt(mt-et.translate($+U,void 0,void 0,j)-et.transB)};return V.y=dt(V.y,-1e5,1e5),Rt(this,"afterGetPosition",{pos:V}),V}getLabelPosition(q,$,U,j,et,_t,mt,V){let rt,I,C=this.axis,z=C.transA,S=C.isLinked&&C.linkedParent?C.linkedParent.reversed:C.reversed,g=C.staggerLines,v=C.tickRotCorr||{x:0,y:0},y=j||C.reserveSpaceDefault?0:-C.labelOffset*(C.labelAlign==="center"?.5:1),T=et.distance,k={};return rt=C.side===0?U.rotation?-T:-U.getBBox().height:C.side===2?v.y+T:Math.cos(U.rotation*Zt)*(v.y-U.getBBox(!1,0).height/2),Lt(et.y)&&(rt=C.side===0&&C.horiz?et.y+rt:et.y),q=q+W(et.x,[0,1,0,-1][C.side]*T)+y+v.x-(_t&&j?_t*z*(S?-1:1):0),$=$+rt-(_t&&!j?_t*z*(S?1:-1):0),g&&(I=mt/(V||1)%g,C.opposite&&(I=g-I-1),$+=I*(C.labelOffset/g)),k.x=q,k.y=Math.round($),Rt(this,"afterGetLabelPosition",{pos:k,tickmarkOffset:_t,index:mt}),k}getLabelSize(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0}getMarkPath(q,$,U,j,et,_t){return _t.crispLine([["M",q,$],["L",q+(et?0:-U),$+(et?U:0)]],j)}handleOverflow(q){let $=this.axis,U=$.options.labels,j=q.x,et=$.chart.chartWidth,_t=$.chart.spacing,mt=W($.labelLeft,Math.min($.pos,_t[3])),V=W($.labelRight,Math.max($.isRadial?0:$.pos+$.len,et-_t[1])),rt=this.label,I=this.rotation,C={left:0,center:.5,right:1}[$.labelAlign||rt.attr("align")],z=rt.getBBox().width,S=$.getSlotWidth(this),g={},v=S,y=1,T;I||U.overflow!=="justify"?I<0&&j-C*z<mt?T=Math.round(j/Math.cos(I*Zt)-mt):I>0&&j+C*z>V&&(T=Math.round((et-j)/Math.cos(I*Zt))):(j-C*z<mt?v=q.x+v*(1-C)-mt:j+(1-C)*z>V&&(v=V-q.x+v*C,y=-1),(v=Math.min(S,v))<S&&$.labelAlign==="center"&&(q.x+=y*(S-v-C*(S-Math.min(z,v)))),(z>v||$.autoRotation&&(rt.styles||{}).width)&&(T=v)),T&&(this.shortenLabel?this.shortenLabel():(g.width=Math.floor(T)+"px",(U.style||{}).textOverflow||(g.textOverflow="ellipsis"),rt.css(g)))}moveLabel(q,$){let U=this,j=U.label,et=U.axis,_t=!1,mt;j&&j.textStr===q?(U.movedLabel=j,_t=!0,delete U.label):at(et.ticks,function(V){_t||V.isNew||V===U||!V.label||V.label.textStr!==q||(U.movedLabel=V.label,_t=!0,V.labelPos=U.movedLabel.xy,delete V.label)}),!_t&&(U.labelPos||j)&&(mt=U.labelPos||j.xy,U.movedLabel=U.createLabel(q,$,mt),U.movedLabel&&U.movedLabel.attr({opacity:0}))}render(q,$,U){let j=this.axis,et=j.horiz,_t=this.pos,mt=W(this.tickmarkOffset,j.tickmarkOffset),V=this.getPosition(et,_t,mt,$),rt=V.x,I=V.y,C=et&&rt===j.pos+j.len||!et&&I===j.pos?-1:1,z=W(U,this.label&&this.label.newOpacity,1);U=W(U,1),this.isActive=!0,this.renderGridLine($,U,C),this.renderMark(V,U,C),this.renderLabel(V,$,z,q),this.isNew=!1,Rt(this,"afterRender")}renderGridLine(q,$,U){let j=this.axis,et=j.options,_t={},mt=this.pos,V=this.type,rt=W(this.tickmarkOffset,j.tickmarkOffset),I=j.chart.renderer,C=this.gridLine,z,S=et.gridLineWidth,g=et.gridLineColor,v=et.gridLineDashStyle;this.type==="minor"&&(S=et.minorGridLineWidth,g=et.minorGridLineColor,v=et.minorGridLineDashStyle),C||(j.chart.styledMode||(_t.stroke=g,_t["stroke-width"]=S||0,_t.dashstyle=v),V||(_t.zIndex=1),q&&($=0),this.gridLine=C=I.path().attr(_t).addClass("highcharts-"+(V?V+"-":"")+"grid-line").add(j.gridGroup)),C&&(z=j.getPlotLinePath({value:mt+rt,lineWidth:C.strokeWidth()*U,force:"pass",old:q,acrossPanes:!1}))&&C[q||this.isNew?"attr":"animate"]({d:z,opacity:$})}renderMark(q,$,U){let j=this.axis,et=j.options,_t=j.chart.renderer,mt=this.type,V=j.tickSize(mt?mt+"Tick":"tick"),rt=q.x,I=q.y,C=W(et[mt!=="minor"?"tickWidth":"minorTickWidth"],!mt&&j.isXAxis?1:0),z=et[mt!=="minor"?"tickColor":"minorTickColor"],S=this.mark,g=!S;V&&(j.opposite&&(V[0]=-V[0]),S||(this.mark=S=_t.path().addClass("highcharts-"+(mt?mt+"-":"")+"tick").add(j.axisGroup),j.chart.styledMode||S.attr({stroke:z,"stroke-width":C})),S[g?"attr":"animate"]({d:this.getMarkPath(rt,I,V[0],S.strokeWidth()*U,j.horiz,_t),opacity:$}))}renderLabel(q,$,U,j){let et=this.axis,_t=et.horiz,mt=et.options,V=this.label,rt=mt.labels,I=rt.step,C=W(this.tickmarkOffset,et.tickmarkOffset),z=q.x,S=q.y,g=!0;V&&Z(z)&&(V.xy=q=this.getLabelPosition(z,S,V,_t,rt,C,j,I),(!this.isFirst||this.isLast||mt.showFirstLabel)&&(!this.isLast||this.isFirst||mt.showLastLabel)?!_t||rt.step||rt.rotation||$||U===0||this.handleOverflow(q):g=!1,I&&j%I&&(g=!1),g&&Z(q.y)?(q.opacity=U,V[this.isNewLabel?"attr":"animate"](q).show(!0),this.isNewLabel=!1):(V.hide(),this.isNewLabel=!0))}replaceMovedLabel(){let q=this.label,$=this.axis;q&&!this.isNew&&(q.animate({opacity:0},void 0,q.destroy),delete this.label),$.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel}}}),te(X,"Core/Axis/Axis.js",[X["Core/Animation/AnimationUtilities.js"],X["Core/Axis/AxisDefaults.js"],X["Core/Color/Color.js"],X["Core/Defaults.js"],X["Core/Foundation.js"],X["Core/Globals.js"],X["Core/Axis/Tick.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt,Nt,Lt,kt){let{animObject:ut}=Et,{xAxis:Rt,yAxis:Z}=At,{defaultOptions:lt}=Zt,{registerEventOptions:at}=dt,{deg2rad:W}=Nt,{arrayMax:q,arrayMin:$,clamp:U,correctFloat:j,defined:et,destroyObjectProperties:_t,erase:mt,error:V,extend:rt,fireEvent:I,getClosestDistance:C,insertItem:z,isArray:S,isNumber:g,isString:v,merge:y,normalizeTickInterval:T,objectEach:k,pick:E,relativeLength:w,removeEvent:R,splat:J,syncTimeout:wt}=kt,ot=(Q,A)=>T(A,void 0,void 0,E(Q.options.allowDecimals,A<.5||Q.tickAmount!==void 0),!!Q.tickAmount);rt(lt,{xAxis:Rt,yAxis:y(Rt,Z)});class it{constructor(A,B,K){this.init(A,B,K)}init(A,B,K=this.coll){let pt=K==="xAxis",_=this.isZAxis||(A.inverted?!pt:pt);this.chart=A,this.horiz=_,this.isXAxis=pt,this.coll=K,I(this,"init",{userOptions:B}),this.opposite=E(B.opposite,this.opposite),this.side=E(B.side,this.side,_?this.opposite?0:2:this.opposite?1:3),this.setOptions(B);let P=this.options,D=P.labels,Y=P.type;this.userOptions=B,this.minPixelPadding=0,this.reversed=E(P.reversed,this.reversed),this.visible=P.visible,this.zoomEnabled=P.zoomEnabled,this.hasNames=Y==="category"||P.categories===!0,this.categories=S(P.categories)&&P.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=et(P.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len=0,this.minRange=this.userMinRange=P.minRange||P.maxZoom,this.range=P.range,this.offset=P.offset||0,this.max=void 0,this.min=void 0;let G=E(P.crosshair,J(A.options.tooltip.crosshairs)[pt?0:1]);this.crosshair=G===!0?{}:G,A.axes.indexOf(this)===-1&&(pt?A.axes.splice(A.xAxis.length,0,this):A.axes.push(this),z(this,A[this.coll])),A.orderItems(this.coll),this.series=this.series||[],A.inverted&&!this.isZAxis&&pt&&!et(this.reversed)&&(this.reversed=!0),this.labelRotation=g(D.rotation)?D.rotation:void 0,at(this,P),I(this,"afterInit")}setOptions(A){let B=this.horiz?{labels:{autoRotation:[-45]},margin:15}:{title:{rotation:90*this.side}};this.options=y(B,lt[this.coll],A),I(this,"afterSetOptions",{userOptions:A})}defaultLabelFormatter(A){let B=this.axis,K=this.chart,{numberFormatter:pt}=K,_=g(this.value)?this.value:NaN,P=B.chart.time,D=B.categories,Y=this.dateTimeLabelFormat,G=lt.lang,xt=G.numericSymbols,Ct=G.numericSymbolMagnitude||1e3,Dt=B.logarithmic?Math.abs(_):B.tickInterval,jt=xt&&xt.length,Kt,ee;if(D)ee=`${this.value}`;else if(Y)ee=P.dateFormat(Y,_);else if(jt&&xt&&Dt>=1e3)for(;jt--&&ee===void 0;)Dt>=(Kt=Math.pow(Ct,jt+1))&&10*_%Kt==0&&xt[jt]!==null&&_!==0&&(ee=pt(_/Kt,-1)+xt[jt]);return ee===void 0&&(ee=Math.abs(_)>=1e4?pt(_,-1):pt(_,-1,void 0,"")),ee}getSeriesExtremes(){let A,B=this;I(this,"getSeriesExtremes",null,function(){B.hasVisibleSeries=!1,B.dataMin=B.dataMax=B.threshold=void 0,B.softThreshold=!B.isXAxis,B.series.forEach(K=>{if(K.reserveSpace()){let pt=K.options,_,P=pt.threshold,D,Y;if(B.hasVisibleSeries=!0,B.positiveValuesOnly&&0>=(P||0)&&(P=void 0),B.isXAxis)(_=K.xData)&&_.length&&(_=B.logarithmic?_.filter(G=>G>0):_,D=(A=K.getXExtremes(_)).min,Y=A.max,g(D)||D instanceof Date||(_=_.filter(g),D=(A=K.getXExtremes(_)).min,Y=A.max),_.length&&(B.dataMin=Math.min(E(B.dataMin,D),D),B.dataMax=Math.max(E(B.dataMax,Y),Y)));else{let G=K.applyExtremes();g(G.dataMin)&&(D=G.dataMin,B.dataMin=Math.min(E(B.dataMin,D),D)),g(G.dataMax)&&(Y=G.dataMax,B.dataMax=Math.max(E(B.dataMax,Y),Y)),et(P)&&(B.threshold=P),(!pt.softThreshold||B.positiveValuesOnly)&&(B.softThreshold=!1)}}})}),I(this,"afterGetSeriesExtremes")}translate(A,B,K,pt,_,P){var ee;let D=this.linkedParent||this,Y=pt&&D.old?D.old.min:D.min;if(!g(Y))return NaN;let G=D.minPixelPadding,xt=(D.isOrdinal||((ee=D.brokenAxis)==null?void 0:ee.hasBreaks)||D.logarithmic&&_)&&D.lin2val,Ct=1,Dt=0,jt=pt&&D.old?D.old.transA:D.transA,Kt=0;if(jt||(jt=D.transA),K&&(Ct*=-1,Dt=D.len),D.reversed&&(Ct*=-1,Dt-=Ct*(D.sector||D.len)),B)Kt=(A=A*Ct+Dt-G)/jt+Y,xt&&(Kt=D.lin2val(Kt));else{xt&&(A=D.val2lin(A));let le=Ct*(A-Y)*jt;Kt=(D.isRadial?le:j(le))+Dt+Ct*G+(g(P)?jt*P:0)}return Kt}toPixels(A,B){return this.translate(A,!1,!this.horiz,void 0,!0)+(B?0:this.pos)}toValue(A,B){return this.translate(A-(B?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(A){let B=this,K=B.chart,pt=B.left,_=B.top,P=A.old,D=A.value,Y=A.lineWidth,G=P&&K.oldChartHeight||K.chartHeight,xt=P&&K.oldChartWidth||K.chartWidth,Ct=B.transB,Dt=A.translatedValue,jt=A.force,Kt,ee,le,ht,st;function Tt(Ht,Vt,re){return jt!=="pass"&&(Ht<Vt||Ht>re)&&(jt?Ht=U(Ht,Vt,re):st=!0),Ht}let Mt={value:D,lineWidth:Y,old:P,force:jt,acrossPanes:A.acrossPanes,translatedValue:Dt};return I(this,"getPlotLinePath",Mt,function(Ht){Kt=le=Math.round((Dt=U(Dt=E(Dt,B.translate(D,void 0,void 0,P)),-1e5,1e5))+Ct),ee=ht=Math.round(G-Dt-Ct),g(Dt)?B.horiz?(ee=_,ht=G-B.bottom,Kt=le=Tt(Kt,pt,pt+B.width)):(Kt=pt,le=xt-B.right,ee=ht=Tt(ee,_,_+B.height)):(st=!0,jt=!1),Ht.path=st&&!jt?void 0:K.renderer.crispLine([["M",Kt,ee],["L",le,ht]],Y||1)}),Mt.path}getLinearTickPositions(A,B,K){let pt,_,P,D=j(Math.floor(B/A)*A),Y=j(Math.ceil(K/A)*A),G=[];if(j(D+A)===D&&(P=20),this.single)return[B];for(pt=D;pt<=Y&&(G.push(pt),(pt=j(pt+A,P))!==_);)_=pt;return G}getMinorTickInterval(){let{minorTicks:A,minorTickInterval:B}=this.options;return A===!0?E(B,"auto"):A!==!1?B:void 0}getMinorTickPositions(){let A=this.options,B=this.tickPositions,K=this.minorTickInterval,pt=this.pointRangePadding||0,_=(this.min||0)-pt,P=(this.max||0)+pt,D=P-_,Y=[],G;if(D&&D/K<this.len/3){let xt=this.logarithmic;if(xt)this.paddedTicks.forEach(function(Ct,Dt,jt){Dt&&Y.push.apply(Y,xt.getLogTickPositions(K,jt[Dt-1],jt[Dt],!0))});else if(this.dateTime&&this.getMinorTickInterval()==="auto")Y=Y.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(K),_,P,A.startOfWeek));else for(G=_+(B[0]-_)%K;G<=P&&G!==Y[0];G+=K)Y.push(G)}return Y.length!==0&&this.trimTicks(Y),Y}adjustForMinRange(){let A=this.options,B=this.logarithmic,{max:K,min:pt,minRange:_}=this,P,D,Y,G;this.isXAxis&&_===void 0&&!B&&(_=et(A.min)||et(A.max)||et(A.floor)||et(A.ceiling)?null:Math.min(5*(C(this.series.map(xt=>{var Ct;return(xt.xIncrement?(Ct=xt.xData)==null?void 0:Ct.slice(0,2):xt.xData)||[]}))||0),this.dataMax-this.dataMin)),g(K)&&g(pt)&&g(_)&&K-pt<_&&(D=this.dataMax-this.dataMin>=_,P=(_-K+pt)/2,Y=[pt-P,E(A.min,pt-P)],D&&(Y[2]=B?B.log2lin(this.dataMin):this.dataMin),G=[(pt=q(Y))+_,E(A.max,pt+_)],D&&(G[2]=B?B.log2lin(this.dataMax):this.dataMax),(K=$(G))-pt<_&&(Y[0]=K-_,Y[1]=E(A.min,K-_),pt=q(Y))),this.minRange=_,this.min=pt,this.max=K}getClosest(){let A,B;if(this.categories)B=1;else{let K=[];this.series.forEach(function(pt){var P;let _=pt.closestPointRange;((P=pt.xData)==null?void 0:P.length)===1?K.push(pt.xData[0]):!pt.noSharedTooltip&&et(_)&&pt.reserveSpace()&&(B=et(B)?Math.min(B,_):_)}),K.length&&(K.sort((pt,_)=>pt-_),A=C([K]))}return A&&B?Math.min(A,B):A||B}nameToX(A){let B=S(this.options.categories),K=B?this.categories:this.names,pt=A.options.x,_;return A.series.requireSorting=!1,et(pt)||(pt=this.options.uniqueNames&&K?B?K.indexOf(A.name):E(K.keys[A.name],-1):A.series.autoIncrement()),pt===-1?!B&&K&&(_=K.length):_=pt,_!==void 0?(this.names[_]=A.name,this.names.keys[A.name]=_):A.x&&(_=A.x),_}updateNames(){let A=this,B=this.names;B.length>0&&(Object.keys(B.keys).forEach(function(pt){delete B.keys[pt]}),B.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(pt=>{pt.xIncrement=null,(!pt.points||pt.isDirtyData)&&(A.max=Math.max(A.max,pt.xData.length-1),pt.processData(),pt.generatePoints()),pt.data.forEach(function(_,P){let D;_!=null&&_.options&&_.name!==void 0&&(D=A.nameToX(_))!==void 0&&D!==_.x&&(_.x=D,pt.xData[P]=D)})}))}setAxisTranslation(){let A=this,B=A.max-A.min,K=A.linkedParent,pt=!!A.categories,_=A.isXAxis,P=A.axisPointRange||0,D,Y=0,G=0,xt,Ct=A.transA;(_||pt||P)&&(D=A.getClosest(),K?(Y=K.minPointOffset,G=K.pointRangePadding):A.series.forEach(function(Dt){let jt=pt?1:_?E(Dt.options.pointRange,D,0):A.axisPointRange||0,Kt=Dt.options.pointPlacement;if(P=Math.max(P,jt),!A.single||pt){let ee=Dt.is("xrange")?!_:_;Y=Math.max(Y,ee&&v(Kt)?0:jt/2),G=Math.max(G,ee&&Kt==="on"?0:jt)}}),xt=A.ordinal&&A.ordinal.slope&&D?A.ordinal.slope/D:1,A.minPointOffset=Y*=xt,A.pointRangePadding=G*=xt,A.pointRange=Math.min(P,A.single&&pt?1:B),_&&D&&(A.closestPointRange=D)),A.translationSlope=A.transA=Ct=A.staticScale||A.len/(B+G||1),A.transB=A.horiz?A.left:A.bottom,A.minPixelPadding=Ct*Y,I(this,"afterSetAxisTranslation")}minFromRange(){let{max:A,min:B}=this;return g(A)&&g(B)&&A-B||void 0}setTickInterval(A){var Ze,Ge,Ee,li;let{categories:B,chart:K,dataMax:pt,dataMin:_,dateTime:P,isXAxis:D,logarithmic:Y,options:G,softThreshold:xt}=this,Ct=g(this.threshold)?this.threshold:void 0,Dt=this.minRange||0,{ceiling:jt,floor:Kt,linkedTo:ee,softMax:le,softMin:ht}=G,st=g(ee)&&((Ze=K[this.coll])==null?void 0:Ze[ee]),Tt=G.tickPixelInterval,Mt=G.maxPadding,Ht=G.minPadding,Vt=0,re,Jt=g(G.tickInterval)&&G.tickInterval>=0?G.tickInterval:void 0,ye,ze,ge,be;if(P||B||st||this.getTickAmount(),ge=E(this.userMin,G.min),be=E(this.userMax,G.max),st?(this.linkedParent=st,re=st.getExtremes(),this.min=E(re.min,re.dataMin),this.max=E(re.max,re.dataMax),G.type!==st.options.type&&V(11,!0,K)):(xt&&et(Ct)&&g(pt)&&g(_)&&(_>=Ct?(ye=Ct,Ht=0):pt<=Ct&&(ze=Ct,Mt=0)),this.min=E(ge,ye,_),this.max=E(be,ze,pt)),g(this.max)&&g(this.min)&&(Y&&(this.positiveValuesOnly&&!A&&0>=Math.min(this.min,E(_,this.min))&&V(10,!0,K),this.min=j(Y.log2lin(this.min),16),this.max=j(Y.log2lin(this.max),16)),this.range&&g(_)&&(this.userMin=this.min=ge=Math.max(_,this.minFromRange()||0),this.userMax=be=this.max,this.range=void 0)),I(this,"foundExtremes"),this.adjustForMinRange(),g(this.min)&&g(this.max)){if(!g(this.userMin)&&g(ht)&&ht<this.min&&(this.min=ge=ht),!g(this.userMax)&&g(le)&&le>this.max&&(this.max=be=le),B||this.axisPointRange||(Ge=this.stacking)!=null&&Ge.usePercentage||st||!(Vt=this.max-this.min)||(!et(ge)&&Ht&&(this.min-=Vt*Ht),et(be)||!Mt||(this.max+=Vt*Mt)),!g(this.userMin)&&g(Kt)&&(this.min=Math.max(this.min,Kt)),!g(this.userMax)&&g(jt)&&(this.max=Math.min(this.max,jt)),xt&&g(_)&&g(pt)){let ii=Ct||0;!et(ge)&&this.min<ii&&_>=ii?this.min=G.minRange?Math.min(ii,this.max-Dt):ii:!et(be)&&this.max>ii&&pt<=ii&&(this.max=G.minRange?Math.max(ii,this.min+Dt):ii)}!K.polar&&this.min>this.max&&(et(G.min)?this.max=this.min:et(G.max)&&(this.min=this.max)),Vt=this.max-this.min}if(this.min!==this.max&&g(this.min)&&g(this.max)?st&&!Jt&&Tt===st.options.tickPixelInterval?this.tickInterval=Jt=st.tickInterval:this.tickInterval=E(Jt,this.tickAmount?Vt/Math.max(this.tickAmount-1,1):void 0,B?1:Vt*Tt/Math.max(this.len,Tt)):this.tickInterval=1,D&&!A){let ii=this.min!==((Ee=this.old)==null?void 0:Ee.min)||this.max!==((li=this.old)==null?void 0:li.max);this.series.forEach(function(xi){var Ni;xi.forceCrop=(Ni=xi.forceCropping)==null?void 0:Ni.call(xi),xi.processData(ii)}),I(this,"postProcessData",{hasExtremesChanged:ii})}this.setAxisTranslation(),I(this,"initialAxisTranslation"),this.pointRange&&!Jt&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval));let Oe=E(G.minTickInterval,P&&!this.series.some(ii=>ii.noSharedTooltip)?this.closestPointRange:0);!Jt&&this.tickInterval<Oe&&(this.tickInterval=Oe),P||Y||Jt||(this.tickInterval=ot(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()}setTickPositions(){var Ct,Dt;let A=this.options,B=A.tickPositions,K=A.tickPositioner,pt=this.getMinorTickInterval(),_=this.hasVerticalPanning(),P=this.coll==="colorAxis",D=(P||!_)&&A.startOnTick,Y=(P||!_)&&A.endOnTick,G=[],xt;if(this.tickmarkOffset=this.categories&&A.tickmarkPlacement==="between"&&this.tickInterval===1?.5:0,this.minorTickInterval=pt==="auto"&&this.tickInterval?this.tickInterval/A.minorTicksPerMajor:pt,this.single=this.min===this.max&&et(this.min)&&!this.tickAmount&&(this.min%1==0||A.allowDecimals!==!1),B)G=B.slice();else if(g(this.min)&&g(this.max)){if(!((Ct=this.ordinal)!=null&&Ct.positions)&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))G=[this.min,this.max],V(19,!1,this.chart);else if(this.dateTime)G=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,A.units),this.min,this.max,A.startOfWeek,(Dt=this.ordinal)==null?void 0:Dt.positions,this.closestPointRange,!0);else if(this.logarithmic)G=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{let jt=this.tickInterval,Kt=jt;for(;Kt<=2*jt&&(G=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&G.length>this.tickAmount);)this.tickInterval=ot(this,Kt*=1.1)}G.length>this.len&&(G=[G[0],G[G.length-1]])[0]===G[1]&&(G.length=1),K&&(this.tickPositions=G,(xt=K.apply(this,[this.min,this.max]))&&(G=xt))}this.tickPositions=G,this.paddedTicks=G.slice(0),this.trimTicks(G,D,Y),!this.isLinked&&g(this.min)&&g(this.max)&&(this.single&&G.length<2&&!this.categories&&!this.series.some(jt=>jt.is("heatmap")&&jt.options.pointPlacement==="between")&&(this.min-=.5,this.max+=.5),B||xt||this.adjustTickAmount()),I(this,"afterSetTickPositions")}trimTicks(A,B,K){let pt=A[0],_=A[A.length-1],P=!this.isOrdinal&&this.minPointOffset||0;if(I(this,"trimTicks"),!this.isLinked){if(B&&pt!==-1/0)this.min=pt;else for(;this.min-P>A[0];)A.shift();if(K)this.max=_;else for(;this.max+P<A[A.length-1];)A.pop();A.length===0&&et(pt)&&!this.options.tickPositions&&A.push((_+pt)/2)}}alignToOthers(){let A,B=this,K=[this],pt=B.options,_=this.chart.options.chart,P=this.coll==="yAxis"&&_.alignThresholds,D=[];if(B.thresholdAlignment=void 0,(_.alignTicks!==!1&&pt.alignTicks||P)&&pt.startOnTick!==!1&&pt.endOnTick!==!1&&!B.logarithmic){let Y=xt=>{let{horiz:Ct,options:Dt}=xt;return[Ct?Dt.left:Dt.top,Dt.width,Dt.height,Dt.pane].join(",")},G=Y(this);this.chart[this.coll].forEach(function(xt){let{series:Ct}=xt;Ct.length&&Ct.some(Dt=>Dt.visible)&&xt!==B&&Y(xt)===G&&(A=!0,K.push(xt))})}if(A&&P){K.forEach(G=>{let xt=G.getThresholdAlignment(B);g(xt)&&D.push(xt)});let Y=D.length>1?D.reduce((G,xt)=>G+=xt,0)/D.length:void 0;K.forEach(G=>{G.thresholdAlignment=Y})}return A}getThresholdAlignment(A){if((!g(this.dataMin)||this!==A&&this.series.some(B=>B.isDirty||B.isDirtyData))&&this.getSeriesExtremes(),g(this.threshold)){let B=U((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return this.options.reversed&&(B=1-B),B}}getTickAmount(){let A=this.options,B=A.tickPixelInterval,K=A.tickAmount;et(A.tickInterval)||K||!(this.len<B)||this.isRadial||this.logarithmic||!A.startOnTick||!A.endOnTick||(K=2),!K&&this.alignToOthers()&&(K=Math.ceil(this.len/B)+1),K<4&&(this.finalTickAmt=K,K=5),this.tickAmount=K}adjustTickAmount(){let A=this,{finalTickAmt:B,max:K,min:pt,options:_,tickPositions:P,tickAmount:D,thresholdAlignment:Y}=A,G=P==null?void 0:P.length,xt=E(A.threshold,A.softThreshold?0:null),Ct,Dt,jt=A.tickInterval,Kt,ee=()=>P.push(j(P[P.length-1]+jt)),le=()=>P.unshift(j(P[0]-jt));if(g(Y)&&(Kt=Y<.5?Math.ceil(Y*(D-1)):Math.floor(Y*(D-1)),_.reversed&&(Kt=D-1-Kt)),A.hasData()&&g(pt)&&g(K)){let ht=()=>{A.transA*=(G-1)/(D-1),A.min=_.startOnTick?P[0]:Math.min(pt,P[0]),A.max=_.endOnTick?P[P.length-1]:Math.max(K,P[P.length-1])};if(g(Kt)&&g(A.threshold)){for(;P[Kt]!==xt||P.length!==D||P[0]>pt||P[P.length-1]<K;){for(P.length=0,P.push(A.threshold);P.length<D;)P[Kt]===void 0||P[Kt]>A.threshold?le():ee();if(jt>8*A.tickInterval)break;jt*=2}ht()}else if(G<D){for(;P.length<D;)P.length%2||pt===xt?ee():le();ht()}if(et(B)){for(Dt=Ct=P.length;Dt--;)(B===3&&Dt%2==1||B<=2&&Dt>0&&Dt<Ct-1)&&P.splice(Dt,1);A.finalTickAmt=void 0}}}setScale(){var P,D;let{coll:A,stacking:B}=this,K=!1,pt=!1;this.series.forEach(Y=>{K=K||Y.isDirtyData||Y.isDirty,pt=pt||Y.xAxis&&Y.xAxis.isDirty||!1}),this.setAxisSize();let _=this.len!==(this.old&&this.old.len);_||K||pt||this.isLinked||this.forceRedraw||this.userMin!==(this.old&&this.old.userMin)||this.userMax!==(this.old&&this.old.userMax)||this.alignToOthers()?(B&&A==="yAxis"&&B.buildStacks(),this.forceRedraw=!1,this.userMinRange||(this.minRange=void 0),this.getSeriesExtremes(),this.setTickInterval(),B&&A==="xAxis"&&B.buildStacks(),this.isDirty||(this.isDirty=_||this.min!==((P=this.old)==null?void 0:P.min)||this.max!==((D=this.old)==null?void 0:D.max))):B&&B.cleanStacks(),K&&this.panningState&&(this.panningState.isDirty=!0),I(this,"afterSetScale")}setExtremes(A,B,K=!0,pt,_){let P=this,D=P.chart;P.series.forEach(Y=>{delete Y.kdTree}),I(P,"setExtremes",_=rt(_,{min:A,max:B}),()=>{P.userMin=A,P.userMax=B,P.eventArgs=_,K&&D.redraw(pt)})}zoom(A,B){let K=this,pt=this.dataMin,_=this.dataMax,P=this.options,D=Math.min(pt,E(P.min,pt)),Y=Math.max(_,E(P.max,_)),G={newMin:A,newMax:B};return I(this,"zoom",G,function(xt){let Ct=xt.newMin,Dt=xt.newMax;(Ct!==K.min||Dt!==K.max)&&(!K.allowZoomOutside&&(et(pt)&&(Ct<D&&(Ct=D),Ct>Y&&(Ct=Y)),et(_)&&(Dt<D&&(Dt=D),Dt>Y&&(Dt=Y))),K.displayBtn=Ct!==void 0||Dt!==void 0,K.setExtremes(Ct,Dt,!1,void 0,{trigger:"zoom"})),xt.zoomed=!0}),G.zoomed}setAxisSize(){let A=this.chart,B=this.options,K=B.offsets||[0,0,0,0],pt=this.horiz,_=this.width=Math.round(w(E(B.width,A.plotWidth-K[3]+K[1]),A.plotWidth)),P=this.height=Math.round(w(E(B.height,A.plotHeight-K[0]+K[2]),A.plotHeight)),D=this.top=Math.round(w(E(B.top,A.plotTop+K[0]),A.plotHeight,A.plotTop)),Y=this.left=Math.round(w(E(B.left,A.plotLeft+K[3]),A.plotWidth,A.plotLeft));this.bottom=A.chartHeight-P-D,this.right=A.chartWidth-_-Y,this.len=Math.max(pt?_:P,0),this.pos=pt?Y:D}getExtremes(){let A=this.logarithmic;return{min:A?j(A.lin2log(this.min)):this.min,max:A?j(A.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}}getThreshold(A){let B=this.logarithmic,K=B?B.lin2log(this.min):this.min,pt=B?B.lin2log(this.max):this.max;return A===null||A===-1/0?A=K:A===1/0?A=pt:K>A?A=K:pt<A&&(A=pt),this.translate(A,0,1,0,1)}autoLabelAlign(A){let B=(E(A,0)-90*this.side+720)%360,K={align:"center"};return I(this,"autoLabelAlign",K,function(pt){B>15&&B<165?pt.align="right":B>195&&B<345&&(pt.align="left")}),K.align}tickSize(A){let B=this.options,K=E(B[A==="tick"?"tickWidth":"minorTickWidth"],A==="tick"&&this.isXAxis&&!this.categories?1:0),pt=B[A==="tick"?"tickLength":"minorTickLength"],_;K&&pt&&(B[A+"Position"]==="inside"&&(pt=-pt),_=[pt,K]);let P={tickSize:_};return I(this,"afterTickSize",P),P.tickSize}labelMetrics(){let A=this.chart.renderer,B=this.ticks,K=B[Object.keys(B)[0]]||{};return this.chart.renderer.fontMetrics(K.label||K.movedLabel||A.box)}unsquish(){let A=this.options.labels,B=this.horiz,K=this.tickInterval,pt=this.len/(((this.categories?1:0)+this.max-this.min)/K),_=A.rotation,P=this.labelMetrics().h,D=Math.max(this.max-this.min,0),Y=function(jt){let Kt=jt/(pt||1);return(Kt=Kt>1?Math.ceil(Kt):1)*K>D&&jt!==1/0&&pt!==1/0&&D&&(Kt=Math.ceil(D/K)),j(Kt*K)},G=K,xt,Ct=Number.MAX_VALUE,Dt;if(B){if(!A.staggerLines&&(g(_)?Dt=[_]:pt<A.autoRotationLimit&&(Dt=A.autoRotation)),Dt){let jt,Kt;for(let ee of Dt)(ee===_||ee&&ee>=-90&&ee<=90)&&(Kt=(jt=Y(Math.abs(P/Math.sin(W*ee))))+Math.abs(ee/360))<Ct&&(Ct=Kt,xt=ee,G=jt)}}else G=Y(.75*P);return this.autoRotation=Dt,this.labelRotation=E(xt,g(_)?_:0),A.step?K:G}getSlotWidth(A){let B=this.chart,K=this.horiz,pt=this.options.labels,_=Math.max(this.tickPositions.length-(this.categories?0:1),1),P=B.margin[3];if(A&&g(A.slotWidth))return A.slotWidth;if(K&&pt.step<2)return pt.rotation?0:(this.staggerLines||1)*this.len/_;if(!K){let D=pt.style.width;if(D!==void 0)return parseInt(String(D),10);if(P)return P-B.spacing[3]}return .33*B.chartWidth}renderUnsquish(){let A=this.chart,B=A.renderer,K=this.tickPositions,pt=this.ticks,_=this.options.labels,P=_.style,D=this.horiz,Y=this.getSlotWidth(),G=Math.max(1,Math.round(Y-2*_.padding)),xt={},Ct=this.labelMetrics(),Dt=P.textOverflow,jt,Kt,ee=0,le,ht;if(v(_.rotation)||(xt.rotation=_.rotation||0),K.forEach(function(st){let Tt=pt[st];Tt.movedLabel&&Tt.replaceMovedLabel(),Tt&&Tt.label&&Tt.label.textPxLength>ee&&(ee=Tt.label.textPxLength)}),this.maxLabelLength=ee,this.autoRotation)ee>G&&ee>Ct.h?xt.rotation=this.labelRotation:this.labelRotation=0;else if(Y&&(jt=G,!Dt))for(Kt="clip",ht=K.length;!D&&ht--;)(le=pt[K[ht]].label)&&(le.styles&&le.styles.textOverflow==="ellipsis"?le.css({textOverflow:"clip"}):le.textPxLength>Y&&le.css({width:Y+"px"}),le.getBBox().height>this.len/K.length-(Ct.h-Ct.f)&&(le.specificTextOverflow="ellipsis"));xt.rotation&&(jt=ee>.5*A.chartHeight?.33*A.chartHeight:ee,Dt||(Kt="ellipsis")),this.labelAlign=_.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(xt.align=this.labelAlign),K.forEach(function(st){let Tt=pt[st],Mt=Tt&&Tt.label,Ht=P.width,Vt={};Mt&&(Mt.attr(xt),Tt.shortenLabel?Tt.shortenLabel():jt&&!Ht&&P.whiteSpace!=="nowrap"&&(jt<Mt.textPxLength||Mt.element.tagName==="SPAN")?(Vt.width=jt+"px",Dt||(Vt.textOverflow=Mt.specificTextOverflow||Kt),Mt.css(Vt)):Mt.styles&&Mt.styles.width&&!Vt.width&&!Ht&&Mt.css({width:null}),delete Mt.specificTextOverflow,Tt.rotation=xt.rotation)},this),this.tickRotCorr=B.rotCorr(Ct.b,this.labelRotation||0,this.side!==0)}hasData(){return this.series.some(function(A){return A.hasData()})||this.options.showEmpty&&et(this.min)&&et(this.max)}addTitle(A){let B,K=this.chart.renderer,pt=this.horiz,_=this.opposite,P=this.options,D=P.title,Y=this.chart.styledMode;this.axisTitle||((B=D.textAlign)||(B=(pt?{low:"left",middle:"center",high:"right"}:{low:_?"right":"left",middle:"center",high:_?"left":"right"})[D.align]),this.axisTitle=K.text(D.text||"",0,0,D.useHTML).attr({zIndex:7,rotation:D.rotation||0,align:B}).addClass("highcharts-axis-title"),Y||this.axisTitle.css(y(D.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),Y||D.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[A?"show":"hide"](A)}generateTick(A){let B=this.ticks;B[A]?B[A].addLabel():B[A]=new Lt(this,A)}createGroups(){let{axisParent:A,chart:B,coll:K,options:pt}=this,_=B.renderer,P=(D,Y,G)=>_.g(D).attr({zIndex:G}).addClass(`highcharts-${K.toLowerCase()}${Y} `+(this.isRadial?`highcharts-radial-axis${Y} `:"")+(pt.className||"")).add(A);this.axisGroup||(this.gridGroup=P("grid","-grid",pt.gridZIndex),this.axisGroup=P("axis","",pt.zIndex),this.labelGroup=P("axis-labels","-labels",pt.labels.zIndex))}getOffset(){let A=this,{chart:B,horiz:K,options:pt,side:_,ticks:P,tickPositions:D,coll:Y}=A,G=B.inverted&&!A.isZAxis?[1,0,3,2][_]:_,xt=A.hasData(),Ct=pt.title,Dt=pt.labels,jt=g(pt.crossing),Kt=B.axisOffset,ee=B.clipOffset,le=[-1,1,1,-1][_],ht,st=0,Tt,Mt=0,Ht=0,Vt,re;if(A.showAxis=ht=xt||pt.showEmpty,A.staggerLines=A.horiz&&Dt.staggerLines||void 0,A.createGroups(),xt||A.isLinked?(D.forEach(function(Jt){A.generateTick(Jt)}),A.renderUnsquish(),A.reserveSpaceDefault=_===0||_===2||{1:"left",3:"right"}[_]===A.labelAlign,E(Dt.reserveSpace,!jt&&null,A.labelAlign==="center"||null,A.reserveSpaceDefault)&&D.forEach(function(Jt){Ht=Math.max(P[Jt].getLabelSize(),Ht)}),A.staggerLines&&(Ht*=A.staggerLines),A.labelOffset=Ht*(A.opposite?-1:1)):k(P,function(Jt,ye){Jt.destroy(),delete P[ye]}),Ct!=null&&Ct.text&&Ct.enabled!==!1&&(A.addTitle(ht),ht&&!jt&&Ct.reserveSpace!==!1&&(A.titleOffset=st=A.axisTitle.getBBox()[K?"height":"width"],Mt=et(Tt=Ct.offset)?0:E(Ct.margin,K?5:10))),A.renderLine(),A.offset=le*E(pt.offset,Kt[_]?Kt[_]+(pt.margin||0):0),A.tickRotCorr=A.tickRotCorr||{x:0,y:0},re=_===0?-A.labelMetrics().h:_===2?A.tickRotCorr.y:0,Vt=Math.abs(Ht)+Mt,Ht&&(Vt-=re,Vt+=le*(K?E(Dt.y,A.tickRotCorr.y+le*Dt.distance):E(Dt.x,le*Dt.distance))),A.axisTitleMargin=E(Tt,Vt),A.getMaxLabelDimensions&&(A.maxLabelDimensions=A.getMaxLabelDimensions(P,D)),Y!=="colorAxis"){let Jt=this.tickSize("tick");Kt[_]=Math.max(Kt[_],(A.axisTitleMargin||0)+st+le*A.offset,Vt,D&&D.length&&Jt?Jt[0]+le*A.offset:0);let ye=!A.axisLine||pt.offset?0:2*Math.floor(A.axisLine.strokeWidth()/2);ee[G]=Math.max(ee[G],ye)}I(this,"afterGetOffset")}getLinePath(A){let B=this.chart,K=this.opposite,pt=this.offset,_=this.horiz,P=this.left+(K?this.width:0)+pt,D=B.chartHeight-this.bottom-(K?this.height:0)+pt;return K&&(A*=-1),B.renderer.crispLine([["M",_?this.left:P,_?D:this.top],["L",_?B.chartWidth-this.right:P,_?D:B.chartHeight-this.bottom]],A)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(A){let B=this.horiz,K=this.left,pt=this.top,_=this.len,P=this.options.title,D=B?K:pt,Y=this.opposite,G=this.offset,xt=P.x,Ct=P.y,Dt=this.chart.renderer.fontMetrics(A),jt=A?Math.max(A.getBBox(!1,0).height-Dt.h-1,0):0,Kt={low:D+(B?0:_),middle:D+_/2,high:D+(B?_:0)}[P.align],ee=(B?pt+this.height:K)+(B?1:-1)*(Y?-1:1)*(this.axisTitleMargin||0)+[-jt,jt,Dt.f,-jt][this.side],le={x:B?Kt+xt:ee+(Y?this.width:0)+G+xt,y:B?ee+Ct-(Y?this.height:0)+G:Kt+Ct};return I(this,"afterGetTitlePosition",{titlePosition:le}),le}renderMinorTick(A,B){let K=this.minorTicks;K[A]||(K[A]=new Lt(this,A,"minor")),B&&K[A].isNew&&K[A].render(null,!0),K[A].render(null,!1,1)}renderTick(A,B,K){let pt=this.isLinked,_=this.ticks;(!pt||A>=this.min&&A<=this.max||this.grid&&this.grid.isColumn)&&(_[A]||(_[A]=new Lt(this,A)),K&&_[A].isNew&&_[A].render(B,!0,-1),_[A].render(B))}render(){let A,B,K=this,pt=K.chart,_=K.logarithmic,P=pt.renderer,D=K.options,Y=K.isLinked,G=K.tickPositions,xt=K.axisTitle,Ct=K.ticks,Dt=K.minorTicks,jt=K.alternateBands,Kt=D.stackLabels,ee=D.alternateGridColor,le=D.crossing,ht=K.tickmarkOffset,st=K.axisLine,Tt=K.showAxis,Mt=ut(P.globalAnimation);if(K.labelEdge.length=0,K.overlap=!1,[Ct,Dt,jt].forEach(function(Ht){k(Ht,function(Vt){Vt.isActive=!1})}),g(le)){let Ht=this.isXAxis?pt.yAxis[0]:pt.xAxis[0],Vt=[1,-1,-1,1][this.side];if(Ht){let re=Ht.toPixels(le,!0);K.horiz&&(re=Ht.len-re),K.offset=Vt*re}}if(K.hasData()||Y){let Ht=K.chart.hasRendered&&K.old&&g(K.old.min);K.minorTickInterval&&!K.categories&&K.getMinorTickPositions().forEach(function(Vt){K.renderMinorTick(Vt,Ht)}),G.length&&(G.forEach(function(Vt,re){K.renderTick(Vt,re,Ht)}),ht&&(K.min===0||K.single)&&(Ct[-1]||(Ct[-1]=new Lt(K,-1,null,!0)),Ct[-1].render(-1))),ee&&G.forEach(function(Vt,re){B=G[re+1]!==void 0?G[re+1]+ht:K.max-ht,re%2==0&&Vt<K.max&&B<=K.max+(pt.polar?-ht:ht)&&(jt[Vt]||(jt[Vt]=new Nt.PlotLineOrBand(K,{})),A=Vt+ht,jt[Vt].options={from:_?_.lin2log(A):A,to:_?_.lin2log(B):B,color:ee,className:"highcharts-alternate-grid"},jt[Vt].render(),jt[Vt].isActive=!0)}),K._addedPlotLB||(K._addedPlotLB=!0,(D.plotLines||[]).concat(D.plotBands||[]).forEach(function(Vt){K.addPlotBandOrLine(Vt)}))}[Ct,Dt,jt].forEach(function(Ht){let Vt=[],re=Mt.duration;k(Ht,function(Jt,ye){Jt.isActive||(Jt.render(ye,!1,0),Jt.isActive=!1,Vt.push(ye))}),wt(function(){let Jt=Vt.length;for(;Jt--;)Ht[Vt[Jt]]&&!Ht[Vt[Jt]].isActive&&(Ht[Vt[Jt]].destroy(),delete Ht[Vt[Jt]])},Ht!==jt&&pt.hasRendered&&re?re:0)}),st&&(st[st.isPlaced?"animate":"attr"]({d:this.getLinePath(st.strokeWidth())}),st.isPlaced=!0,st[Tt?"show":"hide"](Tt)),xt&&Tt&&(xt[xt.isNew?"attr":"animate"](K.getTitlePosition(xt)),xt.isNew=!1),Kt&&Kt.enabled&&K.stacking&&K.stacking.renderStackTotals(),K.old={len:K.len,max:K.max,min:K.min,transA:K.transA,userMax:K.userMax,userMin:K.userMin},K.isDirty=!1,I(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(A){A.render()})),this.series.forEach(function(A){A.isDirty=!0})}getKeepProps(){return this.keepProps||it.keepProps}destroy(A){let B=this,K=B.plotLinesAndBands,pt=this.eventOptions;if(I(this,"destroy",{keepEvents:A}),A||R(B),[B.ticks,B.minorTicks,B.alternateBands].forEach(function(_){_t(_)}),K){let _=K.length;for(;_--;)K[_].destroy()}for(let _ in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(P){B[P]&&(B[P]=B[P].destroy())}),B.plotLinesAndBandsGroups)B.plotLinesAndBandsGroups[_]=B.plotLinesAndBandsGroups[_].destroy();k(B,function(_,P){B.getKeepProps().indexOf(P)===-1&&delete B[P]}),this.eventOptions=pt}drawCrosshair(A,B){let K=this.crosshair,pt=E(K&&K.snap,!0),_=this.chart,P,D,Y,G=this.cross,xt;if(I(this,"drawCrosshair",{e:A,point:B}),A||(A=this.cross&&this.cross.e),K&&(et(B)||!pt)!==!1){if(pt?et(B)&&(D=E(this.coll!=="colorAxis"?B.crosshairPos:null,this.isXAxis?B.plotX:this.len-B.plotY)):D=A&&(this.horiz?A.chartX-this.pos:this.len-A.chartY+this.pos),et(D)&&(xt={value:B&&(this.isXAxis?B.x:E(B.stackY,B.y)),translatedValue:D},_.polar&&rt(xt,{isCrosshair:!0,chartX:A&&A.chartX,chartY:A&&A.chartY,point:B}),P=this.getPlotLinePath(xt)||null),!et(P)){this.hideCrosshair();return}Y=this.categories&&!this.isRadial,G||(this.cross=G=_.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(Y?"category ":"thin ")+(K.className||"")).attr({zIndex:E(K.zIndex,2)}).add(),!_.styledMode&&(G.attr({stroke:K.color||(Y?l.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":E(K.width,1)}).css({"pointer-events":"none"}),K.dashStyle&&G.attr({dashstyle:K.dashStyle}))),G.show().attr({d:P}),Y&&!K.width&&G.attr({"stroke-width":this.transA}),this.cross.e=A}else this.hideCrosshair();I(this,"afterDrawCrosshair",{e:A,point:B})}hideCrosshair(){this.cross&&this.cross.hide(),I(this,"afterHideCrosshair")}hasVerticalPanning(){let A=this.chart.options.chart.panning;return!!(A&&A.enabled&&/y/.test(A.type))}update(A,B){let K=this.chart;A=y(this.userOptions,A),this.destroy(!0),this.init(K,A),K.isDirtyBox=!0,E(B,!0)&&K.redraw()}remove(A){let B=this.chart,K=this.coll,pt=this.series,_=pt.length;for(;_--;)pt[_]&&pt[_].remove(!1);mt(B.axes,this),mt(B[K]||[],this),B.orderItems(K),this.destroy(),B.isDirtyBox=!0,E(A,!0)&&B.redraw()}setTitle(A,B){this.update({title:A},B)}setCategories(A,B){this.update({categories:A},B)}}return it.keepProps=["coll","extKey","hcEvents","names","series","userMax","userMin"],it}),te(X,"Core/Axis/DateTimeAxis.js",[X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At){var l;let{composed:Zt}=Et,{addEvent:dt,getMagnitude:Nt,normalizeTickInterval:Lt,pushUnique:kt,timeUnits:ut}=At;return function(Rt){function Z(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function lt(){if(this.options.type!=="datetime"){this.dateTime=void 0;return}this.dateTime||(this.dateTime=new at(this))}Rt.compose=function W(q){if(kt(Zt,W)){q.keepProps.push("dateTime");let $=q.prototype;$.getTimeTicks=Z,dt(q,"afterSetOptions",lt)}return q};class at{constructor(q){this.axis=q}normalizeTimeTickInterval(q,$){let U=$||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],j=U[U.length-1],et=ut[j[0]],_t=j[1],mt;for(mt=0;mt<U.length;mt++)if(et=ut[(j=U[mt])[0]],_t=j[1],U[mt+1]){let rt=(et*_t[_t.length-1]+ut[U[mt+1][0]])/2;if(q<=rt)break}et===ut.year&&q<5*et&&(_t=[1,2,5]);let V=Lt(q/et,_t,j[0]==="year"?Math.max(Nt(q/et),1):1);return{unitRange:et,count:V,unitName:j[0]}}getXDateFormat(q,$){let{axis:U}=this,j=U.chart.time;return U.closestPointRange?j.getDateFormat(U.closestPointRange,q,U.options.startOfWeek,$)||j.resolveDTLFormat($.year).main:j.resolveDTLFormat($.day).main}}Rt.Additions=at}(l||(l={})),l}),te(X,"Core/Axis/LogarithmicAxis.js",[X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At){var l;let{composed:Zt}=Et,{addEvent:dt,normalizeTickInterval:Nt,pick:Lt,pushUnique:kt}=At;return function(ut){function Rt(at){let W=at.userOptions,q=this.logarithmic;W.type!=="logarithmic"?this.logarithmic=void 0:q||(q=this.logarithmic=new lt(this))}function Z(){let at=this.logarithmic;at&&(this.lin2val=function(W){return at.lin2log(W)},this.val2lin=function(W){return at.log2lin(W)})}ut.compose=function at(W){return kt(Zt,at)&&(W.keepProps.push("logarithmic"),dt(W,"init",Rt),dt(W,"afterInit",Z)),W};class lt{constructor(W){this.axis=W}getLogTickPositions(W,q,$,U){let j=this.axis,et=j.len,_t=j.options,mt=[];if(U||(this.minorAutoInterval=void 0),W>=.5)W=Math.round(W),mt=j.getLinearTickPositions(W,q,$);else if(W>=.08){let V,rt,I,C,z,S,g,v=Math.floor(q);for(V=W>.3?[1,2,4]:W>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],rt=v;rt<$+1&&!g;rt++)for(I=0,C=V.length;I<C&&!g;I++)(z=this.log2lin(this.lin2log(rt)*V[I]))>q&&(!U||S<=$)&&S!==void 0&&mt.push(S),S>$&&(g=!0),S=z}else{let V=this.lin2log(q),rt=this.lin2log($),I=U?j.getMinorTickInterval():_t.tickInterval,C=I==="auto"?null:I,z=_t.tickPixelInterval/(U?5:1),S=U?et/j.tickPositions.length:et;W=Nt(W=Lt(C,this.minorAutoInterval,(rt-V)*z/(S||1))),mt=j.getLinearTickPositions(W,V,rt).map(this.log2lin),U||(this.minorAutoInterval=W/5)}return U||(j.tickInterval=W),mt}lin2log(W){return Math.pow(10,W)}log2lin(W){return Math.log(W)/Math.LN10}}ut.Additions=lt}(l||(l={})),l}),te(X,"Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js",[X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At){var l;let{composed:Zt}=Et,{erase:dt,extend:Nt,isNumber:Lt,pushUnique:kt}=At;return function(ut){let Rt;function Z(j){return this.addPlotBandOrLine(j,"plotBands")}function lt(j,et){let _t=this.userOptions,mt=new Rt(this,j);if(this.visible&&(mt=mt.render()),mt){if(this._addedPlotLB||(this._addedPlotLB=!0,(_t.plotLines||[]).concat(_t.plotBands||[]).forEach(V=>{this.addPlotBandOrLine(V)})),et){let V=_t[et]||[];V.push(j),_t[et]=V}this.plotLinesAndBands.push(mt)}return mt}function at(j){return this.addPlotBandOrLine(j,"plotLines")}function W(j,et,_t){_t=_t||this.options;let mt=this.getPlotLinePath({value:et,force:!0,acrossPanes:_t.acrossPanes}),V=[],rt=this.horiz,I=!Lt(this.min)||!Lt(this.max)||j<this.min&&et<this.min||j>this.max&&et>this.max,C=this.getPlotLinePath({value:j,force:!0,acrossPanes:_t.acrossPanes}),z,S=1,g;if(C&&mt)for(I&&(g=C.toString()===mt.toString(),S=0),z=0;z<C.length;z+=2){let v=C[z],y=C[z+1],T=mt[z],k=mt[z+1];(v[0]==="M"||v[0]==="L")&&(y[0]==="M"||y[0]==="L")&&(T[0]==="M"||T[0]==="L")&&(k[0]==="M"||k[0]==="L")&&(rt&&T[1]===v[1]?(T[1]+=S,k[1]+=S):rt||T[2]!==v[2]||(T[2]+=S,k[2]+=S),V.push(["M",v[1],v[2]],["L",y[1],y[2]],["L",k[1],k[2]],["L",T[1],T[2]],["Z"])),V.isFlat=g}return V}function q(j){this.removePlotBandOrLine(j)}function $(j){let et=this.plotLinesAndBands,_t=this.options,mt=this.userOptions;if(et){let V=et.length;for(;V--;)et[V].id===j&&et[V].destroy();[_t.plotLines||[],mt.plotLines||[],_t.plotBands||[],mt.plotBands||[]].forEach(function(rt){for(V=rt.length;V--;)(rt[V]||{}).id===j&&dt(rt,rt[V])})}}function U(j){this.removePlotBandOrLine(j)}ut.compose=function j(et,_t){return kt(Zt,j)&&(Rt=et,Nt(_t.prototype,{addPlotBand:Z,addPlotLine:at,addPlotBandOrLine:lt,getPlotBandPath:W,removePlotBand:q,removePlotLine:U,removePlotBandOrLine:$})),_t}}(l||(l={})),l}),te(X,"Core/Axis/PlotLineOrBand/PlotLineOrBand.js",[X["Core/Axis/PlotLineOrBand/PlotLineOrBandAxis.js"],X["Core/Utilities.js"]],function(Et,At){let{arrayMax:l,arrayMin:Zt,defined:dt,destroyObjectProperties:Nt,erase:Lt,fireEvent:kt,merge:ut,objectEach:Rt,pick:Z}=At;class lt{static compose(W){return Et.compose(lt,W)}constructor(W,q){this.axis=W,this.options=q,this.id=q.id}render(){kt(this,"render");let{axis:W,options:q}=this,{horiz:$,logarithmic:U}=W,{color:j,events:et,zIndex:_t=0}=q,mt={},V=W.chart.renderer,rt=q.to,I=q.from,C=q.value,z=q.borderWidth,S=q.label,{label:g,svgElem:v}=this,y=[],T,k=dt(I)&&dt(rt),E=dt(C),w=!v,R={class:"highcharts-plot-"+(k?"band ":"line ")+(q.className||"")},J=k?"bands":"lines";if(!W.chart.styledMode&&(E?(R.stroke=j||"#999999",R["stroke-width"]=Z(q.width,1),q.dashStyle&&(R.dashstyle=q.dashStyle)):k&&(R.fill=j||"#e6e9ff",z&&(R.stroke=q.borderColor,R["stroke-width"]=z))),mt.zIndex=_t,J+="-"+_t,(T=W.plotLinesAndBandsGroups[J])||(W.plotLinesAndBandsGroups[J]=T=V.g("plot-"+J).attr(mt).add()),v||(this.svgElem=v=V.path().attr(R).add(T)),dt(C))y=W.getPlotLinePath({value:(U==null?void 0:U.log2lin(C))??C,lineWidth:v.strokeWidth(),acrossPanes:q.acrossPanes});else{if(!(dt(I)&&dt(rt)))return;y=W.getPlotBandPath((U==null?void 0:U.log2lin(I))??I,(U==null?void 0:U.log2lin(rt))??rt,q)}return!this.eventsAdded&&et&&(Rt(et,(wt,ot)=>{v==null||v.on(ot,function(it){et[ot].apply(this,[it])})}),this.eventsAdded=!0),(w||!v.d)&&(y!=null&&y.length)?v.attr({d:y}):v&&(y?(v.show(),v.animate({d:y})):v.d&&(v.hide(),g&&(this.label=g=g.destroy()))),S&&(dt(S.text)||dt(S.formatter))&&(y!=null&&y.length)&&W.width>0&&W.height>0&&!y.isFlat?(S=ut({align:$&&k&&"center",x:$?!k&&4:10,verticalAlign:!$&&k&&"middle",y:$?k?16:10:k?6:-4,rotation:$&&!k&&90},S),this.renderLabel(S,y,k,_t)):g&&g.hide(),this}renderLabel(W,q,$,U){let j=this.axis,et=j.chart.renderer,_t=this.label;_t||(this.label=_t=et.text(this.getLabelText(W),0,0,W.useHTML).attr({align:W.textAlign||W.align,rotation:W.rotation,class:"highcharts-plot-"+($?"band":"line")+"-label"+(W.className||""),zIndex:U}),j.chart.styledMode||_t.css(ut({fontSize:"0.8em",textOverflow:"ellipsis"},W.style)),_t.add());let mt=q.xBounds||[q[0][1],q[1][1],$?q[2][1]:q[0][1]],V=q.yBounds||[q[0][2],q[1][2],$?q[2][2]:q[0][2]],rt=Zt(mt),I=Zt(V);if(_t.align(W,!1,{x:rt,y:I,width:l(mt)-rt,height:l(V)-I}),!_t.alignValue||_t.alignValue==="left"){let C=W.clip?j.width:j.chart.chartWidth;_t.css({width:(_t.rotation===90?j.height-(_t.alignAttr.y-j.top):C-(_t.alignAttr.x-j.left))+"px"})}_t.show(!0)}getLabelText(W){return dt(W.formatter)?W.formatter.call(this):W.text}destroy(){Lt(this.axis.plotLinesAndBands,this),delete this.axis,Nt(this)}}return lt}),te(X,"Core/Tooltip.js",[X["Core/Templating.js"],X["Core/Globals.js"],X["Core/Renderer/RendererUtilities.js"],X["Core/Renderer/RendererRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt){var Nt;let{format:Lt}=Et,{composed:kt,doc:ut,isSafari:Rt}=At,{distribute:Z}=l,{addEvent:lt,clamp:at,css:W,discardElement:q,extend:$,fireEvent:U,isArray:j,isNumber:et,isString:_t,merge:mt,pick:V,pushUnique:rt,splat:I,syncTimeout:C}=dt;class z{constructor(g,v){this.allowShared=!0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.now={},this.options={},this.outside=!1,this.chart=g,this.init(g,v)}bodyFormatter(g){return g.map(function(v){let y=v.series.tooltipOptions;return(y[(v.point.formatPrefix||"point")+"Formatter"]||v.point.tooltipFormatter).call(v.point,y[(v.point.formatPrefix||"point")+"Format"]||"")})}cleanSplit(g){this.chart.series.forEach(function(v){let y=v&&v.tt;y&&(!y.isActive||g?v.tt=y.destroy():y.isActive=!1)})}defaultFormatter(g){let v,y=this.points||I(this);return(v=(v=[g.tooltipFooterHeaderFormatter(y[0])]).concat(g.bodyFormatter(y))).push(g.tooltipFooterHeaderFormatter(y[0],!0)),v}destroy(){this.label&&(this.label=this.label.destroy()),this.split&&(this.cleanSplit(!0),this.tt&&(this.tt=this.tt.destroy())),this.renderer&&(this.renderer=this.renderer.destroy(),q(this.container)),dt.clearTimeout(this.hideTimer),dt.clearTimeout(this.tooltipTimeout)}getAnchor(g,v){let y,T=this.chart,k=T.pointer,E=T.inverted,w=T.plotTop,R=T.plotLeft;if((g=I(g))[0].series&&g[0].series.yAxis&&!g[0].series.yAxis.options.reversedStacks&&(g=g.slice().reverse()),this.followPointer&&v)v.chartX===void 0&&(v=k.normalize(v)),y=[v.chartX-R,v.chartY-w];else if(g[0].tooltipPos)y=g[0].tooltipPos;else{let J=0,wt=0;g.forEach(function(ot){let it=ot.pos(!0);it&&(J+=it[0],wt+=it[1])}),J/=g.length,wt/=g.length,this.shared&&g.length>1&&v&&(E?J=v.chartX:wt=v.chartY),y=[J-R,wt-w]}return y.map(Math.round)}getClassName(g,v,y){let T=this.options,k=g.series,E=k.options;return[T.className,"highcharts-label",y&&"highcharts-tooltip-header",v?"highcharts-tooltip-box":"highcharts-tooltip",!y&&"highcharts-color-"+V(g.colorIndex,k.colorIndex),E&&E.className].filter(_t).join(" ")}getLabel(){let g=this,v=this.chart.styledMode,y=this.options,T=this.split&&this.allowShared,k=this.container,E=this.chart.renderer;if(this.label){let w=!this.label.hasClass("highcharts-label");(!T&&w||T&&!w)&&this.destroy()}if(!this.label){if(this.outside){let w=this.chart.options.chart.style,R=Zt.getRendererType();this.container=k=At.doc.createElement("div"),k.className="highcharts-tooltip-container",W(k,{position:"absolute",top:"1px",pointerEvents:"none",zIndex:Math.max(this.options.style.zIndex||0,(w&&w.zIndex||0)+3)}),this.renderer=E=new R(k,0,0,w,void 0,void 0,E.styledMode)}if(T?this.label=E.g("tooltip"):(this.label=E.label("",0,0,y.shape,void 0,void 0,y.useHTML,void 0,"tooltip").attr({padding:y.padding,r:y.borderRadius}),v||this.label.attr({fill:y.backgroundColor,"stroke-width":y.borderWidth||0}).css(y.style).css({pointerEvents:y.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none")})),g.outside){let w=this.label,{xSetter:R,ySetter:J}=w;w.xSetter=function(wt){R.call(w,g.distance),k&&(k.style.left=wt+"px")},w.ySetter=function(wt){J.call(w,g.distance),k&&(k.style.top=wt+"px")}}this.label.attr({zIndex:8}).shadow(y.shadow).add()}return k&&!k.parentElement&&At.doc.body.appendChild(k),this.label}getPlayingField(){let{body:g,documentElement:v}=ut,{chart:y,distance:T,outside:k}=this;return{width:k?Math.max(g.scrollWidth,v.scrollWidth,g.offsetWidth,v.offsetWidth,v.clientWidth)-2*T:y.chartWidth,height:k?Math.max(g.scrollHeight,v.scrollHeight,g.offsetHeight,v.offsetHeight,v.clientHeight):y.chartHeight}}getPosition(g,v,y){var ht,st;let{distance:T,chart:k,outside:E}=this,{inverted:w,plotLeft:R,plotTop:J,polar:wt}=k,{plotX:ot=0,plotY:it=0}=y,Q={},A=w&&y.h||0,{height:B,width:K}=this.getPlayingField(),pt=k.pointer.getChartPosition(),_=Tt=>Tt*pt.scaleX,P=Tt=>Tt*pt.scaleY,D=Tt=>{let Mt=Tt==="x";return[Tt,Mt?K:B,Mt?g:v].concat(E?[Mt?_(g):P(v),Mt?pt.left-T+_(ot+R):pt.top-T+P(it+J),0,Mt?K:B]:[Mt?g:v,Mt?ot+R:it+J,Mt?R:J,Mt?R+k.plotWidth:J+k.plotHeight])},Y=D("y"),G=D("x"),xt,Ct=!!y.negative;!wt&&((st=(ht=k.hoverSeries)==null?void 0:ht.yAxis)!=null&&st.reversed)&&(Ct=!Ct);let Dt=!this.followPointer&&V(y.ttBelow,!wt&&!w===Ct),jt=function(Tt,Mt,Ht,Vt,re,Jt,ye){let ze=E?Tt==="y"?P(T):_(T):T,ge=(Ht-Vt)/2,be=Vt<re-T,Oe=re+T+Vt<Mt,Ze=re-ze-Ht+ge,Ge=re+ze-ge;if(Dt&&Oe)Q[Tt]=Ge;else if(!Dt&&be)Q[Tt]=Ze;else if(be)Q[Tt]=Math.min(ye-Vt,Ze-A<0?Ze:Ze-A);else{if(!Oe)return!1;Q[Tt]=Math.max(Jt,Ge+A+Ht>Mt?Ge:Ge+A)}},Kt=function(Tt,Mt,Ht,Vt,re){if(re<T||re>Mt-T)return!1;re<Ht/2?Q[Tt]=1:re>Mt-Vt/2?Q[Tt]=Mt-Vt-2:Q[Tt]=re-Ht/2},ee=function(Tt){[Y,G]=[G,Y],xt=Tt},le=()=>{jt.apply(0,Y)!==!1?Kt.apply(0,G)!==!1||xt||(ee(!0),le()):xt?Q.x=Q.y=0:(ee(!0),le())};return(w&&!wt||this.len>1)&&ee(),le(),Q}hide(g){let v=this;dt.clearTimeout(this.hideTimer),g=V(g,this.options.hideDelay),this.isHidden||(this.hideTimer=C(function(){let y=v.getLabel();v.getLabel().animate({opacity:0},{duration:g&&150,complete:()=>{y.hide(),v.container&&v.container.remove()}}),v.isHidden=!0},g))}init(g,v){this.chart=g,this.options=v,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.split=v.split&&!g.inverted&&!g.polar,this.shared=v.shared||this.split,this.outside=V(v.outside,!!(g.scrollablePixelsX||g.scrollablePixelsY))}shouldStickOnContact(g){return!!(!this.followPointer&&this.options.stickOnContact&&(!g||this.chart.pointer.inClass(g.target,"highcharts-tooltip")))}move(g,v,y,T){let k=this,E=k.now,w=k.options.animation!==!1&&!k.isHidden&&(Math.abs(g-E.x)>1||Math.abs(v-E.y)>1),R=k.followPointer||k.len>1;$(E,{x:w?(2*E.x+g)/3:g,y:w?(E.y+v)/2:v,anchorX:R?void 0:w?(2*E.anchorX+y)/3:y,anchorY:R?void 0:w?(E.anchorY+T)/2:T}),k.getLabel().attr(E),k.drawTracker(),w&&(dt.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){k&&k.move(g,v,y,T)},32))}refresh(g,v){let y=this.chart,T=this.options,k=y.pointer,E=I(g),w=E[0],R=[],J=T.format,wt=T.formatter||this.defaultFormatter,ot=this.shared,it=y.styledMode,Q={};if(!T.enabled||!w.series)return;dt.clearTimeout(this.hideTimer),this.allowShared=!(!j(g)&&g.series&&g.series.noSharedTooltip),this.followPointer=!this.split&&w.series.tooltipOptions.followPointer;let A=this.getAnchor(g,v),B=A[0],K=A[1];ot&&this.allowShared?(k.applyInactiveState(E),E.forEach(function(P){P.setState("hover"),R.push(P.getLabelConfig())}),(Q=w.getLabelConfig()).points=R):Q=w.getLabelConfig(),this.len=R.length;let pt=_t(J)?Lt(J,Q,y):wt.call(Q,this),_=w.series;if(this.distance=V(_.tooltipOptions.distance,16),pt===!1)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(pt,E);else{let P=B,D=K;if(v&&k.isDirectTouch&&(P=v.chartX-y.plotLeft,D=v.chartY-y.plotTop),y.polar||_.options.clip===!1||E.some(Y=>k.isDirectTouch||Y.series.shouldShowTooltip(P,D))){let Y=this.getLabel();(!T.style.width||it)&&Y.css({width:(this.outside?this.getPlayingField():y.spacingBox).width+"px"}),Y.attr({text:pt&&pt.join?pt.join(""):pt}),Y.addClass(this.getClassName(w),!0),it||Y.attr({stroke:T.borderColor||w.color||_.color||"#666666"}),this.updatePosition({plotX:B,plotY:K,negative:w.negative,ttBelow:w.ttBelow,h:A[2]||0})}else{this.hide();return}}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}U(this,"refresh")}renderSplit(g,v){let y=this,{chart:T,chart:{chartWidth:k,chartHeight:E,plotHeight:w,plotLeft:R,plotTop:J,pointer:wt,scrollablePixelsY:ot=0,scrollablePixelsX:it,scrollingContainer:{scrollLeft:Q,scrollTop:A}={scrollLeft:0,scrollTop:0},styledMode:B},distance:K,options:pt,options:{positioner:_}}=y,P=y.outside&&typeof it!="number"?ut.documentElement.getBoundingClientRect():{left:Q,right:Q+k,top:A,bottom:A+E},D=y.getLabel(),Y=this.renderer||T.renderer,G=!!(T.xAxis[0]&&T.xAxis[0].opposite),{left:xt,top:Ct}=wt.getChartPosition(),Dt=J+A,jt=0,Kt=w-ot;function ee(Ht,Vt,re,Jt,ye=!0){let ze,ge;return re?(ze=G?0:Kt,ge=at(Ht-Jt/2,P.left,P.right-Jt-(y.outside?xt:0))):(ze=Vt-Dt,ge=at(ge=ye?Ht-Jt-K:Ht+K,ye?ge:P.left,P.right)),{x:ge,y:ze}}_t(g)&&(g=[!1,g]);let le=g.slice(0,v.length+1).reduce(function(Ht,Vt,re){if(Vt!==!1&&Vt!==""){let Jt=v[re-1]||{isHeader:!0,plotX:v[0].plotX,plotY:w,series:{}},ye=Jt.isHeader,ze=ye?y:Jt.series,ge=ze.tt=function(Ee,li,ii){let xi=Ee,{isHeader:Ni,series:cr}=li;if(!xi){let Li={padding:pt.padding,r:pt.borderRadius};B||(Li.fill=pt.backgroundColor,Li["stroke-width"]=pt.borderWidth??1),xi=Y.label("",0,0,pt[Ni?"headerShape":"shape"],void 0,void 0,pt.useHTML).addClass(y.getClassName(li,!0,Ni)).attr(Li).add(D)}return xi.isActive=!0,xi.attr({text:ii}),B||xi.css(pt.style).attr({stroke:pt.borderColor||li.color||cr.color||"#333333"}),xi}(ze.tt,Jt,Vt.toString()),be=ge.getBBox(),Oe=be.width+ge.strokeWidth();ye&&(jt=be.height,Kt+=jt,G&&(Dt-=jt));let{anchorX:Ze,anchorY:Ge}=function(Ee){let li,ii,{isHeader:xi,plotX:Ni=0,plotY:cr=0,series:Li}=Ee;if(xi)li=Math.max(R+Ni,R),ii=J+w/2;else{let{xAxis:F,yAxis:tt}=Li;li=F.pos+at(Ni,-K,F.len+K),Li.shouldShowTooltip(0,tt.pos-J+cr,{ignoreX:!0})&&(ii=tt.pos+cr)}return{anchorX:li=at(li,P.left-K,P.right+K),anchorY:ii}}(Jt);if(typeof Ge=="number"){let Ee=be.height+1,li=_?_.call(y,Oe,Ee,Jt):ee(Ze,Ge,ye,Oe);Ht.push({align:_?0:void 0,anchorX:Ze,anchorY:Ge,boxWidth:Oe,point:Jt,rank:V(li.rank,ye?1:0),size:Ee,target:li.y,tt:ge,x:li.x})}else ge.isActive=!1}return Ht},[]);!_&&le.some(Ht=>{let{outside:Vt}=y,re=(Vt?xt:0)+Ht.anchorX;return re<P.left&&re+Ht.boxWidth<P.right||re<xt-P.left+Ht.boxWidth&&P.right-re>re})&&(le=le.map(Ht=>{let{x:Vt,y:re}=ee(Ht.anchorX,Ht.anchorY,Ht.point.isHeader,Ht.boxWidth,!1);return $(Ht,{target:re,x:Vt})})),y.cleanSplit(),Z(le,Kt);let ht={left:xt,right:xt};le.forEach(function(Ht){let{x:Vt,boxWidth:re,isHeader:Jt}=Ht;!Jt&&(y.outside&&xt+Vt<ht.left&&(ht.left=xt+Vt),!Jt&&y.outside&&ht.left+re>ht.right&&(ht.right=xt+Vt))}),le.forEach(function(Ht){let{x:Vt,anchorX:re,anchorY:Jt,pos:ye,point:{isHeader:ze}}=Ht,ge={visibility:ye===void 0?"hidden":"inherit",x:Vt,y:(ye||0)+Dt,anchorX:re,anchorY:Jt};if(y.outside&&Vt<re){let be=xt-ht.left;be>0&&(ze||(ge.x=Vt+be,ge.anchorX=re+be),ze&&(ge.x=(ht.right-ht.left)/2,ge.anchorX=re+be))}Ht.tt.attr(ge)});let{container:st,outside:Tt,renderer:Mt}=y;if(Tt&&st&&Mt){let{width:Ht,height:Vt,x:re,y:Jt}=D.getBBox();Mt.setSize(Ht+re,Vt+Jt,!1),st.style.left=ht.left+"px",st.style.top=Ct+"px"}Rt&&D.attr({opacity:D.opacity===1?.999:1})}drawTracker(){if(!this.shouldStickOnContact()){this.tracker&&(this.tracker=this.tracker.destroy());return}let g=this.chart,v=this.label,y=this.shared?g.hoverPoints:g.hoverPoint;if(!v||!y)return;let T={x:0,y:0,width:0,height:0},k=this.getAnchor(y),E=v.getBBox();k[0]+=g.plotLeft-(v.translateX||0),k[1]+=g.plotTop-(v.translateY||0),T.x=Math.min(0,k[0]),T.y=Math.min(0,k[1]),T.width=k[0]<0?Math.max(Math.abs(k[0]),E.width-k[0]):Math.max(Math.abs(k[0]),E.width),T.height=k[1]<0?Math.max(Math.abs(k[1]),E.height-Math.abs(k[1])):Math.max(Math.abs(k[1]),E.height),this.tracker?this.tracker.attr(T):(this.tracker=v.renderer.rect(T).addClass("highcharts-tracker").add(v),g.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}styledModeFormat(g){return g.replace('style="font-size: 0.8em"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')}tooltipFooterHeaderFormatter(g,v){let y=g.series,T=y.tooltipOptions,k=y.xAxis,E=k&&k.dateTime,w={isFooter:v,labelConfig:g},R=T.xDateFormat,J=T[v?"footerFormat":"headerFormat"];return U(this,"headerFormatter",w,function(wt){E&&!R&&et(g.key)&&(R=E.getXDateFormat(g.key,T.dateTimeLabelFormats)),E&&R&&(g.point&&g.point.tooltipDateKeys||["key"]).forEach(function(ot){J=J.replace("{point."+ot+"}","{point."+ot+":"+R+"}")}),y.chart.styledMode&&(J=this.styledModeFormat(J)),wt.text=Lt(J,{point:g,series:y},this.chart)}),w.text}update(g){this.destroy(),this.init(this.chart,mt(!0,this.options,g))}updatePosition(g){let{chart:v,container:y,distance:T,options:k,renderer:E}=this,{height:w=0,width:R=0}=this.getLabel(),J=v.pointer,{left:wt,top:ot,scaleX:it,scaleY:Q}=J.getChartPosition(),A=(k.positioner||this.getPosition).call(this,R,w,g),B=(g.plotX||0)+v.plotLeft,K=(g.plotY||0)+v.plotTop,pt;E&&y&&(k.positioner&&(A.x+=wt-T,A.y+=ot-T),pt=(k.borderWidth||0)+2*T+2,E.setSize(R+pt,w+pt,!1),(it!==1||Q!==1)&&(W(y,{transform:`scale(${it}, ${Q})`}),B*=it,K*=Q),B+=wt-A.x,K+=ot-A.y),this.move(Math.round(A.x),Math.round(A.y||0),B,K)}}return(Nt=z||(z={})).compose=function S(g){rt(kt,S)&&lt(g,"afterInit",function(){let v=this.chart;v.options.tooltip&&(v.tooltip=new Nt(v,v.options.tooltip))})},z}),te(X,"Core/Series/Point.js",[X["Core/Renderer/HTML/AST.js"],X["Core/Animation/AnimationUtilities.js"],X["Core/Defaults.js"],X["Core/Templating.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt){let{animObject:Nt}=At,{defaultOptions:Lt}=l,{format:kt}=Zt,{addEvent:ut,defined:Rt,erase:Z,extend:lt,fireEvent:at,getNestedProperty:W,isArray:q,isFunction:$,isNumber:U,isObject:j,merge:et,objectEach:_t,pick:mt,syncTimeout:V,removeEvent:rt,uniqueKey:I}=dt;class C{animateBeforeDestroy(){let S=this,g={x:S.startXPos,opacity:0},v=S.getGraphicalProps();v.singular.forEach(function(y){S[y]=S[y].animate(y==="dataLabel"?{x:S[y].startXPos,y:S[y].startYPos,opacity:0}:g)}),v.plural.forEach(function(y){S[y].forEach(function(T){T.element&&T.animate(lt({x:S.startXPos},T.startYPos?{x:T.startXPos,y:T.startYPos}:{}))})})}applyOptions(S,g){let v=this.series,y=v.options.pointValKey||v.pointValKey;return lt(this,S=C.prototype.optionsToObject.call(this,S)),this.options=this.options?lt(this.options,S):S,S.group&&delete this.group,S.dataLabels&&delete this.dataLabels,y&&(this.y=C.prototype.getNestedProperty.call(this,y)),this.selected&&(this.state="select"),"name"in this&&g===void 0&&v.xAxis&&v.xAxis.hasNames&&(this.x=v.xAxis.nameToX(this)),this.x===void 0&&v?g===void 0?this.x=v.autoIncrement():this.x=g:U(S.x)&&v.options.relativeXValue&&(this.x=v.autoIncrement(S.x)),this.isNull=this.isValid&&!this.isValid(),this.formatPrefix=this.isNull?"null":"point",this}destroy(){if(!this.destroyed){let S=this,g=S.series,v=g.chart,y=g.options.dataSorting,T=v.hoverPoints,k=S.series.chart.renderer.globalAnimation,E=Nt(k),w=()=>{for(let R in(S.graphic||S.graphics||S.dataLabel||S.dataLabels)&&(rt(S),S.destroyElements()),S)delete S[R]};S.legendItem&&v.legend.destroyItem(S),T&&(S.setState(),Z(T,S),T.length||(v.hoverPoints=null)),S===v.hoverPoint&&S.onMouseOut(),y&&y.enabled?(this.animateBeforeDestroy(),V(w,E.duration)):w(),v.pointCount--}this.destroyed=!0}destroyElements(S){let g=this,v=g.getGraphicalProps(S);v.singular.forEach(function(y){g[y]=g[y].destroy()}),v.plural.forEach(function(y){g[y].forEach(function(T){T&&T.element&&T.destroy()}),delete g[y]})}firePointEvent(S,g,v){let y=this,T=this.series,k=T.options;(k.point.events[S]||y.options&&y.options.events&&y.options.events[S])&&y.importEvents(),S==="click"&&k.allowPointSelect&&(v=function(E){!y.destroyed&&y.select&&y.select(null,E.ctrlKey||E.metaKey||E.shiftKey)}),at(y,S,g,v)}getClassName(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(this.colorIndex!==void 0?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")}getGraphicalProps(S){let g,v,y=this,T=[],k={singular:[],plural:[]};for((S=S||{graphic:1,dataLabel:1}).graphic&&T.push("graphic","connector"),S.dataLabel&&T.push("dataLabel","dataLabelPath","dataLabelUpper"),v=T.length;v--;)y[g=T[v]]&&k.singular.push(g);return["graphic","dataLabel"].forEach(function(E){let w=E+"s";S[E]&&y[w]&&k.plural.push(w)}),k}getLabelConfig(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}}getNestedProperty(S){return S?S.indexOf("custom.")===0?W(S,this.options):this[S]:void 0}getZone(){let S=this.series,g=S.zones,v=S.zoneAxis||"y",y,T=0;for(y=g[0];this[v]>=y.value;)y=g[++T];return this.nonZonedColor||(this.nonZonedColor=this.color),y&&y.color&&!this.options.color?this.color=y.color:this.color=this.nonZonedColor,y}hasNewShapeType(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType}constructor(S,g,v){this.formatPrefix="point",this.visible=!0,this.series=S,this.applyOptions(g,v),this.id??(this.id=I()),this.resolveColor(),S.chart.pointCount++,at(this,"afterInit")}isValid(){return(U(this.x)||this.x instanceof Date)&&U(this.y)}optionsToObject(S){let g=this.series,v=g.options.keys,y=v||g.pointArrayMap||["y"],T=y.length,k={},E,w=0,R=0;if(U(S)||S===null)k[y[0]]=S;else if(q(S))for(!v&&S.length>T&&((E=typeof S[0])=="string"?k.name=S[0]:E==="number"&&(k.x=S[0]),w++);R<T;)v&&S[w]===void 0||(y[R].indexOf(".")>0?C.prototype.setNestedProperty(k,S[w],y[R]):k[y[R]]=S[w]),w++,R++;else typeof S=="object"&&(k=S,S.dataLabels&&(g.hasDataLabels=()=>!0),S.marker&&(g._hasPointMarkers=!0));return k}pos(S,g=this.plotY){if(!this.destroyed){let{plotX:v,series:y}=this,{chart:T,xAxis:k,yAxis:E}=y,w=0,R=0;if(U(v)&&U(g))return S&&(w=k?k.pos:T.plotLeft,R=E?E.pos:T.plotTop),T.inverted&&k&&E?[E.len-g+R,k.len-v+w]:[v+w,g+R]}}resolveColor(){let S=this.series,g=S.chart.options.chart,v=S.chart.styledMode,y,T,k=g.colorCount,E;delete this.nonZonedColor,S.options.colorByPoint?(v||(y=(T=S.options.colors||S.chart.options.colors)[S.colorCounter],k=T.length),E=S.colorCounter,S.colorCounter++,S.colorCounter===k&&(S.colorCounter=0)):(v||(y=S.color),E=S.colorIndex),this.colorIndex=mt(this.options.colorIndex,E),this.color=mt(this.options.color,y)}setNestedProperty(S,g,v){return v.split(".").reduce(function(T,k,E,w){let R=w.length-1===E;return T[k]=R?g:j(T[k],!0)?T[k]:{},T[k]},S),S}shouldDraw(){return!this.isNull}tooltipFormatter(S){let g=this.series,v=g.tooltipOptions,y=mt(v.valueDecimals,""),T=v.valuePrefix||"",k=v.valueSuffix||"";return g.chart.styledMode&&(S=g.chart.tooltip.styledModeFormat(S)),(g.pointArrayMap||["y"]).forEach(function(E){E="{point."+E,(T||k)&&(S=S.replace(RegExp(E+"}","g"),T+E+"}"+k)),S=S.replace(RegExp(E+"}","g"),E+":,."+y+"f}")}),kt(S,{point:this,series:this.series},g.chart)}update(S,g,v,y){let T,k=this,E=k.series,w=k.graphic,R=E.chart,J=E.options;function wt(){k.applyOptions(S);let ot=w&&k.hasMockGraphic,it=k.y===null?!ot:ot;w&&it&&(k.graphic=w.destroy(),delete k.hasMockGraphic),j(S,!0)&&(w&&w.element&&S&&S.marker&&S.marker.symbol!==void 0&&(k.graphic=w.destroy()),S!=null&&S.dataLabels&&k.dataLabel&&(k.dataLabel=k.dataLabel.destroy())),T=k.index,E.updateParallelArrays(k,T),J.data[T]=j(J.data[T],!0)||j(S,!0)?k.options:mt(S,J.data[T]),E.isDirty=E.isDirtyData=!0,!E.fixedBox&&E.hasCartesianSeries&&(R.isDirtyBox=!0),J.legendType==="point"&&(R.isDirtyLegend=!0),g&&R.redraw(v)}g=mt(g,!0),y===!1?wt():k.firePointEvent("update",{options:S},wt)}remove(S,g){this.series.removePoint(this.series.data.indexOf(this),S,g)}select(S,g){let v=this,y=v.series,T=y.chart;S=mt(S,!v.selected),this.selectedStaging=S,v.firePointEvent(S?"select":"unselect",{accumulate:g},function(){v.selected=v.options.selected=S,y.options.data[y.data.indexOf(v)]=v.options,v.setState(S&&"select"),g||T.getSelectedPoints().forEach(function(k){let E=k.series;k.selected&&k!==v&&(k.selected=k.options.selected=!1,E.options.data[E.data.indexOf(k)]=k.options,k.setState(T.hoverPoints&&E.options.inactiveOtherPoints?"inactive":""),k.firePointEvent("unselect"))})}),delete this.selectedStaging}onMouseOver(S){let g=this.series,v=g.chart,y=v.pointer;S=S?y.normalize(S):y.getChartCoordinatesFromPoint(this,v.inverted),y.runPointActions(S,this)}onMouseOut(){let S=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(S.hoverPoints||[]).forEach(function(g){g.setState()}),S.hoverPoints=S.hoverPoint=null}importEvents(){if(!this.hasImportedEvents){let S=this,g=et(S.series.options.point,S.options),v=g.events;S.events=v,_t(v,function(y,T){$(y)&&ut(S,T,y)}),this.hasImportedEvents=!0}}setState(S,g){let v=this.series,y=this.state,T=v.options.states[S||"normal"]||{},k=Lt.plotOptions[v.type].marker&&v.options.marker,E=k&&k.enabled===!1,w=k&&k.states&&k.states[S||"normal"]||{},R=w.enabled===!1,J=this.marker||{},wt=v.chart,ot=k&&v.markerAttribs,it=v.halo,Q,A,B,K=v.stateMarkerGraphic,pt;if((S=S||"")===this.state&&!g||this.selected&&S!=="select"||T.enabled===!1||S&&(R||E&&w.enabled===!1)||S&&J.states&&J.states[S]&&J.states[S].enabled===!1)return;if(this.state=S,ot&&(Q=v.markerAttribs(this,S)),this.graphic&&!this.hasMockGraphic){if(y&&this.graphic.removeClass("highcharts-point-"+y),S&&this.graphic.addClass("highcharts-point-"+S),!wt.styledMode){A=v.pointAttribs(this,S),B=mt(wt.options.chart.animation,T.animation);let Y=A.opacity;v.options.inactiveOtherPoints&&U(Y)&&(this.dataLabels||[]).forEach(function(G){G&&!G.hasClass("highcharts-data-label-hidden")&&(G.animate({opacity:Y},B),G.connector&&G.connector.animate({opacity:Y},B))}),this.graphic.animate(A,B)}Q&&this.graphic.animate(Q,mt(wt.options.chart.animation,w.animation,k.animation)),K&&K.hide()}else S&&w&&(pt=J.symbol||v.symbol,K&&K.currentSymbol!==pt&&(K=K.destroy()),Q&&(K?K[g?"animate":"attr"]({x:Q.x,y:Q.y}):pt&&(v.stateMarkerGraphic=K=wt.renderer.symbol(pt,Q.x,Q.y,Q.width,Q.height).add(v.markerGroup),K.currentSymbol=pt)),!wt.styledMode&&K&&this.state!=="inactive"&&K.attr(v.pointAttribs(this,S))),K&&(K[S&&this.isInside?"show":"hide"](),K.element.point=this,K.addClass(this.getClassName(),!0));let _=T.halo,P=this.graphic||K,D=P&&P.visibility||"inherit";_&&_.size&&P&&D!=="hidden"&&!this.isCluster?(it||(v.halo=it=wt.renderer.path().add(P.parentGroup)),it.show()[g?"animate":"attr"]({d:this.haloPath(_.size)}),it.attr({class:"highcharts-halo highcharts-color-"+mt(this.colorIndex,v.colorIndex)+(this.className?" "+this.className:""),visibility:D,zIndex:-1}),it.point=this,wt.styledMode||it.attr(lt({fill:this.color||v.color,"fill-opacity":_.opacity},Et.filterUserAttributes(_.attributes||{})))):it&&it.point&&it.point.haloPath&&it.animate({d:it.point.haloPath(0)},null,it.hide),at(this,"afterSetState",{state:S})}haloPath(S){let g=this.pos();return g?this.series.chart.renderer.symbols.circle(Math.floor(g[0])-S,g[1]-S,2*S,2*S):[]}}return C}),te(X,"Core/Pointer.js",[X["Core/Color/Color.js"],X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At,l){var Zt;let{parse:dt}=Et,{charts:Nt,composed:Lt,noop:kt}=At,{addEvent:ut,attr:Rt,css:Z,defined:lt,extend:at,find:W,fireEvent:q,isNumber:$,isObject:U,objectEach:j,offset:et,pick:_t,pushUnique:mt,splat:V}=l;class rt{applyInactiveState(C){let z=[],S;(C||[]).forEach(function(g){S=g.series,z.push(S),S.linkedParent&&z.push(S.linkedParent),S.linkedSeries&&(z=z.concat(S.linkedSeries)),S.navigatorSeries&&z.push(S.navigatorSeries)}),this.chart.series.forEach(function(g){z.indexOf(g)===-1?g.setState("inactive",!0):g.options.inactiveOtherPoints&&g.setAllPointsToState("inactive")})}destroy(){let C=this;this.eventsToUnbind.forEach(z=>z()),this.eventsToUnbind=[],!At.chartCount&&(rt.unbindDocumentMouseUp&&(rt.unbindDocumentMouseUp=rt.unbindDocumentMouseUp()),rt.unbindDocumentTouchEnd&&(rt.unbindDocumentTouchEnd=rt.unbindDocumentTouchEnd())),clearInterval(C.tooltipTimeout),j(C,function(z,S){C[S]=void 0})}getSelectionMarkerAttrs(C,z){let S={args:{chartX:C,chartY:z},attrs:{},shapeType:"rect"};return q(this,"getSelectionMarkerAttrs",S,g=>{let v,{chart:y,mouseDownX:T=0,mouseDownY:k=0,zoomHor:E,zoomVert:w}=this,R=g.attrs;R.x=y.plotLeft,R.y=y.plotTop,R.width=E?1:y.plotWidth,R.height=w?1:y.plotHeight,E&&(v=C-T,R.width=Math.abs(v),R.x=(v>0?0:v)+T),w&&(v=z-k,R.height=Math.abs(v),R.y=(v>0?0:v)+k)}),S}drag(C){let z=this.chart,S=z.options.chart,g=z.plotLeft,v=z.plotTop,y=z.plotWidth,T=z.plotHeight,k=this.mouseDownX||0,E=this.mouseDownY||0,w=U(S.panning)?S.panning&&S.panning.enabled:S.panning,R=S.panKey&&C[S.panKey+"Key"],J=C.chartX,wt=C.chartY,ot,it=this.selectionMarker;if((!it||!it.touch)&&(J<g?J=g:J>g+y&&(J=g+y),wt<v?wt=v:wt>v+T&&(wt=v+T),this.hasDragged=Math.sqrt(Math.pow(k-J,2)+Math.pow(E-wt,2)),this.hasDragged>10)){ot=z.isInsidePlot(k-g,E-v,{visiblePlotOnly:!0});let{shapeType:Q,attrs:A}=this.getSelectionMarkerAttrs(J,wt);(z.hasCartesianSeries||z.mapView)&&(this.zoomX||this.zoomY)&&ot&&!R&&!it&&(this.selectionMarker=it=z.renderer[Q](),it.attr({class:"highcharts-selection-marker",zIndex:7}).add(),z.styledMode||it.attr({fill:S.selectionMarkerFill||dt("#334eff").setOpacity(.25).get()})),it&&it.attr(A),ot&&!it&&w&&z.pan(C,S.panning)}}dragStart(C){let z=this.chart;z.mouseIsDown=C.type,z.cancelClick=!1,z.mouseDownX=this.mouseDownX=C.chartX,z.mouseDownY=this.mouseDownY=C.chartY}getSelectionBox(C){let z={args:{marker:C},result:{}};return q(this,"getSelectionBox",z,S=>{S.result={x:C.attr?+C.attr("x"):C.x,y:C.attr?+C.attr("y"):C.y,width:C.attr?C.attr("width"):C.width,height:C.attr?C.attr("height"):C.height}}),z.result}drop(C){let z=this,S=this.chart,g=this.hasPinched;if(this.selectionMarker){let{x:v,y,width:T,height:k}=this.getSelectionBox(this.selectionMarker),E={originalEvent:C,xAxis:[],yAxis:[],x:v,y,width:T,height:k},w=!!S.mapView;(this.hasDragged||g)&&(S.axes.forEach(function(R){if(R.zoomEnabled&&lt(R.min)&&(g||z[{xAxis:"zoomX",yAxis:"zoomY"}[R.coll]])&&$(v)&&$(y)&&$(T)&&$(k)){let J=R.horiz,wt=C.type==="touchend"?R.minPixelPadding:0,ot=R.toValue((J?v:y)+wt),it=R.toValue((J?v+T:y+k)-wt);E[R.coll].push({axis:R,min:Math.min(ot,it),max:Math.max(ot,it)}),w=!0}}),w&&q(S,"selection",E,function(R){S.zoom(at(R,g?{animation:!1}:null))})),$(S.index)&&(this.selectionMarker=this.selectionMarker.destroy()),g&&this.scaleGroups()}S&&$(S.index)&&(Z(S.container,{cursor:S._cursor}),S.cancelClick=+this.hasDragged>10,S.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])}findNearestKDPoint(C,z,S){let g;return C.forEach(function(v){let y=v.noSharedTooltip&&z,T=!y&&0>v.options.findNearestPointBy.indexOf("y"),k=v.searchPoint(S,T);U(k,!0)&&k.series&&(!U(g,!0)||function(E,w){let R=E.distX-w.distX,J=E.dist-w.dist,wt=(w.series.group&&w.series.group.zIndex)-(E.series.group&&E.series.group.zIndex);return R!==0&&z?R:J!==0?J:wt!==0?wt:E.series.index>w.series.index?-1:1}(g,k)>0)&&(g=k)}),g}getChartCoordinatesFromPoint(C,z){let S=C.series,g=S.xAxis,v=S.yAxis,y=C.shapeArgs;if(g&&v){let T=_t(C.clientX,C.plotX),k=C.plotY||0;return C.isNode&&y&&$(y.x)&&$(y.y)&&(T=y.x,k=y.y),z?{chartX:v.len+v.pos-k,chartY:g.len+g.pos-T}:{chartX:T+g.pos,chartY:k+v.pos}}if(y&&y.x&&y.y)return{chartX:y.x,chartY:y.y}}getChartPosition(){if(this.chartPosition)return this.chartPosition;let{container:C}=this.chart,z=et(C);this.chartPosition={left:z.left,top:z.top,scaleX:1,scaleY:1};let S=C.offsetWidth,g=C.offsetHeight;return S>2&&g>2&&(this.chartPosition.scaleX=z.width/S,this.chartPosition.scaleY=z.height/g),this.chartPosition}getCoordinates(C){let z={xAxis:[],yAxis:[]};return this.chart.axes.forEach(function(S){z[S.isXAxis?"xAxis":"yAxis"].push({axis:S,value:S.toValue(C[S.horiz?"chartX":"chartY"])})}),z}getHoverData(C,z,S,g,v,y){let T=[],k=function(ot){return ot.visible&&!(!v&&ot.directTouch)&&_t(ot.options.enableMouseTracking,!0)},E=z,w,R={chartX:y?y.chartX:void 0,chartY:y?y.chartY:void 0,shared:v};q(this,"beforeGetHoverData",R),w=E&&!E.stickyTracking?[E]:S.filter(ot=>ot.stickyTracking&&(R.filter||k)(ot));let wt=g&&C||!y?C:this.findNearestKDPoint(w,v,y);return E=wt&&wt.series,wt&&(v&&!E.noSharedTooltip?(w=S.filter(function(ot){return R.filter?R.filter(ot):k(ot)&&!ot.noSharedTooltip})).forEach(function(ot){let it=W(ot.points,function(Q){return Q.x===wt.x&&!Q.isNull});U(it)&&(ot.boosted&&ot.boost&&(it=ot.boost.getPoint(it)),T.push(it))}):T.push(wt)),q(this,"afterGetHoverData",R={hoverPoint:wt}),{hoverPoint:R.hoverPoint,hoverSeries:E,hoverPoints:T}}getPointFromEvent(C){let z=C.target,S;for(;z&&!S;)S=z.point,z=z.parentNode;return S}onTrackerMouseOut(C){let z=this.chart,S=C.relatedTarget,g=z.hoverSeries;this.isDirectTouch=!1,!g||!S||g.stickyTracking||this.inClass(S,"highcharts-tooltip")||this.inClass(S,"highcharts-series-"+g.index)&&this.inClass(S,"highcharts-tracker")||g.onMouseOut()}inClass(C,z){let S=C,g;for(;S;){if(g=Rt(S,"class")){if(g.indexOf(z)!==-1)return!0;if(g.indexOf("highcharts-container")!==-1)return!1}S=S.parentElement}}constructor(C,z){var S;this.hasDragged=!1,this.lastValidTouch={},this.pinchDown=[],this.eventsToUnbind=[],this.options=z,this.chart=C,this.runChartClick=!!((S=z.chart.events)!=null&&S.click),this.pinchDown=[],this.lastValidTouch={},this.setDOMEvents(),q(this,"afterInit")}normalize(C,z){let S=C.touches,g=S?S.length?S.item(0):_t(S.changedTouches,C.changedTouches)[0]:C;z||(z=this.getChartPosition());let v=g.pageX-z.left,y=g.pageY-z.top;return at(C,{chartX:Math.round(v/=z.scaleX),chartY:Math.round(y/=z.scaleY)})}onContainerClick(C){let z=this.chart,S=z.hoverPoint,g=this.normalize(C),v=z.plotLeft,y=z.plotTop;!z.cancelClick&&(S&&this.inClass(g.target,"highcharts-tracker")?(q(S.series,"click",at(g,{point:S})),z.hoverPoint&&S.firePointEvent("click",g)):(at(g,this.getCoordinates(g)),z.isInsidePlot(g.chartX-v,g.chartY-y,{visiblePlotOnly:!0})&&q(z,"click",g)))}onContainerMouseDown(C){let z=(1&(C.buttons||C.button))==1;C=this.normalize(C),At.isFirefox&&C.button!==0&&this.onContainerMouseMove(C),(C.button===void 0||z)&&(this.zoomOption(C),z&&C.preventDefault&&C.preventDefault(),this.dragStart(C))}onContainerMouseLeave(C){let z=Nt[_t(rt.hoverChartIndex,-1)];C=this.normalize(C),this.onContainerMouseMove(C),z&&C.relatedTarget&&!this.inClass(C.relatedTarget,"highcharts-tooltip")&&(z.pointer.reset(),z.pointer.chartPosition=void 0)}onContainerMouseEnter(C){delete this.chartPosition}onContainerMouseMove(C){let z=this.chart,S=z.tooltip,g=this.normalize(C);this.setHoverChartIndex(C),(z.mouseIsDown==="mousedown"||this.touchSelect(g))&&this.drag(g),!z.openMenu&&(this.inClass(g.target,"highcharts-tracker")||z.isInsidePlot(g.chartX-z.plotLeft,g.chartY-z.plotTop,{visiblePlotOnly:!0}))&&!(S&&S.shouldStickOnContact(g))&&(this.inClass(g.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(g))}onDocumentTouchEnd(C){let z=Nt[_t(rt.hoverChartIndex,-1)];z&&z.pointer.drop(C)}onContainerTouchMove(C){this.touchSelect(C)?this.onContainerMouseMove(C):this.touch(C)}onContainerTouchStart(C){this.touchSelect(C)?this.onContainerMouseDown(C):(this.zoomOption(C),this.touch(C,!0))}onDocumentMouseMove(C){let z=this.chart,S=z.tooltip,g=this.chartPosition,v=this.normalize(C,g);!g||z.isInsidePlot(v.chartX-z.plotLeft,v.chartY-z.plotTop,{visiblePlotOnly:!0})||S&&S.shouldStickOnContact(v)||this.inClass(v.target,"highcharts-tracker")||this.reset()}onDocumentMouseUp(C){let z=Nt[_t(rt.hoverChartIndex,-1)];z&&z.pointer.drop(C)}pinch(C){let z=this,S=z.chart,g=z.pinchDown,v=C.touches||[],y=v.length,T=z.lastValidTouch,k=z.hasZoom,E={},w=y===1&&(z.inClass(C.target,"highcharts-tracker")&&S.runTrackerClick||z.runChartClick),R={},J=z.chart.tooltip,wt=y===1&&_t(J&&J.options.followTouchMove,!0),ot=z.selectionMarker;y>1?z.initiated=!0:wt&&(z.initiated=!1),k&&z.initiated&&!w&&C.cancelable!==!1&&C.preventDefault(),[].map.call(v,function(it){return z.normalize(it)}),C.type==="touchstart"?([].forEach.call(v,function(it,Q){g[Q]={chartX:it.chartX,chartY:it.chartY}}),T.x=[g[0].chartX,g[1]&&g[1].chartX],T.y=[g[0].chartY,g[1]&&g[1].chartY],S.axes.forEach(function(it){if(it.zoomEnabled){let Q=S.bounds[it.horiz?"h":"v"],A=it.minPixelPadding,B=it.toPixels(Math.min(_t(it.options.min,it.dataMin),it.dataMin)),K=it.toPixels(Math.max(_t(it.options.max,it.dataMax),it.dataMax)),pt=Math.min(B,K),_=Math.max(B,K);Q.min=Math.min(it.pos,pt-A),Q.max=Math.max(it.pos+it.len,_+A)}}),z.res=!0):wt?this.runPointActions(z.normalize(C)):g.length&&(q(S,"touchpan",{originalEvent:C},()=>{ot||(z.selectionMarker=ot=at({destroy:kt,touch:!0},S.plotBox)),z.pinchTranslate(g,v,E,ot,R,T),z.hasPinched=k,z.scaleGroups(E,R)}),z.res&&(z.res=!1,this.reset(!1,0)))}pinchTranslate(C,z,S,g,v,y){this.zoomHor&&this.pinchTranslateDirection(!0,C,z,S,g,v,y),this.zoomVert&&this.pinchTranslateDirection(!1,C,z,S,g,v,y)}pinchTranslateDirection(C,z,S,g,v,y,T,k){let E=this.chart,w=C?"x":"y",R=C?"X":"Y",J="chart"+R,wt=C?"width":"height",ot=E["plot"+(C?"Left":"Top")],it=E.inverted,Q=E.bounds[C?"h":"v"],A=z.length===1,B=z[0][J],K=!A&&z[1][J],pt=function(){typeof xt=="number"&&Math.abs(B-K)>20&&(Y=k||Math.abs(G-xt)/Math.abs(B-K)),D=(ot-G)/Y+B,_=E["plot"+(C?"Width":"Height")]/Y},_,P,D,Y=k||1,G=S[0][J],xt=!A&&S[1][J],Ct;pt(),(P=D)<Q.min?(P=Q.min,Ct=!0):P+_>Q.max&&(P=Q.max-_,Ct=!0),Ct?(G-=.8*(G-T[w][0]),typeof xt=="number"&&(xt-=.8*(xt-T[w][1])),pt()):T[w]=[G,xt],it||(y[w]=D-ot,y[wt]=_);let Dt=it?C?"scaleY":"scaleX":"scale"+R,jt=it?1/Y:Y;v[wt]=_,v[w]=P,g[Dt]=Y*(it&&!C?-1:1),g["translate"+R]=jt*ot+(G-jt*B)}reset(C,z){let S=this.chart,g=S.hoverSeries,v=S.hoverPoint,y=S.hoverPoints,T=S.tooltip,k=T&&T.shared?y:v;C&&k&&V(k).forEach(function(E){E.series.isCartesian&&E.plotX===void 0&&(C=!1)}),C?T&&k&&V(k).length&&(T.refresh(k),T.shared&&y?y.forEach(function(E){E.setState(E.state,!0),E.series.isCartesian&&(E.series.xAxis.crosshair&&E.series.xAxis.drawCrosshair(null,E),E.series.yAxis.crosshair&&E.series.yAxis.drawCrosshair(null,E))}):v&&(v.setState(v.state,!0),S.axes.forEach(function(E){E.crosshair&&v.series[E.coll]===E&&E.drawCrosshair(null,v)}))):(v&&v.onMouseOut(),y&&y.forEach(function(E){E.setState()}),g&&g.onMouseOut(),T&&T.hide(z),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),S.axes.forEach(function(E){E.hideCrosshair()}),this.hoverX=S.hoverPoints=S.hoverPoint=null)}runPointActions(C,z,S){let g=this.chart,v=g.series,y=g.tooltip&&g.tooltip.options.enabled?g.tooltip:void 0,T=!!y&&y.shared,k=z||g.hoverPoint,E=k&&k.series||g.hoverSeries,w=(!C||C.type!=="touchmove")&&(!!z||E&&E.directTouch&&this.isDirectTouch),R=this.getHoverData(k,E,v,w,T,C);k=R.hoverPoint,E=R.hoverSeries;let J=R.hoverPoints,wt=E&&E.tooltipOptions.followPointer&&!E.tooltipOptions.split,ot=T&&E&&!E.noSharedTooltip;if(k&&(S||k!==g.hoverPoint||y&&y.isHidden)){if((g.hoverPoints||[]).forEach(function(it){J.indexOf(it)===-1&&it.setState()}),g.hoverSeries!==E&&E.onMouseOver(),this.applyInactiveState(J),(J||[]).forEach(function(it){it.setState("hover")}),g.hoverPoint&&g.hoverPoint.firePointEvent("mouseOut"),!k.series)return;g.hoverPoints=J,g.hoverPoint=k,k.firePointEvent("mouseOver",void 0,()=>{y&&k&&y.refresh(ot?J:k,C)})}else if(wt&&y&&!y.isHidden){let it=y.getAnchor([{}],C);g.isInsidePlot(it[0],it[1],{visiblePlotOnly:!0})&&y.updatePosition({plotX:it[0],plotY:it[1]})}this.unDocMouseMove||(this.unDocMouseMove=ut(g.container.ownerDocument,"mousemove",function(it){let Q=Nt[rt.hoverChartIndex];Q&&Q.pointer.onDocumentMouseMove(it)}),this.eventsToUnbind.push(this.unDocMouseMove)),g.axes.forEach(function(it){let Q,A=_t((it.crosshair||{}).snap,!0);!A||(Q=g.hoverPoint)&&Q.series[it.coll]===it||(Q=W(J,B=>B.series&&B.series[it.coll]===it)),Q||!A?it.drawCrosshair(C,Q):it.hideCrosshair()})}scaleGroups(C,z){let S=this.chart;S.series.forEach(function(g){let v=C||g.getPlotBox("series");g.group&&(g.xAxis&&g.xAxis.zoomEnabled||S.mapView)&&(g.group.attr(v),g.markerGroup&&(g.markerGroup.attr(C||g.getPlotBox("marker")),g.markerGroup.clip(z?S.clipRect:null)),g.dataLabelsGroup&&g.dataLabelsGroup.attr(v))}),S.clipRect.attr(z||S.clipBox)}setDOMEvents(){let C=this.chart.container,z=C.ownerDocument;C.onmousedown=this.onContainerMouseDown.bind(this),C.onmousemove=this.onContainerMouseMove.bind(this),C.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(ut(C,"mouseenter",this.onContainerMouseEnter.bind(this))),this.eventsToUnbind.push(ut(C,"mouseleave",this.onContainerMouseLeave.bind(this))),rt.unbindDocumentMouseUp||(rt.unbindDocumentMouseUp=ut(z,"mouseup",this.onDocumentMouseUp.bind(this)));let S=this.chart.renderTo.parentElement;for(;S&&S.tagName!=="BODY";)this.eventsToUnbind.push(ut(S,"scroll",()=>{delete this.chartPosition})),S=S.parentElement;At.hasTouch&&(this.eventsToUnbind.push(ut(C,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1})),this.eventsToUnbind.push(ut(C,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),rt.unbindDocumentTouchEnd||(rt.unbindDocumentTouchEnd=ut(z,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})))}setHoverChartIndex(C){let z=this.chart,S=At.charts[_t(rt.hoverChartIndex,-1)];S&&S!==z&&S.pointer.onContainerMouseLeave(C||{relatedTarget:z.container}),S&&S.mouseIsDown||(rt.hoverChartIndex=z.index)}touch(C,z){let S,g,v=this.chart;this.setHoverChartIndex(),C.touches.length===1?(C=this.normalize(C),v.isInsidePlot(C.chartX-v.plotLeft,C.chartY-v.plotTop,{visiblePlotOnly:!0})&&!v.openMenu?(z&&this.runPointActions(C),C.type==="touchmove"&&(S=!!(g=this.pinchDown)[0]&&Math.sqrt(Math.pow(g[0].chartX-C.chartX,2)+Math.pow(g[0].chartY-C.chartY,2))>=4),_t(S,!0)&&this.pinch(C)):z&&this.reset()):C.touches.length===2&&this.pinch(C)}touchSelect(C){return!!(this.chart.zooming.singleTouch&&C.touches&&C.touches.length===1)}zoomOption(C){let z=this.chart,S=(z.options.chart,z.inverted),g=z.zooming.type||"",v,y;/touch/.test(C.type)&&(g=_t(z.zooming.pinchType,g)),this.zoomX=v=/x/.test(g),this.zoomY=y=/y/.test(g),this.zoomHor=v&&!S||y&&S,this.zoomVert=y&&!S||v&&S,this.hasZoom=v||y}}return(Zt=rt||(rt={})).compose=function I(C){mt(Lt,I)&&ut(C,"beforeRender",function(){this.pointer=new Zt(this,this.options)})},rt}),te(X,"Core/Legend/Legend.js",[X["Core/Animation/AnimationUtilities.js"],X["Core/Templating.js"],X["Core/Globals.js"],X["Core/Series/Point.js"],X["Core/Renderer/RendererUtilities.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt,Nt){var Lt;let{animObject:kt,setAnimation:ut}=Et,{format:Rt}=At,{composed:Z,marginNames:lt}=l,{distribute:at}=dt,{addEvent:W,createElement:q,css:$,defined:U,discardElement:j,find:et,fireEvent:_t,isNumber:mt,merge:V,pick:rt,pushUnique:I,relativeLength:C,stableSort:z,syncTimeout:S}=Nt;class g{constructor(y,T){this.allItems=[],this.initialItemY=0,this.itemHeight=0,this.itemMarginBottom=0,this.itemMarginTop=0,this.itemX=0,this.itemY=0,this.lastItemY=0,this.lastLineHeight=0,this.legendHeight=0,this.legendWidth=0,this.maxItemWidth=0,this.maxLegendWidth=0,this.offsetWidth=0,this.padding=0,this.pages=[],this.symbolHeight=0,this.symbolWidth=0,this.titleHeight=0,this.totalItemWidth=0,this.widthOption=0,this.chart=y,this.setOptions(T),T.enabled&&(this.render(),W(this.chart,"endResize",function(){this.legend.positionCheckboxes()})),W(this.chart,"render",()=>{this.options.enabled&&this.proximate&&(this.proximatePositions(),this.positionItems())})}setOptions(y){let T=rt(y.padding,8);this.options=y,this.chart.styledMode||(this.itemStyle=y.itemStyle,this.itemHiddenStyle=V(this.itemStyle,y.itemHiddenStyle)),this.itemMarginTop=y.itemMarginTop,this.itemMarginBottom=y.itemMarginBottom,this.padding=T,this.initialItemY=T-5,this.symbolWidth=rt(y.symbolWidth,16),this.pages=[],this.proximate=y.layout==="proximate"&&!this.chart.inverted,this.baseline=void 0}update(y,T){let k=this.chart;this.setOptions(V(!0,this.options,y)),this.destroy(),k.isDirtyLegend=k.isDirtyBox=!0,rt(T,!0)&&k.redraw(),_t(this,"afterUpdate",{redraw:T})}colorizeItem(y,T){let{area:k,group:E,label:w,line:R,symbol:J}=y.legendItem||{};if(E==null||E[T?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){let{itemHiddenStyle:wt={}}=this,ot=wt.color,{fillColor:it,fillOpacity:Q,lineColor:A,marker:B}=y.options,K=pt=>(!T&&(pt.fill&&(pt.fill=ot),pt.stroke&&(pt.stroke=ot)),pt);w==null||w.css(V(T?this.itemStyle:wt)),R==null||R.attr(K({stroke:A||y.color})),J&&J.attr(K(B&&J.isMarker?y.pointAttribs():{fill:y.color})),k==null||k.attr(K({fill:it||y.color,"fill-opacity":it?1:Q??.75}))}_t(this,"afterColorizeItem",{item:y,visible:T})}positionItems(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()}positionItem(y){let{group:T,x:k=0,y:E=0}=y.legendItem||{},w=this.options,R=w.symbolPadding,J=!w.rtl,wt=y.checkbox;if(T&&T.element){let ot={translateX:J?k:this.legendWidth-k-2*R-4,translateY:E};T[U(T.translateY)?"animate":"attr"](ot,void 0,()=>{_t(this,"afterPositionItem",{item:y})})}wt&&(wt.x=k,wt.y=E)}destroyItem(y){let T=y.checkbox,k=y.legendItem||{};for(let E of["group","label","line","symbol"])k[E]&&(k[E]=k[E].destroy());T&&j(T),y.legendItem=void 0}destroy(){for(let y of this.getAllItems())this.destroyItem(y);for(let y of["clipRect","up","down","pager","nav","box","title","group"])this[y]&&(this[y]=this[y].destroy());this.display=null}positionCheckboxes(){let y,T=this.group&&this.group.alignAttr,k=this.clipHeight||this.legendHeight,E=this.titleHeight;T&&(y=T.translateY,this.allItems.forEach(function(w){let R,J=w.checkbox;J&&(R=y+E+J.y+(this.scrollOffset||0)+3,$(J,{left:T.translateX+w.checkboxOffset+J.x-20+"px",top:R+"px",display:this.proximate||R>y-6&&R<y+k-6?"":"none"}))},this))}renderTitle(){let y=this.options,T=this.padding,k=y.title,E,w=0;k.text&&(this.title||(this.title=this.chart.renderer.label(k.text,T-3,T-4,void 0,void 0,void 0,y.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(k.style),this.title.add(this.group)),k.width||this.title.css({width:this.maxLegendWidth+"px"}),w=(E=this.title.getBBox()).height,this.offsetWidth=E.width,this.contentGroup.attr({translateY:w})),this.titleHeight=w}setText(y){let T=this.options;y.legendItem.label.attr({text:T.labelFormat?Rt(T.labelFormat,y,this.chart):T.labelFormatter.call(y)})}renderItem(y){let T=y.legendItem=y.legendItem||{},k=this.chart,E=k.renderer,w=this.options,R=w.layout==="horizontal",J=this.symbolWidth,wt=w.symbolPadding||0,ot=this.itemStyle,it=this.itemHiddenStyle,Q=R?rt(w.itemDistance,20):0,A=!w.rtl,B=!y.series,K=!B&&y.series.drawLegendSymbol?y.series:y,pt=K.options,_=!!this.createCheckboxForItem&&pt&&pt.showCheckbox,P=w.useHTML,D=y.options.className,Y=T.label,G=J+wt+Q+(_?20:0);!Y&&(T.group=E.g("legend-item").addClass("highcharts-"+K.type+"-series highcharts-color-"+y.colorIndex+(D?" "+D:"")+(B?" highcharts-series-"+y.index:"")).attr({zIndex:1}).add(this.scrollGroup),T.label=Y=E.text("",A?J+wt:-wt,this.baseline||0,P),k.styledMode||Y.css(V(y.visible?ot:it)),Y.attr({align:A?"left":"right",zIndex:2}).add(T.group),!this.baseline&&(this.fontMetrics=E.fontMetrics(Y),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,Y.attr("y",this.baseline),this.symbolHeight=rt(w.symbolHeight,this.fontMetrics.f),w.squareSymbol&&(this.symbolWidth=rt(w.symbolWidth,Math.max(this.symbolHeight,16)),G=this.symbolWidth+wt+Q+(_?20:0),A&&Y.attr("x",this.symbolWidth+wt))),K.drawLegendSymbol(this,y),this.setItemEvents&&this.setItemEvents(y,Y,P)),_&&!y.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(y),this.colorizeItem(y,y.visible),(k.styledMode||!ot.width)&&Y.css({width:(w.itemWidth||this.widthOption||k.spacingBox.width)-G+"px"}),this.setText(y);let xt=Y.getBBox(),Ct=this.fontMetrics&&this.fontMetrics.h||0;y.itemWidth=y.checkboxOffset=w.itemWidth||T.labelWidth||xt.width+G,this.maxItemWidth=Math.max(this.maxItemWidth,y.itemWidth),this.totalItemWidth+=y.itemWidth,this.itemHeight=y.itemHeight=Math.round(T.labelHeight||(xt.height>1.5*Ct?xt.height:Ct))}layoutItem(y){let T=this.options,k=this.padding,E=T.layout==="horizontal",w=y.itemHeight,R=this.itemMarginBottom,J=this.itemMarginTop,wt=E?rt(T.itemDistance,20):0,ot=this.maxLegendWidth,it=T.alignColumns&&this.totalItemWidth>ot?this.maxItemWidth:y.itemWidth,Q=y.legendItem||{};E&&this.itemX-k+it>ot&&(this.itemX=k,this.lastLineHeight&&(this.itemY+=J+this.lastLineHeight+R),this.lastLineHeight=0),this.lastItemY=J+this.itemY+R,this.lastLineHeight=Math.max(w,this.lastLineHeight),Q.x=this.itemX,Q.y=this.itemY,E?this.itemX+=it:(this.itemY+=J+w+R,this.lastLineHeight=w),this.offsetWidth=this.widthOption||Math.max((E?this.itemX-k-(y.checkbox?0:wt):it)+k,this.offsetWidth)}getAllItems(){let y=[];return this.chart.series.forEach(function(T){let k=T&&T.options;T&&rt(k.showInLegend,!U(k.linkedTo)&&void 0,!0)&&(y=y.concat((T.legendItem||{}).labels||(k.legendType==="point"?T.data:T)))}),_t(this,"afterGetAllItems",{allItems:y}),y}getAlignment(){let y=this.options;return this.proximate?y.align.charAt(0)+"tv":y.floating?"":y.align.charAt(0)+y.verticalAlign.charAt(0)+y.layout.charAt(0)}adjustMargins(y,T){let k=this.chart,E=this.options,w=this.getAlignment();w&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(R,J){R.test(w)&&!U(y[J])&&(k[lt[J]]=Math.max(k[lt[J]],k.legend[(J+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][J]*E[J%2?"x":"y"]+rt(E.margin,12)+T[J]+(k.titleOffset[J]||0)))})}proximatePositions(){let y,T=this.chart,k=[],E=this.options.align==="left";for(let w of(this.allItems.forEach(function(R){let J,wt,ot=E,it,Q;R.yAxis&&(R.xAxis.options.reversed&&(ot=!ot),R.points&&(J=et(ot?R.points:R.points.slice(0).reverse(),function(A){return mt(A.plotY)})),wt=this.itemMarginTop+R.legendItem.label.getBBox().height+this.itemMarginBottom,Q=R.yAxis.top-T.plotTop,it=R.visible?(J?J.plotY:R.yAxis.height)+(Q-.3*wt):Q+R.yAxis.height,k.push({target:it,size:wt,item:R}))},this),at(k,T.plotHeight)))y=w.item.legendItem||{},mt(w.pos)&&(y.y=T.plotTop-T.spacing[0]+w.pos)}render(){let y=this.chart,T=y.renderer,k=this.options,E=this.padding,w=this.getAllItems(),R,J,wt,ot=this.group,it,Q=this.box;this.itemX=E,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=C(k.width,y.spacingBox.width-E),it=y.spacingBox.width-2*E-k.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(it/=2),this.maxLegendWidth=this.widthOption||it,ot||(this.group=ot=T.g("legend").addClass(k.className||"").attr({zIndex:7}).add(),this.contentGroup=T.g().attr({zIndex:1}).add(ot),this.scrollGroup=T.g().add(this.contentGroup)),this.renderTitle(),z(w,(A,B)=>(A.options&&A.options.legendIndex||0)-(B.options&&B.options.legendIndex||0)),k.reversed&&w.reverse(),this.allItems=w,this.display=R=!!w.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,w.forEach(this.renderItem,this),w.forEach(this.layoutItem,this),J=(this.widthOption||this.offsetWidth)+E,wt=this.lastItemY+this.lastLineHeight+this.titleHeight,wt=this.handleOverflow(wt)+E,Q||(this.box=Q=T.rect().addClass("highcharts-legend-box").attr({r:k.borderRadius}).add(ot)),y.styledMode||Q.attr({stroke:k.borderColor,"stroke-width":k.borderWidth||0,fill:k.backgroundColor||"none"}).shadow(k.shadow),J>0&&wt>0&&Q[Q.placed?"animate":"attr"](Q.crisp.call({},{x:0,y:0,width:J,height:wt},Q.strokeWidth())),ot[R?"show":"hide"](),y.styledMode&&ot.getStyle("display")==="none"&&(J=wt=0),this.legendWidth=J,this.legendHeight=wt,R&&this.align(),this.proximate||this.positionItems(),_t(this,"afterRender")}align(y=this.chart.spacingBox){let T=this.chart,k=this.options,E=y.y;/(lth|ct|rth)/.test(this.getAlignment())&&T.titleOffset[0]>0?E+=T.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&T.titleOffset[2]>0&&(E-=T.titleOffset[2]),E!==y.y&&(y=V(y,{y:E})),T.hasRendered||(this.group.placed=!1),this.group.align(V(k,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":k.verticalAlign}),!0,y)}handleOverflow(y){let T=this,k=this.chart,E=k.renderer,w=this.options,R=w.y,J=w.verticalAlign==="top",wt=this.padding,ot=w.maxHeight,it=w.navigation,Q=rt(it.animation,!0),A=it.arrowSize||12,B=this.pages,K=this.allItems,pt=function(Dt){typeof Dt=="number"?Ct.attr({height:Dt}):Ct&&(T.clipRect=Ct.destroy(),T.contentGroup.clip()),T.contentGroup.div&&(T.contentGroup.div.style.clip=Dt?"rect("+wt+"px,9999px,"+(wt+Dt)+"px,0)":"auto")},_=function(Dt){return T[Dt]=E.circle(0,0,1.3*A).translate(A/2,A/2).add(xt),k.styledMode||T[Dt].attr("fill","rgba(0,0,0,0.0001)"),T[Dt]},P,D,Y,G=k.spacingBox.height+(J?-R:R)-wt,xt=this.nav,Ct=this.clipRect;return w.layout!=="horizontal"||w.verticalAlign==="middle"||w.floating||(G/=2),ot&&(G=Math.min(G,ot)),B.length=0,y&&G>0&&y>G&&it.enabled!==!1?(this.clipHeight=P=Math.max(G-20-this.titleHeight-wt,0),this.currentPage=rt(this.currentPage,1),this.fullHeight=y,K.forEach((Dt,jt)=>{Y=Dt.legendItem||{};let Kt=Y.y||0,ee=Math.round(Y.label.getBBox().height),le=B.length;(!le||Kt-B[le-1]>P&&(D||Kt)!==B[le-1])&&(B.push(D||Kt),le++),Y.pageIx=le-1,D&&((K[jt-1].legendItem||{}).pageIx=le-1),jt===K.length-1&&Kt+ee-B[le-1]>P&&Kt>B[le-1]&&(B.push(Kt),Y.pageIx=le),Kt!==D&&(D=Kt)}),Ct||(Ct=T.clipRect=E.clipRect(0,wt-2,9999,0),T.contentGroup.clip(Ct)),pt(P),xt||(this.nav=xt=E.g().attr({zIndex:1}).add(this.group),this.up=E.symbol("triangle",0,0,A,A).add(xt),_("upTracker").on("click",function(){T.scroll(-1,Q)}),this.pager=E.text("",15,10).addClass("highcharts-legend-navigation"),!k.styledMode&&it.style&&this.pager.css(it.style),this.pager.add(xt),this.down=E.symbol("triangle-down",0,0,A,A).add(xt),_("downTracker").on("click",function(){T.scroll(1,Q)})),T.scroll(0),y=G):xt&&(pt(),this.nav=xt.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),y}scroll(y,T){let k=this.chart,E=this.pages,w=E.length,R=this.clipHeight,J=this.options.navigation,wt=this.pager,ot=this.padding,it=this.currentPage+y;if(it>w&&(it=w),it>0){T!==void 0&&ut(T,k),this.nav.attr({translateX:ot,translateY:R+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach(function(A){A.attr({class:it===1?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),wt.attr({text:it+"/"+w}),[this.down,this.downTracker].forEach(function(A){A.attr({x:18+this.pager.getBBox().width,class:it===w?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),k.styledMode||(this.up.attr({fill:it===1?J.inactiveColor:J.activeColor}),this.upTracker.css({cursor:it===1?"default":"pointer"}),this.down.attr({fill:it===w?J.inactiveColor:J.activeColor}),this.downTracker.css({cursor:it===w?"default":"pointer"})),this.scrollOffset=-E[it-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=it,this.positionCheckboxes();let Q=kt(rt(T,k.renderer.globalAnimation,!0));S(()=>{_t(this,"afterScroll",{currentPage:it})},Q.duration)}}setItemEvents(y,T,k){let E=this,w=y.legendItem||{},R=E.chart.renderer.boxWrapper,J=y instanceof Zt,wt="highcharts-legend-"+(J?"point":"series")+"-active",ot=E.chart.styledMode,it=k?[T,w.symbol]:[w.group],Q=A=>{E.allItems.forEach(B=>{y!==B&&[B].concat(B.linkedSeries||[]).forEach(K=>{K.setState(A,!J)})})};for(let A of it)A&&A.on("mouseover",function(){y.visible&&Q("inactive"),y.setState("hover"),y.visible&&R.addClass(wt),ot||T.css(E.options.itemHoverStyle)}).on("mouseout",function(){E.chart.styledMode||T.css(V(y.visible?E.itemStyle:E.itemHiddenStyle)),Q(""),R.removeClass(wt),y.setState()}).on("click",function(B){let K="legendItemClick",pt=function(){y.setVisible&&y.setVisible(),Q(y.visible?"inactive":"")};R.removeClass(wt),B={browserEvent:B},y.firePointEvent?y.firePointEvent(K,B,pt):_t(y,K,B,pt)})}createCheckboxForItem(y){y.checkbox=q("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:y.selected,defaultChecked:y.selected},this.options.itemCheckboxStyle,this.chart.container),W(y.checkbox,"click",function(T){let k=T.target;_t(y.series||y,"checkboxClick",{checked:k.checked,item:y},function(){y.select()})})}}return(Lt=g||(g={})).compose=function v(y){I(Z,v)&&W(y,"beforeMargins",function(){this.legend=new Lt(this,this.options.legend)})},g}),te(X,"Core/Legend/LegendSymbol.js",[X["Core/Utilities.js"]],function(Et){var At;let{extend:l,merge:Zt,pick:dt}=Et;return function(Nt){function Lt(kt,ut,Rt){var z;let Z=this.legendItem=this.legendItem||{},{chart:lt,options:at}=this,{baseline:W=0,symbolWidth:q,symbolHeight:$}=kt,U=this.symbol||"circle",j=$/2,et=lt.renderer,_t=Z.group,mt=W-Math.round($*(Rt?.4:.3)),V={},rt,I=at.marker,C=0;if(lt.styledMode||(V["stroke-width"]=Math.min(at.lineWidth||0,24),at.dashStyle?V.dashstyle=at.dashStyle:at.linecap==="square"||(V["stroke-linecap"]="round")),Z.line=et.path().addClass("highcharts-graph").attr(V).add(_t),Rt&&(Z.area=et.path().addClass("highcharts-area").add(_t)),V["stroke-linecap"]&&(C=Math.min(Z.line.strokeWidth(),q)/2),q){let S=[["M",C,mt],["L",q-C,mt]];Z.line.attr({d:S}),(z=Z.area)==null||z.attr({d:[...S,["L",q-C,W],["L",C,W]]})}if(I&&I.enabled!==!1&&q){let S=Math.min(dt(I.radius,j),j);U.indexOf("url")===0&&(I=Zt(I,{width:$,height:$}),S=0),Z.symbol=rt=et.symbol(U,q/2-S,mt-S,2*S,2*S,l({context:"legend"},I)).addClass("highcharts-point").add(_t),rt.isMarker=!0}}Nt.areaMarker=function(kt,ut){Lt.call(this,kt,ut,!0)},Nt.lineMarker=Lt,Nt.rectangle=function(kt,ut){let Rt=ut.legendItem||{},Z=kt.options,lt=kt.symbolHeight,at=Z.squareSymbol,W=at?lt:kt.symbolWidth;Rt.symbol=this.chart.renderer.rect(at?(kt.symbolWidth-lt)/2:0,kt.baseline-lt+1,W,lt,dt(kt.options.symbolRadius,lt/2)).addClass("highcharts-point").attr({zIndex:3}).add(Rt.group)}}(At||(At={})),At}),te(X,"Core/Series/SeriesDefaults.js",[],function(){return{lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},enableMouseTracking:!0,events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:150},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){let{numberFormatter:Et}=this.series.chart;return typeof this.y!="number"?"":Et(this.y,-1)},padding:5,style:{fontSize:"0.7em",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:150},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:150},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"}}),te(X,"Core/Series/SeriesRegistry.js",[X["Core/Globals.js"],X["Core/Defaults.js"],X["Core/Series/Point.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt){var dt;let{defaultOptions:Nt}=At,{extendClass:Lt,merge:kt}=Zt;return function(ut){function Rt(Z,lt){let at=Nt.plotOptions||{},W=lt.defaultOptions,q=lt.prototype;q.type=Z,q.pointClass||(q.pointClass=l),W&&(at[Z]=W),ut.seriesTypes[Z]=lt}ut.seriesTypes=Et.seriesTypes,ut.registerSeriesType=Rt,ut.seriesType=function(Z,lt,at,W,q){let $=Nt.plotOptions||{};return lt=lt||"",$[Z]=kt($[lt],at),Rt(Z,Lt(ut.seriesTypes[lt]||function(){},W)),ut.seriesTypes[Z].prototype.type=Z,q&&(ut.seriesTypes[Z].prototype.pointClass=Lt(l,q)),ut.seriesTypes[Z]}}(dt||(dt={})),dt}),te(X,"Core/Series/Series.js",[X["Core/Animation/AnimationUtilities.js"],X["Core/Defaults.js"],X["Core/Foundation.js"],X["Core/Globals.js"],X["Core/Legend/LegendSymbol.js"],X["Core/Series/Point.js"],X["Core/Series/SeriesDefaults.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Renderer/SVG/SVGElement.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt,Nt,Lt,kt,ut,Rt){let{animObject:Z,setAnimation:lt}=Et,{defaultOptions:at}=At,{registerEventOptions:W}=l,{hasTouch:q,svg:$,win:U}=Zt,{seriesTypes:j}=kt,{arrayMax:et,arrayMin:_t,clamp:mt,correctFloat:V,defined:rt,destroyObjectProperties:I,diffObjects:C,erase:z,error:S,extend:g,find:v,fireEvent:y,getClosestDistance:T,getNestedProperty:k,insertItem:E,isArray:w,isNumber:R,isString:J,merge:wt,objectEach:ot,pick:it,removeEvent:Q,splat:A,syncTimeout:B}=Rt;class K{constructor(){this.zoneAxis="y"}init(_,P){let D;y(this,"init",{options:P});let Y=this,G=_.series;this.eventsToUnbind=[],Y.chart=_,Y.options=Y.setOptions(P);let xt=Y.options,Ct=xt.visible!==!1;Y.linkedSeries=[],Y.bindAxes(),g(Y,{name:xt.name,state:"",visible:Ct,selected:xt.selected===!0}),W(this,xt);let Dt=xt.events;(Dt&&Dt.click||xt.point&&xt.point.events&&xt.point.events.click||xt.allowPointSelect)&&(_.runTrackerClick=!0),Y.getColor(),Y.getSymbol(),Y.parallelArrays.forEach(function(jt){Y[jt+"Data"]||(Y[jt+"Data"]=[])}),Y.isCartesian&&(_.hasCartesianSeries=!0),G.length&&(D=G[G.length-1]),Y._i=it(D&&D._i,-1)+1,Y.opacity=Y.options.opacity,_.orderItems("series",E(this,G)),xt.dataSorting&&xt.dataSorting.enabled?Y.setDataSortingOptions():Y.points||Y.data||Y.setData(xt.data,!1),y(this,"afterInit")}is(_){return j[_]&&this instanceof j[_]}bindAxes(){let _,P=this,D=P.options,Y=P.chart;y(this,"bindAxes",null,function(){(P.axisTypes||[]).forEach(function(G){Y[G].forEach(function(xt){_=xt.options,(it(D[G],0)===xt.index||D[G]!==void 0&&D[G]===_.id)&&(E(P,xt.series),P[G]=xt,xt.isDirty=!0)}),P[G]||P.optionalAxis===G||S(18,!0,Y)})}),y(this,"afterBindAxes")}updateParallelArrays(_,P,D){let Y=_.series,G=R(P)?function(xt){let Ct=xt==="y"&&Y.toYData?Y.toYData(_):_[xt];Y[xt+"Data"][P]=Ct}:function(xt){Array.prototype[P].apply(Y[xt+"Data"],D)};Y.parallelArrays.forEach(G)}hasData(){return this.visible&&this.dataMax!==void 0&&this.dataMin!==void 0||this.visible&&this.yData&&this.yData.length>0}hasMarkerChanged(_,P){let D=_.marker,Y=P.marker||{};return D&&(Y.enabled&&!D.enabled||Y.symbol!==D.symbol||Y.height!==D.height||Y.width!==D.width)}autoIncrement(_){let P=this.options,D=P.pointIntervalUnit,Y=P.relativeXValue,G=this.chart.time,xt=this.xIncrement,Ct,Dt;return xt=it(xt,P.pointStart,0),this.pointInterval=Dt=it(this.pointInterval,P.pointInterval,1),Y&&R(_)&&(Dt*=_),D&&(Ct=new G.Date(xt),D==="day"?G.set("Date",Ct,G.get("Date",Ct)+Dt):D==="month"?G.set("Month",Ct,G.get("Month",Ct)+Dt):D==="year"&&G.set("FullYear",Ct,G.get("FullYear",Ct)+Dt),Dt=Ct.getTime()-xt),Y&&R(_)?xt+Dt:(this.xIncrement=xt+Dt,xt)}setDataSortingOptions(){let _=this.options;g(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),rt(_.pointRange)||(_.pointRange=1)}setOptions(_){var Ht,Vt;let P,D=this.chart,Y=D.options,G=Y.plotOptions,xt=D.userOptions||{},Ct=wt(_),Dt=D.styledMode,jt={plotOptions:G,userOptions:Ct};y(this,"setOptions",jt);let Kt=jt.plotOptions[this.type],ee=xt.plotOptions||{},le=ee.series||{},ht=at.plotOptions[this.type]||{},st=ee[this.type]||{};this.userOptions=jt.userOptions;let Tt=wt(Kt,G.series,st,Ct);this.tooltipOptions=wt(at.tooltip,(Ht=at.plotOptions.series)==null?void 0:Ht.tooltip,ht==null?void 0:ht.tooltip,D.userOptions.tooltip,(Vt=ee.series)==null?void 0:Vt.tooltip,st.tooltip,Ct.tooltip),this.stickyTracking=it(Ct.stickyTracking,st.stickyTracking,le.stickyTracking,!!this.tooltipOptions.shared&&!this.noSharedTooltip||Tt.stickyTracking),Kt.marker===null&&delete Tt.marker,this.zoneAxis=Tt.zoneAxis||"y";let Mt=this.zones=(Tt.zones||[]).slice();return(Tt.negativeColor||Tt.negativeFillColor)&&!Tt.zones&&(P={value:Tt[this.zoneAxis+"Threshold"]||Tt.threshold||0,className:"highcharts-negative"},Dt||(P.color=Tt.negativeColor,P.fillColor=Tt.negativeFillColor),Mt.push(P)),Mt.length&&rt(Mt[Mt.length-1].value)&&Mt.push(Dt?{}:{color:this.color,fillColor:this.fillColor}),y(this,"afterSetOptions",{options:Tt}),Tt}getName(){return it(this.options.name,"Series "+(this.index+1))}getCyclic(_,P,D){let Y,G,xt=this.chart,Ct=`${_}Index`,Dt=`${_}Counter`,jt=(D==null?void 0:D.length)||xt.options.chart.colorCount;!P&&(rt(G=it(_==="color"?this.options.colorIndex:void 0,this[Ct]))?Y=G:(xt.series.length||(xt[Dt]=0),Y=xt[Dt]%jt,xt[Dt]+=1),D&&(P=D[Y])),Y!==void 0&&(this[Ct]=Y),this[_]=P}getColor(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||at.plotOptions[this.type].color,this.chart.options.colors)}getPointsCollection(){return(this.hasGroupedData?this.points:this.data)||[]}getSymbol(){let _=this.options.marker;this.getCyclic("symbol",_.symbol,this.chart.options.symbols)}findPointIndex(_,P){let D,Y,G,xt=_.id,Ct=_.x,Dt=this.points,jt=this.options.dataSorting;if(xt){let Kt=this.chart.get(xt);Kt instanceof Nt&&(D=Kt)}else if(this.linkedParent||this.enabledDataSorting||this.options.relativeXValue){let Kt=ee=>!ee.touched&&ee.index===_.index;if(jt&&jt.matchByName?Kt=ee=>!ee.touched&&ee.name===_.name:this.options.relativeXValue&&(Kt=ee=>!ee.touched&&ee.options.x===_.x),!(D=v(Dt,Kt)))return}return D&&(G=D&&D.index)!==void 0&&(Y=!0),G===void 0&&R(Ct)&&(G=this.xData.indexOf(Ct,P)),G!==-1&&G!==void 0&&this.cropped&&(G=G>=this.cropStart?G-this.cropStart:G),!Y&&R(G)&&Dt[G]&&Dt[G].touched&&(G=void 0),G}updateData(_,P){let D=this.options,Y=D.dataSorting,G=this.points,xt=[],Ct=this.requireSorting,Dt=_.length===G.length,jt,Kt,ee,le,ht=!0;if(this.xIncrement=null,_.forEach(function(st,Tt){let Mt,Ht=rt(st)&&this.pointClass.prototype.optionsToObject.call({series:this},st)||{},Vt=Ht.x;Ht.id||R(Vt)?((Mt=this.findPointIndex(Ht,le))===-1||Mt===void 0?xt.push(st):G[Mt]&&st!==D.data[Mt]?(G[Mt].update(st,!1,null,!1),G[Mt].touched=!0,Ct&&(le=Mt+1)):G[Mt]&&(G[Mt].touched=!0),(!Dt||Tt!==Mt||Y&&Y.enabled||this.hasDerivedData)&&(jt=!0)):xt.push(st)},this),jt)for(Kt=G.length;Kt--;)(ee=G[Kt])&&!ee.touched&&ee.remove&&ee.remove(!1,P);else!Dt||Y&&Y.enabled?ht=!1:(_.forEach(function(st,Tt){st===G[Tt].y||G[Tt].destroyed||G[Tt].update(st,!1,null,!1)}),xt.length=0);return G.forEach(function(st){st&&(st.touched=!1)}),!!ht&&(xt.forEach(function(st){this.addPoint(st,!1,null,null,!1)},this),this.xIncrement===null&&this.xData&&this.xData.length&&(this.xIncrement=et(this.xData),this.autoIncrement()),!0)}setData(_,P=!0,D,Y){var Ze;let G=this,xt=G.points,Ct=xt&&xt.length||0,Dt=G.options,jt=G.chart,Kt=Dt.dataSorting,ee=G.xAxis,le=Dt.turboThreshold,ht=this.xData,st=this.yData,Tt=G.pointArrayMap,Mt=Tt&&Tt.length,Ht=Dt.keys,Vt,re,Jt,ye=0,ze=1,ge=null,be;jt.options.chart.allowMutatingData||(Dt.data&&delete G.options.data,G.userOptions.data&&delete G.userOptions.data,be=wt(!0,_)),_=be||_||[];let Oe=_.length;if(Kt&&Kt.enabled&&(_=this.sortData(_)),jt.options.chart.allowMutatingData&&Y!==!1&&Oe&&Ct&&!G.cropped&&!G.hasGroupedData&&G.visible&&!G.boosted&&(Jt=this.updateData(_,D)),!Jt){if(G.xIncrement=null,G.colorCounter=0,this.parallelArrays.forEach(function(Ge){G[Ge+"Data"].length=0}),le&&Oe>le)if(R(ge=G.getFirstValidPoint(_)))for(Vt=0;Vt<Oe;Vt++)ht[Vt]=this.autoIncrement(),st[Vt]=_[Vt];else if(w(ge))if(Mt)if(ge.length===Mt)for(Vt=0;Vt<Oe;Vt++)ht[Vt]=this.autoIncrement(),st[Vt]=_[Vt];else for(Vt=0;Vt<Oe;Vt++)re=_[Vt],ht[Vt]=re[0],st[Vt]=re.slice(1,Mt+1);else if(Ht&&(ye=Ht.indexOf("x"),ze=Ht.indexOf("y"),ye=ye>=0?ye:0,ze=ze>=0?ze:1),ge.length===1&&(ze=0),ye===ze)for(Vt=0;Vt<Oe;Vt++)ht[Vt]=this.autoIncrement(),st[Vt]=_[Vt][ze];else for(Vt=0;Vt<Oe;Vt++)re=_[Vt],ht[Vt]=re[ye],st[Vt]=re[ze];else S(12,!1,jt);else for(Vt=0;Vt<Oe;Vt++)re={series:G},G.pointClass.prototype.applyOptions.apply(re,[_[Vt]]),G.updateParallelArrays(re,Vt);for(st&&J(st[0])&&S(14,!0,jt),G.data=[],G.options.data=G.userOptions.data=_,Vt=Ct;Vt--;)(Ze=xt[Vt])==null||Ze.destroy();ee&&(ee.minRange=ee.userMinRange),G.isDirty=jt.isDirtyBox=!0,G.isDirtyData=!!xt,D=!1}Dt.legendType==="point"&&(this.processData(),this.generatePoints()),P&&jt.redraw(D)}sortData(_){let P=this,D=P.options,Y=D.dataSorting,G=Y.sortKey||"y",xt=function(Dt,jt){return rt(jt)&&Dt.pointClass.prototype.optionsToObject.call({series:Dt},jt)||{}};return _.forEach(function(Dt,jt){_[jt]=xt(P,Dt),_[jt].index=jt},this),_.concat().sort((Dt,jt)=>{let Kt=k(G,Dt),ee=k(G,jt);return ee<Kt?-1:ee>Kt?1:0}).forEach(function(Dt,jt){Dt.x=jt},this),P.linkedSeries&&P.linkedSeries.forEach(function(Dt){let jt=Dt.options,Kt=jt.data;jt.dataSorting&&jt.dataSorting.enabled||!Kt||(Kt.forEach(function(ee,le){Kt[le]=xt(Dt,ee),_[le]&&(Kt[le].x=_[le].x,Kt[le].index=le)}),Dt.setData(Kt,!1))}),_}getProcessedData(_){let P=this,D=P.xAxis,Y=P.options,G=Y.cropThreshold,xt=_||P.getExtremesFromAll||Y.getExtremesFromAll,Ct=D==null?void 0:D.logarithmic,Dt=P.isCartesian,jt,Kt,ee=0,le,ht,st,Tt=P.xData,Mt=P.yData,Ht=!1,Vt=Tt.length;D&&(ht=(le=D.getExtremes()).min,st=le.max,Ht=!!(D.categories&&!D.names.length)),Dt&&P.sorted&&!xt&&(!G||Vt>G||P.forceCrop)&&(Tt[Vt-1]<ht||Tt[0]>st?(Tt=[],Mt=[]):P.yData&&(Tt[0]<ht||Tt[Vt-1]>st)&&(Tt=(jt=this.cropData(P.xData,P.yData,ht,st)).xData,Mt=jt.yData,ee=jt.start,Kt=!0));let re=T([Ct?Tt.map(Ct.log2lin):Tt],()=>P.requireSorting&&!Ht&&S(15,!1,P.chart));return{xData:Tt,yData:Mt,cropped:Kt,cropStart:ee,closestPointRange:re}}processData(_){let P=this.xAxis;if(this.isCartesian&&!this.isDirty&&!P.isDirty&&!this.yAxis.isDirty&&!_)return!1;let D=this.getProcessedData();this.cropped=D.cropped,this.cropStart=D.cropStart,this.processedXData=D.xData,this.processedYData=D.yData,this.closestPointRange=this.basePointRange=D.closestPointRange,y(this,"afterProcessData")}cropData(_,P,D,Y){let G=_.length,xt,Ct,Dt=0,jt=G;for(xt=0;xt<G;xt++)if(_[xt]>=D){Dt=Math.max(0,xt-1);break}for(Ct=xt;Ct<G;Ct++)if(_[Ct]>Y){jt=Ct+1;break}return{xData:_.slice(Dt,jt),yData:P.slice(Dt,jt),start:Dt,end:jt}}generatePoints(){let _=this.options,P=this.processedData||_.data,D=this.processedXData,Y=this.processedYData,G=this.pointClass,xt=D.length,Ct=this.cropStart||0,Dt=this.hasGroupedData,jt=_.keys,Kt=[],ee=_.dataGrouping&&_.dataGrouping.groupAll?Ct:0,le,ht,st,Tt,Mt=this.data;if(!Mt&&!Dt){let Ht=[];Ht.length=P.length,Mt=this.data=Ht}for(jt&&Dt&&(this.options.keys=!1),Tt=0;Tt<xt;Tt++)ht=Ct+Tt,Dt?((st=new G(this,[D[Tt]].concat(A(Y[Tt])))).dataGroup=this.groupMap[ee+Tt],st.dataGroup.options&&(st.options=st.dataGroup.options,g(st,st.dataGroup.options),delete st.dataLabels)):(st=Mt[ht])||P[ht]===void 0||(Mt[ht]=st=new G(this,P[ht],D[Tt])),st&&(st.index=Dt?ee+Tt:ht,Kt[Tt]=st);if(this.options.keys=jt,Mt&&(xt!==(le=Mt.length)||Dt))for(Tt=0;Tt<le;Tt++)Tt!==Ct||Dt||(Tt+=xt),Mt[Tt]&&(Mt[Tt].destroyElements(),Mt[Tt].plotX=void 0);this.data=Mt,this.points=Kt,y(this,"afterGeneratePoints")}getXExtremes(_){return{min:_t(_),max:et(_)}}getExtremes(_,P){let D=this.xAxis,Y=this.yAxis,G=this.processedXData||this.xData,xt=[],Ct=this.requireSorting&&!this.is("column")?1:0,Dt=!!Y&&Y.positiveValuesOnly,jt,Kt,ee,le,ht,st,Tt,Mt=0,Ht=0,Vt=0;_=_||this.stackedYData||this.processedYData||[];let re=_.length;for(D&&(Mt=(jt=D.getExtremes()).min,Ht=jt.max),st=0;st<re;st++)if(le=G[st],Kt=(R(ht=_[st])||w(ht))&&((R(ht)?ht>0:ht.length)||!Dt),ee=P||this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||!D||(G[st+Ct]||le)>=Mt&&(G[st-Ct]||le)<=Ht,Kt&&ee)if(Tt=ht.length)for(;Tt--;)R(ht[Tt])&&(xt[Vt++]=ht[Tt]);else xt[Vt++]=ht;let Jt={activeYData:xt,dataMin:_t(xt),dataMax:et(xt)};return y(this,"afterGetExtremes",{dataExtremes:Jt}),Jt}applyExtremes(){let _=this.getExtremes();return this.dataMin=_.dataMin,this.dataMax=_.dataMax,_}getFirstValidPoint(_){let P=_.length,D=0,Y=null;for(;Y===null&&D<P;)Y=_[D],D++;return Y}translate(){var re;this.processedXData||this.processData(),this.generatePoints();let _=this.options,P=_.stacking,D=this.xAxis,Y=D.categories,G=this.enabledDataSorting,xt=this.yAxis,Ct=this.points,Dt=Ct.length,jt=this.pointPlacementToXValue(),Kt=!!jt,ee=_.threshold,le=_.startFromThreshold?ee:0,ht,st,Tt,Mt,Ht=Number.MAX_VALUE;function Vt(Jt){return mt(Jt,-1e5,1e5)}for(ht=0;ht<Dt;ht++){let Jt,ye=Ct[ht],ze=ye.x,ge,be,Oe=ye.y,Ze=ye.low,Ge=P&&((re=xt.stacking)==null?void 0:re.stacks[(this.negStacks&&Oe<(le?0:ee)?"-":"")+this.stackKey]);st=D.translate(ze,!1,!1,!1,!0,jt),ye.plotX=R(st)?V(Vt(st)):void 0,P&&this.visible&&Ge&&Ge[ze]&&(Mt=this.getStackIndicator(Mt,ze,this.index),!ye.isNull&&Mt.key&&(be=(ge=Ge[ze]).points[Mt.key]),ge&&w(be)&&(Ze=be[0],Oe=be[1],Ze===le&&Mt.key===Ge[ze].base&&(Ze=it(R(ee)?ee:xt.min)),xt.positiveValuesOnly&&rt(Ze)&&Ze<=0&&(Ze=void 0),ye.total=ye.stackTotal=it(ge.total),ye.percentage=rt(ye.y)&&ge.total?ye.y/ge.total*100:void 0,ye.stackY=Oe,this.irregularWidths||ge.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))),ye.yBottom=rt(Ze)?Vt(xt.translate(Ze,!1,!0,!1,!0)):void 0,this.dataModify&&(Oe=this.dataModify.modifyValue(Oe,ht)),R(Oe)&&ye.plotX!==void 0&&(Jt=R(Jt=xt.translate(Oe,!1,!0,!1,!0))?Vt(Jt):void 0),ye.plotY=Jt,ye.isInside=this.isPointInside(ye),ye.clientX=Kt?V(D.translate(ze,!1,!1,!1,!0,jt)):st,ye.negative=(ye.y||0)<(ee||0),ye.category=it(Y&&Y[ye.x],ye.x),ye.isNull||ye.visible===!1||(Tt!==void 0&&(Ht=Math.min(Ht,Math.abs(st-Tt))),Tt=st),ye.zone=this.zones.length?ye.getZone():void 0,!ye.graphic&&this.group&&G&&(ye.isNew=!0)}this.closestPointRangePx=Ht,y(this,"afterTranslate")}getValidPoints(_,P,D){let Y=this.chart;return(_||this.points||[]).filter(function(G){let{plotX:xt,plotY:Ct}=G;return!(!D&&(G.isNull||!R(Ct)))&&(!P||!!Y.isInsidePlot(xt,Ct,{inverted:Y.inverted}))&&G.visible!==!1})}getClipBox(){let{chart:_,xAxis:P,yAxis:D}=this,Y=wt(_.clipBox);return P&&P.len!==_.plotSizeX&&(Y.width=P.len),D&&D.len!==_.plotSizeY&&(Y.height=D.len),Y}getSharedClipKey(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0),this.sharedClipKey}setClip(){let{chart:_,group:P,markerGroup:D}=this,Y=_.sharedClips,G=_.renderer,xt=this.getClipBox(),Ct=this.getSharedClipKey(),Dt=Y[Ct];Dt?Dt.animate(xt):Y[Ct]=Dt=G.clipRect(xt),P&&P.clip(this.options.clip===!1?void 0:Dt),D&&D.clip()}animate(_){let{chart:P,group:D,markerGroup:Y}=this,G=P.inverted,xt=Z(this.options.animation),Ct=[this.getSharedClipKey(),xt.duration,xt.easing,xt.defer].join(","),Dt=P.sharedClips[Ct],jt=P.sharedClips[Ct+"m"];if(_&&D){let Kt=this.getClipBox();if(Dt)Dt.attr("height",Kt.height);else{Kt.width=0,G&&(Kt.x=P.plotHeight),Dt=P.renderer.clipRect(Kt),P.sharedClips[Ct]=Dt;let ee={x:-99,y:-99,width:G?P.plotWidth+199:99,height:G?99:P.plotHeight+199};jt=P.renderer.clipRect(ee),P.sharedClips[Ct+"m"]=jt}D.clip(Dt),Y&&Y.clip(jt)}else if(Dt&&!Dt.hasClass("highcharts-animating")){let Kt=this.getClipBox(),ee=xt.step;Y&&Y.element.childNodes.length&&(xt.step=function(le,ht){ee&&ee.apply(ht,arguments),ht.prop==="width"&&jt&&jt.element&&jt.attr(G?"height":"width",le+99)}),Dt.addClass("highcharts-animating").animate(Kt,xt)}}afterAnimate(){this.setClip(),ot(this.chart.sharedClips,(_,P,D)=>{_&&!this.chart.container.querySelector(`[clip-path="url(#${_.id})"]`)&&(_.destroy(),delete D[P])}),this.finishedAnimating=!0,y(this,"afterAnimate")}drawPoints(_=this.points){let P,D,Y,G,xt,Ct,Dt,jt=this.chart,Kt=jt.styledMode,{colorAxis:ee,options:le}=this,ht=le.marker,st=this[this.specialGroup||"markerGroup"],Tt=this.xAxis,Mt=it(ht.enabled,!Tt||!!Tt.isRadial||null,this.closestPointRangePx>=ht.enabledThreshold*ht.radius);if(ht.enabled!==!1||this._hasPointMarkers)for(P=0;P<_.length;P++)if(G=(Y=(D=_[P]).graphic)?"animate":"attr",xt=D.marker||{},Ct=!!D.marker,(Mt&&xt.enabled===void 0||xt.enabled)&&!D.isNull&&D.visible!==!1){let Vt=it(xt.symbol,this.symbol,"rect");Dt=this.markerAttribs(D,D.selected&&"select"),this.enabledDataSorting&&(D.startXPos=Tt.reversed?-(Dt.width||0):Tt.width);let re=D.isInside!==!1;if(!Y&&re&&((Dt.width||0)>0||D.hasImage)&&(D.graphic=Y=jt.renderer.symbol(Vt,Dt.x,Dt.y,Dt.width,Dt.height,Ct?xt:ht).add(st),this.enabledDataSorting&&jt.hasRendered&&(Y.attr({x:D.startXPos}),G="animate")),Y&&G==="animate"&&Y[re?"show":"hide"](re).animate(Dt),Y){let Jt=this.pointAttribs(D,Kt||!D.selected?void 0:"select");Kt?ee&&Y.css({fill:Jt.fill}):Y[G](Jt)}Y&&Y.addClass(D.getClassName(),!0)}else Y&&(D.graphic=Y.destroy())}markerAttribs(_,P){let D=this.options,Y=D.marker,G=_.marker||{},xt=G.symbol||Y.symbol,Ct={},Dt,jt,Kt=it(G.radius,Y&&Y.radius);P&&(Dt=Y.states[P],Kt=it((jt=G.states&&G.states[P])&&jt.radius,Dt&&Dt.radius,Kt&&Kt+(Dt&&Dt.radiusPlus||0))),_.hasImage=xt&&xt.indexOf("url")===0,_.hasImage&&(Kt=0);let ee=_.pos();return R(Kt)&&ee&&(Ct.x=ee[0]-Kt,Ct.y=ee[1]-Kt,D.crisp&&(Ct.x=Math.floor(Ct.x))),Kt&&(Ct.width=Ct.height=2*Kt),Ct}pointAttribs(_,P){let D=this.options.marker,Y=_&&_.options,G=Y&&Y.marker||{},xt=Y&&Y.color,Ct=_&&_.color,Dt=_&&_.zone&&_.zone.color,jt,Kt,ee=this.color,le,ht,st=it(G.lineWidth,D.lineWidth),Tt=1;return ee=xt||Dt||Ct||ee,le=G.fillColor||D.fillColor||ee,ht=G.lineColor||D.lineColor||ee,P=P||"normal",jt=D.states[P]||{},st=it((Kt=G.states&&G.states[P]||{}).lineWidth,jt.lineWidth,st+it(Kt.lineWidthPlus,jt.lineWidthPlus,0)),le=Kt.fillColor||jt.fillColor||le,{stroke:ht=Kt.lineColor||jt.lineColor||ht,"stroke-width":st,fill:le,opacity:Tt=it(Kt.opacity,jt.opacity,Tt)}}destroy(_){let P,D,Y,G=this,xt=G.chart,Ct=/AppleWebKit\/533/.test(U.navigator.userAgent),Dt=G.data||[];for(y(G,"destroy",{keepEventsForUpdate:_}),this.removeEvents(_),(G.axisTypes||[]).forEach(function(jt){(Y=G[jt])&&Y.series&&(z(Y.series,G),Y.isDirty=Y.forceRedraw=!0)}),G.legendItem&&G.chart.legend.destroyItem(G),P=Dt.length;P--;)(D=Dt[P])&&D.destroy&&D.destroy();G.zones.forEach(I),Rt.clearTimeout(G.animationTimeout),ot(G,function(jt,Kt){jt instanceof ut&&!jt.survive&&jt[Ct&&Kt==="group"?"hide":"destroy"]()}),xt.hoverSeries===G&&(xt.hoverSeries=void 0),z(xt.series,G),xt.orderItems("series"),ot(G,function(jt,Kt){_&&Kt==="hcEvents"||delete G[Kt]})}applyZones(){let{area:_,chart:P,graph:D,zones:Y,points:G,xAxis:xt,yAxis:Ct,zoneAxis:Dt}=this,{inverted:jt,renderer:Kt}=P,ee=this[`${Dt}Axis`],{isXAxis:le,len:ht=0}=ee||{},st=((D==null?void 0:D.strokeWidth())||0)/2+1,Tt=(Mt,Ht=0,Vt=0)=>{jt&&(Vt=ht-Vt);let{translated:re=0,lineClip:Jt}=Mt,ye=Vt-re;Jt==null||Jt.push(["L",Ht,Math.abs(ye)<st?Vt-st*(ye<=0?-1:1):re])};if(Y.length&&(D||_)&&ee&&R(ee.min)){let Mt=ee.getExtremes().max,Ht=Jt=>{Jt.forEach((ye,ze)=>{(ye[0]==="M"||ye[0]==="L")&&(Jt[ze]=[ye[0],le?ht-ye[1]:ye[1],le?ye[2]:ht-ye[2]])})};if(Y.forEach((Jt,ye)=>{Jt.lineClip=[],Jt.translated=mt(ee.toPixels(it(Jt.value,Mt),!0)||0,0,ht)}),D&&!this.showLine&&D.hide(),_&&_.hide(),Dt==="y"&&G.length<xt.len)for(let Jt of G){let{plotX:ye,plotY:ze,zone:ge}=Jt,be=ge&&Y[Y.indexOf(ge)-1];ge&&Tt(ge,ye,ze),be&&Tt(be,ye,ze)}let Vt=[],re=ee.toPixels(ee.getExtremes().min,!0);Y.forEach(Jt=>{var xi,Ni;let ye=Jt.lineClip||[],ze=Math.round(Jt.translated||0);xt.reversed&&ye.reverse();let{clip:ge,simpleClip:be}=Jt,Oe=0,Ze=0,Ge=xt.len,Ee=Ct.len;le?(Oe=ze,Ge=re):(Ze=ze,Ee=re);let li=[["M",Oe,Ze],["L",Ge,Ze],["L",Ge,Ee],["L",Oe,Ee],["Z"]],ii=[li[0],...ye,li[1],li[2],...Vt,li[3],li[4]];Vt=ye.reverse(),re=ze,jt&&(Ht(ii),_&&Ht(li)),ge?(ge.animate({d:ii}),be==null||be.animate({d:li})):(ge=Jt.clip=Kt.path(ii),_&&(be=Jt.simpleClip=Kt.path(li))),D&&((xi=Jt.graph)==null||xi.clip(ge)),_&&((Ni=Jt.area)==null||Ni.clip(be))})}else this.visible&&(D&&D.show(),_&&_.show())}plotGroup(_,P,D,Y,G){let xt=this[_],Ct=!xt,Dt={visibility:D,zIndex:Y||.1};return rt(this.opacity)&&!this.chart.styledMode&&this.state!=="inactive"&&(Dt.opacity=this.opacity),xt||(this[_]=xt=this.chart.renderer.g().add(G)),xt.addClass("highcharts-"+P+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(rt(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(xt.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),xt.attr(Dt)[Ct?"attr":"animate"](this.getPlotBox(P)),xt}getPlotBox(_){let P=this.xAxis,D=this.yAxis,Y=this.chart,G=Y.inverted&&!Y.polar&&P&&this.invertible!==!1&&_==="series";return Y.inverted&&(P=D,D=this.xAxis),{translateX:P?P.left:Y.plotLeft,translateY:D?D.top:Y.plotTop,rotation:G?90:0,rotationOriginX:G?(P.len-D.len)/2:0,rotationOriginY:G?(P.len+D.len)/2:0,scaleX:G?-1:1,scaleY:1}}removeEvents(_){let{eventsToUnbind:P}=this;_||Q(this),P.length&&(P.forEach(D=>{D()}),P.length=0)}render(){var Kt,ee,le,ht,st;let _=this,{chart:P,options:D,hasRendered:Y}=_,G=Z(D.animation),xt=_.visible?"inherit":"hidden",Ct=D.zIndex,Dt=P.seriesGroup,jt=_.finishedAnimating?0:G.duration;y(this,"render"),_.plotGroup("group","series",xt,Ct,Dt),_.markerGroup=_.plotGroup("markerGroup","markers",xt,Ct,Dt),D.clip!==!1&&_.setClip(),jt&&((Kt=_.animate)==null||Kt.call(_,!0)),_.drawGraph&&(_.drawGraph(),_.applyZones()),_.visible&&_.drawPoints(),(ee=_.drawDataLabels)==null||ee.call(_),(le=_.redrawPoints)==null||le.call(_),D.enableMouseTracking&&((ht=_.drawTracker)==null||ht.call(_)),jt&&((st=_.animate)==null||st.call(_)),Y||(jt&&G.defer&&(jt+=G.defer),_.animationTimeout=B(()=>{_.afterAnimate()},jt||0)),_.isDirty=!1,_.hasRendered=!0,y(_,"afterRender")}redraw(){let _=this.isDirty||this.isDirtyData;this.translate(),this.render(),_&&delete this.kdTree}reserveSpace(){return this.visible||!this.chart.options.chart.ignoreHiddenSeries}searchPoint(_,P){let{xAxis:D,yAxis:Y}=this,G=this.chart.inverted;return this.searchKDTree({clientX:G?D.len-_.chartY+D.pos:_.chartX-D.pos,plotY:G?Y.len-_.chartX+Y.pos:_.chartY-Y.pos},P,_)}buildKDTree(_){this.buildingKdTree=!0;let P=this,D=P.options.findNearestPointBy.indexOf("y")>-1?2:1;delete P.kdTree,B(function(){P.kdTree=function Y(G,xt,Ct){let Dt,jt,Kt=G==null?void 0:G.length;if(Kt)return Dt=P.kdAxisArray[xt%Ct],G.sort((ee,le)=>(ee[Dt]||0)-(le[Dt]||0)),{point:G[jt=Math.floor(Kt/2)],left:Y(G.slice(0,jt),xt+1,Ct),right:Y(G.slice(jt+1),xt+1,Ct)}}(P.getValidPoints(void 0,!P.directTouch),D,D),P.buildingKdTree=!1},P.options.kdNow||(_==null?void 0:_.type)==="touchstart"?0:1)}searchKDTree(_,P,D){let Y=this,[G,xt]=this.kdAxisArray,Ct=P?"distX":"dist",Dt=(Y.options.findNearestPointBy||"").indexOf("y")>-1?2:1,jt=!!Y.isBubble;if(this.kdTree||this.buildingKdTree||this.buildKDTree(D),this.kdTree)return function Kt(ee,le,ht,st){var ge;let Tt=le.point,Mt=Y.kdAxisArray[ht%st],Ht,Vt,re=Tt;(function(be,Oe){var cr;let Ze=be[G],Ge=Oe[G],Ee=rt(Ze)&&rt(Ge)?Ze-Ge:null,li=be[xt],ii=Oe[xt],xi=rt(li)&&rt(ii)?li-ii:0,Ni=jt&&((cr=Oe.marker)==null?void 0:cr.radius)||0;Oe.dist=Math.sqrt((Ee&&Ee*Ee||0)+xi*xi)-Ni,Oe.distX=rt(Ee)?Math.abs(Ee)-Ni:Number.MAX_VALUE})(ee,Tt);let Jt=(ee[Mt]||0)-(Tt[Mt]||0)+(jt&&((ge=Tt.marker)==null?void 0:ge.radius)||0),ye=Jt<0?"left":"right",ze=Jt<0?"right":"left";return le[ye]&&(re=(Ht=Kt(ee,le[ye],ht+1,st))[Ct]<re[Ct]?Ht:Tt),le[ze]&&Math.sqrt(Jt*Jt)<re[Ct]&&(re=(Vt=Kt(ee,le[ze],ht+1,st))[Ct]<re[Ct]?Vt:re),re}(_,this.kdTree,Dt,Dt)}pointPlacementToXValue(){let{options:_,xAxis:P}=this,D=_.pointPlacement;return D==="between"&&(D=P.reversed?-.5:.5),R(D)?D*(_.pointRange||P.pointRange):0}isPointInside(_){let{chart:P,xAxis:D,yAxis:Y}=this,{plotX:G=-1,plotY:xt=-1}=_;return xt>=0&&xt<=(Y?Y.len:P.plotHeight)&&G>=0&&G<=(D?D.len:P.plotWidth)}drawTracker(){var le;let _=this,P=_.options,D=P.trackByArea,Y=[].concat((D?_.areaPath:_.graphPath)||[]),G=_.chart,xt=G.pointer,Ct=G.renderer,Dt=((le=G.options.tooltip)==null?void 0:le.snap)||0,jt=()=>{P.enableMouseTracking&&G.hoverSeries!==_&&_.onMouseOver()},Kt="rgba(192,192,192,"+($?1e-4:.002)+")",ee=_.tracker;ee?ee.attr({d:Y}):_.graph&&(_.tracker=ee=Ct.path(Y).attr({visibility:_.visible?"inherit":"hidden",zIndex:2}).addClass(D?"highcharts-tracker-area":"highcharts-tracker-line").add(_.group),G.styledMode||ee.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:Kt,fill:D?Kt:"none","stroke-width":_.graph.strokeWidth()+(D?0:2*Dt)}),[_.tracker,_.markerGroup,_.dataLabelsGroup].forEach(ht=>{ht&&(ht.addClass("highcharts-tracker").on("mouseover",jt).on("mouseout",st=>{xt.onTrackerMouseOut(st)}),P.cursor&&!G.styledMode&&ht.css({cursor:P.cursor}),q&&ht.on("touchstart",jt))})),y(this,"afterDrawTracker")}addPoint(_,P,D,Y,G){let xt,Ct,Dt=this.options,jt=this.data,Kt=this.chart,ee=this.xAxis,le=ee&&ee.hasNames&&ee.names,ht=Dt.data,st=this.xData;P=it(P,!0);let Tt={series:this};this.pointClass.prototype.applyOptions.apply(Tt,[_]);let Mt=Tt.x;if(Ct=st.length,this.requireSorting&&Mt<st[Ct-1])for(xt=!0;Ct&&st[Ct-1]>Mt;)Ct--;this.updateParallelArrays(Tt,"splice",[Ct,0,0]),this.updateParallelArrays(Tt,Ct),le&&Tt.name&&(le[Mt]=Tt.name),ht.splice(Ct,0,_),(xt||this.processedData)&&(this.data.splice(Ct,0,null),this.processData()),Dt.legendType==="point"&&this.generatePoints(),D&&(jt[0]&&jt[0].remove?jt[0].remove(!1):(jt.shift(),this.updateParallelArrays(Tt,"shift"),ht.shift())),G!==!1&&y(this,"addPoint",{point:Tt}),this.isDirty=!0,this.isDirtyData=!0,P&&Kt.redraw(Y)}removePoint(_,P,D){let Y=this,G=Y.data,xt=G[_],Ct=Y.points,Dt=Y.chart,jt=function(){Ct&&Ct.length===G.length&&Ct.splice(_,1),G.splice(_,1),Y.options.data.splice(_,1),Y.updateParallelArrays(xt||{series:Y},"splice",[_,1]),xt&&xt.destroy(),Y.isDirty=!0,Y.isDirtyData=!0,P&&Dt.redraw()};lt(D,Dt),P=it(P,!0),xt?xt.firePointEvent("remove",null,jt):jt()}remove(_,P,D,Y){let G=this,xt=G.chart;function Ct(){G.destroy(Y),xt.isDirtyLegend=xt.isDirtyBox=!0,xt.linkSeries(Y),it(_,!0)&&xt.redraw(P)}D!==!1?y(G,"remove",null,Ct):Ct()}update(_,P){var Ht,Vt,re;y(this,"update",{options:_=C(_,this.userOptions)});let D=this,Y=D.chart,G=D.userOptions,xt=D.initialType||D.type,Ct=Y.options.plotOptions,Dt=j[xt].prototype,jt=D.finishedAnimating&&{animation:!1},Kt={},ee,le,ht=["colorIndex","eventOptions","navigatorSeries","symbolIndex","baseSeries"],st=_.type||G.type||Y.options.chart.type,Tt=!(this.hasDerivedData||st&&st!==this.type||_.pointStart!==void 0||_.pointInterval!==void 0||_.relativeXValue!==void 0||_.joinBy||_.mapData||["dataGrouping","pointStart","pointInterval","pointIntervalUnit","keys"].some(Jt=>D.hasOptionChanged(Jt)));st=st||xt,Tt&&(ht.push("data","isDirtyData","isDirtyCanvas","points","processedData","processedXData","processedYData","xIncrement","cropped","_hasPointMarkers","hasDataLabels","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX"),_.visible!==!1&&ht.push("area","graph"),D.parallelArrays.forEach(function(Jt){ht.push(Jt+"Data")}),_.data&&(_.dataSorting&&g(D.options.dataSorting,_.dataSorting),this.setData(_.data,!1))),_=wt(G,{index:G.index===void 0?D.index:G.index,pointStart:((Ht=Ct==null?void 0:Ct.series)==null?void 0:Ht.pointStart)??G.pointStart??((Vt=D.xData)==null?void 0:Vt[0])},!Tt&&{data:D.options.data},_,jt),Tt&&_.data&&(_.data=D.options.data),(ht=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(ht)).forEach(function(Jt){ht[Jt]=D[Jt],delete D[Jt]});let Mt=!1;if(j[st]){if(Mt=st!==D.type,D.remove(!1,!1,!1,!0),Mt)if(Object.setPrototypeOf)Object.setPrototypeOf(D,j[st].prototype);else{let Jt=Object.hasOwnProperty.call(D,"hcEvents")&&D.hcEvents;for(le in Dt)D[le]=void 0;g(D,j[st].prototype),Jt?D.hcEvents=Jt:delete D.hcEvents}}else S(17,!0,Y,{missingModuleFor:st});if(ht.forEach(function(Jt){D[Jt]=ht[Jt]}),D.init(Y,_),Tt&&this.points)for(let Jt of((ee=D.options).visible===!1?(Kt.graphic=1,Kt.dataLabel=1):(this.hasMarkerChanged(ee,G)&&(Kt.graphic=1),(re=D.hasDataLabels)!=null&&re.call(D)||(Kt.dataLabel=1)),this.points))Jt&&Jt.series&&(Jt.resolveColor(),Object.keys(Kt).length&&Jt.destroyElements(Kt),ee.showInLegend===!1&&Jt.legendItem&&Y.legend.destroyItem(Jt));D.initialType=xt,Y.linkSeries(),Y.setSortedData(),Mt&&D.linkedSeries.length&&(D.isDirtyData=!0),y(this,"afterUpdate"),it(P,!0)&&Y.redraw(!!Tt&&void 0)}setName(_){this.name=this.options.name=this.userOptions.name=_,this.chart.isDirtyLegend=!0}hasOptionChanged(_){var Ct,Dt;let P=this.chart,D=this.options[_],Y=P.options.plotOptions,G=this.userOptions[_],xt=it((Ct=Y==null?void 0:Y[this.type])==null?void 0:Ct[_],(Dt=Y==null?void 0:Y.series)==null?void 0:Dt[_]);return G&&!rt(xt)?D!==G:D!==it(xt,D)}onMouseOver(){let _=this.chart,P=_.hoverSeries;_.pointer.setHoverChartIndex(),P&&P!==this&&P.onMouseOut(),this.options.events.mouseOver&&y(this,"mouseOver"),this.setState("hover"),_.hoverSeries=this}onMouseOut(){let _=this.options,P=this.chart,D=P.tooltip,Y=P.hoverPoint;P.hoverSeries=null,Y&&Y.onMouseOut(),this&&_.events.mouseOut&&y(this,"mouseOut"),D&&!this.stickyTracking&&(!D.shared||this.noSharedTooltip)&&D.hide(),P.series.forEach(function(G){G.setState("",!0)})}setState(_,P){let D=this,Y=D.options,G=D.graph,xt=Y.inactiveOtherPoints,Ct=Y.states,Dt=it(Ct[_||"normal"]&&Ct[_||"normal"].animation,D.chart.options.chart.animation),jt=Y.lineWidth,Kt=Y.opacity;if(_=_||"",D.state!==_&&([D.group,D.markerGroup,D.dataLabelsGroup].forEach(function(ee){ee&&(D.state&&ee.removeClass("highcharts-series-"+D.state),_&&ee.addClass("highcharts-series-"+_))}),D.state=_,!D.chart.styledMode)){if(Ct[_]&&Ct[_].enabled===!1)return;if(_&&(jt=Ct[_].lineWidth||jt+(Ct[_].lineWidthPlus||0),Kt=it(Ct[_].opacity,Kt)),G&&!G.dashstyle&&R(jt))for(let ee of[G,...this.zones.map(le=>le.graph)])ee==null||ee.animate({"stroke-width":jt},Dt);xt||[D.group,D.markerGroup,D.dataLabelsGroup,D.labelBySeries].forEach(function(ee){ee&&ee.animate({opacity:Kt},Dt)})}P&&xt&&D.points&&D.setAllPointsToState(_||void 0)}setAllPointsToState(_){this.points.forEach(function(P){P.setState&&P.setState(_)})}setVisible(_,P){var Dt;let D=this,Y=D.chart,G=Y.options.chart.ignoreHiddenSeries,xt=D.visible;D.visible=_=D.options.visible=D.userOptions.visible=_===void 0?!xt:_;let Ct=_?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(jt=>{var Kt;(Kt=D[jt])==null||Kt[Ct]()}),(Y.hoverSeries===D||((Dt=Y.hoverPoint)==null?void 0:Dt.series)===D)&&D.onMouseOut(),D.legendItem&&Y.legend.colorizeItem(D,_),D.isDirty=!0,D.options.stacking&&Y.series.forEach(jt=>{jt.options.stacking&&jt.visible&&(jt.isDirty=!0)}),D.linkedSeries.forEach(jt=>{jt.setVisible(_,!1)}),G&&(Y.isDirtyBox=!0),y(D,Ct),P!==!1&&Y.redraw()}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}select(_){this.selected=_=this.options.selected=_===void 0?!this.selected:_,this.checkbox&&(this.checkbox.checked=_),y(this,_?"select":"unselect")}shouldShowTooltip(_,P,D={}){return D.series=this,D.visiblePlotOnly=!0,this.chart.isInsidePlot(_,P,D)}drawLegendSymbol(_,P){var D;(D=dt[this.options.legendSymbol||"rectangle"])==null||D.call(this,_,P)}}return K.defaultOptions=Lt,K.types=kt.seriesTypes,K.registerType=kt.registerSeriesType,g(K.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,directTouch:!1,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:Nt,requireSorting:!0,sorted:!0}),kt.series=K,K}),te(X,"Core/Chart/Chart.js",[X["Core/Animation/AnimationUtilities.js"],X["Core/Axis/Axis.js"],X["Core/Defaults.js"],X["Core/Templating.js"],X["Core/Foundation.js"],X["Core/Globals.js"],X["Core/Renderer/RendererRegistry.js"],X["Core/Series/Series.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Renderer/SVG/SVGRenderer.js"],X["Core/Time.js"],X["Core/Utilities.js"],X["Core/Renderer/HTML/AST.js"],X["Core/Axis/Tick.js"]],function(Et,At,l,Zt,dt,Nt,Lt,kt,ut,Rt,Z,lt,at,W){let{animate:q,animObject:$,setAnimation:U}=Et,{defaultOptions:j,defaultTime:et}=l,{numberFormat:_t}=Zt,{registerEventOptions:mt}=dt,{charts:V,doc:rt,marginNames:I,svg:C,win:z}=Nt,{seriesTypes:S}=ut,{addEvent:g,attr:v,createElement:y,clamp:T,css:k,defined:E,diffObjects:w,discardElement:R,erase:J,error:wt,extend:ot,find:it,fireEvent:Q,getStyle:A,isArray:B,isNumber:K,isObject:pt,isString:_,merge:P,objectEach:D,pick:Y,pInt:G,relativeLength:xt,removeEvent:Ct,splat:Dt,syncTimeout:jt,uniqueKey:Kt}=lt;class ee{static chart(ht,st,Tt){return new ee(ht,st,Tt)}constructor(ht,st,Tt){this.sharedClips={};let Mt=[...arguments];(_(ht)||ht.nodeName)&&(this.renderTo=Mt.shift()),this.init(Mt[0],Mt[1])}setZoomOptions(){let ht=this.options.chart,st=ht.zooming;this.zooming={...st,type:Y(ht.zoomType,st.type),key:Y(ht.zoomKey,st.key),pinchType:Y(ht.pinchType,st.pinchType),singleTouch:Y(ht.zoomBySingleTouch,st.singleTouch,!1),resetButton:P(st.resetButton,ht.resetZoomButton)}}init(ht,st){Q(this,"init",{args:arguments},function(){let Tt=P(j,ht),Mt=Tt.chart;this.userOptions=ot({},ht),this.margin=[],this.spacing=[],this.bounds={h:{},v:{}},this.labelCollectors=[],this.callback=st,this.isResizing=0,this.options=Tt,this.axes=[],this.series=[],this.time=ht.time&&Object.keys(ht.time).length?new Z(ht.time):Nt.time,this.numberFormatter=Mt.numberFormatter||_t,this.styledMode=Mt.styledMode,this.hasCartesianSeries=Mt.showAxes,this.index=V.length,V.push(this),Nt.chartCount++,mt(this,Mt),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.setZoomOptions(),Q(this,"afterInit"),this.firstRender()})}initSeries(ht){let st=this.options.chart,Tt=ht.type||st.type,Mt=S[Tt];Mt||wt(17,!0,this,{missingModuleFor:Tt});let Ht=new Mt;return typeof Ht.init=="function"&&Ht.init(this,ht),Ht}setSortedData(){this.getSeriesOrderByLinks().forEach(function(ht){ht.points||ht.data||!ht.enabledDataSorting||ht.setData(ht.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(ht,st){return ht.linkedSeries.length||st.linkedSeries.length?st.linkedSeries.length-ht.linkedSeries.length:0})}orderItems(ht,st=0){let Tt=this[ht],Mt=this.options[ht]=Dt(this.options[ht]).slice(),Ht=this.userOptions[ht]=this.userOptions[ht]?Dt(this.userOptions[ht]).slice():[];if(this.hasRendered&&(Mt.splice(st),Ht.splice(st)),Tt)for(let Vt=st,re=Tt.length;Vt<re;++Vt){let Jt=Tt[Vt];Jt&&(Jt.index=Vt,Jt instanceof kt&&(Jt.name=Jt.getName()),Jt.options.isInternal||(Mt[Vt]=Jt.options,Ht[Vt]=Jt.userOptions))}}isInsidePlot(ht,st,Tt={}){let{inverted:Mt,plotBox:Ht,plotLeft:Vt,plotTop:re,scrollablePlotBox:Jt}=this,ye=0,ze=0;Tt.visiblePlotOnly&&this.scrollingContainer&&({scrollLeft:ye,scrollTop:ze}=this.scrollingContainer);let ge=Tt.series,be=Tt.visiblePlotOnly&&Jt||Ht,Oe=Tt.inverted?st:ht,Ze=Tt.inverted?ht:st,Ge={x:Oe,y:Ze,isInsidePlot:!0,options:Tt};if(!Tt.ignoreX){let Ee=ge&&(Mt&&!this.polar?ge.yAxis:ge.xAxis)||{pos:Vt,len:1/0},li=Tt.paneCoordinates?Ee.pos+Oe:Vt+Oe;li>=Math.max(ye+Vt,Ee.pos)&&li<=Math.min(ye+Vt+be.width,Ee.pos+Ee.len)||(Ge.isInsidePlot=!1)}if(!Tt.ignoreY&&Ge.isInsidePlot){let Ee=!Mt&&Tt.axis&&!Tt.axis.isXAxis&&Tt.axis||ge&&(Mt?ge.xAxis:ge.yAxis)||{pos:re,len:1/0},li=Tt.paneCoordinates?Ee.pos+Ze:re+Ze;li>=Math.max(ze+re,Ee.pos)&&li<=Math.min(ze+re+be.height,Ee.pos+Ee.len)||(Ge.isInsidePlot=!1)}return Q(this,"afterIsInsidePlot",Ge),Ge.isInsidePlot}redraw(ht){Q(this,"beforeRedraw");let st=this.hasCartesianSeries?this.axes:this.colorAxis||[],Tt=this.series,Mt=this.pointer,Ht=this.legend,Vt=this.userOptions.legend,re=this.renderer,Jt=re.isHidden(),ye=[],ze,ge,be,Oe=this.isDirtyBox,Ze=this.isDirtyLegend,Ge;for(re.rootFontSize=re.boxWrapper.getStyle("font-size"),this.setResponsive&&this.setResponsive(!1),U(!!this.hasRendered&&ht,this),Jt&&this.temporaryDisplay(),this.layOutTitles(!1),be=Tt.length;be--;)if(((Ge=Tt[be]).options.stacking||Ge.options.centerInCategory)&&(ge=!0,Ge.isDirty)){ze=!0;break}if(ze)for(be=Tt.length;be--;)(Ge=Tt[be]).options.stacking&&(Ge.isDirty=!0);Tt.forEach(function(Ee){Ee.isDirty&&(Ee.options.legendType==="point"?(typeof Ee.updateTotals=="function"&&Ee.updateTotals(),Ze=!0):Vt&&(Vt.labelFormatter||Vt.labelFormat)&&(Ze=!0)),Ee.isDirtyData&&Q(Ee,"updatedData")}),Ze&&Ht&&Ht.options.enabled&&(Ht.render(),this.isDirtyLegend=!1),ge&&this.getStacks(),st.forEach(function(Ee){Ee.updateNames(),Ee.setScale()}),this.getMargins(),st.forEach(function(Ee){Ee.isDirty&&(Oe=!0)}),st.forEach(function(Ee){let li=Ee.min+","+Ee.max;Ee.extKey!==li&&(Ee.extKey=li,ye.push(function(){Q(Ee,"afterSetExtremes",ot(Ee.eventArgs,Ee.getExtremes())),delete Ee.eventArgs})),(Oe||ge)&&Ee.redraw()}),Oe&&this.drawChartBox(),Q(this,"predraw"),Tt.forEach(function(Ee){(Oe||Ee.isDirty)&&Ee.visible&&Ee.redraw(),Ee.isDirtyData=!1}),Mt&&Mt.reset(!0),re.draw(),Q(this,"redraw"),Q(this,"render"),Jt&&this.temporaryDisplay(!0),ye.forEach(function(Ee){Ee.call()})}get(ht){let st=this.series;function Tt(Ht){return Ht.id===ht||Ht.options&&Ht.options.id===ht}let Mt=it(this.axes,Tt)||it(this.series,Tt);for(let Ht=0;!Mt&&Ht<st.length;Ht++)Mt=it(st[Ht].points||[],Tt);return Mt}getAxes(){let ht=this.userOptions;for(let st of(Q(this,"getAxes"),["xAxis","yAxis"])){let Tt=ht[st]=Dt(ht[st]||{});for(let Mt of Tt)new At(this,Mt,st)}Q(this,"afterGetAxes")}getSelectedPoints(){return this.series.reduce((ht,st)=>(st.getPointsCollection().forEach(Tt=>{Y(Tt.selectedStaging,Tt.selected)&&ht.push(Tt)}),ht),[])}getSelectedSeries(){return this.series.filter(function(ht){return ht.selected})}setTitle(ht,st,Tt){this.applyDescription("title",ht),this.applyDescription("subtitle",st),this.applyDescription("caption",void 0),this.layOutTitles(Tt)}applyDescription(ht,st){let Tt=this,Mt=this.options[ht]=P(this.options[ht],st),Ht=this[ht];Ht&&st&&(this[ht]=Ht=Ht.destroy()),Mt&&!Ht&&((Ht=this.renderer.text(Mt.text,0,0,Mt.useHTML).attr({align:Mt.align,class:"highcharts-"+ht,zIndex:Mt.zIndex||4}).add()).update=function(Vt,re){Tt.applyDescription(ht,Vt),Tt.layOutTitles(re)},this.styledMode||Ht.css(ot(ht==="title"?{fontSize:this.options.isStock?"1em":"1.2em"}:{},Mt.style)),this[ht]=Ht)}layOutTitles(ht=!0){let st=[0,0,0],Tt=this.renderer,Mt=this.spacingBox;["title","subtitle","caption"].forEach(function(Vt){let re=this[Vt],Jt=this.options[Vt],ye=Jt.verticalAlign||"top",ze=Vt==="title"?ye==="top"?-3:0:ye==="top"?st[0]+2:0;if(re){re.css({width:(Jt.width||Mt.width+(Jt.widthAdjust||0))+"px"});let ge=Tt.fontMetrics(re).b,be=Math.round(re.getBBox(Jt.useHTML).height);re.align(ot({y:ye==="bottom"?ge:ze+ge,height:be},Jt),!1,"spacingBox"),Jt.floating||(ye==="top"?st[0]=Math.ceil(st[0]+be):ye==="bottom"&&(st[2]=Math.ceil(st[2]+be)))}},this),st[0]&&(this.options.title.verticalAlign||"top")==="top"&&(st[0]+=this.options.title.margin),st[2]&&this.options.caption.verticalAlign==="bottom"&&(st[2]+=this.options.caption.margin);let Ht=!this.titleOffset||this.titleOffset.join(",")!==st.join(",");this.titleOffset=st,Q(this,"afterLayOutTitles"),!this.isDirtyBox&&Ht&&(this.isDirtyBox=this.isDirtyLegend=Ht,this.hasRendered&&ht&&this.isDirtyBox&&this.redraw())}getContainerBox(){return{width:A(this.renderTo,"width",!0)||0,height:A(this.renderTo,"height",!0)||0}}getChartSize(){let ht=this.options.chart,st=ht.width,Tt=ht.height,Mt=this.getContainerBox();this.chartWidth=Math.max(0,st||Mt.width||600),this.chartHeight=Math.max(0,xt(Tt,this.chartWidth)||(Mt.height>1?Mt.height:400)),this.containerBox=Mt}temporaryDisplay(ht){let st=this.renderTo,Tt;if(ht)for(;st&&st.style;)st.hcOrigStyle&&(k(st,st.hcOrigStyle),delete st.hcOrigStyle),st.hcOrigDetached&&(rt.body.removeChild(st),st.hcOrigDetached=!1),st=st.parentNode;else for(;st&&st.style&&(rt.body.contains(st)||st.parentNode||(st.hcOrigDetached=!0,rt.body.appendChild(st)),(A(st,"display",!1)==="none"||st.hcOricDetached)&&(st.hcOrigStyle={display:st.style.display,height:st.style.height,overflow:st.style.overflow},Tt={display:"block",overflow:"hidden"},st!==this.renderTo&&(Tt.height=0),k(st,Tt),st.offsetWidth||st.style.setProperty("display","block","important")),(st=st.parentNode)!==rt.body););}setClassName(ht){this.container.className="highcharts-container "+(ht||"")}getContainer(){let ht=this.options,st=ht.chart,Tt="data-highcharts-chart",Mt=Kt(),Ht,Vt=this.renderTo;Vt||(this.renderTo=Vt=st.renderTo),_(Vt)&&(this.renderTo=Vt=rt.getElementById(Vt)),Vt||wt(13,!0,this);let re=G(v(Vt,Tt));K(re)&&V[re]&&V[re].hasRendered&&V[re].destroy(),v(Vt,Tt,this.index),Vt.innerHTML=at.emptyHTML,st.skipClone||Vt.offsetWidth||this.temporaryDisplay(),this.getChartSize();let Jt=this.chartWidth,ye=this.chartHeight;k(Vt,{overflow:"hidden"}),this.styledMode||(Ht=ot({position:"relative",overflow:"hidden",width:Jt+"px",height:ye+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none"},st.style||{}));let ze=y("div",{id:Mt},Ht,Vt);this.container=ze,this._cursor=ze.style.cursor;let ge=st.renderer||!C?Lt.getRendererType(st.renderer):Rt;if(this.renderer=new ge(ze,Jt,ye,void 0,st.forExport,ht.exporting&&ht.exporting.allowHTML,this.styledMode),this.containerBox=this.getContainerBox(),U(void 0,this),this.setClassName(st.className),this.styledMode)for(let be in ht.defs)this.renderer.definition(ht.defs[be]);else this.renderer.setStyle(st.style);this.renderer.chartIndex=this.index,Q(this,"afterGetContainer")}getMargins(ht){let{spacing:st,margin:Tt,titleOffset:Mt}=this;this.resetMargins(),Mt[0]&&!E(Tt[0])&&(this.plotTop=Math.max(this.plotTop,Mt[0]+st[0])),Mt[2]&&!E(Tt[2])&&(this.marginBottom=Math.max(this.marginBottom,Mt[2]+st[2])),this.legend&&this.legend.display&&this.legend.adjustMargins(Tt,st),Q(this,"getMargins"),ht||this.getAxisMargins()}getAxisMargins(){let ht=this,st=ht.axisOffset=[0,0,0,0],Tt=ht.colorAxis,Mt=ht.margin,Ht=function(Vt){Vt.forEach(function(re){re.visible&&re.getOffset()})};ht.hasCartesianSeries?Ht(ht.axes):Tt&&Tt.length&&Ht(Tt),I.forEach(function(Vt,re){E(Mt[re])||(ht[Vt]+=st[re])}),ht.setChartSize()}getOptions(){return w(this.userOptions,j)}reflow(ht){let st=this,Tt=st.containerBox,Mt=st.getContainerBox();delete st.pointer.chartPosition,!st.isPrinting&&!st.isResizing&&Tt&&Mt.width&&((Mt.width!==Tt.width||Mt.height!==Tt.height)&&(lt.clearTimeout(st.reflowTimeout),st.reflowTimeout=jt(function(){st.container&&st.setSize(void 0,void 0,!1)},ht?100:0)),st.containerBox=Mt)}setReflow(){let ht=this,st=Tt=>{var Mt;(Mt=ht.options)!=null&&Mt.chart.reflow&&ht.hasLoaded&&ht.reflow(Tt)};if(typeof ResizeObserver=="function")new ResizeObserver(st).observe(ht.renderTo);else{let Tt=g(z,"resize",st);g(this,"destroy",Tt)}}setSize(ht,st,Tt){let Mt=this,Ht=Mt.renderer;Mt.isResizing+=1,U(Tt,Mt);let Vt=Ht.globalAnimation;Mt.oldChartHeight=Mt.chartHeight,Mt.oldChartWidth=Mt.chartWidth,ht!==void 0&&(Mt.options.chart.width=ht),st!==void 0&&(Mt.options.chart.height=st),Mt.getChartSize();let{chartWidth:re,chartHeight:Jt,scrollablePixelsX:ye=0,scrollablePixelsY:ze=0}=Mt;(Mt.isDirtyBox||re!==Mt.oldChartWidth||Jt!==Mt.oldChartHeight)&&(Mt.styledMode||(Vt?q:k)(Mt.container,{width:`${re+ye}px`,height:`${Jt+ze}px`},Vt),Mt.setChartSize(!0),Ht.setSize(re,Jt,Vt),Mt.axes.forEach(function(ge){ge.isDirty=!0,ge.setScale()}),Mt.isDirtyLegend=!0,Mt.isDirtyBox=!0,Mt.layOutTitles(),Mt.getMargins(),Mt.redraw(Vt),Mt.oldChartHeight=void 0,Q(Mt,"resize"),setTimeout(()=>{Mt&&Q(Mt,"endResize",void 0,()=>{Mt.isResizing-=1})},$(Vt).duration))}setChartSize(ht){let st,Tt,Mt,Ht,Vt=this.inverted,re=this.renderer,Jt=this.chartWidth,ye=this.chartHeight,ze=this.options.chart,ge=this.spacing,be=this.clipOffset;this.plotLeft=st=Math.round(this.plotLeft),this.plotTop=Tt=Math.round(this.plotTop),this.plotWidth=Mt=Math.max(0,Math.round(Jt-st-this.marginRight)),this.plotHeight=Ht=Math.max(0,Math.round(ye-Tt-this.marginBottom)),this.plotSizeX=Vt?Ht:Mt,this.plotSizeY=Vt?Mt:Ht,this.plotBorderWidth=ze.plotBorderWidth||0,this.spacingBox=re.spacingBox={x:ge[3],y:ge[0],width:Jt-ge[3]-ge[1],height:ye-ge[0]-ge[2]},this.plotBox=re.plotBox={x:st,y:Tt,width:Mt,height:Ht};let Oe=2*Math.floor(this.plotBorderWidth/2),Ze=Math.ceil(Math.max(Oe,be[3])/2),Ge=Math.ceil(Math.max(Oe,be[0])/2);this.clipBox={x:Ze,y:Ge,width:Math.floor(this.plotSizeX-Math.max(Oe,be[1])/2-Ze),height:Math.max(0,Math.floor(this.plotSizeY-Math.max(Oe,be[2])/2-Ge))},ht||(this.axes.forEach(function(Ee){Ee.setAxisSize(),Ee.setAxisTranslation()}),re.alignElements()),Q(this,"afterSetChartSize",{skipAxes:ht})}resetMargins(){Q(this,"resetMargins");let ht=this,st=ht.options.chart;["margin","spacing"].forEach(function(Tt){let Mt=st[Tt],Ht=pt(Mt)?Mt:[Mt,Mt,Mt,Mt];["Top","Right","Bottom","Left"].forEach(function(Vt,re){ht[Tt][re]=Y(st[Tt+Vt],Ht[re])})}),I.forEach(function(Tt,Mt){ht[Tt]=Y(ht.margin[Mt],ht.spacing[Mt])}),ht.axisOffset=[0,0,0,0],ht.clipOffset=[0,0,0,0]}drawChartBox(){let ht=this.options.chart,st=this.renderer,Tt=this.chartWidth,Mt=this.chartHeight,Ht=this.styledMode,Vt=this.plotBGImage,re=ht.backgroundColor,Jt=ht.plotBackgroundColor,ye=ht.plotBackgroundImage,ze=this.plotLeft,ge=this.plotTop,be=this.plotWidth,Oe=this.plotHeight,Ze=this.plotBox,Ge=this.clipRect,Ee=this.clipBox,li=this.chartBackground,ii=this.plotBackground,xi=this.plotBorder,Ni,cr,Li,F="animate";li||(this.chartBackground=li=st.rect().addClass("highcharts-background").add(),F="attr"),Ht?Ni=cr=li.strokeWidth():(cr=(Ni=ht.borderWidth||0)+(ht.shadow?8:0),Li={fill:re||"none"},(Ni||li["stroke-width"])&&(Li.stroke=ht.borderColor,Li["stroke-width"]=Ni),li.attr(Li).shadow(ht.shadow)),li[F]({x:cr/2,y:cr/2,width:Tt-cr-Ni%2,height:Mt-cr-Ni%2,r:ht.borderRadius}),F="animate",ii||(F="attr",this.plotBackground=ii=st.rect().addClass("highcharts-plot-background").add()),ii[F](Ze),!Ht&&(ii.attr({fill:Jt||"none"}).shadow(ht.plotShadow),ye&&(Vt?(ye!==Vt.attr("href")&&Vt.attr("href",ye),Vt.animate(Ze)):this.plotBGImage=st.image(ye,ze,ge,be,Oe).add())),Ge?Ge.animate({width:Ee.width,height:Ee.height}):this.clipRect=st.clipRect(Ee),F="animate",xi||(F="attr",this.plotBorder=xi=st.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),Ht||xi.attr({stroke:ht.plotBorderColor,"stroke-width":ht.plotBorderWidth||0,fill:"none"}),xi[F](xi.crisp({x:ze,y:ge,width:be,height:Oe},-xi.strokeWidth())),this.isDirtyBox=!1,Q(this,"afterDrawChartBox")}propFromSeries(){let ht,st,Tt,Mt=this,Ht=Mt.options.chart,Vt=Mt.options.series;["inverted","angular","polar"].forEach(function(re){for(st=S[Ht.type],Tt=Ht[re]||st&&st.prototype[re],ht=Vt&&Vt.length;!Tt&&ht--;)(st=S[Vt[ht].type])&&st.prototype[re]&&(Tt=!0);Mt[re]=Tt})}linkSeries(ht){let st=this,Tt=st.series;Tt.forEach(function(Mt){Mt.linkedSeries.length=0}),Tt.forEach(function(Mt){let{linkedTo:Ht}=Mt.options;if(_(Ht)){let Vt;(Vt=Ht===":previous"?st.series[Mt.index-1]:st.get(Ht))&&Vt.linkedParent!==Mt&&(Vt.linkedSeries.push(Mt),Mt.linkedParent=Vt,Vt.enabledDataSorting&&Mt.setDataSortingOptions(),Mt.visible=Y(Mt.options.visible,Vt.options.visible,Mt.visible))}}),Q(this,"afterLinkSeries",{isUpdating:ht})}renderSeries(){this.series.forEach(function(ht){ht.translate(),ht.render()})}render(){var ze;let ht=this.axes,st=this.colorAxis,Tt=this.renderer,Mt=this.options.chart.axisLayoutRuns||2,Ht=ge=>{ge.forEach(be=>{be.visible&&be.render()})},Vt=0,re=!0,Jt,ye=0;for(let ge of(this.setTitle(),Q(this,"beforeMargins"),(ze=this.getStacks)==null||ze.call(this),this.getMargins(!0),this.setChartSize(),ht)){let{options:be}=ge,{labels:Oe}=be;if(ge.horiz&&ge.visible&&Oe.enabled&&ge.series.length&&ge.coll!=="colorAxis"&&!this.polar){Vt=be.tickLength,ge.createGroups();let Ze=new W(ge,0,"",!0),Ge=Ze.createLabel("x",Oe);if(Ze.destroy(),Ge&&Y(Oe.reserveSpace,!K(be.crossing))&&(Vt=Ge.getBBox().height+Oe.distance+Math.max(be.offset||0,0)),Vt){Ge==null||Ge.destroy();break}}}for(this.plotHeight=Math.max(this.plotHeight-Vt,0);(re||Jt||Mt>1)&&ye<Mt;){let ge=this.plotWidth,be=this.plotHeight;for(let Oe of ht)ye===0?Oe.setScale():(Oe.horiz&&re||!Oe.horiz&&Jt)&&Oe.setTickInterval(!0);ye===0?this.getAxisMargins():this.getMargins(),re=ge/this.plotWidth>(ye?1:1.1),Jt=be/this.plotHeight>(ye?1:1.05),ye++}this.drawChartBox(),this.hasCartesianSeries?Ht(ht):st&&st.length&&Ht(st),this.seriesGroup||(this.seriesGroup=Tt.g("series-group").attr({zIndex:3}).shadow(this.options.chart.seriesGroupShadow).add()),this.renderSeries(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0}addCredits(ht){let st=this,Tt=P(!0,this.options.credits,ht);Tt.enabled&&!this.credits&&(this.credits=this.renderer.text(Tt.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){Tt.href&&(z.location.href=Tt.href)}).attr({align:Tt.position.align,zIndex:8}),st.styledMode||this.credits.css(Tt.style),this.credits.add().align(Tt.position),this.credits.update=function(Mt){st.credits=st.credits.destroy(),st.addCredits(Mt)})}destroy(){let ht,st=this,Tt=st.axes,Mt=st.series,Ht=st.container,Vt=Ht&&Ht.parentNode;for(Q(st,"destroy"),st.renderer.forExport?J(V,st):V[st.index]=void 0,Nt.chartCount--,st.renderTo.removeAttribute("data-highcharts-chart"),Ct(st),ht=Tt.length;ht--;)Tt[ht]=Tt[ht].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),ht=Mt.length;ht--;)Mt[ht]=Mt[ht].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(function(re){let Jt=st[re];Jt&&Jt.destroy&&(st[re]=Jt.destroy())}),Ht&&(Ht.innerHTML=at.emptyHTML,Ct(Ht),Vt&&R(Ht)),D(st,function(re,Jt){delete st[Jt]})}firstRender(){let ht=this,st=ht.options;ht.getContainer(),ht.resetMargins(),ht.setChartSize(),ht.propFromSeries(),ht.getAxes();let Tt=B(st.series)?st.series:[];st.series=[],Tt.forEach(function(Mt){ht.initSeries(Mt)}),ht.linkSeries(),ht.setSortedData(),Q(ht,"beforeRender"),ht.render(),ht.pointer.getChartPosition(),ht.renderer.imgCount||ht.hasLoaded||ht.onload(),ht.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(ht){ht&&this.index!==void 0&&ht.apply(this,[this])},this),Q(this,"load"),Q(this,"render"),E(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){let{options:ht,title:st}=this;!ht||this.accessibility||(this.renderer.boxWrapper.attr({role:"img","aria-label":(st&&st.element.textContent||"").replace(/</g,"&lt;")}),ht.accessibility&&ht.accessibility.enabled===!1||wt('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(ht,st,Tt){let Mt,Ht=this;return ht&&(st=Y(st,!0),Q(Ht,"addSeries",{options:ht},function(){Mt=Ht.initSeries(ht),Ht.isDirtyLegend=!0,Ht.linkSeries(),Mt.enabledDataSorting&&Mt.setData(ht.data,!1),Q(Ht,"afterAddSeries",{series:Mt}),st&&Ht.redraw(Tt)})),Mt}addAxis(ht,st,Tt,Mt){return this.createAxis(st?"xAxis":"yAxis",{axis:ht,redraw:Tt,animation:Mt})}addColorAxis(ht,st,Tt){return this.createAxis("colorAxis",{axis:ht,redraw:st,animation:Tt})}createAxis(ht,st){let Tt=new At(this,st.axis,ht);return Y(st.redraw,!0)&&this.redraw(st.animation),Tt}showLoading(ht){let st=this,Tt=st.options,Mt=Tt.loading,Ht=function(){Vt&&k(Vt,{left:st.plotLeft+"px",top:st.plotTop+"px",width:st.plotWidth+"px",height:st.plotHeight+"px"})},Vt=st.loadingDiv,re=st.loadingSpan;Vt||(st.loadingDiv=Vt=y("div",{className:"highcharts-loading highcharts-loading-hidden"},null,st.container)),re||(st.loadingSpan=re=y("span",{className:"highcharts-loading-inner"},null,Vt),g(st,"redraw",Ht)),Vt.className="highcharts-loading",at.setElementHTML(re,Y(ht,Tt.lang.loading,"")),st.styledMode||(k(Vt,ot(Mt.style,{zIndex:10})),k(re,Mt.labelStyle),st.loadingShown||(k(Vt,{opacity:0,display:""}),q(Vt,{opacity:Mt.style.opacity||.5},{duration:Mt.showDuration||0}))),st.loadingShown=!0,Ht()}hideLoading(){let ht=this.options,st=this.loadingDiv;st&&(st.className="highcharts-loading highcharts-loading-hidden",this.styledMode||q(st,{opacity:0},{duration:ht.loading.hideDuration||100,complete:function(){k(st,{display:"none"})}})),this.loadingShown=!1}update(ht,st,Tt,Mt){let Ht,Vt,re,Jt=this,ye={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},ze=ht.isResponsiveOptions,ge=[];Q(Jt,"update",{options:ht}),ze||Jt.setResponsive(!1,!0),ht=w(ht,Jt.options),Jt.userOptions=P(Jt.userOptions,ht);let be=ht.chart;be&&(P(!0,Jt.options.chart,be),this.setZoomOptions(),"className"in be&&Jt.setClassName(be.className),("inverted"in be||"polar"in be||"type"in be)&&(Jt.propFromSeries(),Ht=!0),"alignTicks"in be&&(Ht=!0),"events"in be&&mt(this,be),D(be,function(Ge,Ee){Jt.propsRequireUpdateSeries.indexOf("chart."+Ee)!==-1&&(Vt=!0),Jt.propsRequireDirtyBox.indexOf(Ee)!==-1&&(Jt.isDirtyBox=!0),Jt.propsRequireReflow.indexOf(Ee)===-1||(Jt.isDirtyBox=!0,ze||(re=!0))}),!Jt.styledMode&&be.style&&Jt.renderer.setStyle(Jt.options.chart.style||{})),!Jt.styledMode&&ht.colors&&(this.options.colors=ht.colors),ht.time&&(this.time===et&&(this.time=new Z(ht.time)),P(!0,Jt.options.time,ht.time)),D(ht,function(Ge,Ee){Jt[Ee]&&typeof Jt[Ee].update=="function"?Jt[Ee].update(Ge,!1):typeof Jt[ye[Ee]]=="function"?Jt[ye[Ee]](Ge):Ee!=="colors"&&Jt.collectionsWithUpdate.indexOf(Ee)===-1&&P(!0,Jt.options[Ee],ht[Ee]),Ee!=="chart"&&Jt.propsRequireUpdateSeries.indexOf(Ee)!==-1&&(Vt=!0)}),this.collectionsWithUpdate.forEach(function(Ge){ht[Ge]&&(Dt(ht[Ge]).forEach(function(Ee,li){let ii,xi=E(Ee.id);xi&&(ii=Jt.get(Ee.id)),!ii&&Jt[Ge]&&(ii=Jt[Ge][Y(Ee.index,li)])&&(xi&&E(ii.options.id)||ii.options.isInternal)&&(ii=void 0),ii&&ii.coll===Ge&&(ii.update(Ee,!1),Tt&&(ii.touched=!0)),!ii&&Tt&&Jt.collectionsWithInit[Ge]&&(Jt.collectionsWithInit[Ge][0].apply(Jt,[Ee].concat(Jt.collectionsWithInit[Ge][1]||[]).concat([!1])).touched=!0)}),Tt&&Jt[Ge].forEach(function(Ee){Ee.touched||Ee.options.isInternal?delete Ee.touched:ge.push(Ee)}))}),ge.forEach(function(Ge){Ge.chart&&Ge.remove&&Ge.remove(!1)}),Ht&&Jt.axes.forEach(function(Ge){Ge.update({},!1)}),Vt&&Jt.getSeriesOrderByLinks().forEach(function(Ge){Ge.chart&&Ge.update({},!1)},this);let Oe=be&&be.width,Ze=be&&(_(be.height)?xt(be.height,Oe||Jt.chartWidth):be.height);re||K(Oe)&&Oe!==Jt.chartWidth||K(Ze)&&Ze!==Jt.chartHeight?Jt.setSize(Oe,Ze,Mt):Y(st,!0)&&Jt.redraw(Mt),Q(Jt,"afterUpdate",{options:ht,redraw:st,animation:Mt})}setSubtitle(ht,st){this.applyDescription("subtitle",ht),this.layOutTitles(st)}setCaption(ht,st){this.applyDescription("caption",ht),this.layOutTitles(st)}showResetZoom(){let ht=this,st=j.lang,Tt=ht.zooming.resetButton,Mt=Tt.theme,Ht=Tt.relativeTo==="chart"||Tt.relativeTo==="spacingBox"?null:"scrollablePlotBox";function Vt(){ht.zoomOut()}Q(this,"beforeShowResetZoom",null,function(){ht.resetZoomButton=ht.renderer.button(st.resetZoom,null,null,Vt,Mt).attr({align:Tt.position.align,title:st.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(Tt.position,!1,Ht)}),Q(this,"afterShowResetZoom")}zoomOut(){Q(this,"selection",{resetSelection:!0},this.zoom)}zoom(ht){let st=this,Tt=st.pointer,Mt=!1,Ht;!ht||ht.resetSelection?(st.axes.forEach(function(re){Ht=re.zoom()}),Tt.initiated=!1):ht.xAxis.concat(ht.yAxis).forEach(function(re){let Jt=re.axis,ye=Jt.isXAxis,{hasPinched:ze,mouseDownX:ge,mouseDownY:be}=Tt;(Tt[ye?"zoomX":"zoomY"]&&E(ge)&&E(be)&&st.isInsidePlot(ge-st.plotLeft,be-st.plotTop,{axis:Jt,ignoreX:ze,ignoreY:ze})||!E(st.inverted?ge:be))&&(Ht=Jt.zoom(re.min,re.max),Jt.displayBtn&&(Mt=!0))});let Vt=st.resetZoomButton;Mt&&!Vt?st.showResetZoom():!Mt&&pt(Vt)&&(st.resetZoomButton=Vt.destroy()),Ht&&st.redraw(Y(st.options.chart.animation,ht&&ht.animation,st.pointCount<100))}pan(ht,st){let Tt,Mt=this,Ht=Mt.hoverPoints,Vt=typeof st=="object"?st:{enabled:st,type:"x"},re=Mt.options.chart;re&&re.panning&&(re.panning=Vt);let Jt=Vt.type;Q(this,"pan",{originalEvent:ht},function(){Ht&&Ht.forEach(function(ge){ge.setState()});let ye=Mt.xAxis;Jt==="xy"?ye=ye.concat(Mt.yAxis):Jt==="y"&&(ye=Mt.yAxis);let ze={};ye.forEach(function(ge){if(!ge.options.panningEnabled||ge.options.isInternal)return;let be=ge.horiz,Oe=ht[be?"chartX":"chartY"],Ze=be?"mouseDownX":"mouseDownY",Ge=Mt[Ze],Ee=ge.minPointOffset||0,li=ge.reversed&&!Mt.inverted||!ge.reversed&&Mt.inverted?-1:1,ii=ge.getExtremes(),xi=ge.toValue(Ge-Oe,!0)+Ee*li,Ni=ge.toValue(Ge+ge.len-Oe,!0)-(Ee*li||ge.isXAxis&&ge.pointRangePadding||0),cr=Ni<xi,Li=ge.hasVerticalPanning(),F=cr?Ni:xi,tt=cr?xi:Ni,ct=ge.panningState,St;Li&&!ge.isXAxis&&(!ct||ct.isDirty)&&ge.series.forEach(function($t){let yt=$t.getProcessedData(!0),Ut=$t.getExtremes(yt.yData,!0);ct||(ct={startMin:Number.MAX_VALUE,startMax:-Number.MAX_VALUE}),K(Ut.dataMin)&&K(Ut.dataMax)&&(ct.startMin=Math.min(Y($t.options.threshold,1/0),Ut.dataMin,ct.startMin),ct.startMax=Math.max(Y($t.options.threshold,-1/0),Ut.dataMax,ct.startMax))});let zt=Math.min(Y(ct&&ct.startMin,ii.dataMin),Ee?ii.min:ge.toValue(ge.toPixels(ii.min)-ge.minPixelPadding)),Yt=Math.max(Y(ct&&ct.startMax,ii.dataMax),Ee?ii.max:ge.toValue(ge.toPixels(ii.max)+ge.minPixelPadding));ge.panningState=ct,ge.isOrdinal||((St=zt-F)>0&&(tt+=St,F=zt),(St=tt-Yt)>0&&(tt=Yt,F-=St),ge.series.length&&F!==ii.min&&tt!==ii.max&&F>=zt&&tt<=Yt&&(ge.setExtremes(F,tt,!1,!1,{trigger:"pan"}),!Mt.resetZoomButton&&F!==zt&&tt!==Yt&&Jt.match("y")&&(Mt.showResetZoom(),ge.displayBtn=!1),Tt=!0),ze[Ze]=Oe)}),D(ze,(ge,be)=>{Mt[be]=ge}),Tt&&Mt.redraw(!1),k(Mt.container,{cursor:"move"})})}}return ot(ee.prototype,{callbacks:[],collectionsWithInit:{xAxis:[ee.prototype.addAxis,[!0]],yAxis:[ee.prototype.addAxis,[!1]],series:[ee.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]}),ee}),te(X,"Extensions/ScrollablePlotArea.js",[X["Core/Animation/AnimationUtilities.js"],X["Core/Globals.js"],X["Core/Renderer/RendererRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt){let{stop:dt}=Et,{composed:Nt}=At,{addEvent:Lt,createElement:kt,css:ut,defined:Rt,extend:Z,merge:lt,pick:at,pushUnique:W}=Zt;function q(){var G,xt,Ct;let V,{axisOffset:rt,chartWidth:I,chartHeight:C,container:z,plotHeight:S,plotLeft:g,plotTop:v,plotWidth:y,scrollablePixelsX:T=0,scrollablePixelsY:k=0,scrollingContainer:E}=this,w=!this.fixedDiv,R=this.options.chart,J=R.scrollablePlotArea,{scrollPositionX:wt,scrollPositionY:ot}=J,it=l.getRendererType(),{fixedRenderer:Q}=this;Q?Q.setSize(I,C):(this.fixedDiv=kt("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(((G=R.style)==null?void 0:G.zIndex)||0)+2,top:0},void 0,!0),E==null||E.parentNode.insertBefore(this.fixedDiv,E),ut(this.renderTo,{overflow:"visible"}),this.fixedRenderer=Q=new it(this.fixedDiv,I,C,R.style),this.scrollableMask=Q.path().attr({fill:R.backgroundColor||"#fff","fill-opacity":at(J.opacity,.85),zIndex:-1}).addClass("highcharts-scrollable-mask").add(),Lt(this,"afterShowResetZoom",this.moveFixedElements),Lt(this,"afterApplyDrilldown",this.moveFixedElements),Lt(this,"afterLayOutTitles",this.moveFixedElements)),(this.scrollableDirty||w)&&(this.scrollableDirty=!1,this.moveFixedElements());let A=I+T,B=C+k;dt(this.container),ut(z,{width:`${A}px`,height:`${B}px`}),this.renderer.boxWrapper.attr({width:A,height:B,viewBox:[0,0,A,B].join(" ")}),(xt=this.chartBackground)==null||xt.attr({width:A,height:B}),E&&(ut(E,{width:`${this.chartWidth}px`,height:`${this.chartHeight}px`}),w&&(wt&&(E.scrollLeft=T*wt),ot&&(E.scrollTop=k*ot)));let K=v-rt[0]-1,pt=g-rt[3]-1,_=v+S+rt[2]+1,P=g+y+rt[1]+1,D=g+y-T,Y=v+S-k;V=T?[["M",0,K],["L",g-1,K],["L",g-1,_],["L",0,_],["Z"],["M",D,K],["L",I,K],["L",I,_],["L",D,_],["Z"]]:k?[["M",pt,0],["L",pt,v-1],["L",P,v-1],["L",P,0],["Z"],["M",pt,Y],["L",pt,C],["L",P,C],["L",P,Y],["Z"]]:[["M",0,0]],this.redrawTrigger!=="adjustHeight"&&((Ct=this.scrollableMask)==null||Ct.attr({d:V}))}function $(){let V,rt=this.container,I=this.fixedRenderer,C=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-caption",".highcharts-credits",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-reset-zoom",".highcharts-drillup-button",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];for(let z of(this.scrollablePixelsX&&!this.inverted?V=".highcharts-yaxis":this.scrollablePixelsX&&this.inverted||this.scrollablePixelsY&&!this.inverted?V=".highcharts-xaxis":this.scrollablePixelsY&&this.inverted&&(V=".highcharts-yaxis"),V&&C.push(`${V}:not(.highcharts-radial-axis)`,`${V}-labels:not(.highcharts-radial-axis-labels)`),C))[].forEach.call(rt.querySelectorAll(z),S=>{(S.namespaceURI===I.SVG_NS?I.box:I.box.parentNode).appendChild(S),S.style.pointerEvents="auto"})}function U(){let V,rt={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};this.scrollablePixelsX&&(rt.overflowX="auto"),this.scrollablePixelsY&&(rt.overflowY="auto"),this.scrollingParent=kt("div",{className:"highcharts-scrolling-parent"},{position:"relative"},this.renderTo),this.scrollingContainer=kt("div",{className:"highcharts-scrolling"},rt,this.scrollingParent),Lt(this.scrollingContainer,"scroll",()=>{this.pointer&&(delete this.pointer.chartPosition,this.hoverPoint&&(V=this.hoverPoint),this.pointer.runPointActions(void 0,V,!0))}),this.innerContainer=kt("div",{className:"highcharts-inner-container"},null,this.scrollingContainer),this.innerContainer.appendChild(this.container),this.setUpScrolling=null}function j(){this.chart.scrollableDirty=!0}function et(V){let rt,I,C,z=this.options.chart.scrollablePlotArea,S=z&&z.minWidth,g=z&&z.minHeight;if(!this.renderer.forExport&&(S?(this.scrollablePixelsX=rt=Math.max(0,S-this.chartWidth),rt&&(this.scrollablePlotBox=this.renderer.scrollablePlotBox=lt(this.plotBox),this.plotBox.width=this.plotWidth+=rt,this.inverted?this.clipBox.height+=rt:this.clipBox.width+=rt,C={1:{name:"right",value:rt}})):g&&(this.scrollablePixelsY=I=Math.max(0,g-this.chartHeight),Rt(I)&&(this.scrollablePlotBox=this.renderer.scrollablePlotBox=lt(this.plotBox),this.plotBox.height=this.plotHeight+=I,this.inverted?this.clipBox.width+=I:this.clipBox.height+=I,C={2:{name:"bottom",value:I}})),C&&!V.skipAxes))for(let v of this.axes)if(C[v.side]){let y=v.getPlotLinePath;v.getPlotLinePath=function(){let T=C[v.side].name,k=C[v.side].value,E=this[T];this[T]=E-k;let w=y.apply(this,arguments);return this[T]=E,w}}else v.setAxisSize(),v.setAxisTranslation()}function _t(){this.scrollablePixelsX||this.scrollablePixelsY?(this.setUpScrolling&&this.setUpScrolling(),this.applyFixed()):this.fixedDiv&&this.applyFixed()}function mt(){this.chart.scrollableDirty=!0}return{compose:function V(rt,I,C){W(Nt,V)&&(Lt(rt,"afterInit",j),Z(I.prototype,{applyFixed:q,moveFixedElements:$,setUpScrolling:U}),Lt(I,"afterSetChartSize",et),Lt(I,"render",_t),Lt(C,"show",mt))}}}),te(X,"Core/Axis/Stacking/StackItem.js",[X["Core/Templating.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l){let{format:Zt}=Et,{series:dt}=At,{destroyObjectProperties:Nt,fireEvent:Lt,isNumber:kt,pick:ut}=l;return class{constructor(Rt,Z,lt,at,W){let q=Rt.chart.inverted,$=Rt.reversed;this.axis=Rt;let U=this.isNegative=!!lt!=!!$;this.options=Z=Z||{},this.x=at,this.total=null,this.cumulative=null,this.points={},this.hasValidPoints=!1,this.stack=W,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:Z.align||(q?U?"left":"right":"center"),verticalAlign:Z.verticalAlign||(q?"middle":U?"bottom":"top"),y:Z.y,x:Z.x},this.textAlign=Z.textAlign||(q?U?"right":"left":"center")}destroy(){Nt(this,this.axis)}render(Rt){let Z=this.axis.chart,lt=this.options,at=lt.format,W=at?Zt(at,this,Z):lt.formatter.call(this);if(this.label)this.label.attr({text:W,visibility:"hidden"});else{this.label=Z.renderer.label(W,null,void 0,lt.shape,void 0,void 0,lt.useHTML,!1,"stack-labels");let q={r:lt.borderRadius||0,text:W,padding:ut(lt.padding,5),visibility:"hidden"};Z.styledMode||(q.fill=lt.backgroundColor,q.stroke=lt.borderColor,q["stroke-width"]=lt.borderWidth,this.label.css(lt.style||{})),this.label.attr(q),this.label.added||this.label.add(Rt)}this.label.labelrank=Z.plotSizeY,Lt(this,"afterRender")}setOffset(Rt,Z,lt,at,W,q){let{alignOptions:$,axis:U,label:j,options:et,textAlign:_t}=this,mt=U.chart,V=this.getStackBox({xOffset:Rt,width:Z,boxBottom:lt,boxTop:at,defaultX:W,xAxis:q}),{verticalAlign:rt}=$;if(j&&V){let I=j.getBBox(),C=j.padding,z=ut(et.overflow,"justify")==="justify",S;$.x=et.x||0,$.y=et.y||0;let{x:g,y:v}=this.adjustStackPosition({labelBox:I,verticalAlign:rt,textAlign:_t});V.x-=g,V.y-=v,j.align($,!1,V),(S=mt.isInsidePlot(j.alignAttr.x+$.x+g,j.alignAttr.y+$.y+v))||(z=!1),z&&dt.prototype.justifyDataLabel.call(U,j,$,j.alignAttr,I,V),j.attr({x:j.alignAttr.x,y:j.alignAttr.y,rotation:et.rotation,rotationOriginX:I.width/2,rotationOriginY:I.height/2}),ut(!z&&et.crop,!0)&&(S=kt(j.x)&&kt(j.y)&&mt.isInsidePlot(j.x-C+(j.width||0),j.y)&&mt.isInsidePlot(j.x+C,j.y)),j[S?"show":"hide"]()}Lt(this,"afterSetOffset",{xOffset:Rt,width:Z})}adjustStackPosition({labelBox:Rt,verticalAlign:Z,textAlign:lt}){let at={bottom:0,middle:1,top:2,right:1,center:0,left:-1},W=at[Z],q=at[lt];return{x:Rt.width/2+Rt.width/2*q,y:Rt.height/2*W}}getStackBox(Rt){let Z=this.axis,lt=Z.chart,{boxTop:at,defaultX:W,xOffset:q,width:$,boxBottom:U}=Rt,j=Z.stacking.usePercentage?100:ut(at,this.total,0),et=Z.toPixels(j),_t=Rt.xAxis||lt.xAxis[0],mt=ut(W,_t.translate(this.x))+q,V=Z.toPixels(U||kt(Z.min)&&Z.logarithmic&&Z.logarithmic.lin2log(Z.min)||0),rt=Math.abs(et-V),I=lt.inverted,C=this.isNegative;return I?{x:(C?et:et-rt)-lt.plotLeft,y:_t.height-mt-$,width:rt,height:$}:{x:mt+_t.transB-lt.plotLeft,y:(C?et-rt:et)-lt.plotTop,width:$,height:rt}}}}),te(X,"Core/Axis/Stacking/StackingAxis.js",[X["Core/Animation/AnimationUtilities.js"],X["Core/Axis/Axis.js"],X["Core/Globals.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Axis/Stacking/StackItem.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt,Nt){var Lt;let{getDeferredAnimation:kt}=Et,{composed:ut}=l,{series:{prototype:Rt}}=Zt,{addEvent:Z,correctFloat:lt,defined:at,destroyObjectProperties:W,fireEvent:q,isArray:$,isNumber:U,objectEach:j,pick:et,pushUnique:_t}=Nt;function mt(){let y=this.inverted;this.axes.forEach(T=>{T.stacking&&T.stacking.stacks&&T.hasVisibleSeries&&(T.stacking.oldStacks=T.stacking.stacks)}),this.series.forEach(T=>{let k=T.xAxis&&T.xAxis.options||{};T.options.stacking&&T.reserveSpace()&&(T.stackKey=[T.type,et(T.options.stack,""),y?k.top:k.left,y?k.height:k.width].join(","))})}function V(){var T;let y=this.stacking;if(y){let k=y.stacks;j(k,(E,w)=>{W(E),delete k[w]}),(T=y.stackTotalGroup)==null||T.destroy()}}function rt(){this.stacking||(this.stacking=new v(this))}function I(y,T,k,E){return!at(y)||y.x!==T||E&&y.stackKey!==E?y={x:T,index:0,key:E,stackKey:E}:y.index++,y.key=[k,T,y.index].join(","),y}function C(){let y,T=this,k=T.yAxis,E=T.stackKey||"",w=k.stacking.stacks,R=T.processedXData,J=T.options.stacking,wt=T[J+"Stacker"];wt&&[E,"-"+E].forEach(ot=>{var K;let it=R.length,Q,A,B;for(;it--;)Q=R[it],y=T.getStackIndicator(y,Q,T.index,ot),A=(K=w[ot])==null?void 0:K[Q],(B=A==null?void 0:A.points[y.key||""])&&wt.call(T,B,A,it)})}function z(y,T,k){let E=T.total?100/T.total:0;y[0]=lt(y[0]*E),y[1]=lt(y[1]*E),this.stackedYData[k]=y[1]}function S(y){(this.is("column")||this.is("columnrange"))&&(this.options.centerInCategory&&!this.options.stacking&&this.chart.series.length>1?Rt.setStackedPoints.call(this,y,"group"):y.stacking.resetStacks())}function g(y,T){var le,ht;let k,E,w,R,J,wt,ot,it,Q,A=T||this.options.stacking;if(!A||!this.reserveSpace()||({group:"xAxis"}[A]||"yAxis")!==y.coll)return;let B=this.processedXData,K=this.processedYData,pt=[],_=K.length,P=this.options,D=P.threshold||0,Y=P.startFromThreshold?D:0,G=P.stack,xt=T?`${this.type},${A}`:this.stackKey||"",Ct="-"+xt,Dt=this.negStacks,jt=y.stacking,Kt=jt.stacks,ee=jt.oldStacks;for(jt.stacksTouched+=1,ot=0;ot<_;ot++){it=B[ot],Q=K[ot],wt=(k=this.getStackIndicator(k,it,this.index)).key||"",Kt[J=(E=Dt&&Q<(Y?0:D))?Ct:xt]||(Kt[J]={}),Kt[J][it]||((le=ee[J])!=null&&le[it]?(Kt[J][it]=ee[J][it],Kt[J][it].total=null):Kt[J][it]=new dt(y,y.options.stackLabels,!!E,it,G)),w=Kt[J][it],Q!==null?(w.points[wt]=w.points[this.index]=[et(w.cumulative,Y)],at(w.cumulative)||(w.base=wt),w.touched=jt.stacksTouched,k.index>0&&this.singleStacks===!1&&(w.points[wt][0]=w.points[this.index+","+it+",0"][0])):(delete w.points[wt],delete w.points[this.index]);let st=w.total||0;A==="percent"?(R=E?xt:Ct,st=Dt&&((ht=Kt[R])!=null&&ht[it])?(R=Kt[R][it]).total=Math.max(R.total||0,st)+Math.abs(Q)||0:lt(st+(Math.abs(Q)||0))):A==="group"?($(Q)&&(Q=Q[0]),Q!==null&&st++):st=lt(st+(Q||0)),A==="group"?w.cumulative=(st||1)-1:w.cumulative=lt(et(w.cumulative,Y)+(Q||0)),w.total=st,Q!==null&&(w.points[wt].push(w.cumulative),pt[ot]=w.cumulative,w.hasValidPoints=!0)}A==="percent"&&(jt.usePercentage=!0),A!=="group"&&(this.stackedYData=pt),jt.oldStacks={}}class v{constructor(T){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=T}buildStacks(){let T,k,E=this.axis,w=E.series,R=E.coll==="xAxis",J=E.options.reversedStacks,wt=w.length;for(this.resetStacks(),this.usePercentage=!1,k=wt;k--;)T=w[J?k:wt-k-1],R&&T.setGroupedPoints(E),T.setStackedPoints(E);if(!R)for(k=0;k<wt;k++)w[k].modifyStacks();q(E,"afterBuildStacks")}cleanStacks(){this.oldStacks&&(this.stacks=this.oldStacks,j(this.stacks,T=>{j(T,k=>{k.cumulative=k.total})}))}resetStacks(){j(this.stacks,T=>{j(T,(k,E)=>{U(k.touched)&&k.touched<this.stacksTouched?(k.destroy(),delete T[E]):(k.total=null,k.cumulative=null)})})}renderStackTotals(){var ot;let T=this.axis,k=T.chart,E=k.renderer,w=this.stacks,R=(ot=T.options.stackLabels)==null?void 0:ot.animation,J=kt(k,R||!1),wt=this.stackTotalGroup=this.stackTotalGroup||E.g("stack-labels").attr({zIndex:6,opacity:0}).add();wt.translate(k.plotLeft,k.plotTop),j(w,it=>{j(it,Q=>{Q.render(wt)})}),wt.animate({opacity:1},J)}}return(Lt||(Lt={})).compose=function y(T,k,E){if(_t(ut,y)){let w=k.prototype,R=E.prototype;Z(T,"init",rt),Z(T,"destroy",V),w.getStacks=mt,R.getStackIndicator=I,R.modifyStacks=C,R.percentStacker=z,R.setGroupedPoints=S,R.setStackedPoints=g}},Lt}),te(X,"Series/Line/LineSeries.js",[X["Core/Series/Series.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l){let{defined:Zt,merge:dt,isObject:Nt}=l;class Lt extends Et{drawGraph(){let ut=this.options,Rt=(this.gappedPath||this.getGraphPath).call(this),Z=this.chart.styledMode;[this,...this.zones].forEach((lt,at)=>{let W,q=lt.graph,$=q?"animate":"attr",U=lt.dashStyle||ut.dashStyle;q?(q.endX=this.preventGraphAnimation?null:Rt.xMap,q.animate({d:Rt})):Rt.length&&(lt.graph=q=this.chart.renderer.path(Rt).addClass("highcharts-graph"+(at?` highcharts-zone-graph-${at-1} `:" ")+(at&&lt.className||"")).attr({zIndex:1}).add(this.group)),q&&!Z&&(W={stroke:!at&&ut.lineColor||lt.color||this.color||"#cccccc","stroke-width":ut.lineWidth||0,fill:this.fillGraph&&this.color||"none"},U?W.dashstyle=U:ut.linecap!=="square"&&(W["stroke-linecap"]=W["stroke-linejoin"]="round"),q[$](W).shadow(at<2&&ut.shadow&&dt({filterUnits:"userSpaceOnUse"},Nt(ut.shadow)?ut.shadow:{}))),q&&(q.startX=Rt.xMap,q.isArea=Rt.isArea)})}getGraphPath(ut,Rt,Z){let lt=this,at=lt.options,W=[],q=[],$,U=at.step;ut=ut||lt.points;let j=ut.reversed;return j&&ut.reverse(),(U={right:1,center:2}[U]||U&&3)&&j&&(U=4-U),(ut=this.getValidPoints(ut,!1,!(at.connectNulls&&!Rt&&!Z))).forEach(function(et,_t){let mt,V=et.plotX,rt=et.plotY,I=ut[_t-1],C=et.isNull||typeof rt!="number";(et.leftCliff||I&&I.rightCliff)&&!Z&&($=!0),C&&!Zt(Rt)&&_t>0?$=!at.connectNulls:C&&!Rt?$=!0:(_t===0||$?mt=[["M",et.plotX,et.plotY]]:lt.getPointSpline?mt=[lt.getPointSpline(ut,et,_t)]:U?(mt=U===1?[["L",I.plotX,rt]]:U===2?[["L",(I.plotX+V)/2,I.plotY],["L",(I.plotX+V)/2,rt]]:[["L",V,I.plotY]]).push(["L",V,rt]):mt=[["L",V,rt]],q.push(et.x),U&&(q.push(et.x),U===2&&q.push(et.x)),W.push.apply(W,mt),$=!1)}),W.xMap=q,lt.graphPath=W,W}}return Lt.defaultOptions=dt(Et.defaultOptions,{legendSymbol:"lineMarker"}),At.registerSeriesType("line",Lt),Lt}),te(X,"Series/Area/AreaSeries.js",[X["Core/Color/Color.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l){let{seriesTypes:{line:Zt}}=At,{extend:dt,merge:Nt,objectEach:Lt,pick:kt}=l;class ut extends Zt{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);let{areaPath:Z,options:lt}=this;[this,...this.zones].forEach((at,W)=>{let q={},$=at.fillColor||lt.fillColor,U=at.area,j=U?"animate":"attr";U?(U.endX=this.preventGraphAnimation?null:Z.xMap,U.animate({d:Z})):(q.zIndex=0,(U=at.area=this.chart.renderer.path(Z).addClass("highcharts-area"+(W?` highcharts-zone-area-${W-1} `:" ")+(W&&at.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(q.fill=$||at.color||this.color,q["fill-opacity"]=$?1:lt.fillOpacity??.75,U.css({pointerEvents:this.stickyTracking?"none":"auto"})),U[j](q),U.startX=Z.xMap,U.shiftUnit=lt.step?2:1})}getGraphPath(Z){let lt,at,W,q=Zt.prototype.getGraphPath,$=this.options,U=$.stacking,j=this.yAxis,et=[],_t=[],mt=this.index,V=j.stacking.stacks[this.stackKey],rt=$.threshold,I=Math.round(j.getThreshold($.threshold)),C=kt($.connectNulls,U==="percent"),z=function(k,E,w){let R=Z[k],J=U&&V[R.x].points[mt],wt=R[w+"Null"]||0,ot=R[w+"Cliff"]||0,it,Q,A=!0;ot||wt?(it=(wt?J[0]:J[1])+ot,Q=J[0]+ot,A=!!wt):!U&&Z[E]&&Z[E].isNull&&(it=Q=rt),it!==void 0&&(_t.push({plotX:lt,plotY:it===null?I:j.getThreshold(it),isNull:A,isCliff:!0}),et.push({plotX:lt,plotY:Q===null?I:j.getThreshold(Q),doCurve:!1}))};Z=Z||this.points,U&&(Z=this.getStackPoints(Z));for(let k=0,E=Z.length;k<E;++k)U||(Z[k].leftCliff=Z[k].rightCliff=Z[k].leftNull=Z[k].rightNull=void 0),at=Z[k].isNull,lt=kt(Z[k].rectPlotX,Z[k].plotX),W=U?kt(Z[k].yBottom,I):I,at&&!C||(C||z(k,k-1,"left"),at&&!U&&C||(_t.push(Z[k]),et.push({x:k,plotX:lt,plotY:W})),C||z(k,k+1,"right"));let S=q.call(this,_t,!0,!0);et.reversed=!0;let g=q.call(this,et,!0,!0),v=g[0];v&&v[0]==="M"&&(g[0]=["L",v[1],v[2]]);let y=S.concat(g);y.length&&y.push(["Z"]);let T=q.call(this,_t,!1,C);return y.xMap=S.xMap,this.areaPath=y,T}getStackPoints(Z){let lt=this,at=[],W=[],q=this.xAxis,$=this.yAxis,U=$.stacking.stacks[this.stackKey],j={},et=$.series,_t=et.length,mt=$.options.reversedStacks?1:-1,V=et.indexOf(lt);if(Z=Z||this.points,this.options.stacking){for(let I=0;I<Z.length;I++)Z[I].leftNull=Z[I].rightNull=void 0,j[Z[I].x]=Z[I];Lt(U,function(I,C){I.total!==null&&W.push(C)}),W.sort(function(I,C){return I-C});let rt=et.map(I=>I.visible);W.forEach(function(I,C){let z=0,S,g;if(j[I]&&!j[I].isNull)at.push(j[I]),[-1,1].forEach(function(v){let y=v===1?"rightNull":"leftNull",T=U[W[C+v]],k=0;if(T){let E=V;for(;E>=0&&E<_t;){let w=et[E].index;!(S=T.points[w])&&(w===lt.index?j[I][y]=!0:rt[E]&&(g=U[I].points[w])&&(k-=g[1]-g[0])),E+=mt}}j[I][v===1?"rightCliff":"leftCliff"]=k});else{let v=V;for(;v>=0&&v<_t;){let y=et[v].index;if(S=U[I].points[y]){z=S[1];break}v+=mt}z=kt(z,0),z=$.translate(z,0,1,0,1),at.push({isNull:!0,plotX:q.translate(I,0,0,0,1),x:I,plotY:z,yBottom:z})}})}return at}}return ut.defaultOptions=Nt(Zt.defaultOptions,{threshold:0,legendSymbol:"areaMarker"}),dt(ut.prototype,{singleStacks:!1}),At.registerSeriesType("area",ut),ut}),te(X,"Series/Spline/SplineSeries.js",[X["Core/Series/SeriesRegistry.js"],X["Core/Utilities.js"]],function(Et,At){let{line:l}=Et.seriesTypes,{merge:Zt,pick:dt}=At;class Nt extends l{getPointSpline(kt,ut,Rt){let Z,lt,at,W,q=ut.plotX||0,$=ut.plotY||0,U=kt[Rt-1],j=kt[Rt+1];function et(mt){return mt&&!mt.isNull&&mt.doCurve!==!1&&!ut.isCliff}if(et(U)&&et(j)){let mt=U.plotX||0,V=U.plotY||0,rt=j.plotX||0,I=j.plotY||0,C=0;Z=(1.5*q+mt)/2.5,lt=(1.5*$+V)/2.5,at=(1.5*q+rt)/2.5,W=(1.5*$+I)/2.5,at!==Z&&(C=(W-lt)*(at-q)/(at-Z)+$-W),lt+=C,W+=C,lt>V&&lt>$?(lt=Math.max(V,$),W=2*$-lt):lt<V&&lt<$&&(lt=Math.min(V,$),W=2*$-lt),W>I&&W>$?(W=Math.max(I,$),lt=2*$-W):W<I&&W<$&&(W=Math.min(I,$),lt=2*$-W),ut.rightContX=at,ut.rightContY=W,ut.controlPoints={low:[Z,lt],high:[at,W]}}let _t=["C",dt(U.rightContX,U.plotX,0),dt(U.rightContY,U.plotY,0),dt(Z,q,0),dt(lt,$,0),q,$];return U.rightContX=U.rightContY=void 0,_t}}return Nt.defaultOptions=Zt(l.defaultOptions),Et.registerSeriesType("spline",Nt),Nt}),te(X,"Series/AreaSpline/AreaSplineSeries.js",[X["Series/Spline/SplineSeries.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l){let{area:Zt,area:{prototype:dt}}=At.seriesTypes,{extend:Nt,merge:Lt}=l;class kt extends Et{}return kt.defaultOptions=Lt(Et.defaultOptions,Zt.defaultOptions),Nt(kt.prototype,{getGraphPath:dt.getGraphPath,getStackPoints:dt.getStackPoints,drawGraph:dt.drawGraph}),At.registerSeriesType("areaspline",kt),kt}),te(X,"Series/Column/ColumnSeriesDefaults.js",[],function(){return{borderRadius:3,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}}),te(X,"Series/Column/ColumnSeries.js",[X["Core/Animation/AnimationUtilities.js"],X["Core/Color/Color.js"],X["Series/Column/ColumnSeriesDefaults.js"],X["Core/Globals.js"],X["Core/Series/Series.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt,Nt,Lt){let{animObject:kt}=Et,{parse:ut}=At,{hasTouch:Rt,noop:Z}=Zt,{clamp:lt,defined:at,extend:W,fireEvent:q,isArray:$,isNumber:U,merge:j,pick:et,objectEach:_t,relativeLength:mt}=Lt;class V extends dt{animate(I){let C,z,S=this,g=this.yAxis,v=g.pos,y=S.options,T=this.chart.inverted,k={},E=T?"translateX":"translateY";I?(k.scaleY=.001,z=lt(g.toPixels(y.threshold),v,v+g.len),T?k.translateX=z-g.len:k.translateY=z,S.clipBox&&S.setClip(),S.group.attr(k)):(C=Number(S.group.attr(E)),S.group.animate({scaleY:1},W(kt(S.options.animation),{step:function(w,R){S.group&&(k[E]=C+R.pos*(v-C),S.group.attr(k))}})))}init(I,C){super.init.apply(this,arguments);let z=this;(I=z.chart).hasRendered&&I.series.forEach(function(S){S.type===z.type&&(S.isDirty=!0)})}getColumnMetrics(){var Q,A;let I=this,C=I.options,z=I.xAxis,S=I.yAxis,g=z.options.reversedStacks,v=z.reversed&&!g||!z.reversed&&g,y={},T,k=0;C.grouping===!1?k=1:I.chart.series.forEach(function(B){let K,pt=B.yAxis,_=B.options;B.type===I.type&&B.reserveSpace()&&S.len===pt.len&&S.pos===pt.pos&&(_.stacking&&_.stacking!=="group"?(y[T=B.stackKey]===void 0&&(y[T]=k++),K=y[T]):_.grouping!==!1&&(K=k++),B.columnIndex=K)});let E=Math.min(Math.abs(z.transA)*(!((Q=z.brokenAxis)!=null&&Q.hasBreaks)&&((A=z.ordinal)==null?void 0:A.slope)||C.pointRange||z.closestPointRange||z.tickInterval||1),z.len),w=E*C.groupPadding,R=(E-2*w)/(k||1),J=Math.min(C.maxPointWidth||z.len,et(C.pointWidth,R*(1-2*C.pointPadding))),wt=(R-J)/2,ot=(I.columnIndex||0)+(v?1:0),it=wt+(w+ot*R-E/2)*(v?-1:1);return I.columnMetrics={width:J,offset:it,paddedWidth:R,columnCount:k},I.columnMetrics}crispCol(I,C,z,S){this.chart;let g=this.borderWidth,v=-(g%2?.5:0),y=g%2?.5:1;this.options.crisp&&(z=Math.round(I+z)+v-(I=Math.round(I)+v));let T=Math.round(C+S)+y,k=.5>=Math.abs(C)&&T>.5;return S=T-(C=Math.round(C)+y),k&&S&&(C-=1,S+=1),{x:I,y:C,width:z,height:S}}adjustForMissingColumns(I,C,z,S){var g;if(!z.isNull&&S.columnCount>1){let v=this.xAxis.series.filter(E=>E.visible).map(E=>E.index),y=0,T=0;_t((g=this.xAxis.stacking)==null?void 0:g.stacks,E=>{if(typeof z.x=="number"){let w=E[z.x.toString()];if(w){let R=w.points[this.index];if($(R)){let J=Object.keys(w.points).filter(wt=>!wt.match(",")&&w.points[wt]&&w.points[wt].length>1).map(parseFloat).filter(wt=>v.indexOf(wt)!==-1).sort((wt,ot)=>ot-wt);y=J.indexOf(this.index),T=J.length}}}});let k=(T-1)*S.paddedWidth+C;I=(z.plotX||0)+k/2-C-y*S.paddedWidth}return I}translate(){let I=this,C=I.chart,z=I.options,S=I.dense=I.closestPointRange*I.xAxis.transA<2,g=I.borderWidth=et(z.borderWidth,S?0:1),v=I.xAxis,y=I.yAxis,T=z.threshold,k=et(z.minPointLength,5),E=I.getColumnMetrics(),w=E.width,R=I.pointXOffset=E.offset,J=I.dataMin,wt=I.dataMax,ot=I.barW=Math.max(w,1+2*g),it=I.translatedThreshold=y.getThreshold(T);C.inverted&&(it-=.5),z.pointPadding&&(ot=Math.ceil(ot)),dt.prototype.translate.apply(I),I.points.forEach(function(Q){let A=et(Q.yBottom,it),B=999+Math.abs(A),K=Q.plotX||0,pt=lt(Q.plotY,-B,y.len+B);Q.stackBox;let _,P=Math.min(pt,A),D=Math.max(pt,A)-P,Y=w,G=K+R,xt=ot;k&&Math.abs(D)<k&&(D=k,_=!y.reversed&&!Q.negative||y.reversed&&Q.negative,U(T)&&U(wt)&&Q.y===T&&wt<=T&&(y.min||0)<T&&(J!==wt||(y.max||0)<=T)&&(_=!_,Q.negative=!Q.negative),P=Math.abs(P-it)>k?A-k:it-(_?k:0)),at(Q.options.pointWidth)&&(G-=Math.round(((Y=xt=Math.ceil(Q.options.pointWidth))-w)/2)),z.centerInCategory&&!z.stacking&&(G=I.adjustForMissingColumns(G,Y,Q,E)),Q.barX=G,Q.pointWidth=Y,Q.tooltipPos=C.inverted?[lt(y.len+y.pos-C.plotLeft-pt,y.pos-C.plotLeft,y.len+y.pos-C.plotLeft),v.len+v.pos-C.plotTop-G-xt/2,D]:[v.left-C.plotLeft+G+xt/2,lt(pt+y.pos-C.plotTop,y.pos-C.plotTop,y.len+y.pos-C.plotTop),D],Q.shapeType=I.pointClass.prototype.shapeType||"roundedRect",Q.shapeArgs=I.crispCol(G,Q.isNull?it:P,xt,Q.isNull?0:D)}),q(this,"afterColumnTranslate")}drawGraph(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")}pointAttribs(I,C){let z=this.options,S=this.pointAttrToOptions||{},g=S.stroke||"borderColor",v=S["stroke-width"]||"borderWidth",y,T,k,E=I&&I.color||this.color,w=I&&I[g]||z[g]||E,R=I&&I.options.dashStyle||z.dashStyle,J=I&&I[v]||z[v]||this[v]||0,wt=et(I&&I.opacity,z.opacity,1);I&&this.zones.length&&(T=I.getZone(),E=I.options.color||T&&(T.color||I.nonZonedColor)||this.color,T&&(w=T.borderColor||w,R=T.dashStyle||R,J=T.borderWidth||J)),C&&I&&(k=(y=j(z.states[C],I.options.states&&I.options.states[C]||{})).brightness,E=y.color||k!==void 0&&ut(E).brighten(y.brightness).get()||E,w=y[g]||w,J=y[v]||J,R=y.dashStyle||R,wt=et(y.opacity,wt));let ot={fill:E,stroke:w,"stroke-width":J,opacity:wt};return R&&(ot.dashstyle=R),ot}drawPoints(I=this.points){let C,z=this,S=this.chart,g=z.options,v=S.renderer,y=g.animationLimit||250;I.forEach(function(T){let k=T.plotY,E=T.graphic,w=!!E,R=E&&S.pointCount<y?"animate":"attr";U(k)&&T.y!==null?(C=T.shapeArgs,E&&T.hasNewShapeType()&&(E=E.destroy()),z.enabledDataSorting&&(T.startXPos=z.xAxis.reversed?-(C&&C.width||0):z.xAxis.width),!E&&(T.graphic=E=v[T.shapeType](C).add(T.group||z.group),E&&z.enabledDataSorting&&S.hasRendered&&S.pointCount<y&&(E.attr({x:T.startXPos}),w=!0,R="animate")),E&&w&&E[R](j(C)),S.styledMode||E[R](z.pointAttribs(T,T.selected&&"select")).shadow(T.allowShadow!==!1&&g.shadow),E&&(E.addClass(T.getClassName(),!0),E.attr({visibility:T.visible?"inherit":"hidden"}))):E&&(T.graphic=E.destroy())})}drawTracker(I=this.points){let C,z=this,S=z.chart,g=S.pointer,v=function(y){let T=g.getPointFromEvent(y);T!==void 0&&z.options.enableMouseTracking&&(g.isDirectTouch=!0,T.onMouseOver(y))};I.forEach(function(y){C=$(y.dataLabels)?y.dataLabels:y.dataLabel?[y.dataLabel]:[],y.graphic&&(y.graphic.element.point=y),C.forEach(function(T){T.div?T.div.point=y:T.element.point=y})}),z._hasTracking||(z.trackerGroups.forEach(function(y){z[y]&&(z[y].addClass("highcharts-tracker").on("mouseover",v).on("mouseout",function(T){g.onTrackerMouseOut(T)}),Rt&&z[y].on("touchstart",v),!S.styledMode&&z.options.cursor&&z[y].css({cursor:z.options.cursor}))}),z._hasTracking=!0),q(this,"afterDrawTracker")}remove(){let I=this,C=I.chart;C.hasRendered&&C.series.forEach(function(z){z.type===I.type&&(z.isDirty=!0)}),dt.prototype.remove.apply(I,arguments)}}return V.defaultOptions=j(dt.defaultOptions,l),W(V.prototype,{directTouch:!0,getSymbol:Z,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),Nt.registerSeriesType("column",V),V}),te(X,"Core/Series/DataLabel.js",[X["Core/Animation/AnimationUtilities.js"],X["Core/Templating.js"],X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt){var dt;let{getDeferredAnimation:Nt}=Et,{format:Lt}=At,{composed:kt}=l,{defined:ut,extend:Rt,fireEvent:Z,isArray:lt,isString:at,merge:W,objectEach:q,pick:$,pInt:U,pushUnique:j,splat:et}=Zt;return function(_t){function mt(){return g(this).some(y=>y==null?void 0:y.enabled)}function V(y,T,k,E,w){let R=this,J=this.chart,wt=this.isCartesian&&J.inverted,ot=this.enabledDataSorting,it=y.plotX,Q=y.plotY,A=k.rotation,B=k.align,K=ut(it)&&ut(Q)&&J.isInsidePlot(it,Math.round(Q),{inverted:wt,paneCoordinates:!0,series:R}),pt=Ct=>{ot&&R.xAxis&&!Y&&R.setDataLabelStartPos(y,T,w,K,Ct)},_,P,D,Y=$(k.overflow,ot?"none":"justify")==="justify",G=this.visible&&y.visible!==!1&&ut(it)&&(y.series.forceDL||ot&&!Y||K||$(k.inside,!!this.options.stacking)&&E&&J.isInsidePlot(it,wt?E.x+1:E.y+E.height-1,{inverted:wt,paneCoordinates:!0,series:R})),xt=y.pos();if(G&&xt){A&&T.attr({align:B});let Ct=T.getBBox(!0),Dt=[0,0];if(_=J.renderer.fontMetrics(T).b,E=Rt({x:xt[0],y:Math.round(xt[1]),width:0,height:0},E),Rt(k,{width:Ct.width,height:Ct.height}),A?(Y=!1,P=J.renderer.rotCorr(_,A),D={x:E.x+(k.x||0)+E.width/2+P.x,y:E.y+(k.y||0)+{top:0,middle:.5,bottom:1}[k.verticalAlign]*E.height},Dt=[Ct.x-Number(T.attr("x")),Ct.y-Number(T.attr("y"))],pt(D),T[w?"attr":"animate"](D)):(pt(E),T.align(k,void 0,E),D=T.alignAttr),Y&&E.height>=0)this.justifyDataLabel(T,k,D,Ct,E,w);else if($(k.crop,!0)){let{x:jt,y:Kt}=D;jt+=Dt[0],Kt+=Dt[1],G=J.isInsidePlot(jt,Kt,{paneCoordinates:!0,series:R})&&J.isInsidePlot(jt+Ct.width,Kt+Ct.height,{paneCoordinates:!0,series:R})}k.shape&&!A&&T[w?"attr":"animate"]({anchorX:xt[0],anchorY:xt[1]})}w&&ot&&(T.placed=!1),G||ot&&!Y?T.show():(T.hide(),T.placed=!1)}function rt(){return this.plotGroup("dataLabelsGroup","data-labels",this.hasRendered?"inherit":"hidden",this.options.dataLabels.zIndex||6)}function I(y){let T=this.hasRendered||0,k=this.initDataLabelsGroup().attr({opacity:+T});return!T&&k&&(this.visible&&k.show(),this.options.animation?k.animate({opacity:1},y):k.attr({opacity:1})),k}function C(y){var K;let T;y=y||this.points;let k=this,E=k.chart,w=k.options,R=E.renderer,{backgroundColor:J,plotBackgroundColor:wt}=E.options.chart,ot=R.getContrast(at(wt)&&wt||at(J)&&J||"#000000"),it=g(k),{animation:Q,defer:A}=it[0],B=A?Nt(E,Q,k):{defer:0,duration:0};Z(this,"drawDataLabels"),(K=k.hasDataLabels)!=null&&K.call(k)&&(T=this.initDataLabels(B),y.forEach(pt=>{var D,Y;let _=pt.dataLabels||[];et(S(it,pt.dlOptions||((D=pt.options)==null?void 0:D.dataLabels))).forEach((G,xt)=>{var Jt;let Ct=G.enabled&&pt.visible&&(!pt.isNull||pt.dataLabelOnNull)&&function(ye,ze){let ge=ze.filter;if(ge){let be=ge.operator,Oe=ye[ge.property],Ze=ge.value;return be===">"&&Oe>Ze||be==="<"&&Oe<Ze||be===">="&&Oe>=Ze||be==="<="&&Oe<=Ze||be==="=="&&Oe==Ze||be==="==="&&Oe===Ze||be==="!="&&Oe!=Ze||be==="!=="&&Oe!==Ze}return!0}(pt,G),{backgroundColor:Dt,borderColor:jt,distance:Kt,style:ee={}}=G,le,ht,st,Tt,Mt={},Ht=_[xt],Vt=!Ht,re;if(Ct&&(ht=$(G[pt.formatPrefix+"Format"],G.format),le=pt.getLabelConfig(),st=ut(ht)?Lt(ht,le,E):(G[pt.formatPrefix+"Formatter"]||G.formatter).call(le,G),Tt=G.rotation,!E.styledMode&&(ee.color=$(G.color,ee.color,at(k.color)?k.color:void 0,"#000000"),ee.color==="contrast"?(Dt!=="none"&&(re=Dt),pt.contrastColor=R.getContrast(re!=="auto"&&re||pt.color||k.color),ee.color=re||!ut(Kt)&&G.inside||0>U(Kt||0)||w.stacking?pt.contrastColor:ot):delete pt.contrastColor,w.cursor&&(ee.cursor=w.cursor)),Mt={r:G.borderRadius||0,rotation:Tt,padding:G.padding,zIndex:1},E.styledMode||(Mt.fill=Dt==="auto"?pt.color:Dt,Mt.stroke=jt==="auto"?pt.color:jt,Mt["stroke-width"]=G.borderWidth),q(Mt,(ye,ze)=>{ye===void 0&&delete Mt[ze]})),!Ht||Ct&&ut(st)&&!!Ht.div==!!G.useHTML&&(Ht.rotation&&G.rotation||Ht.rotation===G.rotation)||(Ht=void 0,Vt=!0),Ct&&ut(st)&&(Ht?Mt.text=st:(Ht=Tt?R.text(st,0,0,G.useHTML).addClass("highcharts-data-label"):R.label(st,0,0,G.shape,void 0,void 0,G.useHTML,void 0,"data-label"))&&Ht.addClass(" highcharts-data-label-color-"+pt.colorIndex+" "+(G.className||"")+(G.useHTML?" highcharts-tracker":"")),Ht)){Ht.options=G,Ht.attr(Mt),E.styledMode||Ht.css(ee).shadow(G.shadow);let ye=G[pt.formatPrefix+"TextPath"]||G.textPath;ye&&!G.useHTML&&(Ht.setTextPath(((Jt=pt.getDataLabelPath)==null?void 0:Jt.call(pt,Ht))||pt.graphic,ye),pt.dataLabelPath&&!ye.enabled&&(pt.dataLabelPath=pt.dataLabelPath.destroy())),Ht.added||Ht.add(T),k.alignDataLabel(pt,Ht,G,void 0,Vt),Ht.isActive=!0,_[xt]&&_[xt]!==Ht&&_[xt].destroy(),_[xt]=Ht}});let P=_.length;for(;P--;)_[P]&&_[P].isActive?_[P].isActive=!1:((Y=_[P])==null||Y.destroy(),_.splice(P,1));pt.dataLabel=_[0],pt.dataLabels=_})),Z(this,"afterDrawDataLabels")}function z(y,T,k,E,w,R){let J=this.chart,wt=T.align,ot=T.verticalAlign,it=y.box?0:y.padding||0,{x:Q=0,y:A=0}=T,B,K;return(B=(k.x||0)+it)<0&&(wt==="right"&&Q>=0?(T.align="left",T.inside=!0):Q-=B,K=!0),(B=(k.x||0)+E.width-it)>J.plotWidth&&(wt==="left"&&Q<=0?(T.align="right",T.inside=!0):Q+=J.plotWidth-B,K=!0),(B=k.y+it)<0&&(ot==="bottom"&&A>=0?(T.verticalAlign="top",T.inside=!0):A-=B,K=!0),(B=(k.y||0)+E.height-it)>J.plotHeight&&(ot==="top"&&A<=0?(T.verticalAlign="bottom",T.inside=!0):A+=J.plotHeight-B,K=!0),K&&(T.x=Q,T.y=A,y.placed=!R,y.align(T,void 0,w)),K}function S(y,T){let k=[],E;if(lt(y)&&!lt(T))k=y.map(function(w){return W(w,T)});else if(lt(T)&&!lt(y))k=T.map(function(w){return W(y,w)});else if(lt(y)||lt(T)){if(lt(y)&&lt(T))for(E=Math.max(y.length,T.length);E--;)k[E]=W(y[E],T[E])}else k=W(y,T);return k}function g(y){var k,E;let T=y.chart.options.plotOptions;return et(S(S((k=T==null?void 0:T.series)==null?void 0:k.dataLabels,(E=T==null?void 0:T[y.type])==null?void 0:E.dataLabels),y.options.dataLabels))}function v(y,T,k,E,w){let R=this.chart,J=R.inverted,wt=this.xAxis,ot=wt.reversed,it=((J?T.height:T.width)||0)/2,Q=y.pointWidth,A=Q?Q/2:0;T.startXPos=J?w.x:ot?-it-A:wt.width-it+A,T.startYPos=J?ot?this.yAxis.height-it+A:-it-A:w.y,E?T.visibility==="hidden"&&(T.show(),T.attr({opacity:0}).animate({opacity:1})):T.attr({opacity:1}).animate({opacity:0},void 0,T.hide),R.hasRendered&&(k&&T.attr({x:T.startXPos,y:T.startYPos}),T.placed=!0)}_t.compose=function y(T){if(j(kt,y)){let k=T.prototype;k.initDataLabelsGroup=rt,k.initDataLabels=I,k.alignDataLabel=V,k.drawDataLabels=C,k.justifyDataLabel=z,k.setDataLabelStartPos=v,k.hasDataLabels=mt}}}(dt||(dt={})),dt}),te(X,"Series/Column/ColumnDataLabel.js",[X["Core/Series/DataLabel.js"],X["Core/Globals.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt){var dt;let{composed:Nt}=At,{series:Lt}=l,{merge:kt,pick:ut,pushUnique:Rt}=Zt;return function(Z){function lt(at,W,q,$,U){let j=this.chart.inverted,et=at.series,_t=(et.xAxis?et.xAxis.len:this.chart.plotSizeX)||0,mt=(et.yAxis?et.yAxis.len:this.chart.plotSizeY)||0,V=at.dlBox||at.shapeArgs,rt=ut(at.below,at.plotY>ut(this.translatedThreshold,mt)),I=ut(q.inside,!!this.options.stacking);if(V){if($=kt(V),!(q.overflow==="allow"&&q.crop===!1)){$.y<0&&($.height+=$.y,$.y=0);let C=$.y+$.height-mt;C>0&&C<$.height&&($.height-=C)}j&&($={x:mt-$.y-$.height,y:_t-$.x-$.width,width:$.height,height:$.width}),I||(j?($.x+=rt?0:$.width,$.width=0):($.y+=rt?$.height:0,$.height=0))}q.align=ut(q.align,!j||I?"center":rt?"right":"left"),q.verticalAlign=ut(q.verticalAlign,j||I?"middle":rt?"top":"bottom"),Lt.prototype.alignDataLabel.call(this,at,W,q,$,U),q.inside&&at.contrastColor&&W.css({color:at.contrastColor})}Z.compose=function at(W){Et.compose(Lt),Rt(Nt,at)&&(W.prototype.alignDataLabel=lt)}}(dt||(dt={})),dt}),te(X,"Series/Bar/BarSeries.js",[X["Series/Column/ColumnSeries.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l){let{extend:Zt,merge:dt}=l;class Nt extends Et{}return Nt.defaultOptions=dt(Et.defaultOptions,{}),Zt(Nt.prototype,{inverted:!0}),At.registerSeriesType("bar",Nt),Nt}),te(X,"Series/Scatter/ScatterSeriesDefaults.js",[],function(){return{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">●</span> <span style="font-size: 0.8em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}}),te(X,"Series/Scatter/ScatterSeries.js",[X["Series/Scatter/ScatterSeriesDefaults.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l){let{column:Zt,line:dt}=At.seriesTypes,{addEvent:Nt,extend:Lt,merge:kt}=l;class ut extends dt{applyJitter(){let Z=this,lt=this.options.jitter,at=this.points.length;lt&&this.points.forEach(function(W,q){["x","y"].forEach(function($,U){let j,et="plot"+$.toUpperCase(),_t,mt,V;lt[$]&&!W.isNull&&(j=Z[$+"Axis"],V=lt[$]*j.transA,j&&!j.isLog&&(_t=Math.max(0,W[et]-V),mt=Math.min(j.len,W[et]+V),W[et]=_t+(mt-_t)*function(rt){let I=1e4*Math.sin(rt);return I-Math.floor(I)}(q+U*at),$==="x"&&(W.clientX=W.plotX)))})})}drawGraph(){this.options.lineWidth?super.drawGraph():this.graph&&(this.graph=this.graph.destroy())}}return ut.defaultOptions=kt(dt.defaultOptions,Et),Lt(ut.prototype,{drawTracker:Zt.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"]}),Nt(ut,"afterTranslate",function(){this.applyJitter()}),At.registerSeriesType("scatter",ut),ut}),te(X,"Series/CenteredUtilities.js",[X["Core/Globals.js"],X["Core/Series/Series.js"],X["Core/Utilities.js"]],function(Et,At,l){var Zt,dt;let{deg2rad:Nt}=Et,{fireEvent:Lt,isNumber:kt,pick:ut,relativeLength:Rt}=l;return(dt=Zt||(Zt={})).getCenter=function(){let Z=this.options,lt=this.chart,at=2*(Z.slicedOffset||0),W=lt.plotWidth-2*at,q=lt.plotHeight-2*at,$=Z.center,U=Math.min(W,q),j=Z.thickness,et,_t=Z.size,mt=Z.innerSize||0,V,rt;typeof _t=="string"&&(_t=parseFloat(_t)),typeof mt=="string"&&(mt=parseFloat(mt));let I=[ut($[0],"50%"),ut($[1],"50%"),ut(_t&&_t<0?void 0:Z.size,"100%"),ut(mt&&mt<0?void 0:Z.innerSize||0,"0%")];for(!lt.angular||this instanceof At||(I[3]=0),V=0;V<4;++V)rt=I[V],et=V<2||V===2&&/%$/.test(rt),I[V]=Rt(rt,[W,q,U,I[2]][V])+(et?at:0);return I[3]>I[2]&&(I[3]=I[2]),kt(j)&&2*j<I[2]&&j>0&&(I[3]=I[2]-2*j),Lt(this,"afterGetCenter",{positions:I}),I},dt.getStartAndEndRadians=function(Z,lt){let at=kt(Z)?Z:0,W=kt(lt)&&lt>at&&lt-at<360?lt:at+360;return{start:Nt*(at+-90),end:Nt*(W+-90)}},Zt}),te(X,"Series/Pie/PiePoint.js",[X["Core/Animation/AnimationUtilities.js"],X["Core/Series/Point.js"],X["Core/Utilities.js"]],function(Et,At,l){let{setAnimation:Zt}=Et,{addEvent:dt,defined:Nt,extend:Lt,isNumber:kt,isString:ut,pick:Rt,relativeLength:Z}=l;class lt extends At{getConnectorPath(W){let q=W.dataLabelPosition,$=W.options||{},U=$.connectorShape,j=this.connectorShapes[U]||U;return q&&j.call(this,{...q.computed,alignment:q.alignment},q.connectorPosition,$)||[]}getTranslate(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}}haloPath(W){let q=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(q.x,q.y,q.r+W,q.r+W,{innerR:q.r-1,start:q.start,end:q.end,borderRadius:q.borderRadius})}constructor(W,q,$){super(W,q,$),this.half=0,this.name??(this.name="Slice");let U=j=>{this.slice(j.type==="select")};dt(this,"select",U),dt(this,"unselect",U)}isValid(){return kt(this.y)&&this.y>=0}setVisible(W,q=!0){W!==this.visible&&this.update({visible:W??!this.visible},q,void 0,!1)}slice(W,q,$){let U=this.series,j=U.chart;Zt($,j),q=Rt(q,!0),this.sliced=this.options.sliced=W=Nt(W)?W:!this.sliced,U.options.data[U.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate())}}return Lt(lt.prototype,{connectorShapes:{fixedOffset:function(at,W,q){let $=W.breakAt,U=W.touchingSliceAt,j=q.softConnector?["C",at.x+(at.alignment==="left"?-5:5),at.y,2*$.x-U.x,2*$.y-U.y,$.x,$.y]:["L",$.x,$.y];return[["M",at.x,at.y],j,["L",U.x,U.y]]},straight:function(at,W){let q=W.touchingSliceAt;return[["M",at.x,at.y],["L",q.x,q.y]]},crookedLine:function(at,W,q){let{breakAt:$,touchingSliceAt:U}=W,{series:j}=this,[et,_t,mt]=j.center,V=mt/2,{plotLeft:rt,plotWidth:I}=j.chart,C=at.alignment==="left",{x:z,y:S}=at,g=$.x;if(q.crookDistance){let y=Z(q.crookDistance,1);g=C?et+V+(I+rt-et-V)*(1-y):rt+(et-V)*y}else g=et+(_t-S)*Math.tan((this.angle||0)-Math.PI/2);let v=[["M",z,S]];return(C?g<=z&&g>=$.x:g>=z&&g<=$.x)&&v.push(["L",g,S]),v.push(["L",$.x,$.y],["L",U.x,U.y]),v}}}),lt}),te(X,"Series/Pie/PieSeriesDefaults.js",[],function(){return{borderRadius:3,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{connectorPadding:5,connectorShape:"crookedLine",crookDistance:void 0,distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}}),te(X,"Series/Pie/PieSeries.js",[X["Series/CenteredUtilities.js"],X["Series/Column/ColumnSeries.js"],X["Core/Globals.js"],X["Series/Pie/PiePoint.js"],X["Series/Pie/PieSeriesDefaults.js"],X["Core/Series/Series.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Renderer/SVG/Symbols.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt,Nt,Lt,kt,ut){let{getStartAndEndRadians:Rt}=Et,{noop:Z}=l,{clamp:lt,extend:at,fireEvent:W,merge:q,pick:$,relativeLength:U,splat:j}=ut;class et extends Nt{animate(mt){let V=this,rt=V.points,I=V.startAngleRad;mt||rt.forEach(function(C){let z=C.graphic,S=C.shapeArgs;z&&S&&(z.attr({r:$(C.startR,V.center&&V.center[3]/2),start:I,end:I}),z.animate({r:S.r,start:S.start,end:S.end},V.options.animation))})}drawEmpty(){let mt,V,rt=this.startAngleRad,I=this.endAngleRad,C=this.options;this.total===0&&this.center?(mt=this.center[0],V=this.center[1],this.graph||(this.graph=this.chart.renderer.arc(mt,V,this.center[1]/2,0,rt,I).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:kt.arc(mt,V,this.center[2]/2,0,{start:rt,end:I,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":C.borderWidth,fill:C.fillColor||"none",stroke:C.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())}drawPoints(){let mt=this.chart.renderer;this.points.forEach(function(V){V.graphic&&V.hasNewShapeType()&&(V.graphic=V.graphic.destroy()),V.graphic||(V.graphic=mt[V.shapeType](V.shapeArgs).add(V.series.group),V.delayedRendering=!0)})}generatePoints(){super.generatePoints(),this.updateTotals()}getX(mt,V,rt,I){let C=this.center,z=this.radii?this.radii[rt.index]||0:C[2]/2,S=I.dataLabelPosition,g=(S==null?void 0:S.distance)||0,v=Math.asin(lt((mt-C[1])/(z+g),-1,1));return C[0]+(V?-1:1)*(Math.cos(v)*(z+g))+(g>0?(V?-1:1)*(I.padding||0):0)}hasData(){return!!this.processedXData.length}redrawPoints(){let mt,V,rt,I,C=this,z=C.chart;this.drawEmpty(),C.group&&!z.styledMode&&C.group.shadow(C.options.shadow),C.points.forEach(function(S){let g={};V=S.graphic,!S.isNull&&V?(I=S.shapeArgs,mt=S.getTranslate(),z.styledMode||(rt=C.pointAttribs(S,S.selected&&"select")),S.delayedRendering?(V.setRadialReference(C.center).attr(I).attr(mt),z.styledMode||V.attr(rt).attr({"stroke-linejoin":"round"}),S.delayedRendering=!1):(V.setRadialReference(C.center),z.styledMode||q(!0,g,rt),q(!0,g,I,mt),V.animate(g)),V.attr({visibility:S.visible?"inherit":"hidden"}),V.addClass(S.getClassName(),!0)):V&&(S.graphic=V.destroy())})}sortByAngle(mt,V){mt.sort(function(rt,I){return rt.angle!==void 0&&(I.angle-rt.angle)*V})}translate(mt){W(this,"translate"),this.generatePoints();let V=this.options,rt=V.slicedOffset,I=Rt(V.startAngle,V.endAngle),C=this.startAngleRad=I.start,z=this.endAngleRad=I.end,S=z-C,g=this.points,v=V.ignoreHiddenPoint,y=g.length,T,k,E,w,R,J,wt,ot=0;for(mt||(this.center=mt=this.getCenter()),J=0;J<y;J++){wt=g[J],T=C+ot*S,wt.isValid()&&(!v||wt.visible)&&(ot+=wt.percentage/100),k=C+ot*S;let it={x:mt[0],y:mt[1],r:mt[2]/2,innerR:mt[3]/2,start:Math.round(1e3*T)/1e3,end:Math.round(1e3*k)/1e3};wt.shapeType="arc",wt.shapeArgs=it,(E=(k+T)/2)>1.5*Math.PI?E-=2*Math.PI:E<-Math.PI/2&&(E+=2*Math.PI),wt.slicedTranslation={translateX:Math.round(Math.cos(E)*rt),translateY:Math.round(Math.sin(E)*rt)},w=Math.cos(E)*mt[2]/2,R=Math.sin(E)*mt[2]/2,wt.tooltipPos=[mt[0]+.7*w,mt[1]+.7*R],wt.half=E<-Math.PI/2||E>Math.PI/2?1:0,wt.angle=E}W(this,"afterTranslate")}updateTotals(){let mt=this.points,V=mt.length,rt=this.options.ignoreHiddenPoint,I,C,z=0;for(I=0;I<V;I++)(C=mt[I]).isValid()&&(!rt||C.visible)&&(z+=C.y);for(I=0,this.total=z;I<V;I++)(C=mt[I]).percentage=z>0&&(C.visible||!rt)?C.y/z*100:0,C.total=z}}return et.defaultOptions=q(Nt.defaultOptions,dt),at(et.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawTracker:At.prototype.drawTracker,getCenter:Et.getCenter,getSymbol:Z,isCartesian:!1,noSharedTooltip:!0,pointAttribs:At.prototype.pointAttribs,pointClass:Zt,requireSorting:!1,searchPoint:Z,trackerGroups:["group","dataLabelsGroup"]}),Lt.registerSeriesType("pie",et),et}),te(X,"Series/Pie/PieDataLabel.js",[X["Core/Series/DataLabel.js"],X["Core/Globals.js"],X["Core/Renderer/RendererUtilities.js"],X["Core/Series/SeriesRegistry.js"],X["Core/Utilities.js"]],function(Et,At,l,Zt,dt){var Nt;let{composed:Lt,noop:kt}=At,{distribute:ut}=l,{series:Rt}=Zt,{arrayMax:Z,clamp:lt,defined:at,pick:W,pushUnique:q,relativeLength:$}=dt;return function(U){let j={radialDistributionY:function(rt,I){var C;return(((C=I.dataLabelPosition)==null?void 0:C.top)||0)+rt.distributeBox.pos},radialDistributionX:function(rt,I,C,z,S){let g=S.dataLabelPosition;return rt.getX(C<((g==null?void 0:g.top)||0)+2||C>((g==null?void 0:g.bottom)||0)-2?z:C,I.half,I,S)},justify:function(rt,I,C,z){var S;return z[0]+(rt.half?-1:1)*(C+(((S=I.dataLabelPosition)==null?void 0:S.distance)||0))},alignToPlotEdges:function(rt,I,C,z){let S=rt.getBBox().width;return I?S+z:C-S-z},alignToConnectors:function(rt,I,C,z){let S=0,g;return rt.forEach(function(v){(g=v.dataLabel.getBBox().width)>S&&(S=g)}),I?S+z:C-S-z}};function et(rt,I){let{center:C,options:z}=this,S=C[2]/2,g=rt.angle||0,v=Math.cos(g),y=Math.sin(g),T=C[0]+v*S,k=C[1]+y*S,E=Math.min((z.slicedOffset||0)+(z.borderWidth||0),I/5);return{natural:{x:T+v*I,y:k+y*I},computed:{},alignment:I<0?"center":rt.half?"right":"left",connectorPosition:{breakAt:{x:T+v*E,y:k+y*E},touchingSliceAt:{x:T,y:k}},distance:I}}function _t(){var Q;let rt=this,I=rt.points,C=rt.chart,z=C.plotWidth,S=C.plotHeight,g=C.plotLeft,v=Math.round(C.chartWidth/3),y=rt.center,T=y[2]/2,k=y[1],E=[[],[]],w=[0,0,0,0],R=rt.dataLabelPositioners,J,wt,ot,it=0;rt.visible&&((Q=rt.hasDataLabels)!=null&&Q.call(rt))&&(I.forEach(A=>{(A.dataLabels||[]).forEach(B=>{B.shortened&&(B.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),B.shortened=!1)})}),Rt.prototype.drawDataLabels.apply(rt),I.forEach(A=>{(A.dataLabels||[]).forEach((B,K)=>{var D;let pt=y[2]/2,_=B.options,P=$((_==null?void 0:_.distance)||0,pt);K===0&&E[A.half].push(A),!at((D=_==null?void 0:_.style)==null?void 0:D.width)&&B.getBBox().width>v&&(B.css({width:Math.round(.7*v)+"px"}),B.shortened=!0),B.dataLabelPosition=this.getDataLabelPosition(A,P),it=Math.max(it,P)})}),E.forEach((A,B)=>{let K=A.length,pt=[],_,P,D=0,Y;K&&(rt.sortByAngle(A,B-.5),it>0&&(_=Math.max(0,k-T-it),P=Math.min(k+T+it,C.plotHeight),A.forEach(G=>{(G.dataLabels||[]).forEach((xt,Ct)=>{var jt;let Dt=xt.dataLabelPosition;Dt&&Dt.distance>0&&(Dt.top=Math.max(0,k-T-Dt.distance),Dt.bottom=Math.min(k+T+Dt.distance,C.plotHeight),D=xt.getBBox().height||21,G.distributeBox={target:(((jt=xt.dataLabelPosition)==null?void 0:jt.natural.y)||0)-Dt.top+D/2,size:D,rank:G.y},pt.push(G.distributeBox))})}),ut(pt,Y=P+D-_,Y/5)),A.forEach(G=>{(G.dataLabels||[]).forEach(xt=>{let Ct=xt.options||{},Dt=G.distributeBox,jt=xt.dataLabelPosition,Kt=(jt==null?void 0:jt.natural.y)||0,ee=Ct.connectorPadding||0,le=0,ht=Kt,st="inherit";if(jt){if(pt&&at(Dt)&&jt.distance>0&&(Dt.pos===void 0?st="hidden":(ot=Dt.size,ht=R.radialDistributionY(G,xt))),Ct.justify)le=R.justify(G,xt,T,y);else switch(Ct.alignTo){case"connectors":le=R.alignToConnectors(A,B,z,g);break;case"plotEdges":le=R.alignToPlotEdges(xt,B,z,g);break;default:le=R.radialDistributionX(rt,G,ht,Kt,xt)}if(jt.attribs={visibility:st,align:jt.alignment},jt.posAttribs={x:le+(Ct.x||0)+({left:ee,right:-ee}[jt.alignment]||0),y:ht+(Ct.y||0)-xt.getBBox().height/2},jt.computed.x=le,jt.computed.y=ht,W(Ct.crop,!0)){let Tt;le-(wt=xt.getBBox().width)<ee&&B===1?(Tt=Math.round(wt-le+ee),w[3]=Math.max(Tt,w[3])):le+wt>z-ee&&B===0&&(Tt=Math.round(le+wt-z+ee),w[1]=Math.max(Tt,w[1])),ht-ot/2<0?w[0]=Math.max(Math.round(-ht+ot/2),w[0]):ht+ot/2>S&&(w[2]=Math.max(Math.round(ht+ot/2-S),w[2])),jt.sideOverflow=Tt}}})}))}),(Z(w)===0||this.verifyDataLabelOverflow(w))&&(this.placeDataLabels(),this.points.forEach(A=>{(A.dataLabels||[]).forEach(B=>{var P;let{connectorColor:K,connectorWidth:pt=1}=B.options||{},_=B.dataLabelPosition;if(pt){let D;J=B.connector,_&&_.distance>0?(D=!J,J||(B.connector=J=C.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+A.colorIndex+(A.className?" "+A.className:"")).add(rt.dataLabelsGroup)),C.styledMode||J.attr({"stroke-width":pt,stroke:K||A.color||"#666666"}),J[D?"attr":"animate"]({d:A.getConnectorPath(B)}),J.attr({visibility:(P=_.attribs)==null?void 0:P.visibility})):J&&(B.connector=J.destroy())}})})))}function mt(){this.points.forEach(rt=>{(rt.dataLabels||[]).forEach(I=>{var z;let C=I.dataLabelPosition;C?(C.sideOverflow&&(I.css({width:Math.max(I.getBBox().width-C.sideOverflow,0)+"px",textOverflow:(((z=I.options)==null?void 0:z.style)||{}).textOverflow||"ellipsis"}),I.shortened=!0),I.attr(C.attribs),I[I.moved?"animate":"attr"](C.posAttribs),I.moved=!0):I&&I.attr({y:-9999})}),delete rt.distributeBox},this)}function V(rt){let I=this.center,C=this.options,z=C.center,S=C.minSize||80,g=S,v=C.size!==null;return!v&&(z[0]!==null?g=Math.max(I[2]-Math.max(rt[1],rt[3]),S):(g=Math.max(I[2]-rt[1]-rt[3],S),I[0]+=(rt[3]-rt[1])/2),z[1]!==null?g=lt(g,S,I[2]-Math.max(rt[0],rt[2])):(g=lt(g,S,I[2]-rt[0]-rt[2]),I[1]+=(rt[0]-rt[2])/2),g<I[2]?(I[2]=g,I[3]=Math.min(C.thickness?Math.max(0,g-2*C.thickness):Math.max(0,$(C.innerSize||0,g)),g),this.translate(I),this.drawDataLabels&&this.drawDataLabels()):v=!0),v}U.compose=function rt(I){if(Et.compose(Rt),q(Lt,rt)){let C=I.prototype;C.dataLabelPositioners=j,C.alignDataLabel=kt,C.drawDataLabels=_t,C.getDataLabelPosition=et,C.placeDataLabels=mt,C.verifyDataLabelOverflow=V}}}(Nt||(Nt={})),Nt}),te(X,"Extensions/OverlappingDataLabels.js",[X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At){let{composed:l}=Et,{addEvent:Zt,fireEvent:dt,isNumber:Nt,objectEach:Lt,pick:kt,pushUnique:ut}=At;function Rt(at){let W=at.length,q=this.renderer,$=(I,C)=>!(C.x>=I.x+I.width||C.x+C.width<=I.x||C.y>=I.y+I.height||C.y+C.height<=I.y),U=I=>{let C=I.box?0:I.padding||0,z,S,g,v=0,y=0,T,k;if(I&&(!I.alignAttr||I.placed))return z=I.alignAttr||{x:I.attr("x"),y:I.attr("y")},S=I.parentGroup,I.width||(g=I.getBBox(),I.width=g.width,I.height=g.height,v=q.fontMetrics(I.element).h),T=I.width-2*C,(k={left:"0",center:"0.5",right:"1"}[I.alignValue])?y=+k*T:Nt(I.x)&&Math.round(I.x)!==I.translateX&&(y=I.x-(I.translateX||0)),{x:z.x+(S.translateX||0)+C-(y||0),y:z.y+(S.translateY||0)+C-v,width:I.width-2*C,height:(I.height||0)-2*C}},j,et,_t,mt,V,rt=!1;for(let I=0;I<W;I++)(j=at[I])&&(j.oldOpacity=j.opacity,j.newOpacity=1,j.absoluteBox=U(j));at.sort((I,C)=>(C.labelrank||0)-(I.labelrank||0));for(let I=0;I<W;++I){mt=(et=at[I])&&et.absoluteBox;for(let C=I+1;C<W;++C)V=(_t=at[C])&&_t.absoluteBox,mt&&V&&et!==_t&&et.newOpacity!==0&&_t.newOpacity!==0&&et.visibility!=="hidden"&&_t.visibility!=="hidden"&&$(mt,V)&&((et.labelrank<_t.labelrank?et:_t).newOpacity=0)}for(let I of at)Z(I,this)&&(rt=!0);rt&&dt(this,"afterHideAllOverlappingLabels")}function Z(at,W){let q,$=!1;return at&&(q=at.newOpacity,at.oldOpacity!==q&&(at.hasClass("highcharts-data-label")?(at[q?"removeClass":"addClass"]("highcharts-data-label-hidden"),$=!0,at[at.isOld?"animate":"attr"]({opacity:q},void 0,function(){W.styledMode||at.css({pointerEvents:q?"auto":"none"})}),dt(W,"afterHideOverlappingLabel")):at.attr({opacity:q})),at.isOld=!0),$}function lt(){var q;let at=this,W=[];for(let $ of at.labelCollectors||[])W=W.concat($());for(let $ of at.yAxis||[])$.stacking&&$.options.stackLabels&&!$.options.stackLabels.allowOverlap&&Lt($.stacking.stacks,U=>{Lt(U,j=>{j.label&&W.push(j.label)})});for(let $ of at.series||[])if($.visible&&((q=$.hasDataLabels)!=null&&q.call($))){let U=j=>{for(let et of j)et.visible&&(et.dataLabels||[]).forEach(_t=>{var V;let mt=_t.options||{};_t.labelrank=kt(mt.labelrank,et.labelrank,(V=et.shapeArgs)==null?void 0:V.height),mt.allowOverlap??Number(mt.distance)>0?(_t.oldOpacity=_t.opacity,_t.newOpacity=1,Z(_t,at)):W.push(_t)})};U($.nodes||[]),U($.points)}this.hideOverlappingLabels(W)}return{compose:function at(W){if(ut(l,at)){let q=W.prototype;q.hideOverlappingLabels=Rt,Zt(W,"render",lt)}}}}),te(X,"Extensions/BorderRadius.js",[X["Core/Defaults.js"],X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At,l){let{defaultOptions:Zt}=Et,{composed:dt,noop:Nt}=At,{addEvent:Lt,extend:kt,isObject:ut,merge:Rt,pushUnique:Z,relativeLength:lt}=l,at={radius:0,scope:"stack",where:void 0},W=Nt,q=Nt;function $(mt,V,rt,I,C={}){let z=W(mt,V,rt,I,C),{innerR:S=0,r:g=rt,start:v=0,end:y=0}=C;if(C.open||!C.borderRadius)return z;let T=y-v,k=Math.sin(T/2),E=Math.max(Math.min(lt(C.borderRadius||0,g-S),(g-S)/2,g*k/(1+k)),0),w=Math.min(E,2*(T/Math.PI)*S),R=z.length-1;for(;R--;)(function(J,wt,ot){let it,Q,A,B=J[wt],K=J[wt+1];if(K[0]==="Z"&&(K=J[0]),(B[0]==="M"||B[0]==="L")&&K[0]==="A"?(it=B,Q=K,A=!0):B[0]==="A"&&(K[0]==="M"||K[0]==="L")&&(it=K,Q=B),it&&Q&&Q.params){let pt=Q[1],_=Q[5],P=Q.params,{start:D,end:Y,cx:G,cy:xt}=P,Ct=_?pt-ot:pt+ot,Dt=Ct?Math.asin(ot/Ct):0,jt=_?Dt:-Dt,Kt=Math.cos(Dt)*Ct;A?(P.start=D+jt,it[1]=G+Kt*Math.cos(D),it[2]=xt+Kt*Math.sin(D),J.splice(wt+1,0,["A",ot,ot,0,0,1,G+pt*Math.cos(P.start),xt+pt*Math.sin(P.start)])):(P.end=Y-jt,Q[6]=G+pt*Math.cos(P.end),Q[7]=xt+pt*Math.sin(P.end),J.splice(wt+1,0,["A",ot,ot,0,0,1,G+Kt*Math.cos(Y),xt+Kt*Math.sin(Y)])),Q[4]=Math.abs(P.end-P.start)<Math.PI?0:1}})(z,R,R>1?w:E);return z}function U(){var mt,V;if(this.options.borderRadius&&!(this.chart.is3d&&this.chart.is3d())){let{options:rt,yAxis:I}=this,C=rt.stacking==="percent",z=(V=(mt=Zt.plotOptions)==null?void 0:mt[this.type])==null?void 0:V.borderRadius,S=j(rt.borderRadius,ut(z)?z:{}),g=I.options.reversed;for(let v of this.points){let{shapeArgs:y}=v;if(v.shapeType==="roundedRect"&&y){let{width:T=0,height:k=0,y:E=0}=y,w=E,R=k;if(S.scope==="stack"&&v.stackTotal){let it=I.translate(C?100:v.stackTotal,!1,!0,!1,!0),Q=I.translate(rt.threshold||0,!1,!0,!1,!0),A=this.crispCol(0,Math.min(it,Q),0,Math.abs(it-Q));w=A.y,R=A.height}let J=(v.negative?-1:1)*(g?-1:1)==-1,wt=S.where;!wt&&this.is("waterfall")&&Math.abs((v.yBottom||0)-(this.translatedThreshold||0))>this.borderWidth&&(wt="all"),wt||(wt="end");let ot=Math.min(lt(S.radius,T),T/2,wt==="all"?k/2:1/0)||0;wt==="end"&&(J&&(w-=ot),R+=ot),kt(y,{brBoxHeight:R,brBoxY:w,r:ot})}}}}function j(mt,V){return ut(mt)||(mt={radius:mt||0}),Rt(at,V,mt)}function et(){let mt=j(this.options.borderRadius);for(let V of this.points){let rt=V.shapeArgs;rt&&(rt.borderRadius=lt(mt.radius,(rt.r||0)-(rt.innerR||0)))}}function _t(mt,V,rt,I,C={}){let z=q(mt,V,rt,I,C),{r:S=0,brBoxHeight:g=I,brBoxY:v=V}=C,y=V-v,T=v+g-(V+I),k=y-S>-.1?0:S,E=T-S>-.1?0:S,w=Math.max(k&&y,0),R=Math.max(E&&T,0),J=[mt+k,V],wt=[mt+rt-k,V],ot=[mt+rt,V+k],it=[mt+rt,V+I-E],Q=[mt+rt-E,V+I],A=[mt+E,V+I],B=[mt,V+I-E],K=[mt,V+k],pt=(_,P)=>Math.sqrt(Math.pow(_,2)-Math.pow(P,2));if(w){let _=pt(k,k-w);J[0]-=_,wt[0]+=_,ot[1]=K[1]=V+k-w}if(I<k-w){let _=pt(k,k-w-I);ot[0]=it[0]=mt+rt-k+_,Q[0]=Math.min(ot[0],Q[0]),A[0]=Math.max(it[0],A[0]),B[0]=K[0]=mt+k-_,ot[1]=K[1]=V+I}if(R){let _=pt(E,E-R);Q[0]+=_,A[0]-=_,it[1]=B[1]=V+I-E+R}if(I<E-R){let _=pt(E,E-R-I);ot[0]=it[0]=mt+rt-E+_,wt[0]=Math.min(ot[0],wt[0]),J[0]=Math.max(it[0],J[0]),B[0]=K[0]=mt+E-_,it[1]=B[1]=V}return z.length=0,z.push(["M",...J],["L",...wt],["A",k,k,0,0,1,...ot],["L",...it],["A",E,E,0,0,1,...Q],["L",...A],["A",E,E,0,0,1,...B],["L",...K],["A",k,k,0,0,1,...J],["Z"]),z}return{compose:function mt(V,rt,I,C){if(Z(dt,mt)){let z=C.prototype.symbols;Lt(V,"afterColumnTranslate",U,{order:9}),Lt(rt,"afterTranslate",et),I.symbolCustomAttribs.push("borderRadius","brBoxHeight","brBoxY"),W=z.arc,q=z.roundedRect,z.arc=$,z.roundedRect=_t}},optionsToObject:j}}),te(X,"Core/Responsive.js",[X["Core/Globals.js"],X["Core/Utilities.js"]],function(Et,At){var l;let{composed:Zt}=Et,{diffObjects:dt,extend:Nt,find:Lt,merge:kt,pick:ut,pushUnique:Rt,uniqueKey:Z}=At;return function(lt){function at(q,$){let U=q.condition;(U.callback||function(){return this.chartWidth<=ut(U.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=ut(U.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=ut(U.minWidth,0)&&this.chartHeight>=ut(U.minHeight,0)}).call(this)&&$.push(q._id)}function W(q,$){let U=this.options.responsive,j=this.currentResponsive,et=[],_t;!$&&U&&U.rules&&U.rules.forEach(rt=>{rt._id===void 0&&(rt._id=Z()),this.matchResponsiveRule(rt,et)},this);let mt=kt(...et.map(rt=>Lt((U||{}).rules||[],I=>I._id===rt)).map(rt=>rt&&rt.chartOptions));mt.isResponsiveOptions=!0,et=et.toString()||void 0;let V=j&&j.ruleIds;et!==V&&(j&&this.update(j.undoOptions,q,!0),et?((_t=dt(mt,this.options,!0,this.collectionsWithUpdate)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:et,mergedOptions:mt,undoOptions:_t},this.update(mt,q,!0)):this.currentResponsive=void 0)}lt.compose=function q($){return Rt(Zt,q)&&Nt($.prototype,{matchResponsiveRule:at,setResponsive:W}),$}}(l||(l={})),l}),te(X,"masters/highcharts.src.js",[X["Core/Globals.js"],X["Core/Utilities.js"],X["Core/Defaults.js"],X["Core/Animation/Fx.js"],X["Core/Animation/AnimationUtilities.js"],X["Core/Renderer/HTML/AST.js"],X["Core/Templating.js"],X["Core/Renderer/RendererUtilities.js"],X["Core/Renderer/SVG/SVGElement.js"],X["Core/Renderer/SVG/SVGRenderer.js"],X["Core/Renderer/HTML/HTMLElement.js"],X["Core/Renderer/HTML/HTMLRenderer.js"],X["Core/Axis/Axis.js"],X["Core/Axis/DateTimeAxis.js"],X["Core/Axis/LogarithmicAxis.js"],X["Core/Axis/PlotLineOrBand/PlotLineOrBand.js"],X["Core/Axis/Tick.js"],X["Core/Tooltip.js"],X["Core/Series/Point.js"],X["Core/Pointer.js"],X["Core/Legend/Legend.js"],X["Core/Chart/Chart.js"],X["Extensions/ScrollablePlotArea.js"],X["Core/Axis/Stacking/StackingAxis.js"],X["Core/Axis/Stacking/StackItem.js"],X["Core/Series/Series.js"],X["Core/Series/SeriesRegistry.js"],X["Series/Column/ColumnSeries.js"],X["Series/Column/ColumnDataLabel.js"],X["Series/Pie/PieSeries.js"],X["Series/Pie/PieDataLabel.js"],X["Core/Series/DataLabel.js"],X["Extensions/OverlappingDataLabels.js"],X["Extensions/BorderRadius.js"],X["Core/Responsive.js"],X["Core/Color/Color.js"],X["Core/Time.js"]],function(Et,At,l,Zt,dt,Nt,Lt,kt,ut,Rt,Z,lt,at,W,q,$,U,j,et,_t,mt,V,rt,I,C,z,S,g,v,y,T,k,E,w,R,J,wt){return Et.animate=dt.animate,Et.animObject=dt.animObject,Et.getDeferredAnimation=dt.getDeferredAnimation,Et.setAnimation=dt.setAnimation,Et.stop=dt.stop,Et.timers=Zt.timers,Et.AST=Nt,Et.Axis=at,Et.Chart=V,Et.chart=V.chart,Et.Fx=Zt,Et.Legend=mt,Et.PlotLineOrBand=$,Et.Point=et,Et.Pointer=_t,Et.Series=z,Et.StackItem=C,Et.SVGElement=ut,Et.SVGRenderer=Rt,Et.Templating=Lt,Et.Tick=U,Et.Time=wt,Et.Tooltip=j,Et.Color=J,Et.color=J.parse,lt.compose(Rt),Z.compose(ut),_t.compose(V),mt.compose(V),Et.defaultOptions=l.defaultOptions,Et.getOptions=l.getOptions,Et.time=l.defaultTime,Et.setOptions=l.setOptions,Et.dateFormat=Lt.dateFormat,Et.format=Lt.format,Et.numberFormat=Lt.numberFormat,At.extend(Et,At),Et.distribute=kt.distribute,Et.seriesType=S.seriesType,v.compose(g),w.compose(z,y,ut,Rt),k.compose(z),W.compose(at),q.compose(at),E.compose(V),T.compose(y),$.compose(at),R.compose(V),rt.compose(at,V,z),I.compose(at,V,z),j.compose(_t),Et}),X["masters/highcharts.src.js"]._modules=X,X["masters/highcharts.src.js"]})})(Rp);var bo=Rp.exports;const Fp=[{name:"medrnt",description:"Median Rent",format:"dollars",type:"financial",data:[{county:45,year:1990,value:521},{county:45,year:2e3,value:627},{county:45,year:2010,value:600},{county:45,year:2016,value:645}],legend:[{color:"#ecf7e9",label:"$0 - 385"},{color:"#c5e8be",label:"$386 - 434"},{color:"#a0d99a",label:"$435 - 468"},{color:"#74c477",label:"$469 - 512"},{color:"#41ab5d",label:"$513 - 568"},{color:"#238c46",label:"$569 - 681"},{color:"#005931",label:"$682 - 1383"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"capinc",description:"Per Capita Income",format:"dollars",type:"financial",data:[{county:45,year:1990,value:26080},{county:45,year:2e3,value:31903},{county:45,year:2010,value:28602},{county:45,year:2016,value:28065}],legend:[{color:"#ecf7e9",label:"$0-15,638"},{color:"#c5e8be",label:"$15,639-19,501"},{color:"#a0d99a",label:"$19,502-21,846"},{color:"#74c477",label:"$21,847-24,471"},{color:"#41ab5d",label:"$24,472-27,726"},{color:"#238c46",label:"$27,727-33,313"},{color:"#005931",label:"$33,314-72,315"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"snap",description:"SNAP",format:"percent",type:"financial",data:[{county:45,year:1990,value:""},{county:45,year:2e3,value:""},{county:45,year:2010,value:9.1},{county:45,year:2016,value:11.2}],legend:[{color:"#ecf7e9",label:"0 - 3.0%"},{color:"#c5e8be",label:"3.0 - 5.6%"},{color:"#a0d99a",label:"5.6 - 7.9%"},{color:"#74c477",label:"7.9 - 10.3%"},{color:"#41ab5d",label:"10.3 - 13.5%"},{color:"#238c46",label:"13.5 - 20.5%"},{color:"#005931",label:"20.5 - 58.7%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"hocost",description:"Percent of Households with Mortage Costs Exceeding 35% of Household Income",format:"percent",type:"financial",data:[{county:45,year:1990,value:9.8},{county:45,year:2e3,value:13.2},{county:45,year:2010,value:17.9},{county:45,year:2016,value:13.3}],legend:[{color:"#ecf7e9",label:"0 - 8.0%"},{color:"#c5e8be",label:"8.0 - 12.5%"},{color:"#a0d99a",label:"12.5 - 15.8%"},{color:"#74c477",label:"15.8 - 19.6%"},{color:"#41ab5d",label:"19.6 - 24.1%"},{color:"#238c46",label:"24.1 - 30.5%"},{color:"#005931",label:"30.5 - 43.3%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"medhv",description:"Median House Value",format:"dollars",type:"financial",data:[{county:45,year:1990,value:117324},{county:45,year:2e3,value:156228},{county:45,year:2010,value:163354},{county:45,year:2016,value:160900}],legend:[{color:"#ecf7e9",label:"$0 - 86,433"},{color:"#c5e8be",label:"$86,433 - 100,085"},{color:"#a0d99a",label:"$100,085 - 114,729"},{color:"#74c477",label:"$114,729 - 135,648"},{color:"#41ab5d",label:"$135,648 - 165,597"},{color:"#238c46",label:"$165,597 - 193,233"},{color:"#005931",label:"$193,233 - 533,500"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"unemp",description:"Unemployment",format:"percent",type:"financial",data:[{county:45,year:1990,value:4.6},{county:45,year:2e3,value:4.6},{county:45,year:2010,value:8},{county:45,year:2016,value:6.4}],legend:[{color:"#ecf7e9",label:"0 - 2.2%"},{color:"#c5e8be",label:"2.2 - 3.2%"},{color:"#a0d99a",label:"3.2 - 3.9%"},{color:"#74c477",label:"3.9 - 4.8%"},{color:"#41ab5d",label:"4.8 - 6.0%"},{color:"#238c46",label:"6.0 - 8.3%"},{color:"#005931",label:"8.3 - 32.5%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"povind",description:"Individual Poverty Status",format:"percent",type:"financial",data:[{county:45,year:1990,value:10.5},{county:45,year:2e3,value:10.5},{county:45,year:2010,value:14.1},{county:45,year:2016,value:14.3}],legend:[{color:"#ecf7e9",label:"0 - 6.4%"},{color:"#c5e8be",label:"6.4 - 9.4%"},{color:"#a0d99a",label:"9.4 - 13.5%"},{color:"#74c477",label:"13.5 - 18.2%"},{color:"#41ab5d",label:"18.2 - 21.8%"},{color:"#238c46",label:"21.8 - 30.4%"},{color:"#005931",label:"30.4 - 76.4%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"gini",description:"Gini Index (Income Inequality)",format:"index",type:"financial",data:[{county:45,year:1990,value:""},{county:45,year:2e3,value:""},{county:45,year:2010,value:.47},{county:45,year:2016,value:.47}],legend:[{color:"#ecf7e9",label:"0 - .358"},{color:"#c5e8be",label:".359 - .394"},{color:"#a0d99a",label:".395 - .414"},{color:"#74c477",label:".415 - .432"},{color:"#41ab5d",label:".433 - .457"},{color:"#238c46",label:".458 - .490"},{color:"#005931",label:".491 - .728"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"povfam",description:"Family Poverty Status",format:"percent",type:"financial",data:[{county:45,year:1990,value:8.3},{county:45,year:2e3,value:8.9},{county:45,year:2010,value:12.1},{county:45,year:2016,value:12.1}],legend:[{color:"#ecf7e9",label:"0 - 3.9%"},{color:"#c5e8be",label:"3.9 - 7.3%"},{color:"#a0d99a",label:"7.3 - 10.4%"},{color:"#74c477",label:"10.4 - 15.3%"},{color:"#41ab5d",label:"15.3 - 19.4%"},{color:"#238c46",label:"19.4 - 27.2%"},{color:"#005931",label:"27.2 - 77.8%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"medinc",description:"Median Household Income",format:"dollars",type:"financial",data:[{county:45,year:1990,value:54505},{county:45,year:2e3,value:59452},{county:45,year:2010,value:51653},{county:45,year:2016,value:51595}],legend:[{color:"#ecf7e9",label:"$0 - 28,859"},{color:"#c5e8be",label:"$28,859 - 36,984"},{color:"#a0d99a",label:"$36,984 - 43,742"},{color:"#74c477",label:"$43,742 - 49,273"},{color:"#41ab5d",label:"$49,273 - 57,056"},{color:"#238c46",label:"$57,056 - 66,282"},{color:"#005931",label:"$66,282 - 148,405"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"insure",description:"No Health Insurance",format:"percent",type:"financial",data:[{county:45,year:1990,value:""},{county:45,year:2e3,value:""},{county:45,year:2010,value:""},{county:45,year:2016,value:13.5}],legend:[{color:"#ecf7e9",label:"0 - 7.7%"},{color:"#c5e8be",label:"7.7 - 10.2%"},{color:"#a0d99a",label:"10.2 - 11.9%"},{color:"#74c477",label:"11.9 - 13.8%"},{color:"#41ab5d",label:"13.8 - 16.3%"},{color:"#238c46",label:"16.3 - 31.2%"},{color:"#005931",label:"31.2 - 37.3%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"rntcost",description:"Percent of Households with Rental Costs Exceeding 35% of Household Income",format:"percent",type:"financial",data:[{county:45,year:1990,value:25.3},{county:45,year:2e3,value:27.8},{county:45,year:2010,value:38},{county:45,year:2016,value:38.1}],legend:[{color:"#ecf7e9",label:"0 - 21.3%"},{color:"#c5e8be",label:"21.3 - 30.1%"},{color:"#a0d99a",label:"30.1 - 36.0%"},{color:"#74c477",label:"36.0 - 41.5%"},{color:"#41ab5d",label:"41.5 - 47.3%"},{color:"#238c46",label:"47.3 - 53.1%"},{color:"#005931",label:"53.1 - 100.0%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"B1940_",description:"Percent of total housing units built in 1939 or earlier out of the total housing units",format:"percent",type:"manufactured",data:[{county:45,year:1990,value:9},{county:45,year:2e3,value:6.4},{county:45,year:2010,value:5},{county:45,year:2016,value:4.2}],legend:[{color:"#ffedde",label:"0 - .7%"},{color:"#fccfa2",label:".7 - 1.6%"},{color:"#fcae6a",label:"1.6 - 2.9%"},{color:"#fc8d3d",label:"2.9 - 4.6%"},{color:"#f26913",label:"4.6 - 7.8%"},{color:"#d94800",label:"7.8 - 14.8%"},{color:"#8c2d04",label:"14.8 - 55.3%"}]},{name:"heat",description:"Percentage of occupied housing units with inadequate heating fuel. Defined as using either: Fuel oil, kerosene, etc.; Coal or coke; Wood; or No fuel used",format:"percent",type:"manufactured",data:[{county:45,year:1990,value:26.8},{county:45,year:2e3,value:9.9},{county:45,year:2010,value:4.6},{county:45,year:2016,value:2.6}],legend:[{color:"#ffedde",label:"0 - 3.1%"},{color:"#fccfa2",label:"3.1 - 5.9%"},{color:"#fcae6a",label:"5.9 - 9.6%"},{color:"#fc8d3d",label:"9.6 - 11.3%"},{color:"#f26913",label:"11.3 - 14.3%"},{color:"#d94800",label:"14.3 - 18.6%"},{color:"#8c2d04",label:"18.6 - 59.4%"}]},{name:"mhome",description:"Percent of occupied housing units that are defined as mobile homes",format:"percent",type:"manufactured",data:[{county:45,year:1990,value:10},{county:45,year:2e3,value:10.7},{county:45,year:2010,value:9.6},{county:45,year:2016,value:9}],legend:[{color:"#ffedde",label:"0 - 1.3%"},{color:"#fccfa2",label:"1.3 - 3.5%"},{color:"#fcae6a",label:"3.5 - 7.4%"},{color:"#fc8d3d",label:"7.4 - 14.4%"},{color:"#f26913",label:"14.4 - 21.7%"},{color:"#d94800",label:"21.7 - 31.5%"},{color:"#8c2d04",label:"31.5 - 54.2%"}]},{name:"rentocc",description:"Percentage of occupied housing units that are currently renter-occupied",format:"percent",type:"manufactured",data:[{county:45,year:1990,value:33.8},{county:45,year:2e3,value:31.8},{county:45,year:2010,value:32},{county:45,year:2016,value:34.3}],legend:[{color:"#ffedde",label:"0 - 12.8%"},{color:"#fccfa2",label:"12.8 - 18.0%"},{color:"#fcae6a",label:"18.0 - 24.1%"},{color:"#fc8d3d",label:"24.1 - 30.5%"},{color:"#f26913",label:"30.5 - 39.6%"},{color:"#d94800",label:"39.6 - 57.7%"},{color:"#8c2d04",label:"57.7 - 98.9%"}]},{name:"vacant",description:"Percentage of housing units that are vacant/unoccupied",format:"percent",type:"manufactured",data:[{county:45,year:1990,value:6.7},{county:45,year:2e3,value:8.1},{county:45,year:2010,value:10.4},{county:45,year:2016,value:9.5}],legend:[{color:"#ffedde",label:"0 - 5.7%"},{color:"#fccfa2",label:"5.7 - 8.2%"},{color:"#fcae6a",label:"8.2 - 10.1%"},{color:"#fc8d3d",label:"10.1 - 12.8%"},{color:"#f26913",label:"12.8 - 15.2%"},{color:"#d94800",label:"15.2 - 19.1%"},{color:"#8c2d04",label:"19.1 - 47.8%"}]},{name:"vehicle",description:"Percentage of occupied housing units with no vehicles available",format:"percent",type:"manufactured",data:[{county:45,year:1990,value:8.8},{county:45,year:2e3,value:7.6},{county:45,year:2010,value:6.3},{county:45,year:2016,value:6.3}],legend:[{color:"#ffedde",label:"0 - 2.5%"},{color:"#fccfa2",label:"2.5 - 3.9%"},{color:"#fcae6a",label:"3.9 - 5.4%"},{color:"#fc8d3d",label:"5.4 - 7.7%"},{color:"#f26913",label:"7.7 - 16.0%"},{color:"#d94800",label:"16.0 - 34.5%"},{color:"#8c2d04",label:"34.5 - 59.3"}]},{name:"lingiso",description:"Percentage of households where all individuals 14 or older have some difficulty speaking English",format:"percent",type:"social",data:[{county:45,year:1990,value:.5},{county:45,year:2e3,value:1.8},{county:45,year:2010,value:3.6},{county:45,year:2016,value:3.5}],legend:[{color:"#f3f2f7",label:"0%"},{color:"#dfdfed",label:"0 - .7%"},{color:"#c1c4de",label:".7 - 1.4%"},{color:"#a7a3cc",label:"1.4 - 1.9%"},{color:"#8e8cc2",label:"1.9 - 3.1%"},{color:"#7963ab",label:"3.1 - 5.3%"},{color:"#5d2c94",label:"5.3 - 24.4%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"moved",description:"Percent of population that moved to a different MSA (Metropolitan Statistical Area) within the last five years",format:"percent",type:"social",data:[{county:45,year:1990,value:45.8},{county:45,year:2e3,value:48.5},{county:45,year:2010,value:""},{county:45,year:2016,value:""}],legend:[{color:"#f3f2f7",label:"0 - 34.6%"},{color:"#dfdfed",label:"34.6 - 37.0"},{color:"#c1c4de",label:"37.0 - 40.0"},{color:"#a7a3cc",label:"40.0 - 42.8"},{color:"#8e8cc2",label:"42.8 - 47.0"},{color:"#7963ab",label:"47.0 - 54.2%"},{color:"#5d2c94",label:"54.2 - 91.5%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"movedlast",description:"Percent of population that moved to a different MSA (Metropolitan Statistical Area) within the last year",format:"percent",type:"social",data:[{county:45,year:1990,value:""},{county:45,year:2e3,value:""},{county:45,year:2010,value:17.2},{county:45,year:2016,value:13.7}],legend:[{color:"#f3f2f7",label:"0 - 8.5%"},{color:"#dfdfed",label:"8.5 - 10.9%"},{color:"#c1c4de",label:"10.9 - 14.2%"},{color:"#a7a3cc",label:"14.2 - 16.6%"},{color:"#8e8cc2",label:"16.6 - 19.5%"},{color:"#7963ab",label:"19.5 - 25.8%"},{color:"#5d2c94",label:"25.8 - 57.8%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"nonwh",description:"Percent of Population That Does Not Identify as White Only",format:"percent",type:"human",data:[{county:45,year:1990,value:19.1},{county:45,year:2e3,value:22.5},{county:45,year:2010,value:23.3},{county:45,year:2016,value:24}],legend:[{color:"#f2f5ff",label:"0 - 7.3%"},{color:"#cee1f2",label:"7.3 - 13.0%"},{color:"#a8cee3",label:"13.0 - 17.0%"},{color:"#79b6d9",label:"17.0 - 23.4%"},{color:"#549ccc",label:"23.4 - 30.9%"},{color:"#377ebd",label:"30.9 - 45.3%"},{color:"#20569e",label:"45.3 - 98.8%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"popden",description:"Population Density (Number of People Per Square Mile)",format:"index",type:"human",data:[{county:45,year:1990,value:404.2},{county:45,year:2e3,value:480.5},{county:45,year:2010,value:555.9},{county:45,year:2016,value:614.1}],legend:[{color:"#f2f5ff",label:"0 - 114.8"},{color:"#cee1f2",label:"114.8 - 203.8"},{color:"#a8cee3",label:"203.8 - 393.6"},{color:"#79b6d9",label:"393.6 - 732.5"},{color:"#549ccc",label:"732.5 - 1,249.8"},{color:"#377ebd",label:"1,249.8 - 2,300.0"},{color:"#20569e",label:"2,300.0 - 8,357.7"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"latino",description:"Percent Latino or Hispanic",format:"percent",type:"human",data:[{county:45,year:1990,value:.9},{county:45,year:2e3,value:3.8},{county:45,year:2010,value:7.4},{county:45,year:2016,value:8.7}],legend:[{color:"#f2f5ff",label:"0 - 1.1%"},{color:"#cee1f2",label:"1.1 - 2.3%"},{color:"#a8cee3",label:"2.3 - 3.5%"},{color:"#79b6d9",label:"3.5 - 5.1%"},{color:"#549ccc",label:"5.1% - 7.2%"},{color:"#377ebd",label:"7.2 - 11.8"},{color:"#20569e",label:"11.8 - 44.3%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"afram_",description:"Percent African American",format:"percent",type:"human",data:[{county:45,year:1990,value:18},{county:45,year:2e3,value:18.3},{county:45,year:2010,value:17.8},{county:45,year:2016,value:18.3}],legend:[{color:"#f2f5ff",label:"0 - 3.7%"},{color:"#cee1f2",label:"3.7 - 5.7%"},{color:"#a8cee3",label:"5.7 - 9.3%"},{color:"#79b6d9",label:"9.3 - 13.5%"},{color:"#549ccc",label:"13.5 - 20.9%"},{color:"#377ebd",label:"20.9 - 37.8%"},{color:"#20569e",label:"37.8 - 98.8%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"age4_",description:"Percent 0-4 Years Old",format:"percent",type:"human",data:[{county:45,year:1990,value:7.1},{county:45,year:2e3,value:6.8},{county:45,year:2010,value:6.9},{county:45,year:2016,value:6.5}],legend:[{color:"#f2f5ff",label:"0 - 4.3%"},{color:"#cee1f2",label:"4.3 - 5.0%"},{color:"#a8cee3",label:"5.0 - 5.9%"},{color:"#79b6d9",label:"5.9 - 6.8%"},{color:"#549ccc",label:"6.8 - 7.9%"},{color:"#377ebd",label:"7.9 - 9.2%"},{color:"#20569e",label:"9.2 - 21.4%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"age17_",description:"Percent 5-17 Years Old",format:"percent",type:"human",data:[{county:45,year:1990,value:17.6},{county:45,year:2e3,value:17.8},{county:45,year:2010,value:17.5},{county:45,year:2016,value:17}],legend:[{color:"#f2f5ff",label:"0 - 12.0%"},{color:"#cee1f2",label:"12.0 - 15.3%"},{color:"#a8cee3",label:"15.3 - 17.1%"},{color:"#79b6d9",label:"17.1 - 18.1%"},{color:"#549ccc",label:"18.1 - 19.3%"},{color:"#377ebd",label:"19.3 - 20.9%"},{color:"#20569e",label:"20.9 - 29.8%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"age64_",description:"Percent 18-64 Years Old",format:"percent",type:"human",data:[{county:45,year:1990,value:63.5},{county:45,year:2e3,value:63.7},{county:45,year:2010,value:63.2},{county:45,year:2016,value:62.2}],legend:[{color:"#f2f5ff",label:"0 - 56.5%"},{color:"#cee1f2",label:"56.5 - 58.5%"},{color:"#a8cee3",label:"58.5 - 60.4%"},{color:"#79b6d9",label:"60.4 - 62.0%"},{color:"#549ccc",label:"62.0 - 63.6%"},{color:"#377ebd",label:"63.6 - 66.7%"},{color:"#20569e",label:"66.7 - 99.0%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"asian",description:"Percent Asian",format:"percent",type:"human",data:[{county:45,year:1990,value:.7},{county:45,year:2e3,value:1.4},{county:45,year:2010,value:1.9},{county:45,year:2016,value:2.1}],legend:[{color:"#f2f5ff",label:"0 - 0"},{color:"#cee1f2",label:"0 - .4%"},{color:"#a8cee3",label:".4 - .7%"},{color:"#79b6d9",label:".7 - 1.3%"},{color:"#549ccc",label:"1.3 - 2.2%"},{color:"#377ebd",label:"2.2 - 4.5%"},{color:"#20569e",label:"4.5 - 17.3%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"depidx",description:"Ratio of youths (17 years or less) and elderly (65 years or more) to the total population of non-dependents (18-64)",format:"index",type:"human",data:[{county:45,year:1990,value:.57504366},{county:45,year:2e3,value:.571},{county:45,year:2010,value:.583},{county:45,year:2016,value:.609}],legend:[{color:"#f2f5ff",label:"0 - .48"},{color:"#cee1f2",label:".48 - .55"},{color:"#a8cee3",label:".55 - .59"},{color:"#79b6d9",label:".59 - .63"},{color:"#549ccc",label:".63 - .67"},{color:"#377ebd",label:".67 - .73"},{color:"#20569e",label:".73 - 1.18"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"dividx",description:"Diversity Index. 0 indicates perfect diversity. 1 indicates no diversity.",format:"index",type:"human",data:[{county:45,year:1990,value:.688},{county:45,year:2e3,value:.635},{county:45,year:2010,value:.621},{county:45,year:2016,value:.612}],legend:[{color:"#3c3a38",label:"0 - .49"},{color:"#20569e",label:".49 - .58"},{color:"#377ebd",label:".58 - .64"},{color:"#549ccc",label:".64 - .71"},{color:"#79b6d9",label:".71 - .77"},{color:"#a8cee3",label:".77 - .86"},{color:"#cee1f2",label:".86 - .99"},{color:"#f2f5ff",label:"Insufficient Data"}]},{name:"educ",description:"Persons aged 25 years and over who have completed less than 4 years of high school as a percentage of all persons 25 years and over",format:"percent",type:"human",data:[{county:45,year:1990,value:28.4},{county:45,year:2e3,value:20.5},{county:45,year:2010,value:16},{county:45,year:2016,value:13.1}],legend:[{color:"#f2f5ff",label:"0 - 5.8%"},{color:"#cee1f2",label:"5.8 - 12.7%"},{color:"#a8cee3",label:"12.7 - 17.2%"},{color:"#79b6d9",label:"17.2 - 20.7%"},{color:"#549ccc",label:"20.7 - 26.4%"},{color:"#377ebd",label:"26.4 - 31.9%"},{color:"#20569e",label:"31.9 - 70.2%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"fhh",description:"Percent of total families with female householders and no husband",format:"percent",type:"human",data:[{county:45,year:1990,value:16.90160074},{county:45,year:2e3,value:11.2},{county:45,year:2010,value:20},{county:45,year:2016,value:19.42015232}],legend:[{color:"#f2f5ff",label:"0 - 9.5%"},{color:"#cee1f2",label:"9.5 - 12.6%"},{color:"#a8cee3",label:"12.6 - 15.1%"},{color:"#79b6d9",label:"15.1 - 20.8%"},{color:"#549ccc",label:"20.8 - 26.8%"},{color:"#377ebd",label:"26.8 - 34.9%"},{color:"#20569e",label:"34.9 - 86.7%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"minperc",description:"Percent of minors 0-17 out of total population",format:"percent",type:"human",data:[{county:45,year:1990,value:24.6},{county:45,year:2e3,value:24.59959538},{county:45,year:2010,value:24.4},{county:45,year:2016,value:23.5}],legend:[{color:"#f2f5ff",label:"0 - 18.0%"},{color:"#cee1f2",label:"18.0 - 22.2%"},{color:"#a8cee3",label:"22.2 - 25.5%"},{color:"#79b6d9",label:"25.5 - 28.9%"},{color:"#549ccc",label:"28.9 - 32.9%"},{color:"#377ebd",label:"32.9 - 38.5"},{color:"#20569e",label:"38.5 - 70.6%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"min04_",description:"Percent of children under 5 out of all children 17 or younger",format:"percent",type:"human",data:[{county:45,year:1990,value:28.7},{county:45,year:2e3,value:27.5},{county:45,year:2010,value:28.2},{county:45,year:2016,value:27.6}],legend:[{color:"#f2f5ff",label:"0 - 18.0%"},{color:"#cee1f2",label:"18.0 - 22.2%"},{color:"#a8cee3",label:"22.2 - 25.5%"},{color:"#79b6d9",label:"25.5 - 28.9%"},{color:"#549ccc",label:"28.9 - 32.9%"},{color:"#377ebd",label:"32.9 - 38.5%"},{color:"#20569e",label:"38.5 - 70.6%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"chldpt",description:"Number of children under 5 years per 1,000 women aged 15 to 44 years of age",format:"index",type:"human",data:[{county:45,year:1990,value:291.1451149},{county:45,year:2e3,value:301.9158802},{county:45,year:2010,value:328.4},{county:45,year:2016,value:323.2}],legend:[{color:"#f2f5ff",label:"0 - 203.5"},{color:"#cee1f2",label:"203.5 - 263.2"},{color:"#a8cee3",label:"263.2 - 297.6"},{color:"#79b6d9",label:"297.6 - 351.0"},{color:"#549ccc",label:"351.0 - 397.0"},{color:"#377ebd",label:"397.0 - 457.3"},{color:"#20569e",label:"457.3 - 814.2"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"presch",description:"Percent preschool (number of preschoolers per total 0-4 year olds)",format:"percent",type:"human",data:[{county:45,year:1990,value:23.00199247},{county:45,year:2e3,value:24.1},{county:45,year:2010,value:23.7},{county:45,year:2016,value:20.2}],legend:[{color:"#f2f5ff",label:"0 - 4.2%"},{color:"#cee1f2",label:"4.2 - 10.7%"},{color:"#a8cee3",label:"10.7 - 15.4%"},{color:"#79b6d9",label:"15.4 - 21.9%"},{color:"#549ccc",label:"21.9 - 30.4%"},{color:"#377ebd",label:"30.4 - 40.0%"},{color:"#20569e",label:"40.0 - 100%"},{color:"#3c3a38",label:"Insufficient Data"}]},{name:"white",description:"Percent white",format:"percent",type:"human",data:[{county:45,year:1990,value:81},{county:45,year:2e3,value:77.5},{county:45,year:2010,value:76.7},{county:45,year:2016,value:76}],legend:[{color:"#f2f5ff",label:"0 - 54.8%"},{color:"#cee1f2",label:"54.8 - 69.4%"},{color:"#a8cee3",label:"69.4 - 76.6%"},{color:"#79b6d9",label:"76.6 - 83.1%"},{color:"#549ccc",label:"83.1 - 87.1%"},{color:"#377ebd",label:"87.1 - 92.7%"},{color:"#20569e",label:"92.7 - 99.7%"},{color:"#3c3a38",label:"Insufficient Data"}]}],Af=Fp;function Ef(ve,se,X,te,Et){const At=Af.filter(dt=>dt.type===X).find(({name:dt})=>dt===se),l=te.map(dt=>{var Nt,Lt;return{year:dt.year,value:dt.value??null,countyMedian:((Lt=(Nt=At==null?void 0:At.data)==null?void 0:Nt.find(({year:kt,county:ut})=>kt===dt.year&&ut===Et.county))==null?void 0:Lt.value)??null}});let Zt="";Et.name&&(Zt+=`<b>ID:</b> ${Et.name}`),Et.neighborhood&&Et.neighborhood!=="-"&&(Zt+=`<br/><b>Neighborhoods include:</b> ${Et.neighborhood}`),bo.setOptions({lang:{thousandsSep:","}}),bo.chart(ve,{title:{text:At==null?void 0:At.description},subtitle:{text:Zt},tooltip:{formatter:function(){if((At==null?void 0:At.format)==="dollars")return"$"+bo.numberFormat(this.y??0,0,".",",");if((At==null?void 0:At.format)==="integer")return bo.numberFormat(this.y??0,0,".",",");if((At==null?void 0:At.format)==="percent")return bo.numberFormat(this.y??0,1,".",",")+"%";if((At==null?void 0:At.format)==="index")return bo.numberFormat(this.y??0,3,".",",")}},xAxis:{categories:l.map(dt=>dt.year.toString()),title:{text:"Year"}},legend:{enabled:!0},yAxis:{title:{text:At==null?void 0:At.description}},plotOptions:{line:{dataLabels:{enabled:!0,formatter:function(){if((At==null?void 0:At.format)=="dollars")return"$"+bo.numberFormat(this.y??0,0,".",",");if((At==null?void 0:At.format)=="integer")return bo.numberFormat(this.y??0,0,".",",");if((At==null?void 0:At.format)=="percent")return bo.numberFormat(this.y??0,1,".",",")+"%";if((At==null?void 0:At.format)=="index")return bo.numberFormat(this.y??0,3,".",",")}},enableMouseTracking:!0}},series:[{name:Et.name,data:l.map(dt=>dt.value),type:"line"},{name:"County value",data:l.map(dt=>dt.countyMedian),color:"orange",visible:!0,type:"line"}]})}const Mf=({params:ve})=>{const se=(()=>{if(ve.type==="financial")return"Financial Measures";if(ve.type==="human")return"Human Measures";if(ve.type==="manufactured")return"Manufactured Measures";if(ve.type==="social")return"Social Measures"})(),X=(()=>{if(ve.type==="financial")return[{value:"hocost",label:"Homeowner Costs"},{value:"gini",label:"Gini Index"},{value:"povfam",label:"Family Poverty Status"},{value:"povind",label:"Individual Poverty Status"},{value:"medhv",label:"Median House Value"},{value:"medinc",label:"Median Household Income"},{value:"medrnt",label:"Median Rent"},{value:"insure",label:"No Health Insurance"},{value:"capinc",label:"Per Capita Income"},{value:"rntcost",label:"Renter Costs"},{value:"snap",label:"SNAP"},{value:"unemp",label:"Unemployment"}];if(ve.type==="human")return[{value:"afram_",label:"African American"},{value:"age4_",label:"Age 0-4"},{value:"age17_",label:"Age 5-17"},{value:"age64_",label:"Age 18-64"},{value:"asian",label:"Asian"},{value:"chldpt",label:"Child Ratio"},{value:"depidx",label:"Dependency Index"},{value:"dividx",label:"Diversity Index"},{value:"fhh",label:"Female-Headed Family Households"},{value:"latino",label:"Latino or Hispanic"},{value:"educ",label:"Less Than High School"},{value:"min04_",label:"Minor Population (0-4)"},{value:"minperc",label:"Minor Population (0-17)"},{value:"nonwh",label:"Non-White"},{value:"presch",label:"Preschool"},{value:"popden",label:"Population Density"},{value:"white",label:"White"}];if(ve.type==="manufactured")return[{value:"B1940_",label:"Housing Built Before 1940"},{value:"heat",label:"Inadequate Heating Source "},{value:"mhome",label:"Mobile Homes"},{value:"rentocc",label:"Renter-Occupied"},{value:"vacant",label:"Vacancy Rate"},{value:"vehicle",label:"Vehicle Access"}];if(ve.type==="social")return[{value:"lingiso",label:"Linguistic Isolation"},{value:"moved",label:"Moved in the Last Five Years "},{value:"movedlast",label:"Moved in the Last Year"}]})();if(!se)throw kf(404);return{title:se,type:ve.type,indicators:Fp.filter(({type:te})=>te===ve.type),measures:X,helpers:{generateChart:Ef,formatNumber:Cf}}},Hf=Object.freeze(Object.defineProperty({__proto__:null,load:Mf},Symbol.toStringTag,{value:"Module"}));function Sp(ve,se,X){const te=ve.slice();return te[19]=se[X].value,te[20]=se[X].label,te}function Tp(ve){let se,X=ve[20]+"",te,Et;return{c(){se=ci("option"),te=Gc(X),this.h()},l(At){se=ui(At,"OPTION",{});var l=nr(se);te=qc(l,X),l.forEach($e),this.h()},h(){se.__value=Et=ve[19],wo(se,se.__value)},m(At,l){Ii(At,se,l),fi(se,te)},p(At,l){l&1&&X!==(X=At[20]+"")&&Xc(te,X),l&1&&Et!==(Et=At[19])&&(se.__value=Et,wo(se,se.__value))},d(At){At&&$e(se)}}}function kp(ve){let se,X,te,Et="1990",At,l,Zt,dt,Nt="2000",Lt,kt,ut,Rt;return kt=Fs(ve[10][1]),{c(){se=ci("input"),X=qi(),te=ci("label"),te.textContent=Et,At=qi(),l=ci("input"),Zt=qi(),dt=ci("label"),dt.textContent=Nt,Lt=ci("br"),this.h()},l(Z){se=ui(Z,"INPUT",{type:!0,id:!0}),X=Xi(Z),te=ui(Z,"LABEL",{for:!0,"data-svelte-h":!0}),Jr(te)!=="svelte-c6xogq"&&(te.textContent=Et),At=Xi(Z),l=ui(Z,"INPUT",{type:!0,id:!0}),Zt=Xi(Z),dt=ui(Z,"LABEL",{for:!0,"data-svelte-h":!0}),Jr(dt)!=="svelte-1xk3myu"&&(dt.textContent=Nt),Lt=ui(Z,"BR",{}),this.h()},h(){pi(se,"type","radio"),pi(se,"id","L1990"),se.__value="1990",wo(se,se.__value),pi(te,"for","L1990"),pi(l,"type","radio"),pi(l,"id","L2000"),l.__value="2000",wo(l,l.__value),pi(dt,"for","L2000"),kt.p(se,l)},m(Z,lt){Ii(Z,se,lt),se.checked=se.__value===ve[2],Ii(Z,X,lt),Ii(Z,te,lt),Ii(Z,At,lt),Ii(Z,l,lt),l.checked=l.__value===ve[2],Ii(Z,Zt,lt),Ii(Z,dt,lt),Ii(Z,Lt,lt),ut||(Rt=[Kn(se,"change",ve[9]),Kn(l,"change",ve[11])],ut=!0)},p(Z,lt){lt&4&&(se.checked=se.__value===Z[2]),lt&4&&(l.checked=l.__value===Z[2])},d(Z){Z&&($e(se),$e(X),$e(te),$e(At),$e(l),$e(Zt),$e(dt),$e(Lt)),kt.r(),ut=!1,Vc(Rt)}}}function Cp(ve){let se,X,te,Et,At="2016",l,Zt,dt,Nt=ve[1]!=="insure"&&Ap(ve);return l=Fs(ve[10][1]),{c(){Nt&&Nt.c(),se=qi(),X=ci("input"),te=qi(),Et=ci("label"),Et.textContent=At,this.h()},l(Lt){Nt&&Nt.l(Lt),se=Xi(Lt),X=ui(Lt,"INPUT",{type:!0,id:!0}),te=Xi(Lt),Et=ui(Lt,"LABEL",{for:!0,"data-svelte-h":!0}),Jr(Et)!=="svelte-1fxjyiu"&&(Et.textContent=At),this.h()},h(){pi(X,"type","radio"),pi(X,"id","L2016"),X.__value="2016",wo(X,X.__value),pi(Et,"for","L2016"),l.p(X)},m(Lt,kt){Nt&&Nt.m(Lt,kt),Ii(Lt,se,kt),Ii(Lt,X,kt),X.checked=X.__value===ve[2],Ii(Lt,te,kt),Ii(Lt,Et,kt),Zt||(dt=Kn(X,"change",ve[13]),Zt=!0)},p(Lt,kt){Lt[1]!=="insure"?Nt?Nt.p(Lt,kt):(Nt=Ap(Lt),Nt.c(),Nt.m(se.parentNode,se)):Nt&&(Nt.d(1),Nt=null),kt&4&&(X.checked=X.__value===Lt[2])},d(Lt){Lt&&($e(se),$e(X),$e(te),$e(Et)),Nt&&Nt.d(Lt),l.r(),Zt=!1,dt()}}}function Ap(ve){let se,X,te,Et="2010",At,l,Zt;return At=Fs(ve[10][1]),{c(){se=ci("input"),X=qi(),te=ci("label"),te.textContent=Et,this.h()},l(dt){se=ui(dt,"INPUT",{type:!0,id:!0}),X=Xi(dt),te=ui(dt,"LABEL",{for:!0,"data-svelte-h":!0}),Jr(te)!=="svelte-xvk656"&&(te.textContent=Et),this.h()},h(){pi(se,"type","radio"),pi(se,"id","L2010"),se.__value="2010",wo(se,se.__value),pi(te,"for","L2010"),At.p(se)},m(dt,Nt){Ii(dt,se,Nt),se.checked=se.__value===ve[2],Ii(dt,X,Nt),Ii(dt,te,Nt),l||(Zt=Kn(se,"change",ve[12]),l=!0)},p(dt,Nt){Nt&4&&(se.checked=se.__value===dt[2])},d(dt){dt&&($e(se),$e(X),$e(te)),At.r(),l=!1,Zt()}}}function Ep(ve){let se,X,te,Et="1990",At,l,Zt,dt,Nt="2000",Lt,kt,ut,Rt;return kt=Fs(ve[10][0]),{c(){se=ci("input"),X=qi(),te=ci("label"),te.textContent=Et,At=qi(),l=ci("input"),Zt=qi(),dt=ci("label"),dt.textContent=Nt,Lt=ci("br"),this.h()},l(Z){se=ui(Z,"INPUT",{type:!0,id:!0}),X=Xi(Z),te=ui(Z,"LABEL",{for:!0,"data-svelte-h":!0}),Jr(te)!=="svelte-1edp2bg"&&(te.textContent=Et),At=Xi(Z),l=ui(Z,"INPUT",{type:!0,id:!0}),Zt=Xi(Z),dt=ui(Z,"LABEL",{for:!0,"data-svelte-h":!0}),Jr(dt)!=="svelte-1yhrczk"&&(dt.textContent=Nt),Lt=ui(Z,"BR",{}),this.h()},h(){pi(se,"type","radio"),pi(se,"id","R1990"),se.__value="1990",wo(se,se.__value),pi(te,"for","R1990"),pi(l,"type","radio"),pi(l,"id","R2000"),l.__value="2000",wo(l,l.__value),pi(dt,"for","R2000"),kt.p(se,l)},m(Z,lt){Ii(Z,se,lt),se.checked=se.__value===ve[3],Ii(Z,X,lt),Ii(Z,te,lt),Ii(Z,At,lt),Ii(Z,l,lt),l.checked=l.__value===ve[3],Ii(Z,Zt,lt),Ii(Z,dt,lt),Ii(Z,Lt,lt),ut||(Rt=[Kn(se,"change",ve[14]),Kn(l,"change",ve[15])],ut=!0)},p(Z,lt){lt&8&&(se.checked=se.__value===Z[3]),lt&8&&(l.checked=l.__value===Z[3])},d(Z){Z&&($e(se),$e(X),$e(te),$e(At),$e(l),$e(Zt),$e(dt),$e(Lt)),kt.r(),ut=!1,Vc(Rt)}}}function Mp(ve){let se,X,te,Et,At="2016",l,Zt,dt,Nt=ve[1]!=="insure"&&Pp(ve);return l=Fs(ve[10][0]),{c(){Nt&&Nt.c(),se=qi(),X=ci("input"),te=qi(),Et=ci("label"),Et.textContent=At,this.h()},l(Lt){Nt&&Nt.l(Lt),se=Xi(Lt),X=ui(Lt,"INPUT",{type:!0,id:!0}),te=Xi(Lt),Et=ui(Lt,"LABEL",{for:!0,"data-svelte-h":!0}),Jr(Et)!=="svelte-1gv7ojk"&&(Et.textContent=At),this.h()},h(){pi(X,"type","radio"),pi(X,"id","R2016"),X.__value="2016",wo(X,X.__value),pi(Et,"for","R2016"),l.p(X)},m(Lt,kt){Nt&&Nt.m(Lt,kt),Ii(Lt,se,kt),Ii(Lt,X,kt),X.checked=X.__value===ve[3],Ii(Lt,te,kt),Ii(Lt,Et,kt),Zt||(dt=Kn(X,"change",ve[17]),Zt=!0)},p(Lt,kt){Lt[1]!=="insure"?Nt?Nt.p(Lt,kt):(Nt=Pp(Lt),Nt.c(),Nt.m(se.parentNode,se)):Nt&&(Nt.d(1),Nt=null),kt&8&&(X.checked=X.__value===Lt[3])},d(Lt){Lt&&($e(se),$e(X),$e(te),$e(Et)),Nt&&Nt.d(Lt),l.r(),Zt=!1,dt()}}}function Pp(ve){let se,X,te,Et="2010",At,l,Zt;return At=Fs(ve[10][0]),{c(){se=ci("input"),X=qi(),te=ci("label"),te.textContent=Et,this.h()},l(dt){se=ui(dt,"INPUT",{type:!0,id:!0}),X=Xi(dt),te=ui(dt,"LABEL",{for:!0,"data-svelte-h":!0}),Jr(te)!=="svelte-117i0s"&&(te.textContent=Et),this.h()},h(){pi(se,"type","radio"),pi(se,"id","R2010"),se.__value="2010",wo(se,se.__value),pi(te,"for","R2010"),At.p(se)},m(dt,Nt){Ii(dt,se,Nt),se.checked=se.__value===ve[3],Ii(dt,X,Nt),Ii(dt,te,Nt),l||(Zt=Kn(se,"change",ve[16]),l=!0)},p(dt,Nt){Nt&8&&(se.checked=se.__value===dt[3])},d(dt){dt&&($e(se),$e(X),$e(te)),At.r(),l=!1,Zt()}}}function Pf(ve){let se,X,te,Et,At="Select Indicator",l,Zt,dt,Nt,Lt,kt="Select a year for:",ut,Rt,Z,lt="Left Map",at,W,q,$,U,j,et="Right map",_t,mt,V,rt,I,C="Compare",z,S,g,v="Clear Maps",y,T,k=Hh(ve[0]),E=[];for(let ot=0;ot<k.length;ot+=1)E[ot]=Tp(Sp(ve,k,ot));let w=!ve[5]&&kp(ve),R=!ve[4]&&Cp(ve),J=!ve[5]&&Ep(ve),wt=!ve[4]&&Mp(ve);return{c(){se=ci("form"),X=ci("fieldset"),te=ci("div"),Et=ci("legend"),Et.textContent=At,l=qi(),Zt=ci("select");for(let ot=0;ot<E.length;ot+=1)E[ot].c();dt=qi(),Nt=ci("fieldset"),Lt=ci("legend"),Lt.textContent=kt,ut=qi(),Rt=ci("div"),Z=ci("legend"),Z.textContent=lt,at=qi(),w&&w.c(),W=qi(),R&&R.c(),q=qi(),$=ci("fieldset"),U=ci("div"),j=ci("legend"),j.textContent=et,_t=qi(),J&&J.c(),mt=qi(),wt&&wt.c(),V=qi(),rt=ci("div"),I=ci("button"),I.textContent=C,z=qi(),S=ci("div"),g=ci("button"),g.textContent=v,this.h()},l(ot){se=ui(ot,"FORM",{});var it=nr(se);X=ui(it,"FIELDSET",{class:!0});var Q=nr(X);te=ui(Q,"DIV",{class:!0});var A=nr(te);Et=ui(A,"LEGEND",{"data-svelte-h":!0}),Jr(Et)!=="svelte-1uu70p1"&&(Et.textContent=At),l=Xi(A),Zt=ui(A,"SELECT",{id:!0,style:!0});var B=nr(Zt);for(let G=0;G<E.length;G+=1)E[G].l(B);B.forEach($e),A.forEach($e),dt=Xi(Q),Nt=ui(Q,"FIELDSET",{class:!0});var K=nr(Nt);Lt=ui(K,"LEGEND",{"data-svelte-h":!0}),Jr(Lt)!=="svelte-pllrj3"&&(Lt.textContent=kt),ut=Xi(K),Rt=ui(K,"DIV",{class:!0});var pt=nr(Rt);Z=ui(pt,"LEGEND",{"data-svelte-h":!0}),Jr(Z)!=="svelte-1nfesnv"&&(Z.textContent=lt),at=Xi(pt),w&&w.l(pt),W=Xi(pt),R&&R.l(pt),pt.forEach($e),K.forEach($e),q=Xi(Q),$=ui(Q,"FIELDSET",{class:!0});var _=nr($);U=ui(_,"DIV",{class:!0});var P=nr(U);j=ui(P,"LEGEND",{"data-svelte-h":!0}),Jr(j)!=="svelte-10qic6e"&&(j.textContent=et),_t=Xi(P),J&&J.l(P),mt=Xi(P),wt&&wt.l(P),P.forEach($e),_.forEach($e),V=Xi(Q),rt=ui(Q,"DIV",{class:!0});var D=nr(rt);I=ui(D,"BUTTON",{type:!0,"data-svelte-h":!0}),Jr(I)!=="svelte-9lsu3k"&&(I.textContent=C),D.forEach($e),z=Xi(Q),S=ui(Q,"DIV",{class:!0});var Y=nr(S);g=ui(Y,"BUTTON",{type:!0,id:!0,"data-svelte-h":!0}),Jr(g)!=="svelte-u2r7sf"&&(g.textContent=v),Y.forEach($e),Q.forEach($e),it.forEach($e),this.h()},h(){pi(Zt,"id","indicatorNames"),Ol(Zt,"width","80%"),ve[1]===void 0&&xf(()=>ve[8].call(Zt)),pi(te,"class","selectIndicator svelte-fer2ly"),pi(Rt,"class","leftMap svelte-fer2ly"),pi(Nt,"class","svelte-fer2ly"),pi(U,"class","rightMap svelte-fer2ly"),pi($,"class","svelte-fer2ly"),pi(I,"type","button"),pi(rt,"class","subButton svelte-fer2ly"),pi(g,"type","button"),pi(g,"id","clear"),pi(S,"class","clearButton"),pi(X,"class","svelte-fer2ly")},m(ot,it){Ii(ot,se,it),fi(se,X),fi(X,te),fi(te,Et),fi(te,l),fi(te,Zt);for(let Q=0;Q<E.length;Q+=1)E[Q]&&E[Q].m(Zt,null);fp(Zt,ve[1],!0),fi(X,dt),fi(X,Nt),fi(Nt,Lt),fi(Nt,ut),fi(Nt,Rt),fi(Rt,Z),fi(Rt,at),w&&w.m(Rt,null),fi(Rt,W),R&&R.m(Rt,null),fi(X,q),fi(X,$),fi($,U),fi(U,j),fi(U,_t),J&&J.m(U,null),fi(U,mt),wt&&wt.m(U,null),fi(X,V),fi(X,rt),fi(rt,I),fi(X,z),fi(X,S),fi(S,g),y||(T=[Kn(Zt,"change",ve[8]),Kn(I,"click",ve[6]),Kn(g,"click",ve[7])],y=!0)},p(ot,[it]){if(it&1){k=Hh(ot[0]);let Q;for(Q=0;Q<k.length;Q+=1){const A=Sp(ot,k,Q);E[Q]?E[Q].p(A,it):(E[Q]=Tp(A),E[Q].c(),E[Q].m(Zt,null))}for(;Q<E.length;Q+=1)E[Q].d(1);E.length=k.length}it&3&&fp(Zt,ot[1]),ot[5]?w&&(w.d(1),w=null):w?w.p(ot,it):(w=kp(ot),w.c(),w.m(Rt,W)),ot[4]?R&&(R.d(1),R=null):R?R.p(ot,it):(R=Cp(ot),R.c(),R.m(Rt,null)),ot[5]?J&&(J.d(1),J=null):J?J.p(ot,it):(J=Ep(ot),J.c(),J.m(U,mt)),ot[4]?wt&&(wt.d(1),wt=null):wt?wt.p(ot,it):(wt=Mp(ot),wt.c(),wt.m(U,null))},i:Wh,o:Wh,d(ot){ot&&$e(se),Dp(E,ot),w&&w.d(),R&&R.d(),J&&J.d(),wt&&wt.d(),y=!1,Vc(T)}}}function If(ve,se,X){let te,Et,{options:At}=se,l,Zt,dt;const Nt=bf();function Lt(){l&&Zt?Nt("submit",{leftYear:l,rightYear:Zt,indicator:dt}):alert("Please select a year for both the left and right maps.")}function kt(){X(2,l=void 0),X(3,Zt=void 0),Nt("clear")}const ut=[[],[]];function Rt(){dt=wf(this),X(1,dt),X(0,At)}function Z(){l=this.__value,X(2,l)}function lt(){l=this.__value,X(2,l)}function at(){l=this.__value,X(2,l)}function W(){l=this.__value,X(2,l)}function q(){Zt=this.__value,X(3,Zt)}function $(){Zt=this.__value,X(3,Zt)}function U(){Zt=this.__value,X(3,Zt)}function j(){Zt=this.__value,X(3,Zt)}return ve.$$set=et=>{"options"in et&&X(0,At=et.options)},ve.$$.update=()=>{ve.$$.dirty&2&&X(5,te=["snap","gini","insure","movedlast"].includes(dt)),ve.$$.dirty&2&&X(4,Et=["moved"].includes(dt))},[At,dt,l,Zt,Et,te,Lt,kt,Rt,Z,ut,lt,at,W,q,$,U,j]}class Lf extends Wc{constructor(se){super(),Hc(this,se,If,Pf,Nc,{options:0})}}function zf(ve,se){var X=ve.getCenter(),te=ve.getZoom(),Et=ve.getBearing(),At=ve.getPitch();se.forEach(function(l){l.jumpTo({center:X,zoom:te,bearing:Et,pitch:At})})}function Df(){var ve,se=arguments.length;if(se===1)ve=arguments[0];else{ve=[];for(var X=0;X<se;X++)ve.push(arguments[X])}var te=[];ve.forEach(function(Zt,dt){te[dt]=l.bind(null,Zt,ve.filter(function(Nt,Lt){return Lt!==dt}))});function Et(){ve.forEach(function(Zt,dt){Zt.on("move",te[dt])})}function At(){ve.forEach(function(Zt,dt){Zt.off("move",te[dt])})}function l(Zt,dt){At(),zf(Zt,dt),Et()}return Et(),function(){At(),te=[],ve=[]}}var Of=Df;const Bf=Bp(Of);var jp={exports:{}};(function(ve,se){(function(X,te){ve.exports=te()})(Op,function(){var X,te,Et;function At(l,Zt){if(!X)X=Zt;else if(!te)te=Zt;else{var dt="var sharedChunk = {}; ("+X+")(sharedChunk); ("+te+")(sharedChunk);",Nt={};X(Nt),Et=Zt(Nt),typeof window<"u"&&(Et.workerUrl=window.URL.createObjectURL(new Blob([dt],{type:"text/javascript"})))}}return At(["exports"],function(l){function Zt(t,e){return t(e={exports:{}},e.exports),e.exports}var dt=Nt;function Nt(t,e,i,a){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=a,this.p2x=i,this.p2y=a}Nt.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Nt.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Nt.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Nt.prototype.solveCurveX=function(t,e){var i,a,h,c,p;for(e===void 0&&(e=1e-6),h=t,p=0;p<8;p++){if(c=this.sampleCurveX(h)-t,Math.abs(c)<e)return h;var m=this.sampleCurveDerivativeX(h);if(Math.abs(m)<1e-6)break;h-=c/m}if((h=t)<(i=0))return i;if(h>(a=1))return a;for(;i<a;){if(c=this.sampleCurveX(h),Math.abs(c-t)<e)return h;t>c?i=h:a=h,h=.5*(a-i)+i}return h},Nt.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var Lt=kt;function kt(t,e){this.x=t,this.y=e}kt.prototype={clone:function(){return new kt(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),a=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=a,this},_rotateAround:function(t,e){var i=Math.cos(t),a=Math.sin(t),h=e.y+a*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-a*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},kt.convert=function(t){return t instanceof kt?t:Array.isArray(t)?new kt(t[0],t[1]):t};var ut=typeof self<"u"?self:{},Rt=Math.pow(2,53)-1;function Z(t,e,i,a){var h=new dt(t,e,i,a);return function(c){return h.solve(c)}}var lt=Z(.25,.1,.25,1);function at(t,e,i){return Math.min(i,Math.max(e,t))}function W(t,e,i){var a=i-e,h=((t-e)%a+a)%a+e;return h===e?i:h}function q(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];for(var a=0,h=e;a<h.length;a+=1){var c=h[a];for(var p in c)t[p]=c[p]}return t}var $=1;function U(){return $++}function j(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function et(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function _t(t,e){t.forEach(function(i){e[i]&&(e[i]=e[i].bind(e))})}function mt(t,e){return t.indexOf(e,t.length-e.length)!==-1}function V(t,e,i){var a={};for(var h in t)a[h]=e.call(i||this,t[h],h,t);return a}function rt(t,e,i){var a={};for(var h in t)e.call(i||this,t[h],h,t)&&(a[h]=t[h]);return a}function I(t){return Array.isArray(t)?t.map(I):typeof t=="object"&&t?V(t,I):t}var C={};function z(t){C[t]||(typeof console<"u"&&console.warn(t),C[t]=!0)}function S(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function g(t){for(var e=0,i=0,a=t.length,h=a-1,c=void 0,p=void 0;i<a;h=i++)e+=((p=t[h]).x-(c=t[i]).x)*(c.y+p.y);return e}function v(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function y(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(a,h,c,p){var m=c||p;return e[h]=!m||m.toLowerCase(),""}),e["max-age"]){var i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}var T=null;function k(t){if(T==null){var e=t.navigator?t.navigator.userAgent:null;T=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return T}function E(t){try{var e=ut[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}var w,R,J,wt,ot=ut.performance&&ut.performance.now?ut.performance.now.bind(ut.performance):Date.now.bind(Date),it=ut.requestAnimationFrame||ut.mozRequestAnimationFrame||ut.webkitRequestAnimationFrame||ut.msRequestAnimationFrame,Q=ut.cancelAnimationFrame||ut.mozCancelAnimationFrame||ut.webkitCancelAnimationFrame||ut.msCancelAnimationFrame,A={now:ot,frame:function(t){var e=it(t);return{cancel:function(){return Q(e)}}},getImageData:function(t,e){e===void 0&&(e=0);var i=ut.document.createElement("canvas"),a=i.getContext("2d");if(!a)throw new Error("failed to create canvas 2d context");return i.width=t.width,i.height=t.height,a.drawImage(t,0,0,t.width,t.height),a.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return w||(w=ut.document.createElement("a")),w.href=t,w.href},hardwareConcurrency:ut.navigator&&ut.navigator.hardwareConcurrency||4,get devicePixelRatio(){return ut.devicePixelRatio},get prefersReducedMotion(){return!!ut.matchMedia&&(R==null&&(R=ut.matchMedia("(prefers-reduced-motion: reduce)")),R.matches)}},B={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},K={supported:!1,testSupport:function(t){!pt&&wt&&(_?P(t):J=t)}},pt=!1,_=!1;function P(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,wt),t.isContextLost())return;K.supported=!0}catch{}t.deleteTexture(e),pt=!0}ut.document&&((wt=ut.document.createElement("img")).onload=function(){J&&P(J),J=null,_=!0},wt.onerror=function(){pt=!0,J=null},wt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var D="01",Y=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function G(t){return t.indexOf("mapbox:")===0}Y.prototype._createSkuToken=function(){var t=function(){for(var e="",i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",D,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},Y.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Y.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},Y.prototype.normalizeStyleURL=function(t,e){if(!G(t))return t;var i=jt(t);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||e)},Y.prototype.normalizeGlyphsURL=function(t,e){if(!G(t))return t;var i=jt(t);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||e)},Y.prototype.normalizeSourceURL=function(t,e){if(!G(t))return t;var i=jt(t);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||e)},Y.prototype.normalizeSpriteURL=function(t,e,i,a){var h=jt(t);return G(t)?(h.path="/styles/v1"+h.path+"/sprite"+e+i,this._makeAPIURL(h,this._customAccessToken||a)):(h.path+=""+e+i,Kt(h))},Y.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!G(t))return t;var i=jt(t);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(A.devicePixelRatio>=2||e===512?"@2x":"")+(K.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var a=this._customAccessToken||function(h){for(var c=0,p=h;c<p.length;c+=1){var m=p[c].match(/^access_token=(.*)$/);if(m)return m[1]}return null}(i.params)||B.ACCESS_TOKEN;return B.REQUIRE_ACCESS_TOKEN&&a&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,a)},Y.prototype.canonicalizeTileURL=function(t,e){var i=jt(t);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return t;var a="mapbox://tiles/";a+=i.path.replace("/v4/","");var h=i.params;return e&&(h=h.filter(function(c){return!c.match(/^access_token=/)})),h.length&&(a+="?"+h.join("&")),a},Y.prototype.canonicalizeTileset=function(t,e){for(var i=!!e&&G(e),a=[],h=0,c=t.tiles||[];h<c.length;h+=1){var p=c[h];Ct(p)?a.push(this.canonicalizeTileURL(p,i)):a.push(p)}return a},Y.prototype._makeAPIURL=function(t,e){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",a=jt(B.API_URL);if(t.protocol=a.protocol,t.authority=a.authority,t.protocol==="http"){var h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if(a.path!=="/"&&(t.path=""+a.path+t.path),!B.REQUIRE_ACCESS_TOKEN)return Kt(t);if(!(e=e||B.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(e[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return t.params=t.params.filter(function(c){return c.indexOf("access_token")===-1}),t.params.push("access_token="+e),Kt(t)};var xt=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ct(t){return xt.test(t)}var Dt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function jt(t){var e=t.match(Dt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Kt(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function ee(t){if(!t)return null;var e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(ut.atob(e[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var le=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};le.prototype.getStorageKey=function(t){var e,i=ee(B.ACCESS_TOKEN);return e=i&&i.u?ut.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(a,h){return String.fromCharCode(+("0x"+h))})):B.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},le.prototype.fetchEventData=function(){var t=E("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{var a=ut.localStorage.getItem(e);a&&(this.eventData=JSON.parse(a));var h=ut.localStorage.getItem(i);h&&(this.anonId=h)}catch{z("Unable to read from LocalStorage")}},le.prototype.saveEventData=function(){var t=E("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{ut.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&ut.localStorage.setItem(e,JSON.stringify(this.eventData))}catch{z("Unable to write to LocalStorage")}},le.prototype.processRequests=function(t){},le.prototype.postEvent=function(t,e,i,a){var h=this;if(B.EVENTS_URL){var c=jt(B.EVENTS_URL);c.params.push("access_token="+(a||B.ACCESS_TOKEN||""));var p={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:D,userId:this.anonId},m=e?q(p,e):p,b={url:Kt(c),headers:{"Content-Type":"text/plain"},body:JSON.stringify([m])};this.pendingRequest=Li(b,function(M){h.pendingRequest=null,i(M),h.saveEventData(),h.processRequests(a)})}},le.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var ht,st,Tt=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(i,a,h,c){this.skuToken=h;var p=!(!c&&!B.ACCESS_TOKEN),m=Array.isArray(i)&&i.some(function(b){return G(b)||Ct(b)});B.EVENTS_URL&&p&&m&&this.queueRequest({id:a,timestamp:Date.now()},c)},e.prototype.processRequests=function(i){var a=this;if(!this.pendingRequest&&this.queue.length!==0){var h=this.queue.shift(),c=h.id,p=h.timestamp;c&&this.success[c]||(this.anonId||this.fetchEventData(),et(this.anonId)||(this.anonId=j()),this.postEvent(p,{skuToken:this.skuToken},function(m){m||c&&(a.success[c]=!0)},i))}},e}(le),Mt=new(function(t){function e(i){t.call(this,"appUserTurnstile"),this._customAccessToken=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(i,a){B.EVENTS_URL&&B.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(h){return G(h)||Ct(h)})&&this.queueRequest(Date.now(),a)},e.prototype.processRequests=function(i){var a=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var h=ee(B.ACCESS_TOKEN),c=h?h.u:B.ACCESS_TOKEN,p=c!==this.eventData.tokenU;et(this.anonId)||(this.anonId=j(),p=!0);var m=this.queue.shift();if(this.eventData.lastSuccess){var b=new Date(this.eventData.lastSuccess),M=new Date(m),O=(m-this.eventData.lastSuccess)/864e5;p=p||O>=1||O<-1||b.getDate()!==M.getDate()}else p=!0;if(!p)return this.processRequests();this.postEvent(m,{"enabled.telemetry":!1},function(N){N||(a.eventData.lastSuccess=m,a.eventData.tokenU=c)},i)}},e}(le)),Ht=Mt.postTurnstileEvent.bind(Mt),Vt=new Tt,re=Vt.postMapLoadEvent.bind(Vt),Jt=500,ye=50;function ze(){ut.caches&&!ht&&(ht=ut.caches.open("mapbox-tiles"))}function ge(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var be,Oe=1/0;function Ze(){return be==null&&(be=ut.OffscreenCanvas&&new ut.OffscreenCanvas(1,1).getContext("2d")&&typeof ut.createImageBitmap=="function"),be}var Ge={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ge);var Ee=function(t){function e(i,a,h){a===401&&Ct(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,i),this.status=a,this.url=h,this.name=this.constructor.name,this.message=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),li=v()?function(){return self.worker&&self.worker.referrer}:function(){return(ut.location.protocol==="blob:"?ut.parent:ut).location.href},ii,xi,Ni=function(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(li())&&!/^\w+:/.test(i))){if(ut.fetch&&ut.Request&&ut.AbortController&&ut.Request.prototype.hasOwnProperty("signal"))return function(a,h){var c,p=new ut.AbortController,m=new ut.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:li(),signal:p.signal}),b=!1,M=!1,O=(c=m.url).indexOf("sku=")>0&&Ct(c);a.type==="json"&&m.headers.set("Accept","application/json");var N=function(ft,It,Ot){if(!M){if(ft&&ft.message!=="SecurityError"&&z(ft),It&&Ot)return nt(It);var Wt=Date.now();ut.fetch(m).then(function(Gt){if(Gt.ok){var ie=O?Gt.clone():null;return nt(Gt,ie,Wt)}return h(new Ee(Gt.statusText,Gt.status,a.url))}).catch(function(Gt){Gt.code!==20&&h(new Error(Gt.message))})}},nt=function(ft,It,Ot){(a.type==="arrayBuffer"?ft.arrayBuffer():a.type==="json"?ft.json():ft.text()).then(function(Wt){M||(It&&Ot&&function(Gt,ie,ae){if(ze(),ht){var he={status:ie.status,statusText:ie.statusText,headers:new ut.Headers};ie.headers.forEach(function(_e,ke){return he.headers.set(ke,_e)});var ue=y(ie.headers.get("Cache-Control")||"");ue["no-store"]||(ue["max-age"]&&he.headers.set("Expires",new Date(ae+1e3*ue["max-age"]).toUTCString()),new Date(he.headers.get("Expires")).getTime()-ae<42e4||function(_e,ke){if(st===void 0)try{new Response(new ReadableStream),st=!0}catch{st=!1}st?ke(_e.body):_e.blob().then(ke)}(ie,function(_e){var ke=new ut.Response(_e,he);ze(),ht&&ht.then(function(Me){return Me.put(ge(Gt.url),ke)}).catch(function(Me){return z(Me.message)})}))}}(m,It,Ot),b=!0,h(null,Wt,ft.headers.get("Cache-Control"),ft.headers.get("Expires")))}).catch(function(Wt){M||h(new Error(Wt.message))})};return O?function(ft,It){if(ze(),!ht)return It(null);var Ot=ge(ft.url);ht.then(function(Wt){Wt.match(Ot).then(function(Gt){var ie=function(ae){if(!ae)return!1;var he=new Date(ae.headers.get("Expires")||0),ue=y(ae.headers.get("Cache-Control")||"");return he>Date.now()&&!ue["no-cache"]}(Gt);Wt.delete(Ot),ie&&Wt.put(Ot,Gt.clone()),It(null,Gt,ie)}).catch(It)}).catch(It)}(m,N):N(null,null),{cancel:function(){M=!0,b||p.abort()}}}(t,e);if(v()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(a,h){var c=new ut.XMLHttpRequest;for(var p in c.open(a.method||"GET",a.url,!0),a.type==="arrayBuffer"&&(c.responseType="arraybuffer"),a.headers)c.setRequestHeader(p,a.headers[p]);return a.type==="json"&&(c.responseType="text",c.setRequestHeader("Accept","application/json")),c.withCredentials=a.credentials==="include",c.onerror=function(){h(new Error(c.statusText))},c.onload=function(){if((c.status>=200&&c.status<300||c.status===0)&&c.response!==null){var m=c.response;if(a.type==="json")try{m=JSON.parse(c.response)}catch(b){return h(b)}h(null,m,c.getResponseHeader("Cache-Control"),c.getResponseHeader("Expires"))}else h(new Ee(c.statusText,c.status,a.url))},c.send(a.body),{cancel:function(){return c.abort()}}}(t,e)},cr=function(t,e){return Ni(q(t,{type:"arrayBuffer"}),e)},Li=function(t,e){return Ni(q(t,{method:"POST"}),e)},F="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";ii=[],xi=0;var tt=function(t,e){if(K.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),xi>=B.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return ii.push(i),i}xi++;var a=!1,h=function(){if(!a)for(a=!0,xi--;ii.length&&xi<B.MAX_PARALLEL_IMAGE_REQUESTS;){var p=ii.shift();p.cancelled||(p.cancel=tt(p.requestParameters,p.callback).cancel)}},c=cr(t,function(p,m,b,M){h(),p?e(p):m&&(Ze()?function(O,N){var nt=new ut.Blob([new Uint8Array(O)],{type:"image/png"});ut.createImageBitmap(nt).then(function(ft){N(null,ft)}).catch(function(ft){N(new Error("Could not load image because of "+ft.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(m,e):function(O,N,nt,ft){var It=new ut.Image,Ot=ut.URL;It.onload=function(){N(null,It),Ot.revokeObjectURL(It.src),It.onload=null,ut.requestAnimationFrame(function(){It.src=F})},It.onerror=function(){return N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Wt=new ut.Blob([new Uint8Array(O)],{type:"image/png"});It.cacheControl=nt,It.expires=ft,It.src=O.byteLength?Ot.createObjectURL(Wt):F}(m,e,b,M))});return{cancel:function(){c.cancel(),h()}}};function ct(t,e,i){i[t]&&i[t].indexOf(e)!==-1||(i[t]=i[t]||[],i[t].push(e))}function St(t,e,i){if(i&&i[t]){var a=i[t].indexOf(e);a!==-1&&i[t].splice(a,1)}}var zt=function(t,e){e===void 0&&(e={}),q(this,e),this.type=t},Yt=function(t){function e(i,a){a===void 0&&(a={}),t.call(this,"error",q({error:i},a))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(zt),$t=function(){};$t.prototype.on=function(t,e){return this._listeners=this._listeners||{},ct(t,e,this._listeners),this},$t.prototype.off=function(t,e){return St(t,e,this._listeners),St(t,e,this._oneTimeListeners),this},$t.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},ct(t,e,this._oneTimeListeners),this},$t.prototype.fire=function(t,e){typeof t=="string"&&(t=new zt(t,e||{}));var i=t.type;if(this.listens(i)){t.target=this;for(var a=0,h=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];a<h.length;a+=1)h[a].call(this,t);for(var c=0,p=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];c<p.length;c+=1){var m=p[c];St(i,m,this._oneTimeListeners),m.call(this,t)}var b=this._eventedParent;b&&(q(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(t))}else t instanceof Yt&&console.error(t.error);return this},$t.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},$t.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var yt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ut=function(t,e,i,a){this.message=(t?t+": ":"")+i,a&&(this.identifier=a),e!=null&&e.__line__&&(this.line=e.__line__)};function oe(t){var e=t.value;return e?[new Ut(t.key,e,"constants have been deprecated as of v8")]:[]}function we(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];for(var a=0,h=e;a<h.length;a+=1){var c=h[a];for(var p in c)t[p]=c[p]}return t}function Te(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function fe(t){if(Array.isArray(t))return t.map(fe);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var i in t)e[i]=fe(t[i]);return e}return Te(t)}var Se=function(t){function e(i,a){t.call(this,a),this.message=a,this.key=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),qe=function(t,e){e===void 0&&(e=[]),this.parent=t,this.bindings={};for(var i=0,a=e;i<a.length;i+=1){var h=a[i];this.bindings[h[0]]=h[1]}};qe.prototype.concat=function(t){return new qe(this,t)},qe.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},qe.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Ne={kind:"null"},me={kind:"number"},Fe={kind:"string"},Pe={kind:"boolean"},Le={kind:"color"},vi={kind:"object"},Be={kind:"value"},ki={kind:"collator"},Wi={kind:"formatted"},bi={kind:"resolvedImage"};function Oi(t,e){return{kind:"array",itemType:t,N:e}}function Ai(t){if(t.kind==="array"){var e=Ai(t.itemType);return typeof t.N=="number"?"array<"+e+", "+t.N+">":t.itemType.kind==="value"?"array":"array<"+e+">"}return t.kind}var Vr=[Ne,me,Fe,Pe,Le,Wi,vi,Oi(Be),bi];function Fi(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Fi(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(var i=0,a=Vr;i<a.length;i+=1)if(!Fi(a[i],e))return null}}return"Expected "+Ai(t)+" but found "+Ai(e)+" instead."}function ur(t,e){return e.some(function(i){return i.kind===t.kind})}function Vi(t,e){return e.some(function(i){return i==="null"?t===null:i==="array"?Array.isArray(t):i==="object"?t&&!Array.isArray(t)&&typeof t=="object":i===typeof t})}var Ti=Zt(function(t,e){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(m){return(m=Math.round(m))<0?0:m>255?255:m}function h(m){return a(m[m.length-1]==="%"?parseFloat(m)/100*255:parseInt(m))}function c(m){return(b=m[m.length-1]==="%"?parseFloat(m)/100:parseFloat(m))<0?0:b>1?1:b;var b}function p(m,b,M){return M<0?M+=1:M>1&&(M-=1),6*M<1?m+(b-m)*M*6:2*M<1?b:3*M<2?m+(b-m)*(2/3-M)*6:m}try{e.parseCSSColor=function(m){var b,M=m.replace(/ /g,"").toLowerCase();if(M in i)return i[M].slice();if(M[0]==="#")return M.length===4?(b=parseInt(M.substr(1),16))>=0&&b<=4095?[(3840&b)>>4|(3840&b)>>8,240&b|(240&b)>>4,15&b|(15&b)<<4,1]:null:M.length===7&&(b=parseInt(M.substr(1),16))>=0&&b<=16777215?[(16711680&b)>>16,(65280&b)>>8,255&b,1]:null;var O=M.indexOf("("),N=M.indexOf(")");if(O!==-1&&N+1===M.length){var nt=M.substr(0,O),ft=M.substr(O+1,N-(O+1)).split(","),It=1;switch(nt){case"rgba":if(ft.length!==4)return null;It=c(ft.pop());case"rgb":return ft.length!==3?null:[h(ft[0]),h(ft[1]),h(ft[2]),It];case"hsla":if(ft.length!==4)return null;It=c(ft.pop());case"hsl":if(ft.length!==3)return null;var Ot=(parseFloat(ft[0])%360+360)%360/360,Wt=c(ft[1]),Gt=c(ft[2]),ie=Gt<=.5?Gt*(Wt+1):Gt+Wt-Gt*Wt,ae=2*Gt-ie;return[a(255*p(ae,ie,Ot+1/3)),a(255*p(ae,ie,Ot)),a(255*p(ae,ie,Ot-1/3)),It];default:return null}}return null}}catch{}}).parseCSSColor,Bi=function(t,e,i,a){a===void 0&&(a=1),this.r=t,this.g=e,this.b=i,this.a=a};Bi.parse=function(t){if(t){if(t instanceof Bi)return t;if(typeof t=="string"){var e=Ti(t);if(e)return new Bi(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},Bi.prototype.toString=function(){var t=this.toArray(),e=t[1],i=t[2],a=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(i)+","+a+")"},Bi.prototype.toArray=function(){var t=this.a;return t===0?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},Bi.black=new Bi(0,0,0,1),Bi.white=new Bi(1,1,1,1),Bi.transparent=new Bi(0,0,0,0),Bi.red=new Bi(1,0,0,1);var $r=function(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};$r.prototype.compare=function(t,e){return this.collator.compare(t,e)},$r.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var pa=function(t,e,i,a,h){this.text=t,this.image=e,this.scale=i,this.fontStack=a,this.textColor=h},Er=function(t){this.sections=t};Er.fromString=function(t){return new Er([new pa(t,null,null,null,null)])},Er.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(t){return t.text.length!==0||t.image&&t.image.name.length!==0})},Er.factory=function(t){return t instanceof Er?t:Er.fromString(t)},Er.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(t){return t.text}).join("")},Er.prototype.serialize=function(){for(var t=["format"],e=0,i=this.sections;e<i.length;e+=1){var a=i[e];if(a.image)t.push(["image",a.image.name]);else{t.push(a.text);var h={};a.fontStack&&(h["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(h["font-scale"]=a.scale),a.textColor&&(h["text-color"]=["rgba"].concat(a.textColor.toArray())),t.push(h)}}return t};var Qr=function(t){this.name=t.name,this.available=t.available};function js(t,e,i,a){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:"Invalid rgba value ["+[t,e,i,a].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof a=="number"?[t,e,i,a]:[t,e,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function da(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof Bi||t instanceof $r||t instanceof Er||t instanceof Qr)return!0;if(Array.isArray(t)){for(var e=0,i=t;e<i.length;e+=1)if(!da(i[e]))return!1;return!0}if(typeof t=="object"){for(var a in t)if(!da(t[a]))return!1;return!0}return!1}function pr(t){if(t===null)return Ne;if(typeof t=="string")return Fe;if(typeof t=="boolean")return Pe;if(typeof t=="number")return me;if(t instanceof Bi)return Le;if(t instanceof $r)return ki;if(t instanceof Er)return Wi;if(t instanceof Qr)return bi;if(Array.isArray(t)){for(var e,i=t.length,a=0,h=t;a<h.length;a+=1){var c=pr(h[a]);if(e){if(e===c)continue;e=Be;break}e=c}return Oi(e||Be,i)}return vi}function fa(t){var e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof Bi||t instanceof Er||t instanceof Qr?t.toString():JSON.stringify(t)}Qr.prototype.toString=function(){return this.name},Qr.fromString=function(t){return t?new Qr({name:t,available:!1}):null},Qr.prototype.serialize=function(){return["image",this.name]};var Gr=function(t,e){this.type=t,this.value=e};Gr.parse=function(t,e){if(t.length!==2)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!da(t[1]))return e.error("invalid value");var i=t[1],a=pr(i),h=e.expectedType;return a.kind!=="array"||a.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(a=h),new Gr(a,i)},Gr.prototype.evaluate=function(){return this.value},Gr.prototype.eachChild=function(){},Gr.prototype.outputDefined=function(){return!0},Gr.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Bi?["rgba"].concat(this.value.toArray()):this.value instanceof Er?this.value.serialize():this.value};var Mr=function(t){this.name="ExpressionEvaluationError",this.message=t};Mr.prototype.toJSON=function(){return this.message};var vn={string:Fe,number:me,boolean:Pe,object:vi},Qi=function(t,e){this.type=t,this.args=e};Qi.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i,a=1,h=t[0];if(h==="array"){var c,p;if(t.length>2){var m=t[1];if(typeof m!="string"||!(m in vn)||m==="object")return e.error('The item type argument of "array" must be one of string, number, boolean',1);c=vn[m],a++}else c=Be;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);p=t[2],a++}i=Oi(c,p)}else i=vn[h];for(var b=[];a<t.length;a++){var M=e.parse(t[a],a,Be);if(!M)return null;b.push(M)}return new Qi(i,b)},Qi.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var i=this.args[e].evaluate(t);if(!Fi(this.type,pr(i)))return i;if(e===this.args.length-1)throw new Mr("Expected value to be of type "+Ai(this.type)+", but found "+Ai(pr(i))+" instead.")}return null},Qi.prototype.eachChild=function(t){this.args.forEach(t)},Qi.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},Qi.prototype.serialize=function(){var t=this.type,e=[t.kind];if(t.kind==="array"){var i=t.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){e.push(i.kind);var a=t.N;(typeof a=="number"||this.args.length>1)&&e.push(a)}}return e.concat(this.args.map(function(h){return h.serialize()}))};var En=function(t){this.type=Wi,this.sections=t};En.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i=t[1];if(!Array.isArray(i)&&typeof i=="object")return e.error("First argument must be an image or text section.");for(var a=[],h=!1,c=1;c<=t.length-1;++c){var p=t[c];if(h&&typeof p=="object"&&!Array.isArray(p)){h=!1;var m=null;if(p["font-scale"]&&!(m=e.parse(p["font-scale"],1,me)))return null;var b=null;if(p["text-font"]&&!(b=e.parse(p["text-font"],1,Oi(Fe))))return null;var M=null;if(p["text-color"]&&!(M=e.parse(p["text-color"],1,Le)))return null;var O=a[a.length-1];O.scale=m,O.font=b,O.textColor=M}else{var N=e.parse(t[c],1,Be);if(!N)return null;var nt=N.type.kind;if(nt!=="string"&&nt!=="value"&&nt!=="null"&&nt!=="resolvedImage")return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,a.push({content:N,scale:null,font:null,textColor:null})}}return new En(a)},En.prototype.evaluate=function(t){return new Er(this.sections.map(function(e){var i=e.content.evaluate(t);return pr(i)===bi?new pa("",i,null,null,null):new pa(fa(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))},En.prototype.eachChild=function(t){for(var e=0,i=this.sections;e<i.length;e+=1){var a=i[e];t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor)}},En.prototype.outputDefined=function(){return!1},En.prototype.serialize=function(){for(var t=["format"],e=0,i=this.sections;e<i.length;e+=1){var a=i[e];t.push(a.content.serialize());var h={};a.scale&&(h["font-scale"]=a.scale.serialize()),a.font&&(h["text-font"]=a.font.serialize()),a.textColor&&(h["text-color"]=a.textColor.serialize()),t.push(h)}return t};var dn=function(t){this.type=bi,this.input=t};dn.parse=function(t,e){if(t.length!==2)return e.error("Expected two arguments.");var i=e.parse(t[1],1,Fe);return i?new dn(i):e.error("No image name provided.")},dn.prototype.evaluate=function(t){var e=this.input.evaluate(t),i=Qr.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i},dn.prototype.eachChild=function(t){t(this.input)},dn.prototype.outputDefined=function(){return!1},dn.prototype.serialize=function(){return["image",this.input.serialize()]};var Bl={"to-boolean":Pe,"to-color":Le,"to-number":me,"to-string":Fe},_n=function(t,e){this.type=t,this.args=e};_n.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i=t[0];if((i==="to-boolean"||i==="to-string")&&t.length!==2)return e.error("Expected one argument.");for(var a=Bl[i],h=[],c=1;c<t.length;c++){var p=e.parse(t[c],c,Be);if(!p)return null;h.push(p)}return new _n(a,h)},_n.prototype.evaluate=function(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){for(var e,i,a=0,h=this.args;a<h.length;a+=1){if(i=null,(e=h[a].evaluate(t))instanceof Bi)return e;if(typeof e=="string"){var c=t.parseColor(e);if(c)return c}else if(Array.isArray(e)&&!(i=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":js(e[0],e[1],e[2],e[3])))return new Bi(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new Mr(i||"Could not parse color from value '"+(typeof e=="string"?e:String(JSON.stringify(e)))+"'")}if(this.type.kind==="number"){for(var p=null,m=0,b=this.args;m<b.length;m+=1){if((p=b[m].evaluate(t))===null)return 0;var M=Number(p);if(!isNaN(M))return M}throw new Mr("Could not convert "+JSON.stringify(p)+" to number.")}return this.type.kind==="formatted"?Er.fromString(fa(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Qr.fromString(fa(this.args[0].evaluate(t))):fa(this.args[0].evaluate(t))},_n.prototype.eachChild=function(t){this.args.forEach(t)},_n.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},_n.prototype.serialize=function(){if(this.type.kind==="formatted")return new En([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new dn(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var Zh=["Unknown","Point","LineString","Polygon"],Vn=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Vn.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Vn.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Zh[this.feature.type]:this.feature.type:null},Vn.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Vn.prototype.canonicalID=function(){return this.canonical},Vn.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Vn.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Bi.parse(t)),e};var Or=function(t,e,i,a){this.name=t,this.type=e,this._evaluate=i,this.args=a};Or.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Or.prototype.eachChild=function(t){this.args.forEach(t)},Or.prototype.outputDefined=function(){return!1},Or.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},Or.parse=function(t,e){var i,a=t[0],h=Or.definitions[a];if(!h)return e.error('Unknown expression "'+a+'". If you wanted a literal array, use ["literal", [...]].',0);for(var c=Array.isArray(h)?h[0]:h.type,p=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,m=p.filter(function(Je){var Re=Je[0];return!Array.isArray(Re)||Re.length===t.length-1}),b=null,M=0,O=m;M<O.length;M+=1){var N=O[M],nt=N[0],ft=N[1];b=new to(e.registry,e.path,null,e.scope);for(var It=[],Ot=!1,Wt=1;Wt<t.length;Wt++){var Gt=t[Wt],ie=Array.isArray(nt)?nt[Wt-1]:nt.type,ae=b.parse(Gt,1+It.length,ie);if(!ae){Ot=!0;break}It.push(ae)}if(!Ot)if(Array.isArray(nt)&&nt.length!==It.length)b.error("Expected "+nt.length+" arguments, but found "+It.length+" instead.");else{for(var he=0;he<It.length;he++){var ue=Array.isArray(nt)?nt[he]:nt.type,_e=It[he];b.concat(he+1).checkSubtype(ue,_e.type)}if(b.errors.length===0)return new Or(a,c,ft,It)}}if(m.length===1)(i=e.errors).push.apply(i,b.errors);else{for(var ke=(m.length?m:p).map(function(Je){var Re;return Re=Je[0],Array.isArray(Re)?"("+Re.map(Ai).join(", ")+")":"("+Ai(Re.type)+"...)"}).join(" | "),Me=[],He=1;He<t.length;He++){var De=e.parse(t[He],1+Me.length);if(!De)return null;Me.push(Ai(De.type))}e.error("Expected arguments of type "+ke+", but found ("+Me.join(", ")+") instead.")}return null},Or.register=function(t,e){for(var i in Or.definitions=e,e)t[i]=Or};var On=function(t,e,i){this.type=ki,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e};function qr(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function So(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Yh(t,e){var i=(180+t[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(i*h*8192),Math.round(a*h*8192)]}function Kh(t,e,i){return e[1]>t[1]!=i[1]>t[1]&&t[0]<(i[0]-e[0])*(t[1]-e[1])/(i[1]-e[1])+e[0]}function Us(t,e){for(var i,a,h,c,p,m,b,M=!1,O=0,N=e.length;O<N;O++)for(var nt=e[O],ft=0,It=nt.length;ft<It-1;ft++){if((c=(i=t)[0]-(a=nt[ft])[0])*(b=i[1]-(h=nt[ft+1])[1])-(m=i[0]-h[0])*(p=i[1]-a[1])==0&&c*m<=0&&p*b<=0)return!1;Kh(t,nt[ft],nt[ft+1])&&(M=!M)}return M}function Jh(t,e){for(var i=0;i<e.length;i++)if(Us(t,e[i]))return!0;return!1}function Rl(t,e,i,a){var h=a[0]-i[0],c=a[1]-i[1],p=(t[0]-i[0])*c-h*(t[1]-i[1]),m=(e[0]-i[0])*c-h*(e[1]-i[1]);return p>0&&m<0||p<0&&m>0}function $h(t,e,i){for(var a=0,h=i;a<h.length;a+=1)for(var c=h[a],p=0;p<c.length-1;++p)if((N=[(O=c[p+1])[0]-(M=c[p])[0],O[1]-M[1]])[0]*(nt=[(b=e)[0]-(m=t)[0],b[1]-m[1]])[1]-N[1]*nt[0]!=0&&Rl(m,b,M,O)&&Rl(M,O,m,b))return!0;var m,b,M,O,N,nt;return!1}function Fl(t,e){for(var i=0;i<t.length;++i)if(!Us(t[i],e))return!1;for(var a=0;a<t.length-1;++a)if($h(t[a],t[a+1],e))return!1;return!0}function jl(t,e){for(var i=0;i<e.length;i++)if(Fl(t,e[i]))return!0;return!1}function Zo(t,e,i){for(var a=[],h=0;h<t.length;h++){for(var c=[],p=0;p<t[h].length;p++){var m=Yh(t[h][p],i);qr(e,m),c.push(m)}a.push(c)}return a}function Ns(t,e,i){for(var a=[],h=0;h<t.length;h++){var c=Zo(t[h],e,i);a.push(c)}return a}function ma(t,e,i,a){if(t[0]<i[0]||t[0]>i[2]){var h=.5*a,c=t[0]-i[0]>h?-a:i[0]-t[0]>h?a:0;c===0&&(c=t[0]-i[2]>h?-a:i[2]-t[0]>h?a:0),t[0]+=c}qr(e,t)}function Ul(t,e,i,a){for(var h=8192*Math.pow(2,a.z),c=[8192*a.x,8192*a.y],p=[],m=0,b=t;m<b.length;m+=1)for(var M=0,O=b[m];M<O.length;M+=1){var N=O[M],nt=[N.x+c[0],N.y+c[1]];ma(nt,e,i,h),p.push(nt)}return p}function qa(t,e,i,a){for(var h,c=8192*Math.pow(2,a.z),p=[8192*a.x,8192*a.y],m=[],b=0,M=t;b<M.length;b+=1){for(var O=[],N=0,nt=M[b];N<nt.length;N+=1){var ft=nt[N],It=[ft.x+p[0],ft.y+p[1]];qr(e,It),O.push(It)}m.push(O)}if(e[2]-e[0]<=c/2){(h=e)[0]=h[1]=1/0,h[2]=h[3]=-1/0;for(var Ot=0,Wt=m;Ot<Wt.length;Ot+=1)for(var Gt=0,ie=Wt[Ot];Gt<ie.length;Gt+=1)ma(ie[Gt],e,i,c)}return m}On.parse=function(t,e){if(t.length!==2)return e.error("Expected one argument.");var i=t[1];if(typeof i!="object"||Array.isArray(i))return e.error("Collator options argument must be an object.");var a=e.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Pe);if(!a)return null;var h=e.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Pe);if(!h)return null;var c=null;return i.locale&&!(c=e.parse(i.locale,1,Fe))?null:new On(a,h,c)},On.prototype.evaluate=function(t){return new $r(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},On.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},On.prototype.outputDefined=function(){return!1},On.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var xn=function(t,e){this.type=Pe,this.geojson=t,this.geometries=e};function Jn(t){if(t instanceof Or&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof xn)return!1;var e=!0;return t.eachChild(function(i){e&&!Jn(i)&&(e=!1)}),e}function $n(t){if(t instanceof Or&&t.name==="feature-state")return!1;var e=!0;return t.eachChild(function(i){e&&!$n(i)&&(e=!1)}),e}function To(t,e){if(t instanceof Or&&e.indexOf(t.name)>=0)return!1;var i=!0;return t.eachChild(function(a){i&&!To(a,e)&&(i=!1)}),i}xn.parse=function(t,e){if(t.length!==2)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(da(t[1])){var i=t[1];if(i.type==="FeatureCollection")for(var a=0;a<i.features.length;++a){var h=i.features[a].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new xn(i,i.features[a].geometry)}else if(i.type==="Feature"){var c=i.geometry.type;if(c==="Polygon"||c==="MultiPolygon")return new xn(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new xn(i,i)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},xn.prototype.evaluate=function(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(e,i){var a=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],c=e.canonicalID();if(i.type==="Polygon"){var p=Zo(i.coordinates,h,c),m=Ul(e.geometry(),a,h,c);if(!So(a,h))return!1;for(var b=0,M=m;b<M.length;b+=1)if(!Us(M[b],p))return!1}if(i.type==="MultiPolygon"){var O=Ns(i.coordinates,h,c),N=Ul(e.geometry(),a,h,c);if(!So(a,h))return!1;for(var nt=0,ft=N;nt<ft.length;nt+=1)if(!Jh(ft[nt],O))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(e,i){var a=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],c=e.canonicalID();if(i.type==="Polygon"){var p=Zo(i.coordinates,h,c),m=qa(e.geometry(),a,h,c);if(!So(a,h))return!1;for(var b=0,M=m;b<M.length;b+=1)if(!Fl(M[b],p))return!1}if(i.type==="MultiPolygon"){var O=Ns(i.coordinates,h,c),N=qa(e.geometry(),a,h,c);if(!So(a,h))return!1;for(var nt=0,ft=N;nt<ft.length;nt+=1)if(!jl(ft[nt],O))return!1}return!0}(t,this.geometries)}return!1},xn.prototype.eachChild=function(){},xn.prototype.outputDefined=function(){return!0},xn.prototype.serialize=function(){return["within",this.geojson]};var Qn=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Qn.parse=function(t,e){if(t.length!==2||typeof t[1]!="string")return e.error("'var' expression requires exactly one string literal argument.");var i=t[1];return e.scope.has(i)?new Qn(i,e.scope.get(i)):e.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Qn.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Qn.prototype.eachChild=function(){},Qn.prototype.outputDefined=function(){return!1},Qn.prototype.serialize=function(){return["var",this.name]};var to=function(t,e,i,a,h){e===void 0&&(e=[]),a===void 0&&(a=new qe),h===void 0&&(h=[]),this.registry=t,this.path=e,this.key=e.map(function(c){return"["+c+"]"}).join(""),this.scope=a,this.errors=h,this.expectedType=i};function Xa(t,e){for(var i,a=t.length-1,h=0,c=a,p=0;h<=c;)if((i=t[p=Math.floor((h+c)/2)])<=e){if(p===a||e<t[p+1])return p;h=p+1}else{if(!(i>e))throw new Mr("Input is not a number.");c=p-1}return 0}to.prototype.parse=function(t,e,i,a,h){return h===void 0&&(h={}),e?this.concat(e,i,a)._parse(t,h):this._parse(t,h)},to.prototype._parse=function(t,e){function i(M,O,N){return N==="assert"?new Qi(O,[M]):N==="coerce"?new _n(O,[M]):M}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var a=t[0];if(typeof a!="string")return this.error("Expression name must be a string, but found "+typeof a+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var h=this.registry[a];if(h){var c=h.parse(t,this);if(!c)return null;if(this.expectedType){var p=this.expectedType,m=c.type;if(p.kind!=="string"&&p.kind!=="number"&&p.kind!=="boolean"&&p.kind!=="object"&&p.kind!=="array"||m.kind!=="value")if(p.kind!=="color"&&p.kind!=="formatted"&&p.kind!=="resolvedImage"||m.kind!=="value"&&m.kind!=="string"){if(this.checkSubtype(p,m))return null}else c=i(c,p,e.typeAnnotation||"coerce");else c=i(c,p,e.typeAnnotation||"assert")}if(!(c instanceof Gr)&&c.type.kind!=="resolvedImage"&&function M(O){if(O instanceof Qn)return M(O.boundExpression);if(O instanceof Or&&O.name==="error"||O instanceof On||O instanceof xn)return!1;var N=O instanceof _n||O instanceof Qi,nt=!0;return O.eachChild(function(ft){nt=N?nt&&M(ft):nt&&ft instanceof Gr}),!!nt&&Jn(O)&&To(O,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(c)){var b=new Vn;try{c=new Gr(c.type,c.evaluate(b))}catch(M){return this.error(M.message),null}}return c}return this.error('Unknown expression "'+a+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},to.prototype.concat=function(t,e,i){var a=typeof t=="number"?this.path.concat(t):this.path,h=i?this.scope.concat(i):this.scope;return new to(this.registry,a,e||null,h,this.errors)},to.prototype.error=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var a=""+this.key+e.map(function(h){return"["+h+"]"}).join("");this.errors.push(new Se(a,t))},to.prototype.checkSubtype=function(t,e){var i=Fi(t,e);return i&&this.error(i),i};var on=function(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var a=0,h=i;a<h.length;a+=1){var c=h[a],p=c[1];this.labels.push(c[0]),this.outputs.push(p)}};function yr(t,e,i){return t*(1-i)+e*i}on.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var i=e.parse(t[1],1,me);if(!i)return null;var a=[],h=null;e.expectedType&&e.expectedType.kind!=="value"&&(h=e.expectedType);for(var c=1;c<t.length;c+=2){var p=c===1?-1/0:t[c],m=t[c+1],b=c,M=c+1;if(typeof p!="number")return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(a.length&&a[a.length-1][0]>=p)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);var O=e.parse(m,M,h);if(!O)return null;h=h||O.type,a.push([p,O])}return new on(h,i,a)},on.prototype.evaluate=function(t){var e=this.labels,i=this.outputs;if(e.length===1)return i[0].evaluate(t);var a=this.input.evaluate(t);if(a<=e[0])return i[0].evaluate(t);var h=e.length;return a>=e[h-1]?i[h-1].evaluate(t):i[Xa(e,a)].evaluate(t)},on.prototype.eachChild=function(t){t(this.input);for(var e=0,i=this.outputs;e<i.length;e+=1)t(i[e])},on.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},on.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Yo=Object.freeze({__proto__:null,number:yr,color:function(t,e,i){return new Bi(yr(t.r,e.r,i),yr(t.g,e.g,i),yr(t.b,e.b,i),yr(t.a,e.a,i))},array:function(t,e,i){return t.map(function(a,h){return yr(a,e[h],i)})}}),Nl=6/29*3*(6/29),Qh=Math.PI/180,tc=180/Math.PI;function Vs(t){return t>.008856451679035631?Math.pow(t,1/3):t/Nl+4/29}function Gs(t){return t>6/29?t*t*t:Nl*(t-4/29)}function qs(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Xs(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Vl(t){var e=Xs(t.r),i=Xs(t.g),a=Xs(t.b),h=Vs((.4124564*e+.3575761*i+.1804375*a)/.95047),c=Vs((.2126729*e+.7151522*i+.072175*a)/1);return{l:116*c-16,a:500*(h-c),b:200*(c-Vs((.0193339*e+.119192*i+.9503041*a)/1.08883)),alpha:t.a}}function Gl(t){var e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,a=isNaN(t.b)?e:e-t.b/200;return e=1*Gs(e),i=.95047*Gs(i),a=1.08883*Gs(a),new Bi(qs(3.2404542*i-1.5371385*e-.4985314*a),qs(-.969266*i+1.8760108*e+.041556*a),qs(.0556434*i-.2040259*e+1.0572252*a),t.alpha)}function ec(t,e,i){var a=e-t;return t+i*(a>180||a<-180?a-360*Math.round(a/360):a)}var ga={forward:Vl,reverse:Gl,interpolate:function(t,e,i){return{l:yr(t.l,e.l,i),a:yr(t.a,e.a,i),b:yr(t.b,e.b,i),alpha:yr(t.alpha,e.alpha,i)}}},ya={forward:function(t){var e=Vl(t),i=e.l,a=e.a,h=e.b,c=Math.atan2(h,a)*tc;return{h:c<0?c+360:c,c:Math.sqrt(a*a+h*h),l:i,alpha:t.a}},reverse:function(t){var e=t.h*Qh,i=t.c;return Gl({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:ec(t.h,e.h,i),c:yr(t.c,e.c,i),l:yr(t.l,e.l,i),alpha:yr(t.alpha,e.alpha,i)}}},ql=Object.freeze({__proto__:null,lab:ga,hcl:ya}),Br=function(t,e,i,a,h){this.type=t,this.operator=e,this.interpolation=i,this.input=a,this.labels=[],this.outputs=[];for(var c=0,p=h;c<p.length;c+=1){var m=p[c],b=m[1];this.labels.push(m[0]),this.outputs.push(b)}};function Ws(t,e,i,a){var h=a-i,c=t-i;return h===0?0:e===1?c/h:(Math.pow(e,c)-1)/(Math.pow(e,h)-1)}Br.interpolationFactor=function(t,e,i,a){var h=0;if(t.name==="exponential")h=Ws(e,t.base,i,a);else if(t.name==="linear")h=Ws(e,1,i,a);else if(t.name==="cubic-bezier"){var c=t.controlPoints;h=new dt(c[0],c[1],c[2],c[3]).solve(Ws(e,1,i,a))}return h},Br.parse=function(t,e){var i=t[0],a=t[1],h=t[2],c=t.slice(3);if(!Array.isArray(a)||a.length===0)return e.error("Expected an interpolation type expression.",1);if(a[0]==="linear")a={name:"linear"};else if(a[0]==="exponential"){var p=a[1];if(typeof p!="number")return e.error("Exponential interpolation requires a numeric base.",1,1);a={name:"exponential",base:p}}else{if(a[0]!=="cubic-bezier")return e.error("Unknown interpolation type "+String(a[0]),1,0);var m=a.slice(1);if(m.length!==4||m.some(function(Wt){return typeof Wt!="number"||Wt<0||Wt>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);a={name:"cubic-bezier",controlPoints:m}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(h=e.parse(h,2,me)))return null;var b=[],M=null;i==="interpolate-hcl"||i==="interpolate-lab"?M=Le:e.expectedType&&e.expectedType.kind!=="value"&&(M=e.expectedType);for(var O=0;O<c.length;O+=2){var N=c[O],nt=c[O+1],ft=O+3,It=O+4;if(typeof N!="number")return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ft);if(b.length&&b[b.length-1][0]>=N)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ft);var Ot=e.parse(nt,It,M);if(!Ot)return null;M=M||Ot.type,b.push([N,Ot])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new Br(M,i,a,h,b):e.error("Type "+Ai(M)+" is not interpolatable.")},Br.prototype.evaluate=function(t){var e=this.labels,i=this.outputs;if(e.length===1)return i[0].evaluate(t);var a=this.input.evaluate(t);if(a<=e[0])return i[0].evaluate(t);var h=e.length;if(a>=e[h-1])return i[h-1].evaluate(t);var c=Xa(e,a),p=Br.interpolationFactor(this.interpolation,a,e[c],e[c+1]),m=i[c].evaluate(t),b=i[c+1].evaluate(t);return this.operator==="interpolate"?Yo[this.type.kind.toLowerCase()](m,b,p):this.operator==="interpolate-hcl"?ya.reverse(ya.interpolate(ya.forward(m),ya.forward(b),p)):ga.reverse(ga.interpolate(ga.forward(m),ga.forward(b),p))},Br.prototype.eachChild=function(t){t(this.input);for(var e=0,i=this.outputs;e<i.length;e+=1)t(i[e])},Br.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Br.prototype.serialize=function(){var t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],i=0;i<this.labels.length;i++)e.push(this.labels[i],this.outputs[i].serialize());return e};var eo=function(t,e){this.type=t,this.args=e};eo.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var i=null,a=e.expectedType;a&&a.kind!=="value"&&(i=a);for(var h=[],c=0,p=t.slice(1);c<p.length;c+=1){var m=e.parse(p[c],1+h.length,i,void 0,{typeAnnotation:"omit"});if(!m)return null;i=i||m.type,h.push(m)}var b=a&&h.some(function(M){return Fi(a,M.type)});return new eo(b?Be:i,h)},eo.prototype.evaluate=function(t){for(var e,i=null,a=0,h=0,c=this.args;h<c.length&&(a++,(i=c[h].evaluate(t))&&i instanceof Qr&&!i.available&&(e||(e=i.name),i=null,a===this.args.length&&(i=e)),i===null);h+=1);return i},eo.prototype.eachChild=function(t){this.args.forEach(t)},eo.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},eo.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var io=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};io.prototype.evaluate=function(t){return this.result.evaluate(t)},io.prototype.eachChild=function(t){for(var e=0,i=this.bindings;e<i.length;e+=1)t(i[e][1]);t(this.result)},io.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var i=[],a=1;a<t.length-1;a+=2){var h=t[a];if(typeof h!="string")return e.error("Expected string, but found "+typeof h+" instead.",a);if(/[^a-zA-Z0-9_]/.test(h))return e.error("Variable names must contain only alphanumeric characters or '_'.",a);var c=e.parse(t[a+1],a+1);if(!c)return null;i.push([h,c])}var p=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return p?new io(i,p):null},io.prototype.outputDefined=function(){return this.result.outputDefined()},io.prototype.serialize=function(){for(var t=["let"],e=0,i=this.bindings;e<i.length;e+=1){var a=i[e];t.push(a[0],a[1].serialize())}return t.push(this.result.serialize()),t};var ko=function(t,e,i){this.type=t,this.index=e,this.input=i};ko.parse=function(t,e){if(t.length!==3)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,me),a=e.parse(t[2],2,Oi(e.expectedType||Be));return i&&a?new ko(a.type.itemType,i,a):null},ko.prototype.evaluate=function(t){var e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new Mr("Array index out of bounds: "+e+" < 0.");if(e>=i.length)throw new Mr("Array index out of bounds: "+e+" > "+(i.length-1)+".");if(e!==Math.floor(e))throw new Mr("Array index must be an integer, but found "+e+" instead.");return i[e]},ko.prototype.eachChild=function(t){t(this.index),t(this.input)},ko.prototype.outputDefined=function(){return!1},ko.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Co=function(t,e){this.type=Pe,this.needle=t,this.haystack=e};Co.parse=function(t,e){if(t.length!==3)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Be),a=e.parse(t[2],2,Be);return i&&a?ur(i.type,[Pe,Fe,me,Ne,Be])?new Co(i,a):e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ai(i.type)+" instead"):null},Co.prototype.evaluate=function(t){var e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!Vi(e,["boolean","string","number","null"]))throw new Mr("Expected first argument to be of type boolean, string, number or null, but found "+Ai(pr(e))+" instead.");if(!Vi(i,["string","array"]))throw new Mr("Expected second argument to be of type array or string, but found "+Ai(pr(i))+" instead.");return i.indexOf(e)>=0},Co.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},Co.prototype.outputDefined=function(){return!0},Co.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ro=function(t,e,i){this.type=me,this.needle=t,this.haystack=e,this.fromIndex=i};ro.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Be),a=e.parse(t[2],2,Be);if(!i||!a)return null;if(!ur(i.type,[Pe,Fe,me,Ne,Be]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ai(i.type)+" instead");if(t.length===4){var h=e.parse(t[3],3,me);return h?new ro(i,a,h):null}return new ro(i,a)},ro.prototype.evaluate=function(t){var e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!Vi(e,["boolean","string","number","null"]))throw new Mr("Expected first argument to be of type boolean, string, number or null, but found "+Ai(pr(e))+" instead.");if(!Vi(i,["string","array"]))throw new Mr("Expected second argument to be of type array or string, but found "+Ai(pr(i))+" instead.");if(this.fromIndex){var a=this.fromIndex.evaluate(t);return i.indexOf(e,a)}return i.indexOf(e)},ro.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},ro.prototype.outputDefined=function(){return!1},ro.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Ao=function(t,e,i,a,h,c){this.inputType=t,this.type=e,this.input=i,this.cases=a,this.outputs=h,this.otherwise=c};Ao.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var i,a;e.expectedType&&e.expectedType.kind!=="value"&&(a=e.expectedType);for(var h={},c=[],p=2;p<t.length-1;p+=2){var m=t[p],b=t[p+1];Array.isArray(m)||(m=[m]);var M=e.concat(p);if(m.length===0)return M.error("Expected at least one branch label.");for(var O=0,N=m;O<N.length;O+=1){var nt=N[O];if(typeof nt!="number"&&typeof nt!="string")return M.error("Branch labels must be numbers or strings.");if(typeof nt=="number"&&Math.abs(nt)>Number.MAX_SAFE_INTEGER)return M.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof nt=="number"&&Math.floor(nt)!==nt)return M.error("Numeric branch labels must be integer values.");if(i){if(M.checkSubtype(i,pr(nt)))return null}else i=pr(nt);if(h[String(nt)]!==void 0)return M.error("Branch labels must be unique.");h[String(nt)]=c.length}var ft=e.parse(b,p,a);if(!ft)return null;a=a||ft.type,c.push(ft)}var It=e.parse(t[1],1,Be);if(!It)return null;var Ot=e.parse(t[t.length-1],t.length-1,a);return Ot?It.type.kind!=="value"&&e.concat(1).checkSubtype(i,It.type)?null:new Ao(i,a,It,h,c,Ot):null},Ao.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(pr(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Ao.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Ao.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},Ao.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],i=[],a={},h=0,c=Object.keys(this.cases).sort();h<c.length;h+=1){var p=c[h];(N=a[this.cases[p]])===void 0?(a[this.cases[p]]=i.length,i.push([this.cases[p],[p]])):i[N][1].push(p)}for(var m=function(ft){return t.inputType.kind==="number"?Number(ft):ft},b=0,M=i;b<M.length;b+=1){var O=M[b],N=O[0],nt=O[1];e.push(nt.length===1?m(nt[0]):nt.map(m)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var Eo=function(t,e,i){this.type=t,this.branches=e,this.otherwise=i};Eo.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var i;e.expectedType&&e.expectedType.kind!=="value"&&(i=e.expectedType);for(var a=[],h=1;h<t.length-1;h+=2){var c=e.parse(t[h],h,Pe);if(!c)return null;var p=e.parse(t[h+1],h+1,i);if(!p)return null;a.push([c,p]),i=i||p.type}var m=e.parse(t[t.length-1],t.length-1,i);return m?new Eo(i,a,m):null},Eo.prototype.evaluate=function(t){for(var e=0,i=this.branches;e<i.length;e+=1){var a=i[e],h=a[1];if(a[0].evaluate(t))return h.evaluate(t)}return this.otherwise.evaluate(t)},Eo.prototype.eachChild=function(t){for(var e=0,i=this.branches;e<i.length;e+=1){var a=i[e],h=a[1];t(a[0]),t(h)}t(this.otherwise)},Eo.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},Eo.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var no=function(t,e,i,a){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=a};function Xl(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Wl(t,e,i,a){return a.compare(e,i)===0}function Hi(t,e,i){var a=t!=="=="&&t!=="!=";return function(){function h(c,p,m){this.type=Pe,this.lhs=c,this.rhs=p,this.collator=m,this.hasUntypedArgument=c.type.kind==="value"||p.type.kind==="value"}return h.parse=function(c,p){if(c.length!==3&&c.length!==4)return p.error("Expected two or three arguments.");var m=c[0],b=p.parse(c[1],1,Be);if(!b)return null;if(!Xl(m,b.type))return p.concat(1).error('"'+m+`" comparisons are not supported for type '`+Ai(b.type)+"'.");var M=p.parse(c[2],2,Be);if(!M)return null;if(!Xl(m,M.type))return p.concat(2).error('"'+m+`" comparisons are not supported for type '`+Ai(M.type)+"'.");if(b.type.kind!==M.type.kind&&b.type.kind!=="value"&&M.type.kind!=="value")return p.error("Cannot compare types '"+Ai(b.type)+"' and '"+Ai(M.type)+"'.");a&&(b.type.kind==="value"&&M.type.kind!=="value"?b=new Qi(M.type,[b]):b.type.kind!=="value"&&M.type.kind==="value"&&(M=new Qi(b.type,[M])));var O=null;if(c.length===4){if(b.type.kind!=="string"&&M.type.kind!=="string"&&b.type.kind!=="value"&&M.type.kind!=="value")return p.error("Cannot use collator to compare non-string types.");if(!(O=p.parse(c[3],3,ki)))return null}return new h(b,M,O)},h.prototype.evaluate=function(c){var p=this.lhs.evaluate(c),m=this.rhs.evaluate(c);if(a&&this.hasUntypedArgument){var b=pr(p),M=pr(m);if(b.kind!==M.kind||b.kind!=="string"&&b.kind!=="number")throw new Mr('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+b.kind+", "+M.kind+") instead.")}if(this.collator&&!a&&this.hasUntypedArgument){var O=pr(p),N=pr(m);if(O.kind!=="string"||N.kind!=="string")return e(c,p,m)}return this.collator?i(c,p,m,this.collator.evaluate(c)):e(c,p,m)},h.prototype.eachChild=function(c){c(this.lhs),c(this.rhs),this.collator&&c(this.collator)},h.prototype.outputDefined=function(){return!0},h.prototype.serialize=function(){var c=[t];return this.eachChild(function(p){c.push(p.serialize())}),c},h}()}no.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Be),a=e.parse(t[2],2,me);if(!i||!a)return null;if(!ur(i.type,[Oi(Be),Fe,Be]))return e.error("Expected first argument to be of type array or string, but found "+Ai(i.type)+" instead");if(t.length===4){var h=e.parse(t[3],3,me);return h?new no(i.type,i,a,h):null}return new no(i.type,i,a)},no.prototype.evaluate=function(t){var e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!Vi(e,["string","array"]))throw new Mr("Expected first argument to be of type array or string, but found "+Ai(pr(e))+" instead.");if(this.endIndex){var a=this.endIndex.evaluate(t);return e.slice(i,a)}return e.slice(i)},no.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},no.prototype.outputDefined=function(){return!1},no.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var ic=Hi("==",function(t,e,i){return e===i},Wl),Wa=Hi("!=",function(t,e,i){return e!==i},function(t,e,i,a){return!Wl(0,e,i,a)}),Hl=Hi("<",function(t,e,i){return e<i},function(t,e,i,a){return a.compare(e,i)<0}),Zl=Hi(">",function(t,e,i){return e>i},function(t,e,i,a){return a.compare(e,i)>0}),Yl=Hi("<=",function(t,e,i){return e<=i},function(t,e,i,a){return a.compare(e,i)<=0}),Kl=Hi(">=",function(t,e,i){return e>=i},function(t,e,i,a){return a.compare(e,i)>=0}),Mo=function(t,e,i,a,h){this.type=Fe,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=a,this.maxFractionDigits=h};Mo.parse=function(t,e){if(t.length!==3)return e.error("Expected two arguments.");var i=e.parse(t[1],1,me);if(!i)return null;var a=t[2];if(typeof a!="object"||Array.isArray(a))return e.error("NumberFormat options argument must be an object.");var h=null;if(a.locale&&!(h=e.parse(a.locale,1,Fe)))return null;var c=null;if(a.currency&&!(c=e.parse(a.currency,1,Fe)))return null;var p=null;if(a["min-fraction-digits"]&&!(p=e.parse(a["min-fraction-digits"],1,me)))return null;var m=null;return a["max-fraction-digits"]&&!(m=e.parse(a["max-fraction-digits"],1,me))?null:new Mo(i,h,c,p,m)},Mo.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},Mo.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},Mo.prototype.outputDefined=function(){return!1},Mo.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var oo=function(t){this.type=me,this.input=t};oo.parse=function(t,e){if(t.length!==2)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?e.error("Expected argument of type string or array, but found "+Ai(i.type)+" instead."):new oo(i):null},oo.prototype.evaluate=function(t){var e=this.input.evaluate(t);if(typeof e=="string"||Array.isArray(e))return e.length;throw new Mr("Expected value to be of type string or array, but found "+Ai(pr(e))+" instead.")},oo.prototype.eachChild=function(t){t(this.input)},oo.prototype.outputDefined=function(){return!1},oo.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Po={"==":ic,"!=":Wa,">":Zl,"<":Hl,">=":Kl,"<=":Yl,array:Qi,at:ko,boolean:Qi,case:Eo,coalesce:eo,collator:On,format:En,image:dn,in:Co,"index-of":ro,interpolate:Br,"interpolate-hcl":Br,"interpolate-lab":Br,length:oo,let:io,literal:Gr,match:Ao,number:Qi,"number-format":Mo,object:Qi,slice:no,step:on,string:Qi,"to-boolean":_n,"to-color":_n,"to-number":_n,"to-string":_n,var:Qn,within:xn};function Jl(t,e){var i=e[0],a=e[1],h=e[2],c=e[3];i=i.evaluate(t),a=a.evaluate(t),h=h.evaluate(t);var p=c?c.evaluate(t):1,m=js(i,a,h,p);if(m)throw new Mr(m);return new Bi(i/255*p,a/255*p,h/255*p,p)}function $l(t,e){return t in e}function Hs(t,e){var i=e[t];return i===void 0?null:i}function Io(t){return{type:t}}function Ql(t){return{result:"success",value:t}}function Lo(t){return{result:"error",value:t}}function zo(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function th(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function va(t){return!!t.expression&&t.expression.interpolated}function Yi(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function Ha(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function rc(t){return t}function Ko(t,e,i){return t!==void 0?t:e!==void 0?e:i!==void 0?i:void 0}function eh(t,e,i,a,h){return Ko(typeof i===h?a[i]:void 0,t.default,e.default)}function nc(t,e,i){if(Yi(i)!=="number")return Ko(t.default,e.default);var a=t.stops.length;if(a===1||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[a-1][0])return t.stops[a-1][1];var h=Xa(t.stops.map(function(c){return c[0]}),i);return t.stops[h][1]}function ih(t,e,i){var a=t.base!==void 0?t.base:1;if(Yi(i)!=="number")return Ko(t.default,e.default);var h=t.stops.length;if(h===1||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[h-1][0])return t.stops[h-1][1];var c=Xa(t.stops.map(function(N){return N[0]}),i),p=function(N,nt,ft,It){var Ot=It-ft,Wt=N-ft;return Ot===0?0:nt===1?Wt/Ot:(Math.pow(nt,Wt)-1)/(Math.pow(nt,Ot)-1)}(i,a,t.stops[c][0],t.stops[c+1][0]),m=t.stops[c][1],b=t.stops[c+1][1],M=Yo[e.type]||rc;if(t.colorSpace&&t.colorSpace!=="rgb"){var O=ql[t.colorSpace];M=function(N,nt){return O.reverse(O.interpolate(O.forward(N),O.forward(nt),p))}}return typeof m.evaluate=="function"?{evaluate:function(){for(var N=[],nt=arguments.length;nt--;)N[nt]=arguments[nt];var ft=m.evaluate.apply(void 0,N),It=b.evaluate.apply(void 0,N);if(ft!==void 0&&It!==void 0)return M(ft,It,p)}}:M(m,b,p)}function Za(t,e,i){return e.type==="color"?i=Bi.parse(i):e.type==="formatted"?i=Er.fromString(i.toString()):e.type==="resolvedImage"?i=Qr.fromString(i.toString()):Yi(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),Ko(i,t.default,e.default)}Or.register(Po,{error:[{kind:"error"},[Fe],function(t,e){throw new Mr(e[0].evaluate(t))}],typeof:[Fe,[Be],function(t,e){return Ai(pr(e[0].evaluate(t)))}],"to-rgba":[Oi(me,4),[Le],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Le,[me,me,me],Jl],rgba:[Le,[me,me,me,me],Jl],has:{type:Pe,overloads:[[[Fe],function(t,e){return $l(e[0].evaluate(t),t.properties())}],[[Fe,vi],function(t,e){var i=e[1];return $l(e[0].evaluate(t),i.evaluate(t))}]]},get:{type:Be,overloads:[[[Fe],function(t,e){return Hs(e[0].evaluate(t),t.properties())}],[[Fe,vi],function(t,e){var i=e[1];return Hs(e[0].evaluate(t),i.evaluate(t))}]]},"feature-state":[Be,[Fe],function(t,e){return Hs(e[0].evaluate(t),t.featureState||{})}],properties:[vi,[],function(t){return t.properties()}],"geometry-type":[Fe,[],function(t){return t.geometryType()}],id:[Be,[],function(t){return t.id()}],zoom:[me,[],function(t){return t.globals.zoom}],"heatmap-density":[me,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[me,[],function(t){return t.globals.lineProgress||0}],accumulated:[Be,[],function(t){return t.globals.accumulated===void 0?null:t.globals.accumulated}],"+":[me,Io(me),function(t,e){for(var i=0,a=0,h=e;a<h.length;a+=1)i+=h[a].evaluate(t);return i}],"*":[me,Io(me),function(t,e){for(var i=1,a=0,h=e;a<h.length;a+=1)i*=h[a].evaluate(t);return i}],"-":{type:me,overloads:[[[me,me],function(t,e){var i=e[1];return e[0].evaluate(t)-i.evaluate(t)}],[[me],function(t,e){return-e[0].evaluate(t)}]]},"/":[me,[me,me],function(t,e){var i=e[1];return e[0].evaluate(t)/i.evaluate(t)}],"%":[me,[me,me],function(t,e){var i=e[1];return e[0].evaluate(t)%i.evaluate(t)}],ln2:[me,[],function(){return Math.LN2}],pi:[me,[],function(){return Math.PI}],e:[me,[],function(){return Math.E}],"^":[me,[me,me],function(t,e){var i=e[1];return Math.pow(e[0].evaluate(t),i.evaluate(t))}],sqrt:[me,[me],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[me,[me],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[me,[me],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[me,[me],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[me,[me],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[me,[me],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[me,[me],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[me,[me],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[me,[me],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[me,[me],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[me,Io(me),function(t,e){return Math.min.apply(Math,e.map(function(i){return i.evaluate(t)}))}],max:[me,Io(me),function(t,e){return Math.max.apply(Math,e.map(function(i){return i.evaluate(t)}))}],abs:[me,[me],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[me,[me],function(t,e){var i=e[0].evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[me,[me],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[me,[me],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Pe,[Fe,Be],function(t,e){var i=e[0],a=e[1];return t.properties()[i.value]===a.value}],"filter-id-==":[Pe,[Be],function(t,e){var i=e[0];return t.id()===i.value}],"filter-type-==":[Pe,[Fe],function(t,e){var i=e[0];return t.geometryType()===i.value}],"filter-<":[Pe,[Fe,Be],function(t,e){var i=e[0],a=e[1],h=t.properties()[i.value],c=a.value;return typeof h==typeof c&&h<c}],"filter-id-<":[Pe,[Be],function(t,e){var i=e[0],a=t.id(),h=i.value;return typeof a==typeof h&&a<h}],"filter->":[Pe,[Fe,Be],function(t,e){var i=e[0],a=e[1],h=t.properties()[i.value],c=a.value;return typeof h==typeof c&&h>c}],"filter-id->":[Pe,[Be],function(t,e){var i=e[0],a=t.id(),h=i.value;return typeof a==typeof h&&a>h}],"filter-<=":[Pe,[Fe,Be],function(t,e){var i=e[0],a=e[1],h=t.properties()[i.value],c=a.value;return typeof h==typeof c&&h<=c}],"filter-id-<=":[Pe,[Be],function(t,e){var i=e[0],a=t.id(),h=i.value;return typeof a==typeof h&&a<=h}],"filter->=":[Pe,[Fe,Be],function(t,e){var i=e[0],a=e[1],h=t.properties()[i.value],c=a.value;return typeof h==typeof c&&h>=c}],"filter-id->=":[Pe,[Be],function(t,e){var i=e[0],a=t.id(),h=i.value;return typeof a==typeof h&&a>=h}],"filter-has":[Pe,[Be],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Pe,[],function(t){return t.id()!==null&&t.id()!==void 0}],"filter-type-in":[Pe,[Oi(Fe)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Pe,[Oi(Be)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Pe,[Fe,Oi(Be)],function(t,e){var i=e[0];return e[1].value.indexOf(t.properties()[i.value])>=0}],"filter-in-large":[Pe,[Fe,Oi(Be)],function(t,e){var i=e[0],a=e[1];return function(h,c,p,m){for(;p<=m;){var b=p+m>>1;if(c[b]===h)return!0;c[b]>h?m=b-1:p=b+1}return!1}(t.properties()[i.value],a.value,0,a.value.length-1)}],all:{type:Pe,overloads:[[[Pe,Pe],function(t,e){var i=e[1];return e[0].evaluate(t)&&i.evaluate(t)}],[Io(Pe),function(t,e){for(var i=0,a=e;i<a.length;i+=1)if(!a[i].evaluate(t))return!1;return!0}]]},any:{type:Pe,overloads:[[[Pe,Pe],function(t,e){var i=e[1];return e[0].evaluate(t)||i.evaluate(t)}],[Io(Pe),function(t,e){for(var i=0,a=e;i<a.length;i+=1)if(a[i].evaluate(t))return!0;return!1}]]},"!":[Pe,[Pe],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Pe,[Fe],function(t,e){var i=t.globals&&t.globals.isSupportedScript;return!i||i(e[0].evaluate(t))}],upcase:[Fe,[Fe],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Fe,[Fe],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Fe,Io(Be),function(t,e){return e.map(function(i){return fa(i.evaluate(t))}).join("")}],"resolved-locale":[Fe,[ki],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Jo=function(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Vn,this._defaultValue=e?function(i){return i.type==="color"&&Ha(i.default)?new Bi(0,0,0,0):i.type==="color"?Bi.parse(i.default)||null:i.default===void 0?null:i.default}(e):null,this._enumValues=e&&e.type==="enum"?e.values:null};function _a(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Po}function Ya(t,e){var i=new to(Po,[],e?function(h){var c={color:Le,string:Fe,number:me,enum:Fe,boolean:Pe,formatted:Wi,resolvedImage:bi};return h.type==="array"?Oi(c[h.value]||Be,h.length):c[h.type]}(e):void 0),a=i.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?Ql(new Jo(a,e)):Lo(i.errors)}Jo.prototype.evaluateWithoutErrorHandling=function(t,e,i,a,h,c){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=a,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=c,this.expression.evaluate(this._evaluator)},Jo.prototype.evaluate=function(t,e,i,a,h,c){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=a,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=c||null;try{var p=this.expression.evaluate(this._evaluator);if(p==null||typeof p=="number"&&p!=p)return this._defaultValue;if(this._enumValues&&!(p in this._enumValues))throw new Mr("Expected value to be one of "+Object.keys(this._enumValues).map(function(m){return JSON.stringify(m)}).join(", ")+", but found "+JSON.stringify(p)+" instead.");return p}catch(m){return this._warningHistory[m.message]||(this._warningHistory[m.message]=!0,typeof console<"u"&&console.warn(m.message)),this._defaultValue}};var xa=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent=t!=="constant"&&!$n(e.expression)};xa.prototype.evaluateWithoutErrorHandling=function(t,e,i,a,h,c){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,a,h,c)},xa.prototype.evaluate=function(t,e,i,a,h,c){return this._styleExpression.evaluate(t,e,i,a,h,c)};var $o=function(t,e,i,a){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent=t!=="camera"&&!$n(e.expression),this.interpolationType=a};function rh(t,e){if((t=Ya(t,e)).result==="error")return t;var i=t.value.expression,a=Jn(i);if(!a&&!zo(e))return Lo([new Se("","data expressions not supported")]);var h=To(i,["zoom"]);if(!h&&!th(e))return Lo([new Se("","zoom expressions not supported")]);var c=function p(m){var b=null;if(m instanceof io)b=p(m.result);else if(m instanceof eo)for(var M=0,O=m.args;M<O.length&&!(b=p(O[M]));M+=1);else(m instanceof on||m instanceof Br)&&m.input instanceof Or&&m.input.name==="zoom"&&(b=m);return b instanceof Se||m.eachChild(function(N){var nt=p(N);nt instanceof Se?b=nt:!b&&nt?b=new Se("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):b&&nt&&b!==nt&&(b=new Se("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),b}(i);return c||h?c instanceof Se?Lo([c]):c instanceof Br&&!va(e)?Lo([new Se("",'"interpolate" expressions cannot be used with this property')]):Ql(c?new $o(a?"camera":"composite",t.value,c.labels,c instanceof Br?c.interpolation:void 0):new xa(a?"constant":"source",t.value)):Lo([new Se("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}$o.prototype.evaluateWithoutErrorHandling=function(t,e,i,a,h,c){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,a,h,c)},$o.prototype.evaluate=function(t,e,i,a,h,c){return this._styleExpression.evaluate(t,e,i,a,h,c)},$o.prototype.interpolationFactor=function(t,e,i){return this.interpolationType?Br.interpolationFactor(this.interpolationType,t,e,i):0};var Qo=function(t,e){this._parameters=t,this._specification=e,we(this,function i(a,h){var c,p,m,b=h.type==="color",M=a.stops&&typeof a.stops[0][0]=="object",O=M||!(M||a.property!==void 0),N=a.type||(va(h)?"exponential":"interval");if(b&&((a=we({},a)).stops&&(a.stops=a.stops.map(function(De){return[De[0],Bi.parse(De[1])]})),a.default=Bi.parse(a.default?a.default:h.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!ql[a.colorSpace])throw new Error("Unknown color space: "+a.colorSpace);if(N==="exponential")c=ih;else if(N==="interval")c=nc;else if(N==="categorical"){c=eh,p=Object.create(null);for(var nt=0,ft=a.stops;nt<ft.length;nt+=1){var It=ft[nt];p[It[0]]=It[1]}m=typeof a.stops[0][0]}else{if(N!=="identity")throw new Error('Unknown function type "'+N+'"');c=Za}if(M){for(var Ot={},Wt=[],Gt=0;Gt<a.stops.length;Gt++){var ie=a.stops[Gt],ae=ie[0].zoom;Ot[ae]===void 0&&(Ot[ae]={zoom:ae,type:a.type,property:a.property,default:a.default,stops:[]},Wt.push(ae)),Ot[ae].stops.push([ie[0].value,ie[1]])}for(var he=[],ue=0,_e=Wt;ue<_e.length;ue+=1){var ke=_e[ue];he.push([Ot[ke].zoom,i(Ot[ke],h)])}var Me={name:"linear"};return{kind:"composite",interpolationType:Me,interpolationFactor:Br.interpolationFactor.bind(void 0,Me),zoomStops:he.map(function(De){return De[0]}),evaluate:function(De,Je){var Re=De.zoom;return ih({stops:he,base:a.base},h,Re).evaluate(Re,Je)}}}if(O){var He=N==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:He,interpolationFactor:Br.interpolationFactor.bind(void 0,He),zoomStops:a.stops.map(function(De){return De[0]}),evaluate:function(De){return c(a,h,De.zoom,p,m)}}}return{kind:"source",evaluate:function(De,Je){var Re=Je&&Je.properties?Je.properties[a.property]:void 0;return Re===void 0?Ko(a.default,h.default):c(a,h,Re,p,m)}}}(this._parameters,this._specification))};function Mn(t){var e=t.key,i=t.value,a=t.valueSpec||{},h=t.objectElementValidators||{},c=t.style,p=t.styleSpec,m=[],b=Yi(i);if(b!=="object")return[new Ut(e,i,"object expected, "+b+" found")];for(var M in i){var O=M.split(".")[0],N=a[O]||a["*"],nt=void 0;if(h[O])nt=h[O];else if(a[O])nt=Ci;else if(h["*"])nt=h["*"];else{if(!a["*"]){m.push(new Ut(e,i[M],'unknown property "'+M+'"'));continue}nt=Ci}m=m.concat(nt({key:(e&&e+".")+M,value:i[M],valueSpec:N,style:c,styleSpec:p,object:i,objectKey:M},i))}for(var ft in a)h[ft]||a[ft].required&&a[ft].default===void 0&&i[ft]===void 0&&m.push(new Ut(e,i,'missing required property "'+ft+'"'));return m}function nh(t){var e=t.value,i=t.valueSpec,a=t.style,h=t.styleSpec,c=t.key,p=t.arrayElementValidator||Ci;if(Yi(e)!=="array")return[new Ut(c,e,"array expected, "+Yi(e)+" found")];if(i.length&&e.length!==i.length)return[new Ut(c,e,"array length "+i.length+" expected, length "+e.length+" found")];if(i["min-length"]&&e.length<i["min-length"])return[new Ut(c,e,"array length at least "+i["min-length"]+" expected, length "+e.length+" found")];var m={type:i.value,values:i.values};h.$version<7&&(m.function=i.function),Yi(i.value)==="object"&&(m=i.value);for(var b=[],M=0;M<e.length;M++)b=b.concat(p({array:e,arrayIndex:M,value:e[M],valueSpec:m,style:a,styleSpec:h,key:c+"["+M+"]"}));return b}function oh(t){var e=t.key,i=t.value,a=t.valueSpec,h=Yi(i);return h==="number"&&i!=i&&(h="NaN"),h!=="number"?[new Ut(e,i,"number expected, "+h+" found")]:"minimum"in a&&i<a.minimum?[new Ut(e,i,i+" is less than the minimum value "+a.minimum)]:"maximum"in a&&i>a.maximum?[new Ut(e,i,i+" is greater than the maximum value "+a.maximum)]:[]}function ah(t){var e,i,a,h=t.valueSpec,c=Te(t.value.type),p={},m=c!=="categorical"&&t.value.property===void 0,b=!m,M=Yi(t.value.stops)==="array"&&Yi(t.value.stops[0])==="array"&&Yi(t.value.stops[0][0])==="object",O=Mn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(ft){if(c==="identity")return[new Ut(ft.key,ft.value,'identity function may not have a "stops" property')];var It=[],Ot=ft.value;return It=It.concat(nh({key:ft.key,value:Ot,valueSpec:ft.valueSpec,style:ft.style,styleSpec:ft.styleSpec,arrayElementValidator:N})),Yi(Ot)==="array"&&Ot.length===0&&It.push(new Ut(ft.key,Ot,"array must have at least one stop")),It},default:function(ft){return Ci({key:ft.key,value:ft.value,valueSpec:h,style:ft.style,styleSpec:ft.styleSpec})}}});return c==="identity"&&m&&O.push(new Ut(t.key,t.value,'missing required property "property"')),c==="identity"||t.value.stops||O.push(new Ut(t.key,t.value,'missing required property "stops"')),c==="exponential"&&t.valueSpec.expression&&!va(t.valueSpec)&&O.push(new Ut(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(b&&!zo(t.valueSpec)?O.push(new Ut(t.key,t.value,"property functions not supported")):m&&!th(t.valueSpec)&&O.push(new Ut(t.key,t.value,"zoom functions not supported"))),c!=="categorical"&&!M||t.value.property!==void 0||O.push(new Ut(t.key,t.value,'"property" property is required')),O;function N(ft){var It=[],Ot=ft.value,Wt=ft.key;if(Yi(Ot)!=="array")return[new Ut(Wt,Ot,"array expected, "+Yi(Ot)+" found")];if(Ot.length!==2)return[new Ut(Wt,Ot,"array length 2 expected, length "+Ot.length+" found")];if(M){if(Yi(Ot[0])!=="object")return[new Ut(Wt,Ot,"object expected, "+Yi(Ot[0])+" found")];if(Ot[0].zoom===void 0)return[new Ut(Wt,Ot,"object stop key must have zoom")];if(Ot[0].value===void 0)return[new Ut(Wt,Ot,"object stop key must have value")];if(a&&a>Te(Ot[0].zoom))return[new Ut(Wt,Ot[0].zoom,"stop zoom values must appear in ascending order")];Te(Ot[0].zoom)!==a&&(a=Te(Ot[0].zoom),i=void 0,p={}),It=It.concat(Mn({key:Wt+"[0]",value:Ot[0],valueSpec:{zoom:{}},style:ft.style,styleSpec:ft.styleSpec,objectElementValidators:{zoom:oh,value:nt}}))}else It=It.concat(nt({key:Wt+"[0]",value:Ot[0],valueSpec:{},style:ft.style,styleSpec:ft.styleSpec},Ot));return _a(fe(Ot[1]))?It.concat([new Ut(Wt+"[1]",Ot[1],"expressions are not allowed in function stops.")]):It.concat(Ci({key:Wt+"[1]",value:Ot[1],valueSpec:h,style:ft.style,styleSpec:ft.styleSpec}))}function nt(ft,It){var Ot=Yi(ft.value),Wt=Te(ft.value),Gt=ft.value!==null?ft.value:It;if(e){if(Ot!==e)return[new Ut(ft.key,Gt,Ot+" stop domain type must match previous stop domain type "+e)]}else e=Ot;if(Ot!=="number"&&Ot!=="string"&&Ot!=="boolean")return[new Ut(ft.key,Gt,"stop domain value must be a number, string, or boolean")];if(Ot!=="number"&&c!=="categorical"){var ie="number expected, "+Ot+" found";return zo(h)&&c===void 0&&(ie+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ut(ft.key,Gt,ie)]}return c!=="categorical"||Ot!=="number"||isFinite(Wt)&&Math.floor(Wt)===Wt?c!=="categorical"&&Ot==="number"&&i!==void 0&&Wt<i?[new Ut(ft.key,Gt,"stop domain values must appear in ascending order")]:(i=Wt,c==="categorical"&&Wt in p?[new Ut(ft.key,Gt,"stop domain values must be unique")]:(p[Wt]=!0,[])):[new Ut(ft.key,Gt,"integer expected, found "+Wt)]}}function Do(t){var e=(t.expressionContext==="property"?rh:Ya)(fe(t.value),t.valueSpec);if(e.result==="error")return e.value.map(function(a){return new Ut(""+t.key+a.key,t.value,a.message)});var i=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!i.outputDefined())return[new Ut(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!$n(i))return[new Ut(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!$n(i))return[new Ut(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!To(i,["zoom","feature-state"]))return[new Ut(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!Jn(i))return[new Ut(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ba(t){var e=t.key,i=t.value,a=t.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(Te(i))===-1&&h.push(new Ut(e,i,"expected one of ["+a.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(a.values).indexOf(Te(i))===-1&&h.push(new Ut(e,i,"expected one of ["+Object.keys(a.values).join(", ")+"], "+JSON.stringify(i)+" found")),h}function Ka(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,i=t.slice(1);e<i.length;e+=1){var a=i[e];if(!Ka(a)&&typeof a!="boolean")return!1}return!0;default:return!0}}Qo.deserialize=function(t){return new Qo(t._parameters,t._specification)},Qo.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Zs={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ja(t){if(t==null)return{filter:function(){return!0},needGeometry:!1};Ka(t)||(t=$a(t));var e=Ya(t,Zs);if(e.result==="error")throw new Error(e.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,a,h){return e.value.evaluate(i,a,{},h)},needGeometry:function i(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(var h=1;h<a.length;h++)if(i(a[h]))return!0;return!1}(t)}}function oc(t,e){return t<e?-1:t>e?1:0}function $a(t){if(!t)return!0;var e,i=t[0];return t.length<=1?i!=="any":i==="=="?Ys(t[1],t[2],"=="):i==="!="?Qa(Ys(t[1],t[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Ys(t[1],t[2],i):i==="any"?(e=t.slice(1),["any"].concat(e.map($a))):i==="all"?["all"].concat(t.slice(1).map($a)):i==="none"?["all"].concat(t.slice(1).map($a).map(Qa)):i==="in"?sh(t[1],t.slice(2)):i==="!in"?Qa(sh(t[1],t.slice(2))):i==="has"?lh(t[1]):i==="!has"?Qa(lh(t[1])):i!=="within"||t}function Ys(t,e,i){switch(t){case"$type":return["filter-type-"+i,e];case"$id":return["filter-id-"+i,e];default:return["filter-"+i,t,e]}}function sh(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(i){return typeof i!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(oc)]]:["filter-in-small",t,["literal",e]]}}function lh(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Qa(t){return["!",t]}function Ks(t){return Ka(fe(t.value))?Do(we({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(i){var a=i.value,h=i.key;if(Yi(a)!=="array")return[new Ut(h,a,"array expected, "+Yi(a)+" found")];var c,p=i.styleSpec,m=[];if(a.length<1)return[new Ut(h,a,"filter array must have at least 1 element")];switch(m=m.concat(ba({key:h+"[0]",value:a[0],valueSpec:p.filter_operator,style:i.style,styleSpec:i.styleSpec})),Te(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&Te(a[1])==="$type"&&m.push(new Ut(h,a,'"$type" cannot be use with operator "'+a[0]+'"'));case"==":case"!=":a.length!==3&&m.push(new Ut(h,a,'filter array for operator "'+a[0]+'" must have 3 elements'));case"in":case"!in":a.length>=2&&(c=Yi(a[1]))!=="string"&&m.push(new Ut(h+"[1]",a[1],"string expected, "+c+" found"));for(var b=2;b<a.length;b++)c=Yi(a[b]),Te(a[1])==="$type"?m=m.concat(ba({key:h+"["+b+"]",value:a[b],valueSpec:p.geometry_type,style:i.style,styleSpec:i.styleSpec})):c!=="string"&&c!=="number"&&c!=="boolean"&&m.push(new Ut(h+"["+b+"]",a[b],"string, number, or boolean expected, "+c+" found"));break;case"any":case"all":case"none":for(var M=1;M<a.length;M++)m=m.concat(e({key:h+"["+M+"]",value:a[M],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":c=Yi(a[1]),a.length!==2?m.push(new Ut(h,a,'filter array for "'+a[0]+'" operator must have 2 elements')):c!=="string"&&m.push(new Ut(h+"[1]",a[1],"string expected, "+c+" found"));break;case"within":c=Yi(a[1]),a.length!==2?m.push(new Ut(h,a,'filter array for "'+a[0]+'" operator must have 2 elements')):c!=="object"&&m.push(new Ut(h+"[1]",a[1],"object expected, "+c+" found"))}return m}(t)}function Js(t,e){var i=t.key,a=t.style,h=t.styleSpec,c=t.value,p=t.objectKey,m=h[e+"_"+t.layerType];if(!m)return[];var b=p.match(/^(.*)-transition$/);if(e==="paint"&&b&&m[b[1]]&&m[b[1]].transition)return Ci({key:i,value:c,valueSpec:h.transition,style:a,styleSpec:h});var M,O=t.valueSpec||m[p];if(!O)return[new Ut(i,c,'unknown property "'+p+'"')];if(Yi(c)==="string"&&zo(O)&&!O.tokens&&(M=/^{([^}]+)}$/.exec(c)))return[new Ut(i,c,'"'+p+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(M[1])+" }`.")];var N=[];return t.layerType==="symbol"&&(p==="text-field"&&a&&!a.glyphs&&N.push(new Ut(i,c,'use of "text-field" requires a style "glyphs" property')),p==="text-font"&&Ha(fe(c))&&Te(c.type)==="identity"&&N.push(new Ut(i,c,'"text-font" does not support identity functions'))),N.concat(Ci({key:t.key,value:c,valueSpec:O,style:a,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:p}))}function $s(t){return Js(t,"paint")}function wa(t){return Js(t,"layout")}function hh(t){var e=[],i=t.value,a=t.key,h=t.style,c=t.styleSpec;i.type||i.ref||e.push(new Ut(a,i,'either "type" or "ref" is required'));var p,m=Te(i.type),b=Te(i.ref);if(i.id)for(var M=Te(i.id),O=0;O<t.arrayIndex;O++){var N=h.layers[O];Te(N.id)===M&&e.push(new Ut(a,i.id,'duplicate layer id "'+i.id+'", previously used at line '+N.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(It){It in i&&e.push(new Ut(a,i[It],'"'+It+'" is prohibited for ref layers'))}),h.layers.forEach(function(It){Te(It.id)===b&&(p=It)}),p?p.ref?e.push(new Ut(a,i.ref,"ref cannot reference another ref layer")):m=Te(p.type):e.push(new Ut(a,i.ref,'ref layer "'+b+'" not found'));else if(m!=="background")if(i.source){var nt=h.sources&&h.sources[i.source],ft=nt&&Te(nt.type);nt?ft==="vector"&&m==="raster"?e.push(new Ut(a,i.source,'layer "'+i.id+'" requires a raster source')):ft==="raster"&&m!=="raster"?e.push(new Ut(a,i.source,'layer "'+i.id+'" requires a vector source')):ft!=="vector"||i["source-layer"]?ft==="raster-dem"&&m!=="hillshade"?e.push(new Ut(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):m!=="line"||!i.paint||!i.paint["line-gradient"]||ft==="geojson"&&nt.lineMetrics||e.push(new Ut(a,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new Ut(a,i,'layer "'+i.id+'" must specify a "source-layer"')):e.push(new Ut(a,i.source,'source "'+i.source+'" not found'))}else e.push(new Ut(a,i,'missing required property "source"'));return e=e.concat(Mn({key:a,value:i,valueSpec:c.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ci({key:a+".type",value:i.type,valueSpec:c.layer.type,style:t.style,styleSpec:t.styleSpec,object:i,objectKey:"type"})},filter:Ks,layout:function(It){return Mn({layer:i,key:It.key,value:It.value,style:It.style,styleSpec:It.styleSpec,objectElementValidators:{"*":function(Ot){return wa(we({layerType:m},Ot))}}})},paint:function(It){return Mn({layer:i,key:It.key,value:It.value,style:It.style,styleSpec:It.styleSpec,objectElementValidators:{"*":function(Ot){return $s(we({layerType:m},Ot))}}})}}}))}function Oo(t){var e=t.value,i=t.key,a=Yi(e);return a!=="string"?[new Ut(i,e,"string expected, "+a+" found")]:[]}var tr={promoteId:function(t){var e=t.key,i=t.value;if(Yi(i)==="string")return Oo({key:e,value:i});var a=[];for(var h in i)a.push.apply(a,Oo({key:e+"."+h,value:i[h]}));return a}};function ts(t){var e=t.value,i=t.key,a=t.styleSpec,h=t.style;if(!e.type)return[new Ut(i,e,'"type" is required')];var c,p=Te(e.type);switch(p){case"vector":case"raster":case"raster-dem":return Mn({key:i,value:e,valueSpec:a["source_"+p.replace("-","_")],style:t.style,styleSpec:a,objectElementValidators:tr});case"geojson":if(c=Mn({key:i,value:e,valueSpec:a.source_geojson,style:h,styleSpec:a,objectElementValidators:tr}),e.cluster)for(var m in e.clusterProperties){var b=e.clusterProperties[m],M=b[0],O=typeof M=="string"?[M,["accumulated"],["get",m]]:M;c.push.apply(c,Do({key:i+"."+m+".map",value:b[1],expressionContext:"cluster-map"})),c.push.apply(c,Do({key:i+"."+m+".reduce",value:O,expressionContext:"cluster-reduce"}))}return c;case"video":return Mn({key:i,value:e,valueSpec:a.source_video,style:h,styleSpec:a});case"image":return Mn({key:i,value:e,valueSpec:a.source_image,style:h,styleSpec:a});case"canvas":return[new Ut(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ba({key:i+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:a})}}function Bo(t){var e=t.value,i=t.styleSpec,a=i.light,h=t.style,c=[],p=Yi(e);if(e===void 0)return c;if(p!=="object")return c.concat([new Ut("light",e,"object expected, "+p+" found")]);for(var m in e){var b=m.match(/^(.*)-transition$/);c=c.concat(b&&a[b[1]]&&a[b[1]].transition?Ci({key:m,value:e[m],valueSpec:i.transition,style:h,styleSpec:i}):a[m]?Ci({key:m,value:e[m],valueSpec:a[m],style:h,styleSpec:i}):[new Ut(m,e[m],'unknown property "'+m+'"')])}return c}var ao={"*":function(){return[]},array:nh,boolean:function(t){var e=t.value,i=t.key,a=Yi(e);return a!=="boolean"?[new Ut(i,e,"boolean expected, "+a+" found")]:[]},number:oh,color:function(t){var e=t.key,i=t.value,a=Yi(i);return a!=="string"?[new Ut(e,i,"color expected, "+a+" found")]:Ti(i)===null?[new Ut(e,i,'color expected, "'+i+'" found')]:[]},constants:oe,enum:ba,filter:Ks,function:ah,layer:hh,object:Mn,source:ts,light:Bo,string:Oo,formatted:function(t){return Oo(t).length===0?[]:Do(t)},resolvedImage:function(t){return Oo(t).length===0?[]:Do(t)}};function Ci(t){var e=t.value,i=t.valueSpec,a=t.styleSpec;return i.expression&&Ha(Te(e))?ah(t):i.expression&&_a(fe(e))?Do(t):i.type&&ao[i.type]?ao[i.type](t):Mn(we({},t,{valueSpec:i.type?a[i.type]:i}))}function Ki(t){var e=t.value,i=t.key,a=Oo(t);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new Ut(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new Ut(i,e,'"glyphs" url must include a "{range}" token'))),a}function fn(t,e){e===void 0&&(e=yt);var i=[];return i=i.concat(Ci({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Ki,"*":function(){return[]}}})),t.constants&&(i=i.concat(oe({key:"constants",value:t.constants,style:t,styleSpec:e}))),Sa(i)}function Sa(t){return[].concat(t).sort(function(e,i){return e.line-i.line})}function ta(t){return function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];return Sa(t.apply(this,e))}}fn.source=ta(ts),fn.light=ta(Bo),fn.layer=ta(hh),fn.filter=ta(Ks),fn.paintProperty=ta($s),fn.layoutProperty=ta(wa);var Ta=fn,ac=Ta.light,sc=Ta.paintProperty,ka=Ta.layoutProperty;function Ca(t,e){var i=!1;if(e&&e.length)for(var a=0,h=e;a<h.length;a+=1)t.fire(new Yt(new Error(h[a].message))),i=!0;return i}var Gn=xr;function xr(t,e,i){var a=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var h=new Int32Array(this.arrayBuffer);t=h[0],this.d=(e=h[1])+2*(i=h[2]);for(var c=0;c<this.d*this.d;c++){var p=h[3+c],m=h[3+c+1];a.push(p===m?null:h.subarray(p,m))}var b=h[3+a.length+1];this.keys=h.subarray(h[3+a.length],b),this.bboxes=h.subarray(b),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var M=0;M<this.d*this.d;M++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var O=i/e*t;this.min=-O,this.max=t+O}xr.prototype.insert=function(t,e,i,a,h){this._forEachCell(e,i,a,h,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(h)},xr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},xr.prototype._insertCell=function(t,e,i,a,h,c){this.cells[h].push(c)},xr.prototype.query=function(t,e,i,a,h){var c=this.min,p=this.max;if(t<=c&&e<=c&&p<=i&&p<=a&&!h)return Array.prototype.slice.call(this.keys);var m=[];return this._forEachCell(t,e,i,a,this._queryCell,m,{},h),m},xr.prototype._queryCell=function(t,e,i,a,h,c,p,m){var b=this.cells[h];if(b!==null)for(var M=this.keys,O=this.bboxes,N=0;N<b.length;N++){var nt=b[N];if(p[nt]===void 0){var ft=4*nt;(m?m(O[ft+0],O[ft+1],O[ft+2],O[ft+3]):t<=O[ft+2]&&e<=O[ft+3]&&i>=O[ft+0]&&a>=O[ft+1])?(p[nt]=!0,c.push(M[nt])):p[nt]=!1}}},xr.prototype._forEachCell=function(t,e,i,a,h,c,p,m){for(var b=this._convertToCellCoord(t),M=this._convertToCellCoord(e),O=this._convertToCellCoord(i),N=this._convertToCellCoord(a),nt=b;nt<=O;nt++)for(var ft=M;ft<=N;ft++){var It=this.d*ft+nt;if((!m||m(this._convertFromCellCoord(nt),this._convertFromCellCoord(ft),this._convertFromCellCoord(nt+1),this._convertFromCellCoord(ft+1)))&&h.call(this,t,e,i,a,It,c,p,m))return}},xr.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},xr.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},xr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,i=0,a=0;a<this.cells.length;a++)i+=this.cells[a].length;var h=new Int32Array(e+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var c=e,p=0;p<t.length;p++){var m=t[p];h[3+p]=c,h.set(m,c),c+=m.length}return h[3+t.length]=c,h.set(this.keys,c),h[3+t.length+1]=c+=this.keys.length,h.set(this.bboxes,c),c+=this.bboxes.length,h.buffer};var Aa=ut.ImageData,ch=ut.ImageBitmap,vr={};function Ve(t,e,i){i===void 0&&(i={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),vr[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}for(var an in Ve("Object",Object),Gn.serialize=function(t,e){var i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}},Gn.deserialize=function(t){return new Gn(t.buffer)},Ve("Grid",Gn),Ve("Color",Bi),Ve("Error",Error),Ve("ResolvedImage",Qr),Ve("StylePropertyFunction",Qo),Ve("StyleExpression",Jo,{omit:["_evaluator"]}),Ve("ZoomDependentExpression",$o),Ve("ZoomConstantExpression",xa),Ve("CompoundExpression",Or,{omit:["_evaluate"]}),Po)Po[an]._classRegistryKey||Ve("Expression_"+an,Po[an]);function es(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function ea(t){return ch&&t instanceof ch}function Pn(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(es(t)||ea(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var i=t;return e&&e.push(i.buffer),i}if(t instanceof Aa)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var a=[],h=0,c=t;h<c.length;h+=1)a.push(Pn(c[h],e));return a}if(typeof t=="object"){var p=t.constructor,m=p._classRegistryKey;if(!m)throw new Error("can't serialize object of unregistered class");var b=p.serialize?p.serialize(t,e):{};if(!p.serialize){for(var M in t)if(t.hasOwnProperty(M)&&!(vr[m].omit.indexOf(M)>=0)){var O=t[M];b[M]=vr[m].shallow.indexOf(M)>=0?O:Pn(O,e)}t instanceof Error&&(b.message=t.message)}if(b.$name)throw new Error("$name property is reserved for worker serialization logic.");return m!=="Object"&&(b.$name=m),b}throw new Error("can't serialize object of type "+typeof t)}function sn(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||es(t)||ea(t)||ArrayBuffer.isView(t)||t instanceof Aa)return t;if(Array.isArray(t))return t.map(sn);if(typeof t=="object"){var e=t.$name||"Object",i=vr[e].klass;if(!i)throw new Error("can't deserialize unregistered class "+e);if(i.deserialize)return i.deserialize(t);for(var a=Object.create(i.prototype),h=0,c=Object.keys(t);h<c.length;h+=1){var p=c[h];if(p!=="$name"){var m=t[p];a[p]=vr[e].shallow.indexOf(p)>=0?m:sn(m)}}return a}throw new Error("can't deserialize object of type "+typeof t)}var Qs=function(){this.first=!0};Qs.prototype.update=function(t,e){var i=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=i,!0))};var Ie={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function tl(t){for(var e=0,i=t;e<i.length;e+=1)if(is(i[e].charCodeAt(0)))return!0;return!1}function is(t){return!(t!==746&&t!==747&&(t<4352||!(Ie["Bopomofo Extended"](t)||Ie.Bopomofo(t)||Ie["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Ie["CJK Compatibility Ideographs"](t)||Ie["CJK Compatibility"](t)||Ie["CJK Radicals Supplement"](t)||Ie["CJK Strokes"](t)||!(!Ie["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||Ie["CJK Unified Ideographs Extension A"](t)||Ie["CJK Unified Ideographs"](t)||Ie["Enclosed CJK Letters and Months"](t)||Ie["Hangul Compatibility Jamo"](t)||Ie["Hangul Jamo Extended-A"](t)||Ie["Hangul Jamo Extended-B"](t)||Ie["Hangul Jamo"](t)||Ie["Hangul Syllables"](t)||Ie.Hiragana(t)||Ie["Ideographic Description Characters"](t)||Ie.Kanbun(t)||Ie["Kangxi Radicals"](t)||Ie["Katakana Phonetic Extensions"](t)||Ie.Katakana(t)&&t!==12540||!(!Ie["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!Ie["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Ie["Unified Canadian Aboriginal Syllabics"](t)||Ie["Unified Canadian Aboriginal Syllabics Extended"](t)||Ie["Vertical Forms"](t)||Ie["Yijing Hexagram Symbols"](t)||Ie["Yi Syllables"](t)||Ie["Yi Radicals"](t))))}function el(t){return!(is(t)||function(e){return!!(Ie["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Ie["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Ie["Letterlike Symbols"](e)||Ie["Number Forms"](e)||Ie["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ie["Control Pictures"](e)&&e!==9251||Ie["Optical Character Recognition"](e)||Ie["Enclosed Alphanumerics"](e)||Ie["Geometric Shapes"](e)||Ie["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ie["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ie["CJK Symbols and Punctuation"](e)||Ie.Katakana(e)||Ie["Private Use Area"](e)||Ie["CJK Compatibility Forms"](e)||Ie["Small Form Variants"](e)||Ie["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function bn(t){return t>=1424&&t<=2303||Ie["Arabic Presentation Forms-A"](t)||Ie["Arabic Presentation Forms-B"](t)}function ln(t,e){return!(!e&&bn(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Ie.Khmer(t))}function rs(t){for(var e=0,i=t;e<i.length;e+=1)if(bn(i[e].charCodeAt(0)))return!0;return!1}var ns=null,hn="unavailable",qn=null,uh=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(hn="error"),ns&&ns(t)};function Ea(){il.fire(new zt("pluginStateChange",{pluginStatus:hn,pluginURL:qn}))}var il=new $t,rl=function(){return hn},In=function(){if(hn!=="deferred"||!qn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");hn="loading",Ea(),qn&&cr({url:qn},function(t){t?uh(t):(hn="loaded",Ea())})},mn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return hn==="loaded"||mn.applyArabicShaping!=null},isLoading:function(){return hn==="loading"},setState:function(t){hn=t.pluginStatus,qn=t.pluginURL},isParsed:function(){return mn.applyArabicShaping!=null&&mn.processBidirectionalText!=null&&mn.processStyledBidirectionalText!=null},getPluginURL:function(){return qn}},wi=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Qs,this.transition={})};wi.prototype.isSupportedScript=function(t){return function(e,i){for(var a=0,h=e;a<h.length;a+=1)if(!ln(h[a].charCodeAt(0),i))return!1;return!0}(t,mn.isLoaded())},wi.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},wi.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*e}};var Bn=function(t,e){this.property=t,this.value=e,this.expression=function(i,a){if(Ha(i))return new Qo(i,a);if(_a(i)){var h=rh(i,a);if(h.result==="error")throw new Error(h.value.map(function(p){return p.key+": "+p.message}).join(", "));return h.value}var c=i;return typeof i=="string"&&a.type==="color"&&(c=Bi.parse(i)),{kind:"constant",evaluate:function(){return c}}}(e===void 0?t.specification.default:e,t.specification)};Bn.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Bn.prototype.possiblyEvaluate=function(t,e,i){return this.property.possiblyEvaluate(this,t,e,i)};var wn=function(t){this.property=t,this.value=new Bn(t,void 0)};wn.prototype.transitioned=function(t,e){return new Ro(this.property,this.value,e,q({},t.transition,this.transition),t.now)},wn.prototype.untransitioned=function(){return new Ro(this.property,this.value,null,{},0)};var Rr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Rr.prototype.getValue=function(t){return I(this._values[t].value.value)},Rr.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new wn(this._values[t].property)),this._values[t].value=new Bn(this._values[t].property,e===null?void 0:I(e))},Rr.prototype.getTransition=function(t){return I(this._values[t].transition)},Rr.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new wn(this._values[t].property)),this._values[t].transition=I(e)||void 0},Rr.prototype.serialize=function(){for(var t={},e=0,i=Object.keys(this._values);e<i.length;e+=1){var a=i[e],h=this.getValue(a);h!==void 0&&(t[a]=h);var c=this.getTransition(a);c!==void 0&&(t[a+"-transition"]=c)}return t},Rr.prototype.transitioned=function(t,e){for(var i=new so(this._properties),a=0,h=Object.keys(this._values);a<h.length;a+=1){var c=h[a];i._values[c]=this._values[c].transitioned(t,e._values[c])}return i},Rr.prototype.untransitioned=function(){for(var t=new so(this._properties),e=0,i=Object.keys(this._values);e<i.length;e+=1){var a=i[e];t._values[a]=this._values[a].untransitioned()}return t};var Ro=function(t,e,i,a,h){this.property=t,this.value=e,this.begin=h+a.delay||0,this.end=this.begin+a.duration||0,t.specification.transition&&(a.delay||a.duration)&&(this.prior=i)};Ro.prototype.possiblyEvaluate=function(t,e,i){var a=t.now||0,h=this.value.possiblyEvaluate(t,e,i),c=this.prior;if(c){if(a>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(a<this.begin)return c.possiblyEvaluate(t,e,i);var p=(a-this.begin)/(this.end-this.begin);return this.property.interpolate(c.possiblyEvaluate(t,e,i),h,function(m){if(m<=0)return 0;if(m>=1)return 1;var b=m*m,M=b*m;return 4*(m<.5?M:3*(m-b)+M-.75)}(p))}return h};var so=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};so.prototype.possiblyEvaluate=function(t,e,i){for(var a=new Ma(this._properties),h=0,c=Object.keys(this._values);h<c.length;h+=1){var p=c[h];a._values[p]=this._values[p].possiblyEvaluate(t,e,i)}return a},so.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var Ln=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Ln.prototype.getValue=function(t){return I(this._values[t].value)},Ln.prototype.setValue=function(t,e){this._values[t]=new Bn(this._values[t].property,e===null?void 0:I(e))},Ln.prototype.serialize=function(){for(var t={},e=0,i=Object.keys(this._values);e<i.length;e+=1){var a=i[e],h=this.getValue(a);h!==void 0&&(t[a]=h)}return t},Ln.prototype.possiblyEvaluate=function(t,e,i){for(var a=new Ma(this._properties),h=0,c=Object.keys(this._values);h<c.length;h+=1){var p=c[h];a._values[p]=this._values[p].possiblyEvaluate(t,e,i)}return a};var Xr=function(t,e,i){this.property=t,this.value=e,this.parameters=i};Xr.prototype.isConstant=function(){return this.value.kind==="constant"},Xr.prototype.constantOr=function(t){return this.value.kind==="constant"?this.value.value:t},Xr.prototype.evaluate=function(t,e,i,a){return this.property.evaluate(this.value,this.parameters,t,e,i,a)};var Ma=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Ma.prototype.get=function(t){return this._values[t]};var Ye=function(t){this.specification=t};Ye.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Ye.prototype.interpolate=function(t,e,i){var a=Yo[this.specification.type];return a?a(t,e,i):t};var Xe=function(t,e){this.specification=t,this.overrides=e};Xe.prototype.possiblyEvaluate=function(t,e,i,a){return new Xr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(e,null,{},i,a)}:t.expression,e)},Xe.prototype.interpolate=function(t,e,i){if(t.value.kind!=="constant"||e.value.kind!=="constant")return t;if(t.value.value===void 0||e.value.value===void 0)return new Xr(this,{kind:"constant",value:void 0},t.parameters);var a=Yo[this.specification.type];return a?new Xr(this,{kind:"constant",value:a(t.value.value,e.value.value,i)},t.parameters):t},Xe.prototype.evaluate=function(t,e,i,a,h,c){return t.kind==="constant"?t.value:t.evaluate(e,i,a,h,c)};var os=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(i,a,h,c){if(i.value===void 0)return new Xr(this,{kind:"constant",value:void 0},a);if(i.expression.kind==="constant"){var p=i.expression.evaluate(a,null,{},h,c),m=i.property.specification.type==="resolvedImage"&&typeof p!="string"?p.name:p,b=this._calculate(m,m,m,a);return new Xr(this,{kind:"constant",value:b},a)}if(i.expression.kind==="camera"){var M=this._calculate(i.expression.evaluate({zoom:a.zoom-1}),i.expression.evaluate({zoom:a.zoom}),i.expression.evaluate({zoom:a.zoom+1}),a);return new Xr(this,{kind:"constant",value:M},a)}return new Xr(this,i.expression,a)},e.prototype.evaluate=function(i,a,h,c,p,m){if(i.kind==="source"){var b=i.evaluate(a,h,c,p,m);return this._calculate(b,b,b,a)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(a.zoom)-1},h,c),i.evaluate({zoom:Math.floor(a.zoom)},h,c),i.evaluate({zoom:Math.floor(a.zoom)+1},h,c),a):i.value},e.prototype._calculate=function(i,a,h,c){return c.zoom>c.zoomHistory.lastIntegerZoom?{from:i,to:a}:{from:h,to:a}},e.prototype.interpolate=function(i){return i},e}(Xe),Wr=function(t){this.specification=t};Wr.prototype.possiblyEvaluate=function(t,e,i,a){if(t.value!==void 0){if(t.expression.kind==="constant"){var h=t.expression.evaluate(e,null,{},i,a);return this._calculate(h,h,h,e)}return this._calculate(t.expression.evaluate(new wi(Math.floor(e.zoom-1),e)),t.expression.evaluate(new wi(Math.floor(e.zoom),e)),t.expression.evaluate(new wi(Math.floor(e.zoom+1),e)),e)}},Wr.prototype._calculate=function(t,e,i,a){return a.zoom>a.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}},Wr.prototype.interpolate=function(t){return t};var zn=function(t){this.specification=t};zn.prototype.possiblyEvaluate=function(t,e,i,a){return!!t.expression.evaluate(e,null,{},i,a)},zn.prototype.interpolate=function(){return!1};var Fr=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var i=t[e];i.specification.overridable&&this.overridableProperties.push(e);var a=this.defaultPropertyValues[e]=new Bn(i,void 0),h=this.defaultTransitionablePropertyValues[e]=new wn(i);this.defaultTransitioningPropertyValues[e]=h.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=a.possiblyEvaluate({})}};Ve("DataDrivenProperty",Xe),Ve("DataConstantProperty",Ye),Ve("CrossFadedDataDrivenProperty",os),Ve("CrossFadedProperty",Wr),Ve("ColorRampProperty",zn);var Rn=function(t){function e(i,a){if(t.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),a.layout&&(this._unevaluatedLayout=new Ln(a.layout)),a.paint)){for(var h in this._transitionablePaint=new Rr(a.paint),i.paint)this.setPaintProperty(h,i.paint[h],{validate:!1});for(var c in i.layout)this.setLayoutProperty(c,i.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ma(a.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},e.prototype.setLayoutProperty=function(i,a,h){h===void 0&&(h={}),a!=null&&this._validate(ka,"layers."+this.id+".layout."+i,i,a,h)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,a):this.visibility=a)},e.prototype.getPaintProperty=function(i){return mt(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},e.prototype.setPaintProperty=function(i,a,h){if(h===void 0&&(h={}),a!=null&&this._validate(sc,"layers."+this.id+".paint."+i,i,a,h))return!1;if(mt(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),a||void 0),!1;var c=this._transitionablePaint._values[i],p=c.property.specification["property-type"]==="cross-faded-data-driven",m=c.value.isDataDriven(),b=c.value;this._transitionablePaint.setValue(i,a),this._handleSpecialPaintPropertyUpdate(i);var M=this._transitionablePaint._values[i].value;return M.isDataDriven()||m||p||this._handleOverridablePaintPropertyUpdate(i,b,M)},e.prototype._handleSpecialPaintPropertyUpdate=function(i){},e.prototype._handleOverridablePaintPropertyUpdate=function(i,a,h){return!1},e.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},e.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(i,a){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,a)},e.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),rt(i,function(a,h){return!(a===void 0||h==="layout"&&!Object.keys(a).length||h==="paint"&&!Object.keys(a).length)})},e.prototype._validate=function(i,a,h,c,p){return p===void 0&&(p={}),(!p||p.validate!==!1)&&Ca(this,i.call(Ta,{key:a,layerType:this.type,objectKey:h,value:c,styleSpec:yt,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var i in this.paint._values){var a=this.paint.get(i);if(a instanceof Xr&&zo(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1},e}($t),nl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},as=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},ji=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Pr(t,e){e===void 0&&(e=1);var i=0,a=0;return{members:t.map(function(h){var c=nl[h.type].BYTES_PER_ELEMENT,p=i=ph(i,Math.max(e,c)),m=h.components||1;return a=Math.max(a,c),i+=c*m,{name:h.name,type:h.type,components:m,offset:p}}),size:ph(i,Math.max(a,e)),alignment:e}}function ph(t,e){return Math.ceil(t/e)*e}ji.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},ji.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},ji.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},ji.prototype.clear=function(){this.length=0},ji.prototype.resize=function(t){this.reserve(t),this.length=t},ji.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},ji.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Fo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a){var h=this.length;return this.resize(h+1),this.emplace(h,i,a)},e.prototype.emplace=function(i,a,h){var c=2*i;return this.int16[c+0]=a,this.int16[c+1]=h,i},e}(ji);Fo.prototype.bytesPerElement=4,Ve("StructArrayLayout2i4",Fo);var ol=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c){var p=this.length;return this.resize(p+1),this.emplace(p,i,a,h,c)},e.prototype.emplace=function(i,a,h,c,p){var m=4*i;return this.int16[m+0]=a,this.int16[m+1]=h,this.int16[m+2]=c,this.int16[m+3]=p,i},e}(ji);ol.prototype.bytesPerElement=8,Ve("StructArrayLayout4i8",ol);var Xn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c,p,m){var b=this.length;return this.resize(b+1),this.emplace(b,i,a,h,c,p,m)},e.prototype.emplace=function(i,a,h,c,p,m,b){var M=6*i;return this.int16[M+0]=a,this.int16[M+1]=h,this.int16[M+2]=c,this.int16[M+3]=p,this.int16[M+4]=m,this.int16[M+5]=b,i},e}(ji);Xn.prototype.bytesPerElement=12,Ve("StructArrayLayout2i4i12",Xn);var cn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c,p,m){var b=this.length;return this.resize(b+1),this.emplace(b,i,a,h,c,p,m)},e.prototype.emplace=function(i,a,h,c,p,m,b){var M=4*i,O=8*i;return this.int16[M+0]=a,this.int16[M+1]=h,this.uint8[O+4]=c,this.uint8[O+5]=p,this.uint8[O+6]=m,this.uint8[O+7]=b,i},e}(ji);cn.prototype.bytesPerElement=8,Ve("StructArrayLayout2i4ub8",cn);var ia=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a){var h=this.length;return this.resize(h+1),this.emplace(h,i,a)},e.prototype.emplace=function(i,a,h){var c=2*i;return this.float32[c+0]=a,this.float32[c+1]=h,i},e}(ji);ia.prototype.bytesPerElement=8,Ve("StructArrayLayout2f8",ia);var Fn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c,p,m,b,M,O,N){var nt=this.length;return this.resize(nt+1),this.emplace(nt,i,a,h,c,p,m,b,M,O,N)},e.prototype.emplace=function(i,a,h,c,p,m,b,M,O,N,nt){var ft=10*i;return this.uint16[ft+0]=a,this.uint16[ft+1]=h,this.uint16[ft+2]=c,this.uint16[ft+3]=p,this.uint16[ft+4]=m,this.uint16[ft+5]=b,this.uint16[ft+6]=M,this.uint16[ft+7]=O,this.uint16[ft+8]=N,this.uint16[ft+9]=nt,i},e}(ji);Fn.prototype.bytesPerElement=20,Ve("StructArrayLayout10ui20",Fn);var ss=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c,p,m,b,M,O,N,nt,ft){var It=this.length;return this.resize(It+1),this.emplace(It,i,a,h,c,p,m,b,M,O,N,nt,ft)},e.prototype.emplace=function(i,a,h,c,p,m,b,M,O,N,nt,ft,It){var Ot=12*i;return this.int16[Ot+0]=a,this.int16[Ot+1]=h,this.int16[Ot+2]=c,this.int16[Ot+3]=p,this.uint16[Ot+4]=m,this.uint16[Ot+5]=b,this.uint16[Ot+6]=M,this.uint16[Ot+7]=O,this.int16[Ot+8]=N,this.int16[Ot+9]=nt,this.int16[Ot+10]=ft,this.int16[Ot+11]=It,i},e}(ji);ss.prototype.bytesPerElement=24,Ve("StructArrayLayout4i4ui4i24",ss);var ra=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h){var c=this.length;return this.resize(c+1),this.emplace(c,i,a,h)},e.prototype.emplace=function(i,a,h,c){var p=3*i;return this.float32[p+0]=a,this.float32[p+1]=h,this.float32[p+2]=c,i},e}(ji);ra.prototype.bytesPerElement=12,Ve("StructArrayLayout3f12",ra);var Pa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var a=this.length;return this.resize(a+1),this.emplace(a,i)},e.prototype.emplace=function(i,a){return this.uint32[1*i+0]=a,i},e}(ji);Pa.prototype.bytesPerElement=4,Ve("StructArrayLayout1ul4",Pa);var al=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c,p,m,b,M,O){var N=this.length;return this.resize(N+1),this.emplace(N,i,a,h,c,p,m,b,M,O)},e.prototype.emplace=function(i,a,h,c,p,m,b,M,O,N){var nt=10*i,ft=5*i;return this.int16[nt+0]=a,this.int16[nt+1]=h,this.int16[nt+2]=c,this.int16[nt+3]=p,this.int16[nt+4]=m,this.int16[nt+5]=b,this.uint32[ft+3]=M,this.uint16[nt+8]=O,this.uint16[nt+9]=N,i},e}(ji);al.prototype.bytesPerElement=20,Ve("StructArrayLayout6i1ul2ui20",al);var na=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c,p,m){var b=this.length;return this.resize(b+1),this.emplace(b,i,a,h,c,p,m)},e.prototype.emplace=function(i,a,h,c,p,m,b){var M=6*i;return this.int16[M+0]=a,this.int16[M+1]=h,this.int16[M+2]=c,this.int16[M+3]=p,this.int16[M+4]=m,this.int16[M+5]=b,i},e}(ji);na.prototype.bytesPerElement=12,Ve("StructArrayLayout2i2i2i12",na);var jo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c,p){var m=this.length;return this.resize(m+1),this.emplace(m,i,a,h,c,p)},e.prototype.emplace=function(i,a,h,c,p,m){var b=4*i,M=8*i;return this.float32[b+0]=a,this.float32[b+1]=h,this.float32[b+2]=c,this.int16[M+6]=p,this.int16[M+7]=m,i},e}(ji);jo.prototype.bytesPerElement=16,Ve("StructArrayLayout2f1f2i16",jo);var sl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c){var p=this.length;return this.resize(p+1),this.emplace(p,i,a,h,c)},e.prototype.emplace=function(i,a,h,c,p){var m=12*i,b=3*i;return this.uint8[m+0]=a,this.uint8[m+1]=h,this.float32[b+1]=c,this.float32[b+2]=p,i},e}(ji);sl.prototype.bytesPerElement=12,Ve("StructArrayLayout2ub2f12",sl);var lo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h){var c=this.length;return this.resize(c+1),this.emplace(c,i,a,h)},e.prototype.emplace=function(i,a,h,c){var p=3*i;return this.uint16[p+0]=a,this.uint16[p+1]=h,this.uint16[p+2]=c,i},e}(ji);lo.prototype.bytesPerElement=6,Ve("StructArrayLayout3ui6",lo);var ho=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c,p,m,b,M,O,N,nt,ft,It,Ot,Wt,Gt,ie){var ae=this.length;return this.resize(ae+1),this.emplace(ae,i,a,h,c,p,m,b,M,O,N,nt,ft,It,Ot,Wt,Gt,ie)},e.prototype.emplace=function(i,a,h,c,p,m,b,M,O,N,nt,ft,It,Ot,Wt,Gt,ie,ae){var he=24*i,ue=12*i,_e=48*i;return this.int16[he+0]=a,this.int16[he+1]=h,this.uint16[he+2]=c,this.uint16[he+3]=p,this.uint32[ue+2]=m,this.uint32[ue+3]=b,this.uint32[ue+4]=M,this.uint16[he+10]=O,this.uint16[he+11]=N,this.uint16[he+12]=nt,this.float32[ue+7]=ft,this.float32[ue+8]=It,this.uint8[_e+36]=Ot,this.uint8[_e+37]=Wt,this.uint8[_e+38]=Gt,this.uint32[ue+10]=ie,this.int16[he+22]=ae,i},e}(ji);ho.prototype.bytesPerElement=48,Ve("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ho);var ls=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c,p,m,b,M,O,N,nt,ft,It,Ot,Wt,Gt,ie,ae,he,ue,_e,ke,Me,He,De,Je,Re,yi){var ni=this.length;return this.resize(ni+1),this.emplace(ni,i,a,h,c,p,m,b,M,O,N,nt,ft,It,Ot,Wt,Gt,ie,ae,he,ue,_e,ke,Me,He,De,Je,Re,yi)},e.prototype.emplace=function(i,a,h,c,p,m,b,M,O,N,nt,ft,It,Ot,Wt,Gt,ie,ae,he,ue,_e,ke,Me,He,De,Je,Re,yi,ni){var We=34*i,_i=17*i;return this.int16[We+0]=a,this.int16[We+1]=h,this.int16[We+2]=c,this.int16[We+3]=p,this.int16[We+4]=m,this.int16[We+5]=b,this.int16[We+6]=M,this.int16[We+7]=O,this.uint16[We+8]=N,this.uint16[We+9]=nt,this.uint16[We+10]=ft,this.uint16[We+11]=It,this.uint16[We+12]=Ot,this.uint16[We+13]=Wt,this.uint16[We+14]=Gt,this.uint16[We+15]=ie,this.uint16[We+16]=ae,this.uint16[We+17]=he,this.uint16[We+18]=ue,this.uint16[We+19]=_e,this.uint16[We+20]=ke,this.uint16[We+21]=Me,this.uint16[We+22]=He,this.uint32[_i+12]=De,this.float32[_i+13]=Je,this.float32[_i+14]=Re,this.float32[_i+15]=yi,this.float32[_i+16]=ni,i},e}(ji);ls.prototype.bytesPerElement=68,Ve("StructArrayLayout8i15ui1ul4f68",ls);var co=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var a=this.length;return this.resize(a+1),this.emplace(a,i)},e.prototype.emplace=function(i,a){return this.float32[1*i+0]=a,i},e}(ji);co.prototype.bytesPerElement=4,Ve("StructArrayLayout1f4",co);var Sn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h){var c=this.length;return this.resize(c+1),this.emplace(c,i,a,h)},e.prototype.emplace=function(i,a,h,c){var p=3*i;return this.int16[p+0]=a,this.int16[p+1]=h,this.int16[p+2]=c,i},e}(ji);Sn.prototype.bytesPerElement=6,Ve("StructArrayLayout3i6",Sn);var ll=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h){var c=this.length;return this.resize(c+1),this.emplace(c,i,a,h)},e.prototype.emplace=function(i,a,h,c){var p=4*i;return this.uint32[2*i+0]=a,this.uint16[p+2]=h,this.uint16[p+3]=c,i},e}(ji);ll.prototype.bytesPerElement=8,Ve("StructArrayLayout1ul2ui8",ll);var Ia=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a){var h=this.length;return this.resize(h+1),this.emplace(h,i,a)},e.prototype.emplace=function(i,a,h){var c=2*i;return this.uint16[c+0]=a,this.uint16[c+1]=h,i},e}(ji);Ia.prototype.bytesPerElement=4,Ve("StructArrayLayout2ui4",Ia);var hl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var a=this.length;return this.resize(a+1),this.emplace(a,i)},e.prototype.emplace=function(i,a){return this.uint16[1*i+0]=a,i},e}(ji);hl.prototype.bytesPerElement=2,Ve("StructArrayLayout1ui2",hl);var hs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,a,h,c){var p=this.length;return this.resize(p+1),this.emplace(p,i,a,h,c)},e.prototype.emplace=function(i,a,h,c,p){var m=4*i;return this.float32[m+0]=a,this.float32[m+1]=h,this.float32[m+2]=c,this.float32[m+3]=p,i},e}(ji);hs.prototype.bytesPerElement=16,Ve("StructArrayLayout4f16",hs);var r=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new Lt(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,i),e}(as);r.prototype.size=20;var o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new r(this,i)},e}(al);Ve("CollisionBoxArray",o);var n=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(a){this._structArray.uint8[this._pos1+37]=a},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(a){this._structArray.uint8[this._pos1+38]=a},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(a){this._structArray.uint32[this._pos4+10]=a},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,i),e}(as);n.prototype.size=48;var s=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new n(this,i)},e}(ho);Ve("PlacedSymbolArray",s);var u=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(a){this._structArray.uint32[this._pos4+12]=a},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,i),e}(as);u.prototype.size=68;var d=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new u(this,i)},e}(ls);Ve("SymbolInstanceArray",d);var f=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(i){return this.float32[1*i+0]},e}(co);Ve("GlyphOffsetArray",f);var x=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(i){return this.int16[3*i+0]},e.prototype.gety=function(i){return this.int16[3*i+1]},e.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},e}(Sn);Ve("SymbolLineVertexArray",x);var L=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,i),e}(as);L.prototype.size=8;var H=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new L(this,i)},e}(ll);Ve("FeatureIndexArray",H);var gt=Pr([{name:"a_pos",components:2,type:"Int16"}],4).members,vt=function(t){t===void 0&&(t=[]),this.segments=t};function bt(t,e){return 256*(t=at(Math.floor(t),0,255))+at(Math.floor(e),0,255)}vt.prototype.prepareSegment=function(t,e,i,a){var h=this.segments[this.segments.length-1];return t>vt.MAX_VERTEX_ARRAY_LENGTH&&z("Max vertices per segment is "+vt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!h||h.vertexLength+t>vt.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==a)&&(h={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},a!==void 0&&(h.sortKey=a),this.segments.push(h)),h},vt.prototype.get=function(){return this.segments},vt.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var i=e[t];for(var a in i.vaos)i.vaos[a].destroy()}},vt.simpleSegment=function(t,e,i,a){return new vt([{vertexOffset:t,primitiveOffset:e,vertexLength:i,primitiveLength:a,vaos:{},sortKey:0}])},vt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ve("SegmentVector",vt);var Ft=Pr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Bt=Zt(function(t){t.exports=function(e,i){var a,h,c,p,m,b,M,O;for(h=e.length-(a=3&e.length),c=i,m=3432918353,b=461845907,O=0;O<h;)M=255&e.charCodeAt(O)|(255&e.charCodeAt(++O))<<8|(255&e.charCodeAt(++O))<<16|(255&e.charCodeAt(++O))<<24,++O,c=27492+(65535&(p=5*(65535&(c=(c^=M=(65535&(M=(M=(65535&M)*m+(((M>>>16)*m&65535)<<16)&4294967295)<<15|M>>>17))*b+(((M>>>16)*b&65535)<<16)&4294967295)<<13|c>>>19))+((5*(c>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(M=0,a){case 3:M^=(255&e.charCodeAt(O+2))<<16;case 2:M^=(255&e.charCodeAt(O+1))<<8;case 1:c^=M=(65535&(M=(M=(65535&(M^=255&e.charCodeAt(O)))*m+(((M>>>16)*m&65535)<<16)&4294967295)<<15|M>>>17))*b+(((M>>>16)*b&65535)<<16)&4294967295}return c^=e.length,c=2246822507*(65535&(c^=c>>>16))+((2246822507*(c>>>16)&65535)<<16)&4294967295,c=3266489909*(65535&(c^=c>>>13))+((3266489909*(c>>>16)&65535)<<16)&4294967295,(c^=c>>>16)>>>0}}),Xt=Zt(function(t){t.exports=function(e,i){for(var a,h=e.length,c=i^h,p=0;h>=4;)a=1540483477*(65535&(a=255&e.charCodeAt(p)|(255&e.charCodeAt(++p))<<8|(255&e.charCodeAt(++p))<<16|(255&e.charCodeAt(++p))<<24))+((1540483477*(a>>>16)&65535)<<16),c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),h-=4,++p;switch(h){case 3:c^=(255&e.charCodeAt(p+2))<<16;case 2:c^=(255&e.charCodeAt(p+1))<<8;case 1:c=1540483477*(65535&(c^=255&e.charCodeAt(p)))+((1540483477*(c>>>16)&65535)<<16)}return c=1540483477*(65535&(c^=c>>>13))+((1540483477*(c>>>16)&65535)<<16),(c^=c>>>15)>>>0}}),Pt=Bt,qt=Xt;Pt.murmur3=Bt,Pt.murmur2=qt;var Qt=function(){this.ids=[],this.positions=[],this.indexed=!1};Qt.prototype.add=function(t,e,i,a){this.ids.push(pe(t)),this.positions.push(e,i,a)},Qt.prototype.getPositions=function(t){for(var e=pe(t),i=0,a=this.ids.length-1;i<a;){var h=i+a>>1;this.ids[h]>=e?a=h:i=h+1}for(var c=[];this.ids[i]===e;)c.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return c},Qt.serialize=function(t,e){var i=new Float64Array(t.ids),a=new Uint32Array(t.positions);return function h(c,p,m,b){for(;m<b;){for(var M=c[m+b>>1],O=m-1,N=b+1;;){do O++;while(c[O]<M);do N--;while(c[N]>M);if(O>=N)break;ce(c,O,N),ce(p,3*O,3*N),ce(p,3*O+1,3*N+1),ce(p,3*O+2,3*N+2)}N-m<b-N?(h(c,p,m,N),m=N+1):(h(c,p,N+1,b),b=N)}}(i,a,0,i.length-1),e&&e.push(i.buffer,a.buffer),{ids:i,positions:a}},Qt.deserialize=function(t){var e=new Qt;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var ne=Math.pow(2,53)-1;function pe(t){var e=+t;return!isNaN(e)&&e<=ne?e:Pt(String(t))}function ce(t,e,i){var a=t[e];t[e]=t[i],t[i]=a}Ve("FeaturePositionMap",Qt);var de=function(t,e){this.gl=t.gl,this.location=e},xe=function(t){function e(i,a){t.call(this,i,a),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},e}(de),Ae=function(t){function e(i,a){t.call(this,i,a),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},e}(de),Ce=function(t){function e(i,a){t.call(this,i,a),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},e}(de),je=function(t){function e(i,a){t.call(this,i,a),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},e}(de),Ke=function(t){function e(i,a){t.call(this,i,a),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},e}(de),ei=function(t){function e(i,a){t.call(this,i,a),this.current=Bi.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},e}(de),ti=new Float32Array(16),Mi=function(t){function e(i,a){t.call(this,i,a),this.current=ti}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var a=1;a<16;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},e}(de);function Ue(t){return[bt(255*t.r,255*t.g),bt(255*t.b,255*t.a)]}var hi=function(t,e,i){this.value=t,this.uniformNames=e.map(function(a){return"u_"+a}),this.type=i};hi.prototype.setUniform=function(t,e,i){t.set(i.constantOr(this.value))},hi.prototype.getBinding=function(t,e,i){return this.type==="color"?new ei(t,e):new Ae(t,e)};var gi=function(t,e){this.uniformNames=e.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};gi.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},gi.prototype.setUniform=function(t,e,i,a){var h=a==="u_pattern_to"?this.patternTo:a==="u_pattern_from"?this.patternFrom:a==="u_pixel_ratio_to"?this.pixelRatioTo:a==="u_pixel_ratio_from"?this.pixelRatioFrom:null;h&&t.set(h)},gi.prototype.getBinding=function(t,e,i){return i.substr(0,9)==="u_pattern"?new Ke(t,e):new Ae(t,e)};var si=function(t,e,i,a){this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=e.map(function(h){return{name:"a_"+h,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new a};si.prototype.populatePaintArray=function(t,e,i,a,h){var c=this.paintVertexArray.length,p=this.expression.evaluate(new wi(0),e,{},a,[],h);this.paintVertexArray.resize(t),this._setPaintValue(c,t,p)},si.prototype.updatePaintArray=function(t,e,i,a){var h=this.expression.evaluate({zoom:0},i,a);this._setPaintValue(t,e,h)},si.prototype._setPaintValue=function(t,e,i){if(this.type==="color")for(var a=Ue(i),h=t;h<e;h++)this.paintVertexArray.emplace(h,a[0],a[1]);else{for(var c=t;c<e;c++)this.paintVertexArray.emplace(c,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},si.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},si.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ai=function(t,e,i,a,h,c){this.expression=t,this.uniformNames=e.map(function(p){return"u_"+p+"_t"}),this.type=i,this.useIntegerZoom=a,this.zoom=h,this.maxValue=0,this.paintVertexAttributes=e.map(function(p){return{name:"a_"+p,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new c};ai.prototype.populatePaintArray=function(t,e,i,a,h){var c=this.expression.evaluate(new wi(this.zoom),e,{},a,[],h),p=this.expression.evaluate(new wi(this.zoom+1),e,{},a,[],h),m=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(m,t,c,p)},ai.prototype.updatePaintArray=function(t,e,i,a){var h=this.expression.evaluate({zoom:this.zoom},i,a),c=this.expression.evaluate({zoom:this.zoom+1},i,a);this._setPaintValue(t,e,h,c)},ai.prototype._setPaintValue=function(t,e,i,a){if(this.type==="color")for(var h=Ue(i),c=Ue(a),p=t;p<e;p++)this.paintVertexArray.emplace(p,h[0],h[1],c[0],c[1]);else{for(var m=t;m<e;m++)this.paintVertexArray.emplace(m,i,a);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(a))}},ai.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ai.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ai.prototype.setUniform=function(t,e){var i=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,a=at(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);t.set(a)},ai.prototype.getBinding=function(t,e,i){return new Ae(t,e)};var mi=function(t,e,i,a,h,c){this.expression=t,this.type=e,this.useIntegerZoom=i,this.zoom=a,this.layerId=c,this.zoomInPaintVertexArray=new h,this.zoomOutPaintVertexArray=new h};mi.prototype.populatePaintArray=function(t,e,i){var a=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(a,t,e.patterns&&e.patterns[this.layerId],i)},mi.prototype.updatePaintArray=function(t,e,i,a,h){this._setPaintValues(t,e,i.patterns&&i.patterns[this.layerId],h)},mi.prototype._setPaintValues=function(t,e,i,a){if(a&&i){var h=a[i.min],c=a[i.mid],p=a[i.max];if(h&&c&&p)for(var m=t;m<e;m++)this.zoomInPaintVertexArray.emplace(m,c.tl[0],c.tl[1],c.br[0],c.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],c.pixelRatio,h.pixelRatio),this.zoomOutPaintVertexArray.emplace(m,c.tl[0],c.tl[1],c.br[0],c.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],c.pixelRatio,p.pixelRatio)}},mi.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ft.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ft.members,this.expression.isStateDependent))},mi.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var oi=function(t,e,i){this.binders={},this._buffers=[];var a=[];for(var h in t.paint._values)if(i(h)){var c=t.paint.get(h);if(c instanceof Xr&&zo(c.property.specification)){var p=Tr(h,t.type),m=c.value,b=c.property.specification.type,M=c.property.useIntegerZoom,O=c.property.specification["property-type"],N=O==="cross-faded"||O==="cross-faded-data-driven";if(m.kind==="constant")this.binders[h]=N?new gi(m.value,p):new hi(m.value,p,b),a.push("/u_"+h);else if(m.kind==="source"||N){var nt=sr(h,b,"source");this.binders[h]=N?new mi(m,b,M,e,nt,t.id):new si(m,p,b,nt),a.push("/a_"+h)}else{var ft=sr(h,b,"composite");this.binders[h]=new ai(m,p,b,M,e,ft),a.push("/z_"+h)}}}this.cacheKey=a.sort().join("")};oi.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof si||e instanceof ai?e.maxValue:0},oi.prototype.populatePaintArrays=function(t,e,i,a,h){for(var c in this.binders){var p=this.binders[c];(p instanceof si||p instanceof ai||p instanceof mi)&&p.populatePaintArray(t,e,i,a,h)}},oi.prototype.setConstantPatternPositions=function(t,e){for(var i in this.binders){var a=this.binders[i];a instanceof gi&&a.setConstantPatternPositions(t,e)}},oi.prototype.updatePaintArrays=function(t,e,i,a,h){var c=!1;for(var p in t)for(var m=0,b=e.getPositions(p);m<b.length;m+=1){var M=b[m],O=i.feature(M.index);for(var N in this.binders){var nt=this.binders[N];if((nt instanceof si||nt instanceof ai||nt instanceof mi)&&nt.expression.isStateDependent===!0){var ft=a.paint.get(N);nt.expression=ft.value,nt.updatePaintArray(M.start,M.end,O,t[p],h),c=!0}}}return c},oi.prototype.defines=function(){var t=[];for(var e in this.binders){var i=this.binders[e];(i instanceof hi||i instanceof gi)&&t.push.apply(t,i.uniformNames.map(function(a){return"#define HAS_UNIFORM_"+a}))}return t},oi.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var i=this.binders[e];if(i instanceof si||i instanceof ai)for(var a=0;a<i.paintVertexAttributes.length;a++)t.push(i.paintVertexAttributes[a].name);else if(i instanceof mi)for(var h=0;h<Ft.members.length;h++)t.push(Ft.members[h].name)}return t},oi.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var i=this.binders[e];if(i instanceof hi||i instanceof gi||i instanceof ai)for(var a=0,h=i.uniformNames;a<h.length;a+=1)t.push(h[a])}return t},oi.prototype.getPaintVertexBuffers=function(){return this._buffers},oi.prototype.getUniforms=function(t,e){var i=[];for(var a in this.binders){var h=this.binders[a];if(h instanceof hi||h instanceof gi||h instanceof ai)for(var c=0,p=h.uniformNames;c<p.length;c+=1){var m=p[c];if(e[m]){var b=h.getBinding(t,e[m],m);i.push({name:m,property:a,binding:b})}}}return i},oi.prototype.setUniforms=function(t,e,i,a){for(var h=0,c=e;h<c.length;h+=1){var p=c[h],m=p.name,b=p.property;this.binders[b].setUniform(p.binding,a,i.get(b),m)}},oi.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var i=this.binders[e];if(t&&i instanceof mi){var a=t.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;a&&this._buffers.push(a)}else(i instanceof si||i instanceof ai)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},oi.prototype.upload=function(t){for(var e in this.binders){var i=this.binders[e];(i instanceof si||i instanceof ai||i instanceof mi)&&i.upload(t)}this.updatePaintBuffers()},oi.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof si||e instanceof ai||e instanceof mi)&&e.destroy()}};var ri=function(t,e,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var a=0,h=t;a<h.length;a+=1){var c=h[a];this.programConfigurations[c.id]=new oi(c,e,i)}this.needsUpload=!1,this._featureMap=new Qt,this._bufferOffset=0};function Tr(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function sr(t,e,i){var a={color:{source:ia,composite:hs},number:{source:co,composite:ia}},h=function(c){return{"line-pattern":{source:Fn,composite:Fn},"fill-pattern":{source:Fn,composite:Fn},"fill-extrusion-pattern":{source:Fn,composite:Fn}}[c]}(t);return h&&h[i]||a[e][i]}ri.prototype.populatePaintArrays=function(t,e,i,a,h,c){for(var p in this.programConfigurations)this.programConfigurations[p].populatePaintArrays(t,e,a,h,c);e.id!==void 0&&this._featureMap.add(e.id,i,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},ri.prototype.updatePaintArrays=function(t,e,i,a){for(var h=0,c=i;h<c.length;h+=1){var p=c[h];this.needsUpload=this.programConfigurations[p.id].updatePaintArrays(t,this._featureMap,e,p,a)||this.needsUpload}},ri.prototype.get=function(t){return this.programConfigurations[t]},ri.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},ri.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Ve("ConstantBinder",hi),Ve("CrossFadedConstantBinder",gi),Ve("SourceExpressionBinder",si),Ve("CrossFadedCompositeBinder",mi),Ve("CompositeExpressionBinder",ai),Ve("ProgramConfiguration",oi,{omit:["_buffers"]}),Ve("ProgramConfigurationSet",ri);var jr=Math.pow(2,14)-1,Ir=-jr-1;function or(t){for(var e=8192/t.extent,i=t.loadGeometry(),a=0;a<i.length;a++)for(var h=i[a],c=0;c<h.length;c++){var p=h[c],m=Math.round(p.x*e),b=Math.round(p.y*e);p.x=at(m,Ir,jr),p.y=at(b,Ir,jr),(m<p.x||m>p.x+1||b<p.y||b>p.y+1)&&z("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function dr(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?or(t):[]}}function un(t,e,i,a,h){t.emplaceBack(2*e+(a+1)/2,2*i+(h+1)/2)}var Hr=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Fo,this.indexArray=new lo,this.segments=new vt,this.programConfigurations=new ri(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function uo(t,e){for(var i=0;i<t.length;i++)if(jn(e,t[i]))return!0;for(var a=0;a<e.length;a++)if(jn(t,e[a]))return!0;return!!La(t,e)}function tn(t,e,i){return!!jn(t,e)||!!po(e,t,i)}function Dn(t,e){if(t.length===1)return za(e,t[0]);for(var i=0;i<e.length;i++)for(var a=e[i],h=0;h<a.length;h++)if(jn(t,a[h]))return!0;for(var c=0;c<t.length;c++)if(za(e,t[c]))return!0;for(var p=0;p<e.length;p++)if(La(t,e[p]))return!0;return!1}function Tn(t,e,i){if(t.length>1){if(La(t,e))return!0;for(var a=0;a<e.length;a++)if(po(e[a],t,i))return!0}for(var h=0;h<t.length;h++)if(po(t[h],e,i))return!0;return!1}function La(t,e){if(t.length===0||e.length===0)return!1;for(var i=0;i<t.length-1;i++)for(var a=t[i],h=t[i+1],c=0;c<e.length-1;c++)if(oa(a,h,e[c],e[c+1]))return!0;return!1}function oa(t,e,i,a){return S(t,i,a)!==S(e,i,a)&&S(t,e,i)!==S(t,e,a)}function po(t,e,i){var a=i*i;if(e.length===1)return t.distSqr(e[0])<a;for(var h=1;h<e.length;h++)if(aa(t,e[h-1],e[h])<a)return!0;return!1}function aa(t,e,i){var a=e.distSqr(i);if(a===0)return t.distSqr(e);var h=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/a;return t.distSqr(h<0?e:h>1?i:i.sub(e)._mult(h)._add(e))}function za(t,e){for(var i,a,h,c=!1,p=0;p<t.length;p++)for(var m=0,b=(i=t[p]).length-1;m<i.length;b=m++)(a=i[m]).y>e.y!=(h=i[b]).y>e.y&&e.x<(h.x-a.x)*(e.y-a.y)/(h.y-a.y)+a.x&&(c=!c);return c}function jn(t,e){for(var i=!1,a=0,h=t.length-1;a<t.length;h=a++){var c=t[a],p=t[h];c.y>e.y!=p.y>e.y&&e.x<(p.x-c.x)*(e.y-c.y)/(p.y-c.y)+c.x&&(i=!i)}return i}function Da(t,e,i){var a=i[0],h=i[2];if(t.x<a.x&&e.x<a.x||t.x>h.x&&e.x>h.x||t.y<a.y&&e.y<a.y||t.y>h.y&&e.y>h.y)return!1;var c=S(t,e,i[0]);return c!==S(t,e,i[1])||c!==S(t,e,i[2])||c!==S(t,e,i[3])}function Un(t,e,i){var a=e.paint.get(t).value;return a.kind==="constant"?a.value:i.programConfigurations.get(e.id).getMaxValue(t)}function kr(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Wn(t,e,i,a,h){if(!e[0]&&!e[1])return t;var c=Lt.convert(e)._mult(h);i==="viewport"&&c._rotate(-a);for(var p=[],m=0;m<t.length;m++)p.push(t[m].sub(c));return p}Hr.prototype.populate=function(t,e,i){var a=this.layers[0],h=[],c=null;a.type==="circle"&&(c=a.layout.get("circle-sort-key"));for(var p=0,m=t;p<m.length;p+=1){var b=m[p],M=b.feature,O=b.id,N=b.index,nt=b.sourceLayerIndex,ft=this.layers[0]._featureFilter.needGeometry,It=dr(M,ft);if(this.layers[0]._featureFilter.filter(new wi(this.zoom),It,i)){var Ot=c?c.evaluate(It,{},i):void 0,Wt={id:O,properties:M.properties,type:M.type,sourceLayerIndex:nt,index:N,geometry:ft?It.geometry:or(M),patterns:{},sortKey:Ot};h.push(Wt)}}c&&h.sort(function(Me,He){return Me.sortKey-He.sortKey});for(var Gt=0,ie=h;Gt<ie.length;Gt+=1){var ae=ie[Gt],he=ae.geometry,ue=ae.index,_e=ae.sourceLayerIndex,ke=t[ue].feature;this.addFeature(ae,he,ue,i),e.featureIndex.insert(ke,he,ue,_e,this.index)}},Hr.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},Hr.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Hr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Hr.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Hr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Hr.prototype.addFeature=function(t,e,i,a){for(var h=0,c=e;h<c.length;h+=1)for(var p=0,m=c[h];p<m.length;p+=1){var b=m[p],M=b.x,O=b.y;if(!(M<0||M>=8192||O<0||O>=8192)){var N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),nt=N.vertexLength;un(this.layoutVertexArray,M,O,-1,-1),un(this.layoutVertexArray,M,O,1,-1),un(this.layoutVertexArray,M,O,1,1),un(this.layoutVertexArray,M,O,-1,1),this.indexArray.emplaceBack(nt,nt+1,nt+2),this.indexArray.emplaceBack(nt,nt+3,nt+2),N.vertexLength+=4,N.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{},a)},Ve("CircleBucket",Hr,{omit:["layers"]});var fo=new Fr({"circle-sort-key":new Xe(yt.layout_circle["circle-sort-key"])}),Uo={paint:new Fr({"circle-radius":new Xe(yt.paint_circle["circle-radius"]),"circle-color":new Xe(yt.paint_circle["circle-color"]),"circle-blur":new Xe(yt.paint_circle["circle-blur"]),"circle-opacity":new Xe(yt.paint_circle["circle-opacity"]),"circle-translate":new Ye(yt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ye(yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ye(yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ye(yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xe(yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xe(yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xe(yt.paint_circle["circle-stroke-opacity"])}),layout:fo},Ri=typeof Float32Array<"u"?Float32Array:Array;function gn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function en(t,e,i){var a=e[0],h=e[1],c=e[2],p=e[3],m=e[4],b=e[5],M=e[6],O=e[7],N=e[8],nt=e[9],ft=e[10],It=e[11],Ot=e[12],Wt=e[13],Gt=e[14],ie=e[15],ae=i[0],he=i[1],ue=i[2],_e=i[3];return t[0]=ae*a+he*m+ue*N+_e*Ot,t[1]=ae*h+he*b+ue*nt+_e*Wt,t[2]=ae*c+he*M+ue*ft+_e*Gt,t[3]=ae*p+he*O+ue*It+_e*ie,t[4]=(ae=i[4])*a+(he=i[5])*m+(ue=i[6])*N+(_e=i[7])*Ot,t[5]=ae*h+he*b+ue*nt+_e*Wt,t[6]=ae*c+he*M+ue*ft+_e*Gt,t[7]=ae*p+he*O+ue*It+_e*ie,t[8]=(ae=i[8])*a+(he=i[9])*m+(ue=i[10])*N+(_e=i[11])*Ot,t[9]=ae*h+he*b+ue*nt+_e*Wt,t[10]=ae*c+he*M+ue*ft+_e*Gt,t[11]=ae*p+he*O+ue*It+_e*ie,t[12]=(ae=i[12])*a+(he=i[13])*m+(ue=i[14])*N+(_e=i[15])*Ot,t[13]=ae*h+he*b+ue*nt+_e*Wt,t[14]=ae*c+he*M+ue*ft+_e*Gt,t[15]=ae*p+he*O+ue*It+_e*ie,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,i=arguments.length;i--;)e+=t[i]*t[i];return Math.sqrt(e)});var No,lc=en;function cs(t,e,i){var a=e[0],h=e[1],c=e[2],p=e[3];return t[0]=i[0]*a+i[4]*h+i[8]*c+i[12]*p,t[1]=i[1]*a+i[5]*h+i[9]*c+i[13]*p,t[2]=i[2]*a+i[6]*h+i[10]*c+i[14]*p,t[3]=i[3]*a+i[7]*h+i[11]*c+i[15]*p,t}No=new Ri(3),Ri!=Float32Array&&(No[0]=0,No[1]=0,No[2]=0),function(){var t=new Ri(4);Ri!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var hc=(function(){var t=new Ri(2);Ri!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(i){t.call(this,i,Uo)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new Hr(i)},e.prototype.queryRadius=function(i){var a=i;return Un("circle-radius",this,a)+Un("circle-stroke-width",this,a)+kr(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(i,a,h,c,p,m,b,M){for(var O=Wn(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,b),N=this.paint.get("circle-radius").evaluate(a,h)+this.paint.get("circle-stroke-width").evaluate(a,h),nt=this.paint.get("circle-pitch-alignment")==="map",ft=nt?O:function(ke,Me){return ke.map(function(He){return Oa(He,Me)})}(O,M),It=nt?N*b:N,Ot=0,Wt=c;Ot<Wt.length;Ot+=1)for(var Gt=0,ie=Wt[Ot];Gt<ie.length;Gt+=1){var ae=ie[Gt],he=nt?ae:Oa(ae,M),ue=It,_e=cs([],[ae.x,ae.y,0,1],M);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ue*=_e[3]/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ue*=m.cameraToCenterDistance/_e[3]),tn(ft,he,ue))return!0}return!1},e}(Rn));function Oa(t,e){var i=cs([],[t.x,t.y,0,1],e);return new Lt(i[0]/i[3],i[1]/i[3])}var dh=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Hr);function sa(t,e,i,a){var h=e.width,c=e.height;if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==h*c*i)throw new RangeError("mismatched image size")}else a=new Uint8Array(h*c*i);return t.width=h,t.height=c,t.data=a,t}function us(t,e,i){var a=e.width,h=e.height;if(a!==t.width||h!==t.height){var c=sa({},{width:a,height:h},i);cc(t,c,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,a),height:Math.min(t.height,h)},i),t.width=a,t.height=h,t.data=c.data}}function cc(t,e,i,a,h,c){if(h.width===0||h.height===0)return e;if(h.width>t.width||h.height>t.height||i.x>t.width-h.width||i.y>t.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||a.x>e.width-h.width||a.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");for(var p=t.data,m=e.data,b=0;b<h.height;b++)for(var M=((i.y+b)*t.width+i.x)*c,O=((a.y+b)*e.width+a.x)*c,N=0;N<h.width*c;N++)m[O+N]=p[M+N];return e}Ve("HeatmapBucket",dh,{omit:["layers"]});var Ba=function(t,e){sa(this,t,1,e)};Ba.prototype.resize=function(t){us(this,t,1)},Ba.prototype.clone=function(){return new Ba({width:this.width,height:this.height},new Uint8Array(this.data))},Ba.copy=function(t,e,i,a,h){cc(t,e,i,a,h,1)};var pn=function(t,e){sa(this,t,4,e)};pn.prototype.resize=function(t){us(this,t,4)},pn.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},pn.prototype.clone=function(){return new pn({width:this.width,height:this.height},new Uint8Array(this.data))},pn.copy=function(t,e,i,a,h){cc(t,e,i,a,h,4)},Ve("AlphaImage",Ba),Ve("RGBAImage",pn);var Up={paint:new Fr({"heatmap-radius":new Xe(yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xe(yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ye(yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new zn(yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ye(yt.paint_heatmap["heatmap-opacity"])})};function Zc(t){var e={},i=t.resolution||256,a=t.clips?t.clips.length:1,h=t.image||new pn({width:i,height:a}),c=function(It,Ot,Wt){e[t.evaluationKey]=Wt;var Gt=t.expression.evaluate(e);h.data[It+Ot+0]=Math.floor(255*Gt.r/Gt.a),h.data[It+Ot+1]=Math.floor(255*Gt.g/Gt.a),h.data[It+Ot+2]=Math.floor(255*Gt.b/Gt.a),h.data[It+Ot+3]=Math.floor(255*Gt.a)};if(t.clips)for(var p=0,m=0;p<a;++p,m+=4*i)for(var b=0,M=0;b<i;b++,M+=4){var O=b/(i-1),N=t.clips[p];c(m,M,N.start*(1-O)+N.end*O)}else for(var nt=0,ft=0;nt<i;nt++,ft+=4)c(0,ft,nt/(i-1));return h}var Np=function(t){function e(i){t.call(this,i,Up),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new dh(i)},e.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=Zc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},e}(Rn),Vp={paint:new Fr({"hillshade-illumination-direction":new Ye(yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ye(yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ye(yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ye(yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ye(yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ye(yt.paint_hillshade["hillshade-accent-color"])})},Gp=function(t){function e(i){t.call(this,i,Vp)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},e}(Rn),qp=Pr([{name:"a_pos",components:2,type:"Int16"}],4).members,uc=fh,Xp=fh;function fh(t,e,i){i=i||2;var a,h,c,p,m,b,M,O=e&&e.length,N=O?e[0]*i:t.length,nt=Yc(t,0,N,i,!0),ft=[];if(!nt||nt.next===nt.prev)return ft;if(O&&(nt=function(Ot,Wt,Gt,ie){var ae,he,ue,_e=[];for(ae=0,he=Wt.length;ae<he;ae++)(ue=Yc(Ot,Wt[ae]*ie,ae<he-1?Wt[ae+1]*ie:Ot.length,ie,!1))===ue.next&&(ue.steiner=!0),_e.push(Qp(ue));for(_e.sort(Kp),ae=0;ae<_e.length;ae++)Jp(_e[ae],Gt),Gt=la(Gt,Gt.next);return Gt}(t,e,nt,i)),t.length>80*i){a=c=t[0],h=p=t[1];for(var It=i;It<N;It+=i)(m=t[It])<a&&(a=m),(b=t[It+1])<h&&(h=b),m>c&&(c=m),b>p&&(p=b);M=(M=Math.max(c-a,p-h))!==0?1/M:0}return cl(nt,ft,i,a,h,M),ft}function Yc(t,e,i,a,h){var c,p;if(h===fc(t,e,i,a)>0)for(c=e;c<i;c+=a)p=$c(c,t[c],t[c+1],p);else for(c=i-a;c>=e;c-=a)p=$c(c,t[c],t[c+1],p);return p&&mh(p,p.next)&&(pl(p),p=p.next),p}function la(t,e){if(!t)return t;e||(e=t);var i,a=t;do if(i=!1,a.steiner||!mh(a,a.next)&&br(a.prev,a,a.next)!==0)a=a.next;else{if(pl(a),(a=e=a.prev)===a.next)break;i=!0}while(i||a!==e);return e}function cl(t,e,i,a,h,c,p){if(t){!p&&c&&function(O,N,nt,ft){var It=O;do It.z===null&&(It.z=pc(It.x,It.y,N,nt,ft)),It.prevZ=It.prev,It.nextZ=It.next,It=It.next;while(It!==O);It.prevZ.nextZ=null,It.prevZ=null,function(Ot){var Wt,Gt,ie,ae,he,ue,_e,ke,Me=1;do{for(Gt=Ot,Ot=null,he=null,ue=0;Gt;){for(ue++,ie=Gt,_e=0,Wt=0;Wt<Me&&(_e++,ie=ie.nextZ);Wt++);for(ke=Me;_e>0||ke>0&&ie;)_e!==0&&(ke===0||!ie||Gt.z<=ie.z)?(ae=Gt,Gt=Gt.nextZ,_e--):(ae=ie,ie=ie.nextZ,ke--),he?he.nextZ=ae:Ot=ae,ae.prevZ=he,he=ae;Gt=ie}he.nextZ=null,Me*=2}while(ue>1)}(It)}(t,a,h,c);for(var m,b,M=t;t.prev!==t.next;)if(m=t.prev,b=t.next,c?Hp(t,a,h,c):Wp(t))e.push(m.i/i),e.push(t.i/i),e.push(b.i/i),pl(t),t=b.next,M=b.next;else if((t=b)===M){p?p===1?cl(t=Zp(la(t),e,i),e,i,a,h,c,2):p===2&&Yp(t,e,i,a,h,c):cl(la(t),e,i,a,h,c,1);break}}}function Wp(t){var e=t.prev,i=t,a=t.next;if(br(e,i,a)>=0)return!1;for(var h=t.next.next;h!==t.prev;){if(ps(e.x,e.y,i.x,i.y,a.x,a.y,h.x,h.y)&&br(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function Hp(t,e,i,a){var h=t.prev,c=t,p=t.next;if(br(h,c,p)>=0)return!1;for(var m=h.x>c.x?h.x>p.x?h.x:p.x:c.x>p.x?c.x:p.x,b=h.y>c.y?h.y>p.y?h.y:p.y:c.y>p.y?c.y:p.y,M=pc(h.x<c.x?h.x<p.x?h.x:p.x:c.x<p.x?c.x:p.x,h.y<c.y?h.y<p.y?h.y:p.y:c.y<p.y?c.y:p.y,e,i,a),O=pc(m,b,e,i,a),N=t.prevZ,nt=t.nextZ;N&&N.z>=M&&nt&&nt.z<=O;){if(N!==t.prev&&N!==t.next&&ps(h.x,h.y,c.x,c.y,p.x,p.y,N.x,N.y)&&br(N.prev,N,N.next)>=0||(N=N.prevZ,nt!==t.prev&&nt!==t.next&&ps(h.x,h.y,c.x,c.y,p.x,p.y,nt.x,nt.y)&&br(nt.prev,nt,nt.next)>=0))return!1;nt=nt.nextZ}for(;N&&N.z>=M;){if(N!==t.prev&&N!==t.next&&ps(h.x,h.y,c.x,c.y,p.x,p.y,N.x,N.y)&&br(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;nt&&nt.z<=O;){if(nt!==t.prev&&nt!==t.next&&ps(h.x,h.y,c.x,c.y,p.x,p.y,nt.x,nt.y)&&br(nt.prev,nt,nt.next)>=0)return!1;nt=nt.nextZ}return!0}function Zp(t,e,i){var a=t;do{var h=a.prev,c=a.next.next;!mh(h,c)&&Kc(h,a,a.next,c)&&ul(h,c)&&ul(c,h)&&(e.push(h.i/i),e.push(a.i/i),e.push(c.i/i),pl(a),pl(a.next),a=t=c),a=a.next}while(a!==t);return la(a)}function Yp(t,e,i,a,h,c){var p=t;do{for(var m=p.next.next;m!==p.prev;){if(p.i!==m.i&&td(p,m)){var b=Jc(p,m);return p=la(p,p.next),b=la(b,b.next),cl(p,e,i,a,h,c),void cl(b,e,i,a,h,c)}m=m.next}p=p.next}while(p!==t)}function Kp(t,e){return t.x-e.x}function Jp(t,e){if(e=function(a,h){var c,p=h,m=a.x,b=a.y,M=-1/0;do{if(b<=p.y&&b>=p.next.y&&p.next.y!==p.y){var O=p.x+(b-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(O<=m&&O>M){if(M=O,O===m){if(b===p.y)return p;if(b===p.next.y)return p.next}c=p.x<p.next.x?p:p.next}}p=p.next}while(p!==h);if(!c)return null;if(m===M)return c;var N,nt=c,ft=c.x,It=c.y,Ot=1/0;p=c;do m>=p.x&&p.x>=ft&&m!==p.x&&ps(b<It?m:M,b,ft,It,b<It?M:m,b,p.x,p.y)&&(N=Math.abs(b-p.y)/(m-p.x),ul(p,a)&&(N<Ot||N===Ot&&(p.x>c.x||p.x===c.x&&$p(c,p)))&&(c=p,Ot=N)),p=p.next;while(p!==nt);return c}(t,e)){var i=Jc(e,t);la(e,e.next),la(i,i.next)}}function $p(t,e){return br(t.prev,t,e.prev)<0&&br(e.next,t,t.next)<0}function pc(t,e,i,a,h){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*h)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-a)*h)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Qp(t){var e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function ps(t,e,i,a,h,c,p,m){return(h-p)*(e-m)-(t-p)*(c-m)>=0&&(t-p)*(a-m)-(i-p)*(e-m)>=0&&(i-p)*(c-m)-(h-p)*(a-m)>=0}function td(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(i,a){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==a.i&&h.next.i!==a.i&&Kc(h,h.next,i,a))return!0;h=h.next}while(h!==i);return!1}(t,e)&&(ul(t,e)&&ul(e,t)&&function(i,a){var h=i,c=!1,p=(i.x+a.x)/2,m=(i.y+a.y)/2;do h.y>m!=h.next.y>m&&h.next.y!==h.y&&p<(h.next.x-h.x)*(m-h.y)/(h.next.y-h.y)+h.x&&(c=!c),h=h.next;while(h!==i);return c}(t,e)&&(br(t.prev,t,e.prev)||br(t,e.prev,e))||mh(t,e)&&br(t.prev,t,t.next)>0&&br(e.prev,e,e.next)>0)}function br(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function mh(t,e){return t.x===e.x&&t.y===e.y}function Kc(t,e,i,a){var h=yh(br(t,e,i)),c=yh(br(t,e,a)),p=yh(br(i,a,t)),m=yh(br(i,a,e));return h!==c&&p!==m||!(h!==0||!gh(t,i,e))||!(c!==0||!gh(t,a,e))||!(p!==0||!gh(i,t,a))||!(m!==0||!gh(i,e,a))}function gh(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function yh(t){return t>0?1:t<0?-1:0}function ul(t,e){return br(t.prev,t,t.next)<0?br(t,e,t.next)>=0&&br(t,t.prev,e)>=0:br(t,e,t.prev)<0||br(t,t.next,e)<0}function Jc(t,e){var i=new dc(t.i,t.x,t.y),a=new dc(e.i,e.x,e.y),h=t.next,c=e.prev;return t.next=e,e.prev=t,i.next=h,h.prev=i,a.next=i,i.prev=a,c.next=a,a.prev=c,a}function $c(t,e,i,a){var h=new dc(t,e,i);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function pl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function dc(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function fc(t,e,i,a){for(var h=0,c=e,p=i-a;c<i;c+=a)h+=(t[p]-t[c])*(t[c+1]+t[p+1]),p=c;return h}function ed(t,e,i,a,h){(function c(p,m,b,M,O){for(;M>b;){if(M-b>600){var N=M-b+1,nt=m-b+1,ft=Math.log(N),It=.5*Math.exp(2*ft/3),Ot=.5*Math.sqrt(ft*It*(N-It)/N)*(nt-N/2<0?-1:1);c(p,m,Math.max(b,Math.floor(m-nt*It/N+Ot)),Math.min(M,Math.floor(m+(N-nt)*It/N+Ot)),O)}var Wt=p[m],Gt=b,ie=M;for(dl(p,b,m),O(p[M],Wt)>0&&dl(p,b,M);Gt<ie;){for(dl(p,Gt,ie),Gt++,ie--;O(p[Gt],Wt)<0;)Gt++;for(;O(p[ie],Wt)>0;)ie--}O(p[b],Wt)===0?dl(p,b,ie):dl(p,++ie,M),ie<=m&&(b=ie+1),m<=ie&&(M=ie-1)}})(t,e,i||0,a||t.length-1,h||id)}function dl(t,e,i){var a=t[e];t[e]=t[i],t[i]=a}function id(t,e){return t<e?-1:t>e?1:0}function mc(t,e){var i=t.length;if(i<=1)return[t];for(var a,h,c=[],p=0;p<i;p++){var m=g(t[p]);m!==0&&(t[p].area=Math.abs(m),h===void 0&&(h=m<0),h===m<0?(a&&c.push(a),a=[t[p]]):a.push(t[p]))}if(a&&c.push(a),e>1)for(var b=0;b<c.length;b++)c[b].length<=e||(ed(c[b],e,1,c[b].length-1,rd),c[b]=c[b].slice(0,e));return c}function rd(t,e){return e.area-t.area}function gc(t,e,i){for(var a=i.patternDependencies,h=!1,c=0,p=e;c<p.length;c+=1){var m=p[c].paint.get(t+"-pattern");m.isConstant()||(h=!0);var b=m.constantOr(null);b&&(h=!0,a[b.to]=!0,a[b.from]=!0)}return h}function yc(t,e,i,a,h){for(var c=h.patternDependencies,p=0,m=e;p<m.length;p+=1){var b=m[p],M=b.paint.get(t+"-pattern").value;if(M.kind!=="constant"){var O=M.evaluate({zoom:a-1},i,{},h.availableImages),N=M.evaluate({zoom:a},i,{},h.availableImages),nt=M.evaluate({zoom:a+1},i,{},h.availableImages);N=N&&N.name?N.name:N,nt=nt&&nt.name?nt.name:nt,c[O=O&&O.name?O.name:O]=!0,c[N]=!0,c[nt]=!0,i.patterns[b.id]={min:O,mid:N,max:nt}}}return i}fh.deviation=function(t,e,i,a){var h=e&&e.length,c=Math.abs(fc(t,0,h?e[0]*i:t.length,i));if(h)for(var p=0,m=e.length;p<m;p++)c-=Math.abs(fc(t,e[p]*i,p<m-1?e[p+1]*i:t.length,i));var b=0;for(p=0;p<a.length;p+=3){var M=a[p]*i,O=a[p+1]*i,N=a[p+2]*i;b+=Math.abs((t[M]-t[N])*(t[O+1]-t[M+1])-(t[M]-t[O])*(t[N+1]-t[M+1]))}return c===0&&b===0?0:Math.abs((b-c)/c)},fh.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},a=0,h=0;h<t.length;h++){for(var c=0;c<t[h].length;c++)for(var p=0;p<e;p++)i.vertices.push(t[h][c][p]);h>0&&i.holes.push(a+=t[h-1].length)}return i},uc.default=Xp;var Hn=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Fo,this.indexArray=new lo,this.indexArray2=new Ia,this.programConfigurations=new ri(t.layers,t.zoom),this.segments=new vt,this.segments2=new vt,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};Hn.prototype.populate=function(t,e,i){this.hasPattern=gc("fill",this.layers,e);for(var a=this.layers[0].layout.get("fill-sort-key"),h=[],c=0,p=t;c<p.length;c+=1){var m=p[c],b=m.feature,M=m.id,O=m.index,N=m.sourceLayerIndex,nt=this.layers[0]._featureFilter.needGeometry,ft=dr(b,nt);if(this.layers[0]._featureFilter.filter(new wi(this.zoom),ft,i)){var It=a?a.evaluate(ft,{},i,e.availableImages):void 0,Ot={id:M,properties:b.properties,type:b.type,sourceLayerIndex:N,index:O,geometry:nt?ft.geometry:or(b),patterns:{},sortKey:It};h.push(Ot)}}a&&h.sort(function(ke,Me){return ke.sortKey-Me.sortKey});for(var Wt=0,Gt=h;Wt<Gt.length;Wt+=1){var ie=Gt[Wt],ae=ie.geometry,he=ie.index,ue=ie.sourceLayerIndex;if(this.hasPattern){var _e=yc("fill",this.layers,ie,this.zoom,e);this.patternFeatures.push(_e)}else this.addFeature(ie,ae,he,i,{});e.featureIndex.insert(t[he].feature,ae,he,ue,this.index)}},Hn.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},Hn.prototype.addFeatures=function(t,e,i){for(var a=0,h=this.patternFeatures;a<h.length;a+=1){var c=h[a];this.addFeature(c,c.geometry,c.index,e,i)}},Hn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Hn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Hn.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},Hn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Hn.prototype.addFeature=function(t,e,i,a,h){for(var c=0,p=mc(e,500);c<p.length;c+=1){for(var m=p[c],b=0,M=0,O=m;M<O.length;M+=1)b+=O[M].length;for(var N=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),nt=N.vertexLength,ft=[],It=[],Ot=0,Wt=m;Ot<Wt.length;Ot+=1){var Gt=Wt[Ot];if(Gt.length!==0){Gt!==m[0]&&It.push(ft.length/2);var ie=this.segments2.prepareSegment(Gt.length,this.layoutVertexArray,this.indexArray2),ae=ie.vertexLength;this.layoutVertexArray.emplaceBack(Gt[0].x,Gt[0].y),this.indexArray2.emplaceBack(ae+Gt.length-1,ae),ft.push(Gt[0].x),ft.push(Gt[0].y);for(var he=1;he<Gt.length;he++)this.layoutVertexArray.emplaceBack(Gt[he].x,Gt[he].y),this.indexArray2.emplaceBack(ae+he-1,ae+he),ft.push(Gt[he].x),ft.push(Gt[he].y);ie.vertexLength+=Gt.length,ie.primitiveLength+=Gt.length}}for(var ue=uc(ft,It),_e=0;_e<ue.length;_e+=3)this.indexArray.emplaceBack(nt+ue[_e],nt+ue[_e+1],nt+ue[_e+2]);N.vertexLength+=b,N.primitiveLength+=ue.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,h,a)},Ve("FillBucket",Hn,{omit:["layers","patternFeatures"]});var nd=new Fr({"fill-sort-key":new Xe(yt.layout_fill["fill-sort-key"])}),od={paint:new Fr({"fill-antialias":new Ye(yt.paint_fill["fill-antialias"]),"fill-opacity":new Xe(yt.paint_fill["fill-opacity"]),"fill-color":new Xe(yt.paint_fill["fill-color"]),"fill-outline-color":new Xe(yt.paint_fill["fill-outline-color"]),"fill-translate":new Ye(yt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ye(yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new os(yt.paint_fill["fill-pattern"])}),layout:nd},ad=function(t){function e(i){t.call(this,i,od)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(i,a){t.prototype.recalculate.call(this,i,a);var h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(i){return new Hn(i)},e.prototype.queryRadius=function(){return kr(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(i,a,h,c,p,m,b){return Dn(Wn(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,b),c)},e.prototype.isTileClipped=function(){return!0},e}(Rn),sd=Pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Qc=ds;function ds(t,e,i,a,h){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=a,this._values=h,t.readFields(ld,this,e)}function ld(t,e,i){t==1?e.id=i.readVarint():t==2?function(a,h){for(var c=a.readVarint()+a.pos;a.pos<c;){var p=h._keys[a.readVarint()],m=h._values[a.readVarint()];h.properties[p]=m}}(i,e):t==3?e.type=i.readVarint():t==4&&(e._geometry=i.pos)}function hd(t){for(var e,i,a=0,h=0,c=t.length,p=c-1;h<c;p=h++)a+=((i=t[p]).x-(e=t[h]).x)*(e.y+i.y);return a}ds.types=["Unknown","Point","LineString","Polygon"],ds.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,a=1,h=0,c=0,p=0,m=[];t.pos<i;){if(h<=0){var b=t.readVarint();a=7&b,h=b>>3}if(h--,a===1||a===2)c+=t.readSVarint(),p+=t.readSVarint(),a===1&&(e&&m.push(e),e=[]),e.push(new Lt(c,p));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&m.push(e),m},ds.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,a=0,h=0,c=0,p=1/0,m=-1/0,b=1/0,M=-1/0;t.pos<e;){if(a<=0){var O=t.readVarint();i=7&O,a=O>>3}if(a--,i===1||i===2)(h+=t.readSVarint())<p&&(p=h),h>m&&(m=h),(c+=t.readSVarint())<b&&(b=c),c>M&&(M=c);else if(i!==7)throw new Error("unknown command "+i)}return[p,b,m,M]},ds.prototype.toGeoJSON=function(t,e,i){var a,h,c=this.extent*Math.pow(2,i),p=this.extent*t,m=this.extent*e,b=this.loadGeometry(),M=ds.types[this.type];function O(ft){for(var It=0;It<ft.length;It++){var Ot=ft[It];ft[It]=[360*(Ot.x+p)/c-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ot.y+m)/c)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(a=0;a<b.length;a++)N[a]=b[a][0];O(b=N);break;case 2:for(a=0;a<b.length;a++)O(b[a]);break;case 3:for(b=function(ft){var It=ft.length;if(It<=1)return[ft];for(var Ot,Wt,Gt=[],ie=0;ie<It;ie++){var ae=hd(ft[ie]);ae!==0&&(Wt===void 0&&(Wt=ae<0),Wt===ae<0?(Ot&&Gt.push(Ot),Ot=[ft[ie]]):Ot.push(ft[ie]))}return Ot&&Gt.push(Ot),Gt}(b),a=0;a<b.length;a++)for(h=0;h<b[a].length;h++)O(b[a][h])}b.length===1?b=b[0]:M="Multi"+M;var nt={type:"Feature",geometry:{type:M,coordinates:b},properties:this.properties};return"id"in this&&(nt.id=this.id),nt};var tu=eu;function eu(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(cd,this,e),this.length=this._features.length}function cd(t,e,i){t===15?e.version=i.readVarint():t===1?e.name=i.readString():t===5?e.extent=i.readVarint():t===2?e._features.push(i.pos):t===3?e._keys.push(i.readString()):t===4&&e._values.push(function(a){for(var h=null,c=a.readVarint()+a.pos;a.pos<c;){var p=a.readVarint()>>3;h=p===1?a.readString():p===2?a.readFloat():p===3?a.readDouble():p===4?a.readVarint64():p===5?a.readVarint():p===6?a.readSVarint():p===7?a.readBoolean():null}return h}(i))}function ud(t,e,i){if(t===3){var a=new tu(i,i.readVarint()+i.pos);a.length&&(e[a.name]=a)}}eu.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Qc(this._pbf,e,this.extent,this._keys,this._values)};var fs={VectorTile:function(t,e){this.layers=t.readFields(ud,{},e)},VectorTileFeature:Qc,VectorTileLayer:tu},pd=fs.VectorTileFeature.types,vc=Math.pow(2,13);function fl(t,e,i,a,h,c,p,m){t.emplaceBack(e,i,2*Math.floor(a*vc)+p,h*vc*2,c*vc*2,Math.round(m))}var Zn=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Xn,this.indexArray=new lo,this.programConfigurations=new ri(t.layers,t.zoom),this.segments=new vt,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function dd(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}Zn.prototype.populate=function(t,e,i){this.features=[],this.hasPattern=gc("fill-extrusion",this.layers,e);for(var a=0,h=t;a<h.length;a+=1){var c=h[a],p=c.feature,m=c.id,b=c.index,M=c.sourceLayerIndex,O=this.layers[0]._featureFilter.needGeometry,N=dr(p,O);if(this.layers[0]._featureFilter.filter(new wi(this.zoom),N,i)){var nt={id:m,sourceLayerIndex:M,index:b,geometry:O?N.geometry:or(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(yc("fill-extrusion",this.layers,nt,this.zoom,e)):this.addFeature(nt,nt.geometry,b,i,{}),e.featureIndex.insert(p,nt.geometry,b,M,this.index,!0)}}},Zn.prototype.addFeatures=function(t,e,i){for(var a=0,h=this.features;a<h.length;a+=1){var c=h[a];this.addFeature(c,c.geometry,c.index,e,i)}},Zn.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},Zn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Zn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zn.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,sd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Zn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Zn.prototype.addFeature=function(t,e,i,a,h){for(var c=0,p=mc(e,500);c<p.length;c+=1){for(var m=p[c],b=0,M=0,O=m;M<O.length;M+=1)b+=O[M].length;for(var N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),nt=0,ft=m;nt<ft.length;nt+=1){var It=ft[nt];if(It.length!==0&&!((_i=It).every(function(di){return di.x<0})||_i.every(function(di){return di.x>8192})||_i.every(function(di){return di.y<0})||_i.every(function(di){return di.y>8192})))for(var Ot=0,Wt=0;Wt<It.length;Wt++){var Gt=It[Wt];if(Wt>=1){var ie=It[Wt-1];if(!dd(Gt,ie)){N.vertexLength+4>vt.MAX_VERTEX_ARRAY_LENGTH&&(N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var ae=Gt.sub(ie)._perp()._unit(),he=ie.dist(Gt);Ot+he>32768&&(Ot=0),fl(this.layoutVertexArray,Gt.x,Gt.y,ae.x,ae.y,0,0,Ot),fl(this.layoutVertexArray,Gt.x,Gt.y,ae.x,ae.y,0,1,Ot),fl(this.layoutVertexArray,ie.x,ie.y,ae.x,ae.y,0,0,Ot+=he),fl(this.layoutVertexArray,ie.x,ie.y,ae.x,ae.y,0,1,Ot);var ue=N.vertexLength;this.indexArray.emplaceBack(ue,ue+2,ue+1),this.indexArray.emplaceBack(ue+1,ue+2,ue+3),N.vertexLength+=4,N.primitiveLength+=2}}}}if(N.vertexLength+b>vt.MAX_VERTEX_ARRAY_LENGTH&&(N=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray)),pd[t.type]==="Polygon"){for(var _e=[],ke=[],Me=N.vertexLength,He=0,De=m;He<De.length;He+=1){var Je=De[He];if(Je.length!==0){Je!==m[0]&&ke.push(_e.length/2);for(var Re=0;Re<Je.length;Re++){var yi=Je[Re];fl(this.layoutVertexArray,yi.x,yi.y,0,0,1,1,0),_e.push(yi.x),_e.push(yi.y)}}}for(var ni=uc(_e,ke),We=0;We<ni.length;We+=3)this.indexArray.emplaceBack(Me+ni[We],Me+ni[We+2],Me+ni[We+1]);N.primitiveLength+=ni.length/3,N.vertexLength+=b}}var _i;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,h,a)},Ve("FillExtrusionBucket",Zn,{omit:["layers","features"]});var fd={paint:new Fr({"fill-extrusion-opacity":new Ye(yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xe(yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ye(yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ye(yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new os(yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xe(yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xe(yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ye(yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},md=function(t){function e(i){t.call(this,i,fd)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new Zn(i)},e.prototype.queryRadius=function(){return kr(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(i,a,h,c,p,m,b,M){var O=Wn(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,b),N=this.paint.get("fill-extrusion-height").evaluate(a,h),nt=this.paint.get("fill-extrusion-base").evaluate(a,h),ft=function(Ot,Wt,Gt,ie){for(var ae=[],he=0,ue=Ot;he<ue.length;he+=1){var _e=ue[he],ke=[_e.x,_e.y,0,1];cs(ke,ke,Wt),ae.push(new Lt(ke[0]/ke[3],ke[1]/ke[3]))}return ae}(O,M),It=function(Ot,Wt,Gt,ie){for(var ae=[],he=[],ue=ie[8]*Wt,_e=ie[9]*Wt,ke=ie[10]*Wt,Me=ie[11]*Wt,He=ie[8]*Gt,De=ie[9]*Gt,Je=ie[10]*Gt,Re=ie[11]*Gt,yi=0,ni=Ot;yi<ni.length;yi+=1){for(var We=[],_i=[],di=0,Ei=ni[yi];di<Ei.length;di+=1){var Qe=Ei[di],zi=Qe.x,ir=Qe.y,lr=ie[0]*zi+ie[4]*ir+ie[12],ar=ie[1]*zi+ie[5]*ir+ie[13],rr=ie[2]*zi+ie[6]*ir+ie[14],hr=ie[3]*zi+ie[7]*ir+ie[15],Cr=rr+ke,Ar=hr+Me,Yr=lr+He,zr=ar+De,Kr=rr+Je,fr=hr+Re,Dr=new Lt((lr+ue)/Ar,(ar+_e)/Ar);Dr.z=Cr/Ar,We.push(Dr);var Si=new Lt(Yr/fr,zr/fr);Si.z=Kr/fr,_i.push(Si)}ae.push(We),he.push(_i)}return[ae,he]}(c,nt,N,M);return function(Ot,Wt,Gt){var ie=1/0;Dn(Gt,Wt)&&(ie=iu(Gt,Wt[0]));for(var ae=0;ae<Wt.length;ae++)for(var he=Wt[ae],ue=Ot[ae],_e=0;_e<he.length-1;_e++){var ke=he[_e],Me=[ke,he[_e+1],ue[_e+1],ue[_e],ke];uo(Gt,Me)&&(ie=Math.min(ie,iu(Gt,Me)))}return ie!==1/0&&ie}(It[0],It[1],ft)},e}(Rn);function ml(t,e){return t.x*e.x+t.y*e.y}function iu(t,e){if(t.length===1){for(var i,a=0,h=e[a++];!i||h.equals(i);)if(!(i=e[a++]))return 1/0;for(;a<e.length;a++){var c=e[a],p=t[0],m=i.sub(h),b=c.sub(h),M=p.sub(h),O=ml(m,m),N=ml(m,b),nt=ml(b,b),ft=ml(M,m),It=ml(M,b),Ot=O*nt-N*N,Wt=(nt*ft-N*It)/Ot,Gt=(O*It-N*ft)/Ot,ie=h.z*(1-Wt-Gt)+i.z*Wt+c.z*Gt;if(isFinite(ie))return ie}return 1/0}for(var ae=1/0,he=0,ue=e;he<ue.length;he+=1)ae=Math.min(ae,ue[he].z);return ae}var gd=Pr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,yd=Pr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,vd=fs.VectorTileFeature.types,_d=Math.cos(Math.PI/180*37.5),ru=Math.pow(2,14)/.5,rn=function(t){var e=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){e.gradients[i.id]={}}),this.layoutVertexArray=new cn,this.layoutVertexArray2=new ia,this.indexArray=new lo,this.programConfigurations=new ri(t.layers,t.zoom),this.segments=new vt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};rn.prototype.populate=function(t,e,i){this.hasPattern=gc("line",this.layers,e);for(var a=this.layers[0].layout.get("line-sort-key"),h=[],c=0,p=t;c<p.length;c+=1){var m=p[c],b=m.feature,M=m.id,O=m.index,N=m.sourceLayerIndex,nt=this.layers[0]._featureFilter.needGeometry,ft=dr(b,nt);if(this.layers[0]._featureFilter.filter(new wi(this.zoom),ft,i)){var It=a?a.evaluate(ft,{},i):void 0,Ot={id:M,properties:b.properties,type:b.type,sourceLayerIndex:N,index:O,geometry:nt?ft.geometry:or(b),patterns:{},sortKey:It};h.push(Ot)}}a&&h.sort(function(ke,Me){return ke.sortKey-Me.sortKey});for(var Wt=0,Gt=h;Wt<Gt.length;Wt+=1){var ie=Gt[Wt],ae=ie.geometry,he=ie.index,ue=ie.sourceLayerIndex;if(this.hasPattern){var _e=yc("line",this.layers,ie,this.zoom,e);this.patternFeatures.push(_e)}else this.addFeature(ie,ae,he,i,{});e.featureIndex.insert(t[he].feature,ae,he,ue,this.index)}},rn.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},rn.prototype.addFeatures=function(t,e,i){for(var a=0,h=this.patternFeatures;a<h.length;a+=1){var c=h[a];this.addFeature(c,c.geometry,c.index,e,i)}},rn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},rn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rn.prototype.upload=function(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,yd)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},rn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},rn.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},rn.prototype.addFeature=function(t,e,i,a,h){var c=this.layers[0].layout,p=c.get("line-join").evaluate(t,{}),m=c.get("line-cap"),b=c.get("line-miter-limit"),M=c.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var O=0,N=e;O<N.length;O+=1)this.addLine(N[O],t,p,m,b,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,h,a)},rn.prototype.addLine=function(t,e,i,a,h,c){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var p=0;p<t.length-1;p++)this.totalDistance+=t[p].dist(t[p+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var m=vd[e.type]==="Polygon",b=t.length;b>=2&&t[b-1].equals(t[b-2]);)b--;for(var M=0;M<b-1&&t[M].equals(t[M+1]);)M++;if(!(b<(m?3:2))){i==="bevel"&&(h=1.05);var O,N=this.overscaling<=16?122880/(512*this.overscaling):0,nt=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray),ft=void 0,It=void 0,Ot=void 0,Wt=void 0;this.e1=this.e2=-1,m&&(Wt=t[M].sub(O=t[b-2])._unit()._perp());for(var Gt=M;Gt<b;Gt++)if(!(It=Gt===b-1?m?t[M+1]:void 0:t[Gt+1])||!t[Gt].equals(It)){Wt&&(Ot=Wt),O&&(ft=O),O=t[Gt],Wt=It?It.sub(O)._unit()._perp():Ot;var ie=(Ot=Ot||Wt).add(Wt);ie.x===0&&ie.y===0||ie._unit();var ae=Ot.x*Wt.x+Ot.y*Wt.y,he=ie.x*Wt.x+ie.y*Wt.y,ue=he!==0?1/he:1/0,_e=2*Math.sqrt(2-2*he),ke=he<_d&&ft&&It,Me=Ot.x*Wt.y-Ot.y*Wt.x>0;if(ke&&Gt>M){var He=O.dist(ft);if(He>2*N){var De=O.sub(O.sub(ft)._mult(N/He)._round());this.updateDistance(ft,De),this.addCurrentVertex(De,Ot,0,0,nt),ft=De}}var Je=ft&&It,Re=Je?i:m?"butt":a;if(Je&&Re==="round"&&(ue<c?Re="miter":ue<=2&&(Re="fakeround")),Re==="miter"&&ue>h&&(Re="bevel"),Re==="bevel"&&(ue>2&&(Re="flipbevel"),ue<h&&(Re="miter")),ft&&this.updateDistance(ft,O),Re==="miter")ie._mult(ue),this.addCurrentVertex(O,ie,0,0,nt);else if(Re==="flipbevel"){if(ue>100)ie=Wt.mult(-1);else{var yi=ue*Ot.add(Wt).mag()/Ot.sub(Wt).mag();ie._perp()._mult(yi*(Me?-1:1))}this.addCurrentVertex(O,ie,0,0,nt),this.addCurrentVertex(O,ie.mult(-1),0,0,nt)}else if(Re==="bevel"||Re==="fakeround"){var ni=-Math.sqrt(ue*ue-1),We=Me?ni:0,_i=Me?0:ni;if(ft&&this.addCurrentVertex(O,Ot,We,_i,nt),Re==="fakeround")for(var di=Math.round(180*_e/Math.PI/20),Ei=1;Ei<di;Ei++){var Qe=Ei/di;if(Qe!==.5){var zi=Qe-.5;Qe+=Qe*zi*(Qe-1)*((1.0904+ae*(ae*(3.55645-1.43519*ae)-3.2452))*zi*zi+(.848013+ae*(.215638*ae-1.06021)))}var ir=Wt.sub(Ot)._mult(Qe)._add(Ot)._unit()._mult(Me?-1:1);this.addHalfVertex(O,ir.x,ir.y,!1,Me,0,nt)}It&&this.addCurrentVertex(O,Wt,-We,-_i,nt)}else if(Re==="butt")this.addCurrentVertex(O,ie,0,0,nt);else if(Re==="square"){var lr=ft?1:-1;this.addCurrentVertex(O,ie,lr,lr,nt)}else Re==="round"&&(ft&&(this.addCurrentVertex(O,Ot,0,0,nt),this.addCurrentVertex(O,Ot,1,1,nt,!0)),It&&(this.addCurrentVertex(O,Wt,-1,-1,nt,!0),this.addCurrentVertex(O,Wt,0,0,nt)));if(ke&&Gt<b-1){var ar=O.dist(It);if(ar>2*N){var rr=O.add(It.sub(O)._mult(N/ar)._round());this.updateDistance(O,rr),this.addCurrentVertex(rr,Wt,0,0,nt),O=rr}}}}},rn.prototype.addCurrentVertex=function(t,e,i,a,h,c){c===void 0&&(c=!1);var p=e.y*a-e.x,m=-e.y-e.x*a;this.addHalfVertex(t,e.x+e.y*i,e.y-e.x*i,c,!1,i,h),this.addHalfVertex(t,p,m,c,!0,-a,h),this.distance>ru/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,e,i,a,h,c))},rn.prototype.addHalfVertex=function(t,e,i,a,h,c,p){var m=.5*(this.lineClips?this.scaledDistance*(ru-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(a?1:0),(t.y<<1)+(h?1:0),Math.round(63*e)+128,Math.round(63*i)+128,1+(c===0?0:c<0?-1:1)|(63&m)<<2,m>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var b=p.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),p.primitiveLength++),h?this.e2=b:this.e1=b},rn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},rn.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},Ve("LineBucket",rn,{omit:["layers","patternFeatures"]});var xd=new Fr({"line-cap":new Ye(yt.layout_line["line-cap"]),"line-join":new Xe(yt.layout_line["line-join"]),"line-miter-limit":new Ye(yt.layout_line["line-miter-limit"]),"line-round-limit":new Ye(yt.layout_line["line-round-limit"]),"line-sort-key":new Xe(yt.layout_line["line-sort-key"])}),nu={paint:new Fr({"line-opacity":new Xe(yt.paint_line["line-opacity"]),"line-color":new Xe(yt.paint_line["line-color"]),"line-translate":new Ye(yt.paint_line["line-translate"]),"line-translate-anchor":new Ye(yt.paint_line["line-translate-anchor"]),"line-width":new Xe(yt.paint_line["line-width"]),"line-gap-width":new Xe(yt.paint_line["line-gap-width"]),"line-offset":new Xe(yt.paint_line["line-offset"]),"line-blur":new Xe(yt.paint_line["line-blur"]),"line-dasharray":new Wr(yt.paint_line["line-dasharray"]),"line-pattern":new os(yt.paint_line["line-pattern"]),"line-gradient":new zn(yt.paint_line["line-gradient"])}),layout:xd},ou=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(i,a){return a=new wi(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),t.prototype.possiblyEvaluate.call(this,i,a)},e.prototype.evaluate=function(i,a,h,c){return a=q({},a,{zoom:Math.floor(a.zoom)}),t.prototype.evaluate.call(this,i,a,h,c)},e}(Xe))(nu.paint.properties["line-width"].specification);ou.useIntegerZoom=!0;var bd=function(t){function e(i){t.call(this,i,nu),this.gradientVersion=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof on,this.gradientVersion=(this.gradientVersion+1)%Rt)},e.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},e.prototype.recalculate=function(i,a){t.prototype.recalculate.call(this,i,a),this.paint._values["line-floorwidth"]=ou.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},e.prototype.createBucket=function(i){return new rn(i)},e.prototype.queryRadius=function(i){var a=i,h=au(Un("line-width",this,a),Un("line-gap-width",this,a)),c=Un("line-offset",this,a);return h/2+Math.abs(c)+kr(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(i,a,h,c,p,m,b){var M=Wn(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,b),O=b/2*au(this.paint.get("line-width").evaluate(a,h),this.paint.get("line-gap-width").evaluate(a,h)),N=this.paint.get("line-offset").evaluate(a,h);return N&&(c=function(nt,ft){for(var It=[],Ot=new Lt(0,0),Wt=0;Wt<nt.length;Wt++){for(var Gt=nt[Wt],ie=[],ae=0;ae<Gt.length;ae++){var he=Gt[ae],ue=Gt[ae+1],_e=ae===0?Ot:he.sub(Gt[ae-1])._unit()._perp(),ke=ae===Gt.length-1?Ot:ue.sub(he)._unit()._perp(),Me=_e._add(ke)._unit();Me._mult(1/(Me.x*ke.x+Me.y*ke.y)),ie.push(Me._mult(ft)._add(he))}It.push(ie)}return It}(c,N*b)),function(nt,ft,It){for(var Ot=0;Ot<ft.length;Ot++){var Wt=ft[Ot];if(nt.length>=3){for(var Gt=0;Gt<Wt.length;Gt++)if(jn(nt,Wt[Gt]))return!0}if(Tn(nt,Wt,It))return!0}return!1}(M,c,O)},e.prototype.isTileClipped=function(){return!0},e}(Rn);function au(t,e){return e>0?e+2*t:t}var wd=Pr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Sd=Pr([{name:"a_projected_pos",components:3,type:"Float32"}],4),Td=(Pr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Pr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),su=(Pr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),kd=Pr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Cd(t,e,i){return t.sections.forEach(function(a){a.text=function(h,c,p){var m=c.layout.get("text-transform").evaluate(p,{});return m==="uppercase"?h=h.toLocaleUpperCase():m==="lowercase"&&(h=h.toLocaleLowerCase()),mn.applyArabicShaping&&(h=mn.applyArabicShaping(h)),h}(a.text,e,i)}),t}Pr([{name:"triangle",components:3,type:"Uint16"}]),Pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Pr([{type:"Float32",name:"offsetX"}]),Pr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var gl={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},lu=function(t,e,i,a,h){var c,p,m=8*h-a-1,b=(1<<m)-1,M=b>>1,O=-7,N=i?h-1:0,nt=i?-1:1,ft=t[e+N];for(N+=nt,c=ft&(1<<-O)-1,ft>>=-O,O+=m;O>0;c=256*c+t[e+N],N+=nt,O-=8);for(p=c&(1<<-O)-1,c>>=-O,O+=a;O>0;p=256*p+t[e+N],N+=nt,O-=8);if(c===0)c=1-M;else{if(c===b)return p?NaN:1/0*(ft?-1:1);p+=Math.pow(2,a),c-=M}return(ft?-1:1)*p*Math.pow(2,c-a)},hu=function(t,e,i,a,h,c){var p,m,b,M=8*c-h-1,O=(1<<M)-1,N=O>>1,nt=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,ft=a?0:c-1,It=a?1:-1,Ot=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(m=isNaN(e)?1:0,p=O):(p=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-p))<1&&(p--,b*=2),(e+=p+N>=1?nt/b:nt*Math.pow(2,1-N))*b>=2&&(p++,b/=2),p+N>=O?(m=0,p=O):p+N>=1?(m=(e*b-1)*Math.pow(2,h),p+=N):(m=e*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;t[i+ft]=255&m,ft+=It,m/=256,h-=8);for(p=p<<h|m,M+=h;M>0;t[i+ft]=255&p,ft+=It,p/=256,M-=8);t[i+ft-It]|=128*Ot},vh=Ji;function Ji(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Ji.Varint=0,Ji.Fixed64=1,Ji.Bytes=2,Ji.Fixed32=5;var cu=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Vo(t){return t.type===Ji.Bytes?t.readVarint()+t.pos:t.pos+1}function ms(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function uu(t,e,i){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(a);for(var h=i.pos-1;h>=t;h--)i.buf[h+a]=i.buf[h]}function Ad(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Ed(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function Md(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function Pd(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function Id(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function Ld(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function zd(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function Dd(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function Od(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function _h(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function gs(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function pu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Bd(t,e,i){t===1&&i.readMessage(Rd,e)}function Rd(t,e,i){if(t===3){var a=i.readMessage(Fd,{}),h=a.width,c=a.height,p=a.left,m=a.top,b=a.advance;e.push({id:a.id,bitmap:new Ba({width:h+6,height:c+6},a.bitmap),metrics:{width:h,height:c,left:p,top:m,advance:b}})}}function Fd(t,e,i){t===1?e.id=i.readVarint():t===2?e.bitmap=i.readBytes():t===3?e.width=i.readVarint():t===4?e.height=i.readVarint():t===5?e.left=i.readSVarint():t===6?e.top=i.readSVarint():t===7&&(e.advance=i.readVarint())}function du(t){for(var e=0,i=0,a=0,h=t;a<h.length;a+=1){var c=h[a];e+=c.w*c.h,i=Math.max(i,c.w)}t.sort(function(Ot,Wt){return Wt.h-Ot.h});for(var p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}],m=0,b=0,M=0,O=t;M<O.length;M+=1)for(var N=O[M],nt=p.length-1;nt>=0;nt--){var ft=p[nt];if(!(N.w>ft.w||N.h>ft.h)){if(N.x=ft.x,N.y=ft.y,b=Math.max(b,N.y+N.h),m=Math.max(m,N.x+N.w),N.w===ft.w&&N.h===ft.h){var It=p.pop();nt<p.length&&(p[nt]=It)}else N.h===ft.h?(ft.x+=N.w,ft.w-=N.w):N.w===ft.w?(ft.y+=N.h,ft.h-=N.h):(p.push({x:ft.x+N.w,y:ft.y,w:ft.w-N.w,h:N.h}),ft.y+=N.h,ft.h-=N.h);break}}return{w:m,h:b,fill:e/(m*b)||0}}Ji.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var a=this.readVarint(),h=a>>3,c=this.pos;this.type=7&a,t(h,e,this),this.pos===c&&this.skip(a)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=_h(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=pu(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=_h(this.buf,this.pos)+4294967296*_h(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=_h(this.buf,this.pos)+4294967296*pu(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=lu(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=lu(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,a=this.buf;return e=127&(i=a[this.pos++]),i<128?e:(e|=(127&(i=a[this.pos++]))<<7,i<128?e:(e|=(127&(i=a[this.pos++]))<<14,i<128?e:(e|=(127&(i=a[this.pos++]))<<21,i<128?e:function(h,c,p){var m,b,M=p.buf;if(m=(112&(b=M[p.pos++]))>>4,b<128||(m|=(127&(b=M[p.pos++]))<<3,b<128)||(m|=(127&(b=M[p.pos++]))<<10,b<128)||(m|=(127&(b=M[p.pos++]))<<17,b<128)||(m|=(127&(b=M[p.pos++]))<<24,b<128)||(m|=(1&(b=M[p.pos++]))<<31,b<128))return ms(h,m,c);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=a[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&cu?function(i,a,h){return cu.decode(i.subarray(a,h))}(this.buf,e,t):function(i,a,h){for(var c="",p=a;p<h;){var m,b,M,O=i[p],N=null,nt=O>239?4:O>223?3:O>191?2:1;if(p+nt>h)break;nt===1?O<128&&(N=O):nt===2?(192&(m=i[p+1]))==128&&(N=(31&O)<<6|63&m)<=127&&(N=null):nt===3?(b=i[p+2],(192&(m=i[p+1]))==128&&(192&b)==128&&((N=(15&O)<<12|(63&m)<<6|63&b)<=2047||N>=55296&&N<=57343)&&(N=null)):nt===4&&(b=i[p+2],M=i[p+3],(192&(m=i[p+1]))==128&&(192&b)==128&&(192&M)==128&&((N=(15&O)<<18|(63&m)<<12|(63&b)<<6|63&M)<=65535||N>=1114112)&&(N=null)),N===null?(N=65533,nt=1):N>65535&&(N-=65536,c+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),c+=String.fromCharCode(N),p+=nt}return c}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Ji.Bytes)return t.push(this.readVarint(e));var i=Vo(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Ji.Bytes)return t.push(this.readSVarint());var e=Vo(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ji.Bytes)return t.push(this.readBoolean());var e=Vo(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ji.Bytes)return t.push(this.readFloat());var e=Vo(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ji.Bytes)return t.push(this.readDouble());var e=Vo(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ji.Bytes)return t.push(this.readFixed32());var e=Vo(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ji.Bytes)return t.push(this.readSFixed32());var e=Vo(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ji.Bytes)return t.push(this.readFixed64());var e=Vo(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ji.Bytes)return t.push(this.readSFixed64());var e=Vo(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Ji.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ji.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ji.Fixed32)this.pos+=4;else{if(e!==Ji.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),gs(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),gs(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),gs(this.buf,-1&t,this.pos),gs(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),gs(this.buf,-1&t,this.pos),gs(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,i){var a,h;if(e>=0?(a=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(c,p,m){m.buf[m.pos++]=127&c|128,c>>>=7,m.buf[m.pos++]=127&c|128,c>>>=7,m.buf[m.pos++]=127&c|128,c>>>=7,m.buf[m.pos++]=127&c|128,m.buf[m.pos]=127&(c>>>=7)}(a,0,i),function(c,p){var m=(7&c)<<4;p.buf[p.pos++]|=m|((c>>>=3)?128:0),c&&(p.buf[p.pos++]=127&c|((c>>>=7)?128:0),c&&(p.buf[p.pos++]=127&c|((c>>>=7)?128:0),c&&(p.buf[p.pos++]=127&c|((c>>>=7)?128:0),c&&(p.buf[p.pos++]=127&c|((c>>>=7)?128:0),c&&(p.buf[p.pos++]=127&c)))))}(h,i)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(a,h,c){for(var p,m,b=0;b<h.length;b++){if((p=h.charCodeAt(b))>55295&&p<57344){if(!m){p>56319||b+1===h.length?(a[c++]=239,a[c++]=191,a[c++]=189):m=p;continue}if(p<56320){a[c++]=239,a[c++]=191,a[c++]=189,m=p;continue}p=m-55296<<10|p-56320|65536,m=null}else m&&(a[c++]=239,a[c++]=191,a[c++]=189,m=null);p<128?a[c++]=p:(p<2048?a[c++]=p>>6|192:(p<65536?a[c++]=p>>12|224:(a[c++]=p>>18|240,a[c++]=p>>12&63|128),a[c++]=p>>6&63|128),a[c++]=63&p|128)}return c}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&uu(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),hu(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),hu(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var a=this.pos-i;a>=128&&uu(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeMessage:function(t,e,i){this.writeTag(t,Ji.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Ad,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Ed,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Id,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Md,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Pd,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Ld,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,zd,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Dd,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Od,e)},writeBytesField:function(t,e){this.writeTag(t,Ji.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ji.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ji.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ji.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ji.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ji.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ji.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ji.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ji.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ji.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var xh=function(t,e){var i=e.pixelRatio,a=e.version,h=e.stretchX,c=e.stretchY,p=e.content;this.paddedRect=t,this.pixelRatio=i,this.stretchX=h,this.stretchY=c,this.content=p,this.version=a},yl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};yl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},yl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},yl.tlbr.get=function(){return this.tl.concat(this.br)},yl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(xh.prototype,yl);var vl=function(t,e){var i={},a={};this.haveRenderCallbacks=[];var h=[];this.addImages(t,i,h),this.addImages(e,a,h);var c=du(h),p=new pn({width:c.w||1,height:c.h||1});for(var m in t){var b=t[m],M=i[m].paddedRect;pn.copy(b.data,p,{x:0,y:0},{x:M.x+1,y:M.y+1},b.data)}for(var O in e){var N=e[O],nt=a[O].paddedRect,ft=nt.x+1,It=nt.y+1,Ot=N.data.width,Wt=N.data.height;pn.copy(N.data,p,{x:0,y:0},{x:ft,y:It},N.data),pn.copy(N.data,p,{x:0,y:Wt-1},{x:ft,y:It-1},{width:Ot,height:1}),pn.copy(N.data,p,{x:0,y:0},{x:ft,y:It+Wt},{width:Ot,height:1}),pn.copy(N.data,p,{x:Ot-1,y:0},{x:ft-1,y:It},{width:1,height:Wt}),pn.copy(N.data,p,{x:0,y:0},{x:ft+Ot,y:It},{width:1,height:Wt})}this.image=p,this.iconPositions=i,this.patternPositions=a};vl.prototype.addImages=function(t,e,i){for(var a in t){var h=t[a],c={x:0,y:0,w:h.data.width+2,h:h.data.height+2};i.push(c),e[a]=new xh(c,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(a)}},vl.prototype.patchUpdatedImages=function(t,e){for(var i in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[i],t.getImage(i),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i),e)},vl.prototype.patchUpdatedImage=function(t,e,i){if(t&&e&&t.version!==e.version){t.version=e.version;var a=t.tl;i.update(e.data,void 0,{x:a[0],y:a[1]})}},Ve("ImagePosition",xh),Ve("ImageAtlas",vl);var kn={horizontal:1,vertical:2,horizontalOnly:3},ys=function(){this.scale=1,this.fontStack="",this.imageName=null};ys.forText=function(t,e){var i=new ys;return i.scale=t||1,i.fontStack=e,i},ys.forImage=function(t){var e=new ys;return e.imageName=t,e};var Zr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function bh(t,e,i,a,h,c,p,m,b,M,O,N,nt,ft,It,Ot){var Wt,Gt=Zr.fromFeature(t,h);N===kn.vertical&&Gt.verticalizePunctuation();var ie=mn.processBidirectionalText,ae=mn.processStyledBidirectionalText;if(ie&&Gt.sections.length===1){Wt=[];for(var he=0,ue=ie(Gt.toString(),_c(Gt,M,c,e,a,ft,It));he<ue.length;he+=1){var _e=ue[he],ke=new Zr;ke.text=_e,ke.sections=Gt.sections;for(var Me=0;Me<_e.length;Me++)ke.sectionIndex.push(0);Wt.push(ke)}}else if(ae){Wt=[];for(var He=0,De=ae(Gt.text,Gt.sectionIndex,_c(Gt,M,c,e,a,ft,It));He<De.length;He+=1){var Je=De[He],Re=new Zr;Re.text=Je[0],Re.sectionIndex=Je[1],Re.sections=Gt.sections,Wt.push(Re)}}else Wt=function(We,_i){for(var di=[],Ei=We.text,Qe=0,zi=0,ir=_i;zi<ir.length;zi+=1){var lr=ir[zi];di.push(We.substring(Qe,lr)),Qe=lr}return Qe<Ei.length&&di.push(We.substring(Qe,Ei.length)),di}(Gt,_c(Gt,M,c,e,a,ft,It));var yi=[],ni={positionedLines:yi,text:Gt.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:N,iconsInText:!1,verticalizable:!1};return function(We,_i,di,Ei,Qe,zi,ir,lr,ar,rr,hr,Cr){for(var Ar=0,Yr=-17,zr=0,Kr=0,fr=lr==="right"?1:lr==="left"?0:.5,Dr=0,Si=0,Zi=Qe;Si<Zi.length;Si+=1){var Ui=Zi[Si];Ui.trim();var Pi=Ui.getMaxScale(),nn=24*(Pi-1),Ur={positionedGlyphs:[],lineOffset:0};We.positionedLines[Dr]=Ur;var $i=Ur.positionedGlyphs,_r=0;if(Ui.length()){for(var Nr=0;Nr<Ui.length();Nr++){var Di=Ui.getSection(Nr),mo=Ui.getSectionIndex(Nr),Cn=Ui.getCharCode(Nr),go=0,mr=null,yo=null,Nn=null,ks=24,Ua=!(ar===kn.horizontal||!hr&&!is(Cn)||hr&&(wh[Cn]||(Wo=Cn,Ie.Arabic(Wo)||Ie["Arabic Supplement"](Wo)||Ie["Arabic Extended-A"](Wo)||Ie["Arabic Presentation Forms-A"](Wo)||Ie["Arabic Presentation Forms-B"](Wo))));if(Di.imageName){var Cs=Ei[Di.imageName];if(!Cs)continue;Nn=Di.imageName,We.iconsInText=We.iconsInText||!0,yo=Cs.paddedRect;var Xo=Cs.displaySize;Di.scale=24*Di.scale/Cr,go=nn+(24-Xo[1]*Di.scale),ks=(mr={width:Xo[0],height:Xo[1],left:1,top:-3,advance:Ua?Xo[1]:Xo[0]}).advance;var As=Ua?Xo[0]*Di.scale-24*Pi:Xo[1]*Di.scale-24*Pi;As>0&&As>_r&&(_r=As)}else{var Ih=di[Di.fontStack],Es=Ih&&Ih[Cn];if(Es&&Es.rect)yo=Es.rect,mr=Es.metrics;else{var bl=_i[Di.fontStack],Lh=bl&&bl[Cn];if(!Lh)continue;mr=Lh.metrics}go=24*(Pi-Di.scale)}Ua?(We.verticalizable=!0,$i.push({glyph:Cn,imageName:Nn,x:Ar,y:Yr+go,vertical:Ua,scale:Di.scale,fontStack:Di.fontStack,sectionIndex:mo,metrics:mr,rect:yo}),Ar+=ks*Di.scale+rr):($i.push({glyph:Cn,imageName:Nn,x:Ar,y:Yr+go,vertical:Ua,scale:Di.scale,fontStack:Di.fontStack,sectionIndex:mo,metrics:mr,rect:yo}),Ar+=mr.advance*Di.scale+rr)}$i.length!==0&&(zr=Math.max(Ar-rr,zr),Ud($i,0,$i.length-1,fr,_r)),Ar=0;var zh=zi*Pi+_r;Ur.lineOffset=Math.max(_r,nn),Yr+=zh,Kr=Math.max(zh,Kr),++Dr}else Yr+=zi,++Dr}var Wo,wl=Yr- -17,Ms=xc(ir),ca=Ms.horizontalAlign,Ps=Ms.verticalAlign;(function(Dh,Oh,Sl,Tl,Bh,kl,Cl,Al,Rh){var Is,Fh=(Oh-Sl)*Bh;Is=kl!==Cl?-Al*Tl- -17:(-Tl*Rh+.5)*Cl;for(var Ls=0,El=Dh;Ls<El.length;Ls+=1)for(var Na=0,Ml=El[Ls].positionedGlyphs;Na<Ml.length;Na+=1){var zs=Ml[Na];zs.x+=Fh,zs.y+=Is}})(We.positionedLines,fr,ca,Ps,zr,Kr,zi,wl,Qe.length),We.top+=-Ps*wl,We.bottom=We.top+wl,We.left+=-ca*zr,We.right=We.left+zr}(ni,e,i,a,Wt,p,m,b,N,M,nt,Ot),!function(We){for(var _i=0,di=We;_i<di.length;_i+=1)if(di[_i].positionedGlyphs.length!==0)return!1;return!0}(yi)&&ni}Zr.fromFeature=function(t,e){for(var i=new Zr,a=0;a<t.sections.length;a++){var h=t.sections[a];h.image?i.addImageSection(h):i.addTextSection(h,e)}return i},Zr.prototype.length=function(){return this.text.length},Zr.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},Zr.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},Zr.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},Zr.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",i=0;i<t.length;i++){var a=t.charCodeAt(i+1)||null,h=t.charCodeAt(i-1)||null;e+=a&&el(a)&&!gl[t[i+1]]||h&&el(h)&&!gl[t[i-1]]||!gl[t[i]]?t[i]:gl[t[i]]}return e}(this.text)},Zr.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&wh[this.text.charCodeAt(e)];e++)t++;for(var i=this.text.length,a=this.text.length-1;a>=0&&a>=t&&wh[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)},Zr.prototype.substring=function(t,e){var i=new Zr;return i.text=this.text.substring(t,e),i.sectionIndex=this.sectionIndex.slice(t,e),i.sections=this.sections,i},Zr.prototype.toString=function(){return this.text},Zr.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,i){return Math.max(e,t.sections[i].scale)},0)},Zr.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(ys.forText(t.scale,t.fontStack||e));for(var i=this.sections.length-1,a=0;a<t.text.length;++a)this.sectionIndex.push(i)},Zr.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(e.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(ys.forImage(e)),this.sectionIndex.push(this.sections.length-1)):z("Reached maximum number of images 6401")}else z("Can't add FormattedSection with an empty image.")},Zr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var wh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},yn={};function fu(t,e,i,a,h,c){if(e.imageName){var p=a[e.imageName];return p?p.displaySize[0]*e.scale*24/c+h:0}var m=i[e.fontStack],b=m&&m[t];return b?b.metrics.advance*e.scale+h:0}function mu(t,e,i,a){var h=Math.pow(t-e,2);return a?t<e?h/2:2*h:h+Math.abs(i)*i}function jd(t,e,i){var a=0;return t===10&&(a-=1e4),i&&(a+=150),t!==40&&t!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function gu(t,e,i,a,h,c){for(var p=null,m=mu(e,i,h,c),b=0,M=a;b<M.length;b+=1){var O=M[b],N=mu(e-O.x,i,h,c)+O.badness;N<=m&&(p=O,m=N)}return{index:t,x:e,priorBreak:p,badness:m}}function _c(t,e,i,a,h,c,p){if(c!=="point")return[];if(!t)return[];for(var m,b=[],M=function(Wt,Gt,ie,ae,he,ue){for(var _e=0,ke=0;ke<Wt.length();ke++){var Me=Wt.getSection(ke);_e+=fu(Wt.getCharCode(ke),Me,ae,he,Gt,ue)}return _e/Math.max(1,Math.ceil(_e/ie))}(t,e,i,a,h,p),O=t.text.indexOf("​")>=0,N=0,nt=0;nt<t.length();nt++){var ft=t.getSection(nt),It=t.getCharCode(nt);if(wh[It]||(N+=fu(It,ft,a,h,e,p)),nt<t.length()-1){var Ot=!((m=It)<11904||!(Ie["Bopomofo Extended"](m)||Ie.Bopomofo(m)||Ie["CJK Compatibility Forms"](m)||Ie["CJK Compatibility Ideographs"](m)||Ie["CJK Compatibility"](m)||Ie["CJK Radicals Supplement"](m)||Ie["CJK Strokes"](m)||Ie["CJK Symbols and Punctuation"](m)||Ie["CJK Unified Ideographs Extension A"](m)||Ie["CJK Unified Ideographs"](m)||Ie["Enclosed CJK Letters and Months"](m)||Ie["Halfwidth and Fullwidth Forms"](m)||Ie.Hiragana(m)||Ie["Ideographic Description Characters"](m)||Ie["Kangxi Radicals"](m)||Ie["Katakana Phonetic Extensions"](m)||Ie.Katakana(m)||Ie["Vertical Forms"](m)||Ie["Yi Radicals"](m)||Ie["Yi Syllables"](m)));(yn[It]||Ot||ft.imageName)&&b.push(gu(nt+1,N,M,b,jd(It,t.getCharCode(nt+1),Ot&&O),!1))}}return function Wt(Gt){return Gt?Wt(Gt.priorBreak).concat(Gt.index):[]}(gu(t.length(),N,M,b,0,!0))}function xc(t){var e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function Ud(t,e,i,a,h){if(a||h)for(var c=t[i],p=(t[i].x+c.metrics.advance*c.scale)*a,m=e;m<=i;m++)t[m].x-=p,t[m].y+=h}function yu(t,e,i,a,h,c){var p,m=t.image;if(m.content){var b=m.content,M=m.pixelRatio||1;p=[b[0]/M,b[1]/M,m.displaySize[0]-b[2]/M,m.displaySize[1]-b[3]/M]}var O,N,nt,ft,It=e.left*c,Ot=e.right*c;i==="width"||i==="both"?(ft=h[0]+It-a[3],N=h[0]+Ot+a[1]):N=(ft=h[0]+(It+Ot-m.displaySize[0])/2)+m.displaySize[0];var Wt=e.top*c,Gt=e.bottom*c;return i==="height"||i==="both"?(O=h[1]+Wt-a[0],nt=h[1]+Gt+a[2]):nt=(O=h[1]+(Wt+Gt-m.displaySize[1])/2)+m.displaySize[1],{image:m,top:O,right:N,bottom:nt,left:ft,collisionPadding:p}}yn[10]=!0,yn[32]=!0,yn[38]=!0,yn[40]=!0,yn[41]=!0,yn[43]=!0,yn[45]=!0,yn[47]=!0,yn[173]=!0,yn[183]=!0,yn[8203]=!0,yn[8208]=!0,yn[8211]=!0,yn[8231]=!0;var vs=function(t){function e(i,a,h,c){t.call(this,i,a),this.angle=h,c!==void 0&&(this.segment=c)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(Lt);function bc(t,e){var i=e.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new wi(t+1))};if(i.kind==="source")return{kind:"source"};for(var a=i.zoomStops,h=i.interpolationType,c=0;c<a.length&&a[c]<=t;)c++;for(var p=c=Math.max(0,c-1);p<a.length&&a[p]<t+1;)p++;p=Math.min(a.length-1,p);var m=a[c],b=a[p];return i.kind==="composite"?{kind:"composite",minZoom:m,maxZoom:b,interpolationType:h}:{kind:"camera",minZoom:m,maxZoom:b,minSize:i.evaluate(new wi(m)),maxSize:i.evaluate(new wi(b)),interpolationType:h}}function vu(t,e,i){var a=e.uSize,h=i.lowerSize;return t.kind==="source"?h/128:t.kind==="composite"?yr(h/128,i.upperSize/128,e.uSizeT):a}function _u(t,e){var i=0,a=0;if(t.kind==="constant")a=t.layoutSize;else if(t.kind!=="source"){var h=t.interpolationType,c=h?at(Br.interpolationFactor(h,e,t.minZoom,t.maxZoom),0,1):0;t.kind==="camera"?a=yr(t.minSize,t.maxSize,c):i=c}return{uSizeT:i,uSize:a}}Ve("Anchor",vs);var Nd=Object.freeze({__proto__:null,getSizeData:bc,evaluateSizeForFeature:vu,evaluateSizeForZoom:_u,SIZE_PACK_FACTOR:128});function xu(t,e,i,a,h){if(e.segment===void 0)return!0;for(var c=e,p=e.segment+1,m=0;m>-i/2;){if(--p<0)return!1;m-=t[p].dist(c),c=t[p]}m+=t[p].dist(t[p+1]),p++;for(var b=[],M=0;m<i/2;){var O=t[p],N=t[p+1];if(!N)return!1;var nt=t[p-1].angleTo(O)-O.angleTo(N);for(nt=Math.abs((nt+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:m,angleDelta:nt}),M+=nt;m-b[0].distance>a;)M-=b.shift().angleDelta;if(M>h)return!1;p++,m+=O.dist(N)}return!0}function bu(t){for(var e=0,i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function wu(t,e,i){return t?.6*e*i:0}function Su(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Vd(t,e,i,a,h,c){for(var p=wu(i,h,c),m=Su(i,a)*c,b=0,M=bu(t)/2,O=0;O<t.length-1;O++){var N=t[O],nt=t[O+1],ft=N.dist(nt);if(b+ft>M){var It=(M-b)/ft,Ot=yr(N.x,nt.x,It),Wt=yr(N.y,nt.y,It),Gt=new vs(Ot,Wt,nt.angleTo(N),O);return Gt._round(),!p||xu(t,Gt,m,p,e)?Gt:void 0}b+=ft}}function Gd(t,e,i,a,h,c,p,m,b){var M=wu(a,c,p),O=Su(a,h),N=O*p,nt=t[0].x===0||t[0].x===b||t[0].y===0||t[0].y===b;return e-N<e/4&&(e=N+e/4),function ft(It,Ot,Wt,Gt,ie,ae,he,ue,_e){for(var ke=ae/2,Me=bu(It),He=0,De=Ot-Wt,Je=[],Re=0;Re<It.length-1;Re++){for(var yi=It[Re],ni=It[Re+1],We=yi.dist(ni),_i=ni.angleTo(yi);De+Wt<He+We;){var di=((De+=Wt)-He)/We,Ei=yr(yi.x,ni.x,di),Qe=yr(yi.y,ni.y,di);if(Ei>=0&&Ei<_e&&Qe>=0&&Qe<_e&&De-ke>=0&&De+ke<=Me){var zi=new vs(Ei,Qe,_i,Re);zi._round(),Gt&&!xu(It,zi,ae,Gt,ie)||Je.push(zi)}}He+=We}return ue||Je.length||he||(Je=ft(It,He/2,Wt,Gt,ie,ae,he,!0,_e)),Je}(t,nt?e/2*m%e:(O/2+2*c)*p*m%e,e,M,i,N,nt,!1,b)}function Tu(t,e,i,a,h){for(var c=[],p=0;p<t.length;p++)for(var m=t[p],b=void 0,M=0;M<m.length-1;M++){var O=m[M],N=m[M+1];O.x<e&&N.x<e||(O.x<e?O=new Lt(e,O.y+(e-O.x)/(N.x-O.x)*(N.y-O.y))._round():N.x<e&&(N=new Lt(e,O.y+(e-O.x)/(N.x-O.x)*(N.y-O.y))._round()),O.y<i&&N.y<i||(O.y<i?O=new Lt(O.x+(i-O.y)/(N.y-O.y)*(N.x-O.x),i)._round():N.y<i&&(N=new Lt(O.x+(i-O.y)/(N.y-O.y)*(N.x-O.x),i)._round()),O.x>=a&&N.x>=a||(O.x>=a?O=new Lt(a,O.y+(a-O.x)/(N.x-O.x)*(N.y-O.y))._round():N.x>=a&&(N=new Lt(a,O.y+(a-O.x)/(N.x-O.x)*(N.y-O.y))._round()),O.y>=h&&N.y>=h||(O.y>=h?O=new Lt(O.x+(h-O.y)/(N.y-O.y)*(N.x-O.x),h)._round():N.y>=h&&(N=new Lt(O.x+(h-O.y)/(N.y-O.y)*(N.x-O.x),h)._round()),b&&O.equals(b[b.length-1])||c.push(b=[O]),b.push(N)))))}return c}function ku(t,e,i,a){var h=[],c=t.image,p=c.pixelRatio,m=c.paddedRect.w-2,b=c.paddedRect.h-2,M=t.right-t.left,O=t.bottom-t.top,N=c.stretchX||[[0,m]],nt=c.stretchY||[[0,b]],ft=function(Ei,Qe){return Ei+Qe[1]-Qe[0]},It=N.reduce(ft,0),Ot=nt.reduce(ft,0),Wt=m-It,Gt=b-Ot,ie=0,ae=It,he=0,ue=Ot,_e=0,ke=Wt,Me=0,He=Gt;if(c.content&&a){var De=c.content;ie=Sh(N,0,De[0]),he=Sh(nt,0,De[1]),ae=Sh(N,De[0],De[2]),ue=Sh(nt,De[1],De[3]),_e=De[0]-ie,Me=De[1]-he,ke=De[2]-De[0]-ae,He=De[3]-De[1]-ue}var Je=function(Ei,Qe,zi,ir){var lr=Th(Ei.stretch-ie,ae,M,t.left),ar=kh(Ei.fixed-_e,ke,Ei.stretch,It),rr=Th(Qe.stretch-he,ue,O,t.top),hr=kh(Qe.fixed-Me,He,Qe.stretch,Ot),Cr=Th(zi.stretch-ie,ae,M,t.left),Ar=kh(zi.fixed-_e,ke,zi.stretch,It),Yr=Th(ir.stretch-he,ue,O,t.top),zr=kh(ir.fixed-Me,He,ir.stretch,Ot),Kr=new Lt(lr,rr),fr=new Lt(Cr,rr),Dr=new Lt(Cr,Yr),Si=new Lt(lr,Yr),Zi=new Lt(ar/p,hr/p),Ui=new Lt(Ar/p,zr/p),Pi=e*Math.PI/180;if(Pi){var nn=Math.sin(Pi),Ur=Math.cos(Pi),$i=[Ur,-nn,nn,Ur];Kr._matMult($i),fr._matMult($i),Si._matMult($i),Dr._matMult($i)}var _r=Ei.stretch+Ei.fixed,Nr=Qe.stretch+Qe.fixed;return{tl:Kr,tr:fr,bl:Si,br:Dr,tex:{x:c.paddedRect.x+1+_r,y:c.paddedRect.y+1+Nr,w:zi.stretch+zi.fixed-_r,h:ir.stretch+ir.fixed-Nr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Zi,pixelOffsetBR:Ui,minFontScaleX:ke/p/M,minFontScaleY:He/p/O,isSDF:i}};if(a&&(c.stretchX||c.stretchY))for(var Re=Cu(N,Wt,It),yi=Cu(nt,Gt,Ot),ni=0;ni<Re.length-1;ni++)for(var We=Re[ni],_i=Re[ni+1],di=0;di<yi.length-1;di++)h.push(Je(We,yi[di],_i,yi[di+1]));else h.push(Je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:m+1},{fixed:0,stretch:b+1}));return h}function Sh(t,e,i){for(var a=0,h=0,c=t;h<c.length;h+=1){var p=c[h];a+=Math.max(e,Math.min(i,p[1]))-Math.max(e,Math.min(i,p[0]))}return a}function Cu(t,e,i){for(var a=[{fixed:-1,stretch:0}],h=0,c=t;h<c.length;h+=1){var p=c[h],m=p[0],b=p[1],M=a[a.length-1];a.push({fixed:m-M.stretch,stretch:M.stretch}),a.push({fixed:m-M.stretch,stretch:M.stretch+(b-m)})}return a.push({fixed:e+1,stretch:i}),a}function Th(t,e,i,a){return t/e*i+a}function kh(t,e,i,a){return t-e*i/a}var Ch=function(t,e,i,a,h,c,p,m,b,M){if(this.boxStartIndex=t.length,b){var O=c.top,N=c.bottom,nt=c.collisionPadding;nt&&(O-=nt[1],N+=nt[3]);var ft=N-O;ft>0&&(ft=Math.max(10,ft),this.circleDiameter=ft)}else{var It=c.top*p-m,Ot=c.bottom*p+m,Wt=c.left*p-m,Gt=c.right*p+m,ie=c.collisionPadding;if(ie&&(Wt-=ie[0]*p,It-=ie[1]*p,Gt+=ie[2]*p,Ot+=ie[3]*p),M){var ae=new Lt(Wt,It),he=new Lt(Gt,It),ue=new Lt(Wt,Ot),_e=new Lt(Gt,Ot),ke=M*Math.PI/180;ae._rotate(ke),he._rotate(ke),ue._rotate(ke),_e._rotate(ke),Wt=Math.min(ae.x,he.x,ue.x,_e.x),Gt=Math.max(ae.x,he.x,ue.x,_e.x),It=Math.min(ae.y,he.y,ue.y,_e.y),Ot=Math.max(ae.y,he.y,ue.y,_e.y)}t.emplaceBack(e.x,e.y,Wt,It,Gt,Ot,i,a,h)}this.boxEndIndex=t.length},_s=function(t,e){if(t===void 0&&(t=[]),e===void 0&&(e=qd),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function qd(t,e){return t<e?-1:t>e?1:0}function Xd(t,e,i){e===void 0&&(e=1),i===void 0&&(i=!1);for(var a=1/0,h=1/0,c=-1/0,p=-1/0,m=t[0],b=0;b<m.length;b++){var M=m[b];(!b||M.x<a)&&(a=M.x),(!b||M.y<h)&&(h=M.y),(!b||M.x>c)&&(c=M.x),(!b||M.y>p)&&(p=M.y)}var O=Math.min(c-a,p-h),N=O/2,nt=new _s([],Wd);if(O===0)return new Lt(a,h);for(var ft=a;ft<c;ft+=O)for(var It=h;It<p;It+=O)nt.push(new xs(ft+N,It+N,N,t));for(var Ot=function(ie){for(var ae=0,he=0,ue=0,_e=ie[0],ke=0,Me=_e.length,He=Me-1;ke<Me;He=ke++){var De=_e[ke],Je=_e[He],Re=De.x*Je.y-Je.x*De.y;he+=(De.x+Je.x)*Re,ue+=(De.y+Je.y)*Re,ae+=3*Re}return new xs(he/ae,ue/ae,0,ie)}(t),Wt=nt.length;nt.length;){var Gt=nt.pop();(Gt.d>Ot.d||!Ot.d)&&(Ot=Gt,i&&console.log("found best %d after %d probes",Math.round(1e4*Gt.d)/1e4,Wt)),Gt.max-Ot.d<=e||(nt.push(new xs(Gt.p.x-(N=Gt.h/2),Gt.p.y-N,N,t)),nt.push(new xs(Gt.p.x+N,Gt.p.y-N,N,t)),nt.push(new xs(Gt.p.x-N,Gt.p.y+N,N,t)),nt.push(new xs(Gt.p.x+N,Gt.p.y+N,N,t)),Wt+=4)}return i&&(console.log("num probes: "+Wt),console.log("best distance: "+Ot.d)),Ot.p}function Wd(t,e){return e.max-t.max}function xs(t,e,i,a){this.p=new Lt(t,e),this.h=i,this.d=function(h,c){for(var p=!1,m=1/0,b=0;b<c.length;b++)for(var M=c[b],O=0,N=M.length,nt=N-1;O<N;nt=O++){var ft=M[O],It=M[nt];ft.y>h.y!=It.y>h.y&&h.x<(It.x-ft.x)*(h.y-ft.y)/(It.y-ft.y)+ft.x&&(p=!p),m=Math.min(m,aa(h,ft,It))}return(p?1:-1)*Math.sqrt(m)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}_s.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},_s.prototype.pop=function(){if(this.length!==0){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},_s.prototype.peek=function(){return this.data[0]},_s.prototype._up=function(t){for(var e=this.data,i=this.compare,a=e[t];t>0;){var h=t-1>>1,c=e[h];if(i(a,c)>=0)break;e[t]=c,t=h}e[t]=a},_s.prototype._down=function(t){for(var e=this.data,i=this.compare,a=this.length>>1,h=e[t];t<a;){var c=1+(t<<1),p=e[c],m=c+1;if(m<this.length&&i(e[m],p)<0&&(c=m,p=e[m]),i(p,h)>=0)break;e[t]=p,t=c}e[t]=h};var wc=Number.POSITIVE_INFINITY;function Au(t,e){return e[1]!==wc?function(i,a,h){var c=0,p=0;switch(a=Math.abs(a),h=Math.abs(h),i){case"top-right":case"top-left":case"top":p=h-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-h}switch(i){case"top-right":case"bottom-right":case"right":c=-a;break;case"top-left":case"bottom-left":case"left":c=a}return[c,p]}(t,e[0],e[1]):function(i,a){var h=0,c=0;a<0&&(a=0);var p=a/Math.sqrt(2);switch(i){case"top-right":case"top-left":c=p-7;break;case"bottom-right":case"bottom-left":c=7-p;break;case"bottom":c=7-a;break;case"top":c=a-7}switch(i){case"top-right":case"bottom-right":h=-p;break;case"top-left":case"bottom-left":h=p;break;case"left":h=a;break;case"right":h=-a}return[h,c]}(t,e[0])}function Sc(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Eu(t,e,i,a,h,c,p,m,b,M,O,N,nt,ft,It){var Ot=function(he,ue,_e,ke,Me,He,De,Je){for(var Re=ke.layout.get("text-rotate").evaluate(He,{})*Math.PI/180,yi=[],ni=0,We=ue.positionedLines;ni<We.length;ni+=1)for(var _i=We[ni],di=0,Ei=_i.positionedGlyphs;di<Ei.length;di+=1){var Qe=Ei[di];if(Qe.rect){var zi=Qe.rect||{},ir=4,lr=!0,ar=1,rr=0,hr=(Me||Je)&&Qe.vertical,Cr=Qe.metrics.advance*Qe.scale/2;if(Je&&ue.verticalizable&&(rr=_i.lineOffset/2-(Qe.imageName?-(24-Qe.metrics.width*Qe.scale)/2:24*(Qe.scale-1))),Qe.imageName){var Ar=De[Qe.imageName];lr=Ar.sdf,ir=1/(ar=Ar.pixelRatio)}var Yr=Me?[Qe.x+Cr,Qe.y]:[0,0],zr=Me?[0,0]:[Qe.x+Cr+_e[0],Qe.y+_e[1]-rr],Kr=[0,0];hr&&(Kr=zr,zr=[0,0]);var fr=(Qe.metrics.left-ir)*Qe.scale-Cr+zr[0],Dr=(-Qe.metrics.top-ir)*Qe.scale+zr[1],Si=fr+zi.w*Qe.scale/ar,Zi=Dr+zi.h*Qe.scale/ar,Ui=new Lt(fr,Dr),Pi=new Lt(Si,Dr),nn=new Lt(fr,Zi),Ur=new Lt(Si,Zi);if(hr){var $i=new Lt(-Cr,Cr- -17),_r=-Math.PI/2,Nr=12-Cr,Di=new Lt(22-Nr,-(Qe.imageName?Nr:0)),mo=new(Function.prototype.bind.apply(Lt,[null].concat(Kr)));Ui._rotateAround(_r,$i)._add(Di)._add(mo),Pi._rotateAround(_r,$i)._add(Di)._add(mo),nn._rotateAround(_r,$i)._add(Di)._add(mo),Ur._rotateAround(_r,$i)._add(Di)._add(mo)}if(Re){var Cn=Math.sin(Re),go=Math.cos(Re),mr=[go,-Cn,Cn,go];Ui._matMult(mr),Pi._matMult(mr),nn._matMult(mr),Ur._matMult(mr)}var yo=new Lt(0,0),Nn=new Lt(0,0);yi.push({tl:Ui,tr:Pi,bl:nn,br:Ur,tex:zi,writingMode:ue.writingMode,glyphOffset:Yr,sectionIndex:Qe.sectionIndex,isSDF:lr,pixelOffsetTL:yo,pixelOffsetBR:Nn,minFontScaleX:0,minFontScaleY:0})}}return yi}(0,i,m,h,c,p,a,t.allowVerticalPlacement),Wt=t.textSizeData,Gt=null;Wt.kind==="source"?(Gt=[128*h.layout.get("text-size").evaluate(p,{})])[0]>32640&&z(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Wt.kind==="composite"&&((Gt=[128*ft.compositeTextSizes[0].evaluate(p,{},It),128*ft.compositeTextSizes[1].evaluate(p,{},It)])[0]>32640||Gt[1]>32640)&&z(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,Ot,Gt,m,c,p,M,e,b.lineStartIndex,b.lineLength,nt,It);for(var ie=0,ae=O;ie<ae.length;ie+=1)N[ae[ie]]=t.text.placedSymbolArray.length-1;return 4*Ot.length}function Mu(t){for(var e in t)return t[e];return null}function Hd(t,e,i,a){var h=t.compareText;if(e in h){for(var c=h[e],p=c.length-1;p>=0;p--)if(a.dist(c[p])<i)return!0}else h[e]=[];return h[e].push(a),!1}var Zd=fs.VectorTileFeature.types,Yd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ah(t,e,i,a,h,c,p,m,b,M,O,N,nt){var ft=m?Math.min(32640,Math.round(m[0])):0,It=m?Math.min(32640,Math.round(m[1])):0;t.emplaceBack(e,i,Math.round(32*a),Math.round(32*h),c,p,(ft<<1)+(b?1:0),It,16*M,16*O,256*N,256*nt)}function Tc(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function Kd(t){for(var e=0,i=t.sections;e<i.length;e+=1)if(rs(i[e].text))return!0;return!1}var bs=function(t){this.layoutVertexArray=new ss,this.indexArray=new lo,this.programConfigurations=t,this.segments=new vt,this.dynamicLayoutVertexArray=new ra,this.opacityVertexArray=new Pa,this.placedSymbolArray=new s};bs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},bs.prototype.upload=function(t,e,i,a){this.isEmpty()||(i&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wd.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Sd.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Yd,!0),this.opacityVertexBuffer.itemSize=1),(i||a)&&this.programConfigurations.upload(t))},bs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Ve("SymbolBuffers",bs);var _l=function(t,e,i){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new i,this.segments=new vt,this.collisionVertexArray=new sl};_l.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Td.members,!0)},_l.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Ve("CollisionBuffers",_l);var Gi=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(c){return c.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=gn([]),this.placementViewportMatrix=gn([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=bc(this.zoom,e["text-size"]),this.iconSizeData=bc(this.zoom,e["icon-size"]);var i=this.layers[0].layout,a=i.get("symbol-sort-key"),h=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&a.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(c){return kn[c]})),this.stateDependentLayerIds=this.layers.filter(function(c){return c.isStateDependent()}).map(function(c){return c.id}),this.sourceID=t.sourceID};Gi.prototype.createArrays=function(){this.text=new bs(new ri(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new bs(new ri(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new f,this.lineVertexArray=new x,this.symbolInstances=new d},Gi.prototype.calculateGlyphDependencies=function(t,e,i,a,h){for(var c=0;c<t.length;c++)if(e[t.charCodeAt(c)]=!0,(i||a)&&h){var p=gl[t.charAt(c)];p&&(e[p.charCodeAt(0)]=!0)}},Gi.prototype.populate=function(t,e,i){var a=this.layers[0],h=a.layout,c=h.get("text-font"),p=h.get("text-field"),m=h.get("icon-image"),b=(p.value.kind!=="constant"||p.value.value instanceof Er&&!p.value.value.isEmpty()||p.value.value.toString().length>0)&&(c.value.kind!=="constant"||c.value.value.length>0),M=m.value.kind!=="constant"||!!m.value.value||Object.keys(m.parameters).length>0,O=h.get("symbol-sort-key");if(this.features=[],b||M){for(var N=e.iconDependencies,nt=e.glyphDependencies,ft=e.availableImages,It=new wi(this.zoom),Ot=0,Wt=t;Ot<Wt.length;Ot+=1){var Gt=Wt[Ot],ie=Gt.feature,ae=Gt.id,he=Gt.index,ue=Gt.sourceLayerIndex,_e=a._featureFilter.needGeometry,ke=dr(ie,_e);if(a._featureFilter.filter(It,ke,i)){_e||(ke.geometry=or(ie));var Me=void 0;if(b){var He=a.getValueAndResolveTokens("text-field",ke,i,ft),De=Er.factory(He);Kd(De)&&(this.hasRTLText=!0),(!this.hasRTLText||rl()==="unavailable"||this.hasRTLText&&mn.isParsed())&&(Me=Cd(De,a,ke))}var Je=void 0;if(M){var Re=a.getValueAndResolveTokens("icon-image",ke,i,ft);Je=Re instanceof Qr?Re:Qr.fromString(Re)}if(Me||Je){var yi=this.sortFeaturesByKey?O.evaluate(ke,{},i):void 0;if(this.features.push({id:ae,text:Me,icon:Je,index:he,sourceLayerIndex:ue,geometry:ke.geometry,properties:ie.properties,type:Zd[ie.type],sortKey:yi}),Je&&(N[Je.name]=!0),Me){var ni=c.evaluate(ke,{},i).join(","),We=h.get("text-rotation-alignment")==="map"&&h.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(kn.vertical)>=0;for(var _i=0,di=Me.sections;_i<di.length;_i+=1){var Ei=di[_i];if(Ei.image)N[Ei.image.name]=!0;else{var Qe=tl(Me.toString()),zi=Ei.fontStack||ni,ir=nt[zi]=nt[zi]||{};this.calculateGlyphDependencies(Ei.text,ir,We,this.allowVerticalPlacement,Qe)}}}}}}h.get("symbol-placement")==="line"&&(this.features=function(lr){var ar={},rr={},hr=[],Cr=0;function Ar($i){hr.push(lr[$i]),Cr++}function Yr($i,_r,Nr){var Di=rr[$i];return delete rr[$i],rr[_r]=Di,hr[Di].geometry[0].pop(),hr[Di].geometry[0]=hr[Di].geometry[0].concat(Nr[0]),Di}function zr($i,_r,Nr){var Di=ar[_r];return delete ar[_r],ar[$i]=Di,hr[Di].geometry[0].shift(),hr[Di].geometry[0]=Nr[0].concat(hr[Di].geometry[0]),Di}function Kr($i,_r,Nr){var Di=Nr?_r[0][_r[0].length-1]:_r[0][0];return $i+":"+Di.x+":"+Di.y}for(var fr=0;fr<lr.length;fr++){var Dr=lr[fr],Si=Dr.geometry,Zi=Dr.text?Dr.text.toString():null;if(Zi){var Ui=Kr(Zi,Si),Pi=Kr(Zi,Si,!0);if(Ui in rr&&Pi in ar&&rr[Ui]!==ar[Pi]){var nn=zr(Ui,Pi,Si),Ur=Yr(Ui,Pi,hr[nn].geometry);delete ar[Ui],delete rr[Pi],rr[Kr(Zi,hr[Ur].geometry,!0)]=Ur,hr[nn].geometry=null}else Ui in rr?Yr(Ui,Pi,Si):Pi in ar?zr(Ui,Pi,Si):(Ar(fr),ar[Ui]=Cr-1,rr[Pi]=Cr-1)}else Ar(fr)}return hr.filter(function($i){return $i.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(lr,ar){return lr.sortKey-ar.sortKey})}},Gi.prototype.update=function(t,e,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,i),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,i))},Gi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Gi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Gi.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Gi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Gi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Gi.prototype.addToLineVertexArray=function(t,e){var i=this.lineVertexArray.length;if(t.segment!==void 0){for(var a=t.dist(e[t.segment+1]),h=t.dist(e[t.segment]),c={},p=t.segment+1;p<e.length;p++)c[p]={x:e[p].x,y:e[p].y,tileUnitDistanceFromAnchor:a},p<e.length-1&&(a+=e[p+1].dist(e[p]));for(var m=t.segment||0;m>=0;m--)c[m]={x:e[m].x,y:e[m].y,tileUnitDistanceFromAnchor:h},m>0&&(h+=e[m-1].dist(e[m]));for(var b=0;b<e.length;b++){var M=c[b];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Gi.prototype.addSymbols=function(t,e,i,a,h,c,p,m,b,M,O,N){for(var nt=t.indexArray,ft=t.layoutVertexArray,It=t.segments.prepareSegment(4*e.length,ft,nt,this.canOverlap?c.sortKey:void 0),Ot=this.glyphOffsetArray.length,Wt=It.vertexLength,Gt=this.allowVerticalPlacement&&p===kn.vertical?Math.PI/2:0,ie=c.text&&c.text.sections,ae=0;ae<e.length;ae++){var he=e[ae],ue=he.tl,_e=he.tr,ke=he.bl,Me=he.br,He=he.tex,De=he.pixelOffsetTL,Je=he.pixelOffsetBR,Re=he.minFontScaleX,yi=he.minFontScaleY,ni=he.glyphOffset,We=he.isSDF,_i=he.sectionIndex,di=It.vertexLength,Ei=ni[1];Ah(ft,m.x,m.y,ue.x,Ei+ue.y,He.x,He.y,i,We,De.x,De.y,Re,yi),Ah(ft,m.x,m.y,_e.x,Ei+_e.y,He.x+He.w,He.y,i,We,Je.x,De.y,Re,yi),Ah(ft,m.x,m.y,ke.x,Ei+ke.y,He.x,He.y+He.h,i,We,De.x,Je.y,Re,yi),Ah(ft,m.x,m.y,Me.x,Ei+Me.y,He.x+He.w,He.y+He.h,i,We,Je.x,Je.y,Re,yi),Tc(t.dynamicLayoutVertexArray,m,Gt),nt.emplaceBack(di,di+1,di+2),nt.emplaceBack(di+1,di+2,di+3),It.vertexLength+=4,It.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ni[0]),ae!==e.length-1&&_i===e[ae+1].sectionIndex||t.programConfigurations.populatePaintArrays(ft.length,c,c.index,{},N,ie&&ie[_i])}t.placedSymbolArray.emplaceBack(m.x,m.y,Ot,this.glyphOffsetArray.length-Ot,Wt,b,M,m.segment,i?i[0]:0,i?i[1]:0,a[0],a[1],p,0,!1,0,O)},Gi.prototype._addCollisionDebugVertex=function(t,e,i,a,h,c){return e.emplaceBack(0,0),t.emplaceBack(i.x,i.y,a,h,Math.round(c.x),Math.round(c.y))},Gi.prototype.addCollisionDebugVertices=function(t,e,i,a,h,c,p){var m=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),b=m.vertexLength,M=h.layoutVertexArray,O=h.collisionVertexArray,N=p.anchorX,nt=p.anchorY;this._addCollisionDebugVertex(M,O,c,N,nt,new Lt(t,e)),this._addCollisionDebugVertex(M,O,c,N,nt,new Lt(i,e)),this._addCollisionDebugVertex(M,O,c,N,nt,new Lt(i,a)),this._addCollisionDebugVertex(M,O,c,N,nt,new Lt(t,a)),m.vertexLength+=4;var ft=h.indexArray;ft.emplaceBack(b,b+1),ft.emplaceBack(b+1,b+2),ft.emplaceBack(b+2,b+3),ft.emplaceBack(b+3,b),m.primitiveLength+=4},Gi.prototype.addDebugCollisionBoxes=function(t,e,i,a){for(var h=t;h<e;h++){var c=this.collisionBoxArray.get(h);this.addCollisionDebugVertices(c.x1,c.y1,c.x2,c.y2,a?this.textCollisionBox:this.iconCollisionBox,c.anchorPoint,i)}},Gi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _l(na,su.members,Ia),this.iconCollisionBox=new _l(na,su.members,Ia);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},Gi.prototype._deserializeCollisionBoxesForSymbol=function(t,e,i,a,h,c,p,m,b){for(var M={},O=e;O<i;O++){var N=t.get(O);M.textBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},M.textFeatureIndex=N.featureIndex;break}for(var nt=a;nt<h;nt++){var ft=t.get(nt);M.verticalTextBox={x1:ft.x1,y1:ft.y1,x2:ft.x2,y2:ft.y2,anchorPointX:ft.anchorPointX,anchorPointY:ft.anchorPointY},M.verticalTextFeatureIndex=ft.featureIndex;break}for(var It=c;It<p;It++){var Ot=t.get(It);M.iconBox={x1:Ot.x1,y1:Ot.y1,x2:Ot.x2,y2:Ot.y2,anchorPointX:Ot.anchorPointX,anchorPointY:Ot.anchorPointY},M.iconFeatureIndex=Ot.featureIndex;break}for(var Wt=m;Wt<b;Wt++){var Gt=t.get(Wt);M.verticalIconBox={x1:Gt.x1,y1:Gt.y1,x2:Gt.x2,y2:Gt.y2,anchorPointX:Gt.anchorPointX,anchorPointY:Gt.anchorPointY},M.verticalIconFeatureIndex=Gt.featureIndex;break}return M},Gi.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var i=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Gi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Gi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Gi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Gi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Gi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Gi.prototype.addIndicesForPlacedSymbol=function(t,e){for(var i=t.placedSymbolArray.get(e),a=i.vertexStartIndex+4*i.numGlyphs,h=i.vertexStartIndex;h<a;h+=4)t.indexArray.emplaceBack(h,h+1,h+2),t.indexArray.emplaceBack(h+1,h+2,h+3)},Gi.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var e=Math.sin(t),i=Math.cos(t),a=[],h=[],c=[],p=0;p<this.symbolInstances.length;++p){c.push(p);var m=this.symbolInstances.get(p);a.push(0|Math.round(e*m.anchorX+i*m.anchorY)),h.push(m.featureIndex)}return c.sort(function(b,M){return a[b]-a[M]||h[M]-h[b]}),c},Gi.prototype.addToSortKeyRanges=function(t,e){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===e?i.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},Gi.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,a=this.symbolInstanceIndexes;i<a.length;i+=1){var h=this.symbolInstances.get(a[i]);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach(function(c,p,m){c>=0&&m.indexOf(c)===p&&e.addIndicesForPlacedSymbol(e.text,c)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Ve("SymbolBucket",Gi,{omit:["layers","collisionBoxArray","features","compareText"]}),Gi.MAX_GLYPHS=65535,Gi.addDynamicAttributes=Tc;var Jd=new Fr({"symbol-placement":new Ye(yt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ye(yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ye(yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xe(yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ye(yt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ye(yt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ye(yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ye(yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ye(yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xe(yt.layout_symbol["icon-size"]),"icon-text-fit":new Ye(yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ye(yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xe(yt.layout_symbol["icon-image"]),"icon-rotate":new Xe(yt.layout_symbol["icon-rotate"]),"icon-padding":new Ye(yt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ye(yt.layout_symbol["icon-keep-upright"]),"icon-offset":new Xe(yt.layout_symbol["icon-offset"]),"icon-anchor":new Xe(yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ye(yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ye(yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ye(yt.layout_symbol["text-rotation-alignment"]),"text-field":new Xe(yt.layout_symbol["text-field"]),"text-font":new Xe(yt.layout_symbol["text-font"]),"text-size":new Xe(yt.layout_symbol["text-size"]),"text-max-width":new Xe(yt.layout_symbol["text-max-width"]),"text-line-height":new Ye(yt.layout_symbol["text-line-height"]),"text-letter-spacing":new Xe(yt.layout_symbol["text-letter-spacing"]),"text-justify":new Xe(yt.layout_symbol["text-justify"]),"text-radial-offset":new Xe(yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ye(yt.layout_symbol["text-variable-anchor"]),"text-anchor":new Xe(yt.layout_symbol["text-anchor"]),"text-max-angle":new Ye(yt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ye(yt.layout_symbol["text-writing-mode"]),"text-rotate":new Xe(yt.layout_symbol["text-rotate"]),"text-padding":new Ye(yt.layout_symbol["text-padding"]),"text-keep-upright":new Ye(yt.layout_symbol["text-keep-upright"]),"text-transform":new Xe(yt.layout_symbol["text-transform"]),"text-offset":new Xe(yt.layout_symbol["text-offset"]),"text-allow-overlap":new Ye(yt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ye(yt.layout_symbol["text-ignore-placement"]),"text-optional":new Ye(yt.layout_symbol["text-optional"])}),kc={paint:new Fr({"icon-opacity":new Xe(yt.paint_symbol["icon-opacity"]),"icon-color":new Xe(yt.paint_symbol["icon-color"]),"icon-halo-color":new Xe(yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xe(yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xe(yt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ye(yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ye(yt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xe(yt.paint_symbol["text-opacity"]),"text-color":new Xe(yt.paint_symbol["text-color"],{runtimeType:Le,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Xe(yt.paint_symbol["text-halo-color"]),"text-halo-width":new Xe(yt.paint_symbol["text-halo-width"]),"text-halo-blur":new Xe(yt.paint_symbol["text-halo-blur"]),"text-translate":new Ye(yt.paint_symbol["text-translate"]),"text-translate-anchor":new Ye(yt.paint_symbol["text-translate-anchor"])}),layout:Jd},ws=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ne,this.defaultValue=t};ws.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},ws.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},ws.prototype.outputDefined=function(){return!1},ws.prototype.serialize=function(){return null},Ve("FormatSectionOverride",ws,{omit:["defaultValue"]});var $d=function(t){function e(i){t.call(this,i,kc)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(i,a){if(t.prototype.recalculate.call(this,i,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var h=this.layout.get("text-writing-mode");if(h){for(var c=[],p=0,m=h;p<m.length;p+=1){var b=m[p];c.indexOf(b)<0&&c.push(b)}this.layout._values["text-writing-mode"]=c}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(i,a,h,c){var p=this.layout.get(i).evaluate(a,{},h,c),m=this._unevaluatedLayout._values[i];return m.isDataDriven()||_a(m.value)||!p?p:function(b,M){return M.replace(/{([^{}]+)}/g,function(O,N){return N in b?String(b[N]):""})}(a.properties,p)},e.prototype.createBucket=function(i){return new Gi(i)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var i=0,a=kc.paint.overridableProperties;i<a.length;i+=1){var h=a[i];if(e.hasPaintOverride(this.layout,h)){var c,p=this.paint.get(h),m=new ws(p),b=new Jo(m,p.property.specification);c=p.value.kind==="constant"||p.value.kind==="source"?new xa("source",b):new $o("composite",b,p.value.zoomStops,p.value._interpolationType),this.paint._values[h]=new Xr(p.property,c,p.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(i,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&e.hasPaintOverride(this.layout,i)},e.hasPaintOverride=function(i,a){var h=i.get("text-field"),c=kc.paint.properties[a],p=!1,m=function(O){for(var N=0,nt=O;N<nt.length;N+=1)if(c.overrides&&c.overrides.hasOverride(nt[N]))return void(p=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Er)m(h.value.value.sections);else if(h.value.kind==="source"){var b=function(O){p||(O instanceof Gr&&pr(O.value)===Wi?m(O.value.sections):O instanceof En?m(O.sections):O.eachChild(b))},M=h.value;M._styleExpression&&b(M._styleExpression.expression)}return p},e}(Rn),Qd={paint:new Fr({"background-color":new Ye(yt.paint_background["background-color"]),"background-pattern":new Wr(yt.paint_background["background-pattern"]),"background-opacity":new Ye(yt.paint_background["background-opacity"])})},tf=function(t){function e(i){t.call(this,i,Qd)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Rn),ef={paint:new Fr({"raster-opacity":new Ye(yt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ye(yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ye(yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ye(yt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ye(yt.paint_raster["raster-saturation"]),"raster-contrast":new Ye(yt.paint_raster["raster-contrast"]),"raster-resampling":new Ye(yt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ye(yt.paint_raster["raster-fade-duration"])})},rf=function(t){function e(i){t.call(this,i,ef)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Rn),nf=function(t){function e(i){t.call(this,i,{}),this.implementation=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},e.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},e.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},e}(Rn),of={circle:hc,heatmap:Np,hillshade:Gp,fill:ad,"fill-extrusion":md,line:bd,symbol:$d,background:tf,raster:rf},Pu=ut.HTMLImageElement,Iu=ut.HTMLCanvasElement,Lu=ut.HTMLVideoElement,zu=ut.ImageData,Eh=ut.ImageBitmap,Ra=function(t,e,i,a){this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(e,a)};Ra.prototype.update=function(t,e,i){var a=t.width,h=t.height,c=!(this.size&&this.size[0]===a&&this.size[1]===h||i),p=this.context,m=p.gl;if(this.useMipmap=!!(e&&e.useMipmap),m.bindTexture(m.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===m.RGBA&&(!e||e.premultiply!==!1)),c)this.size=[a,h],t instanceof Pu||t instanceof Iu||t instanceof Lu||t instanceof zu||Eh&&t instanceof Eh?m.texImage2D(m.TEXTURE_2D,0,this.format,this.format,m.UNSIGNED_BYTE,t):m.texImage2D(m.TEXTURE_2D,0,this.format,a,h,0,this.format,m.UNSIGNED_BYTE,t.data);else{var b=i||{x:0,y:0},M=b.x,O=b.y;t instanceof Pu||t instanceof Iu||t instanceof Lu||t instanceof zu||Eh&&t instanceof Eh?m.texSubImage2D(m.TEXTURE_2D,0,M,O,m.RGBA,m.UNSIGNED_BYTE,t):m.texSubImage2D(m.TEXTURE_2D,0,M,O,a,h,m.RGBA,m.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&m.generateMipmap(m.TEXTURE_2D)},Ra.prototype.bind=function(t,e,i){var a=this.context.gl;a.bindTexture(a.TEXTURE_2D,this.texture),i!==a.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=a.LINEAR),t!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,t),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,i||t),this.filter=t),e!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,e),this.wrap=e)},Ra.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ra.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Cc=function(t){var e=this;this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};Cc.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Cc.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ss=function(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},_t(["receive","process"],this),this.invoker=new Cc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=v()?t:ut};function Du(t,e,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[t*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}Ss.prototype.send=function(t,e,i,a,h){var c=this;h===void 0&&(h=!1);var p=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[p]=i);var m=k(this.globalScope)?void 0:[];return this.target.postMessage({id:p,type:t,hasCallback:!!i,targetMapId:a,mustQueue:h,sourceMapId:this.mapId,data:Pn(e,m)},m),{cancel:function(){i&&delete c.callbacks[p],c.target.postMessage({id:p,type:"<cancel>",targetMapId:a,sourceMapId:c.mapId})}}},Ss.prototype.receive=function(t){var e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[i];var a=this.cancelCallbacks[i];delete this.cancelCallbacks[i],a&&a()}else v()||e.mustQueue?(this.tasks[i]=e,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,e)},Ss.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Ss.prototype.processTask=function(t,e){var i=this;if(e.type==="<response>"){var a=this.callbacks[t];delete this.callbacks[t],a&&(e.error?a(sn(e.error)):a(null,sn(e.data)))}else{var h=!1,c=k(this.globalScope)?void 0:[],p=e.hasCallback?function(O,N){h=!0,delete i.cancelCallbacks[t],i.target.postMessage({id:t,type:"<response>",sourceMapId:i.mapId,error:O?Pn(O):null,data:Pn(N,c)},c)}:function(O){h=!0},m=null,b=sn(e.data);if(this.parent[e.type])m=this.parent[e.type](e.sourceMapId,b,p);else if(this.parent.getWorkerSource){var M=e.type.split(".");m=this.parent.getWorkerSource(e.sourceMapId,M[0],b.source)[M[1]](b,p)}else p(new Error("Could not find function "+e.type));!h&&m&&m.cancel&&(this.cancelCallbacks[t]=m.cancel)}},Ss.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var wr=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};wr.prototype.setNorthEast=function(t){return this._ne=t instanceof er?new er(t.lng,t.lat):er.convert(t),this},wr.prototype.setSouthWest=function(t){return this._sw=t instanceof er?new er(t.lng,t.lat):er.convert(t),this},wr.prototype.extend=function(t){var e,i,a=this._sw,h=this._ne;if(t instanceof er)e=t,i=t;else{if(!(t instanceof wr))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(wr.convert(t)):this.extend(er.convert(t)):this;if(i=t._ne,!(e=t._sw)||!i)return this}return a||h?(a.lng=Math.min(e.lng,a.lng),a.lat=Math.min(e.lat,a.lat),h.lng=Math.max(i.lng,h.lng),h.lat=Math.max(i.lat,h.lat)):(this._sw=new er(e.lng,e.lat),this._ne=new er(i.lng,i.lat)),this},wr.prototype.getCenter=function(){return new er((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},wr.prototype.getSouthWest=function(){return this._sw},wr.prototype.getNorthEast=function(){return this._ne},wr.prototype.getNorthWest=function(){return new er(this.getWest(),this.getNorth())},wr.prototype.getSouthEast=function(){return new er(this.getEast(),this.getSouth())},wr.prototype.getWest=function(){return this._sw.lng},wr.prototype.getSouth=function(){return this._sw.lat},wr.prototype.getEast=function(){return this._ne.lng},wr.prototype.getNorth=function(){return this._ne.lat},wr.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},wr.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},wr.prototype.isEmpty=function(){return!(this._sw&&this._ne)},wr.prototype.contains=function(t){var e=er.convert(t),i=e.lng,a=e.lat,h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&h},wr.convert=function(t){return!t||t instanceof wr?t:new wr(t)};var er=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};er.prototype.wrap=function(){return new er(W(this.lng,-180,180),this.lat)},er.prototype.toArray=function(){return[this.lng,this.lat]},er.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},er.prototype.distanceTo=function(t){var e=Math.PI/180,i=this.lat*e,a=t.lat*e,h=Math.sin(i)*Math.sin(a)+Math.cos(i)*Math.cos(a)*Math.cos((t.lng-this.lng)*e);return 63710088e-1*Math.acos(Math.min(h,1))},er.prototype.toBounds=function(t){t===void 0&&(t=0);var e=360*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return new wr(new er(this.lng-i,this.lat-e),new er(this.lng+i,this.lat+e))},er.convert=function(t){if(t instanceof er)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new er(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new er(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Ou=2*Math.PI*63710088e-1;function Bu(t){return Ou*Math.cos(t*Math.PI/180)}function Ru(t){return(180+t)/360}function Fu(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function ju(t,e){return t/Bu(e)}function Ac(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var Fa=function(t,e,i){i===void 0&&(i=0),this.x=+t,this.y=+e,this.z=+i};Fa.fromLngLat=function(t,e){e===void 0&&(e=0);var i=er.convert(t);return new Fa(Ru(i.lng),Fu(i.lat),ju(e,i.lat))},Fa.prototype.toLngLat=function(){return new er(360*this.x-180,Ac(this.y))},Fa.prototype.toAltitude=function(){return this.z*Bu(Ac(this.y))},Fa.prototype.meterInMercatorCoordinateUnits=function(){return 1/Ou*(t=Ac(this.y),1/Math.cos(t*Math.PI/180));var t};var ja=function(t,e,i){this.z=t,this.x=e,this.y=i,this.key=xl(0,t,t,e,i)};ja.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},ja.prototype.url=function(t,e){var i,a,h,c,p,m=(a=this.y,h=this.z,c=Du(256*(i=this.x),256*(a=Math.pow(2,h)-a-1),h),p=Du(256*(i+1),256*(a+1),h),c[0]+","+c[1]+","+p[0]+","+p[1]),b=function(M,O,N){for(var nt,ft="",It=M;It>0;It--)ft+=(O&(nt=1<<It-1)?1:0)+(N&nt?2:0);return ft}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(e==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",b).replace("{bbox-epsg-3857}",m)},ja.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new Lt(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},ja.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Uu=function(t,e){this.wrap=t,this.canonical=e,this.key=xl(t,e.z,e.z,e.x,e.y)},Sr=function(t,e,i,a,h){this.overscaledZ=t,this.wrap=e,this.canonical=new ja(i,+a,+h),this.key=xl(e,t,i,a,h)};function xl(t,e,i,a,h){(t*=2)<0&&(t=-1*t-1);var c=1<<i;return(c*c*t+c*h+a).toString(36)+i.toString(36)+e.toString(36)}Sr.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Sr.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new Sr(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Sr(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},Sr.prototype.calculateScaledKey=function(t,e){var i=this.canonical.z-t;return t>this.canonical.z?xl(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):xl(this.wrap*+e,t,t,this.canonical.x>>i,this.canonical.y>>i)},Sr.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},Sr.prototype.children=function(t){if(this.overscaledZ>=t)return[new Sr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,i=2*this.canonical.x,a=2*this.canonical.y;return[new Sr(e,this.wrap,e,i,a),new Sr(e,this.wrap,e,i+1,a),new Sr(e,this.wrap,e,i,a+1),new Sr(e,this.wrap,e,i+1,a+1)]},Sr.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Sr.prototype.wrapped=function(){return new Sr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Sr.prototype.unwrapTo=function(t){return new Sr(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Sr.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Sr.prototype.toUnwrapped=function(){return new Uu(this.wrap,this.canonical)},Sr.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Sr.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new Fa(t.x-this.wrap,t.y))},Ve("CanonicalTileID",ja),Ve("OverscaledTileID",Sr,{omit:["posMatrix"]});var Go=function(t,e,i){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return z('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var a=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=i||"mapbox";for(var h=0;h<a;h++)this.data[this._idx(-1,h)]=this.data[this._idx(0,h)],this.data[this._idx(a,h)]=this.data[this._idx(a-1,h)],this.data[this._idx(h,-1)]=this.data[this._idx(h,0)],this.data[this._idx(h,a)]=this.data[this._idx(h,a-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(a,-1)]=this.data[this._idx(a-1,0)],this.data[this._idx(-1,a)]=this.data[this._idx(0,a-1)],this.data[this._idx(a,a)]=this.data[this._idx(a-1,a-1)]};Go.prototype.get=function(t,e){var i=new Uint8Array(this.data.buffer),a=4*this._idx(t,e);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[a],i[a+1],i[a+2])},Go.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Go.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Go.prototype._unpackMapbox=function(t,e,i){return(256*t*256+256*e+i)/10-1e4},Go.prototype._unpackTerrarium=function(t,e,i){return 256*t+e+i/256-32768},Go.prototype.getPixels=function(){return new pn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Go.prototype.backfillBorder=function(t,e,i){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var a=e*this.dim,h=e*this.dim+this.dim,c=i*this.dim,p=i*this.dim+this.dim;switch(e){case-1:a=h-1;break;case 1:h=a+1}switch(i){case-1:c=p-1;break;case 1:p=c+1}for(var m=-e*this.dim,b=-i*this.dim,M=c;M<p;M++)for(var O=a;O<h;O++)this.data[this._idx(O,M)]=t.data[this._idx(O+m,M+b)]},Ve("DEMData",Go);var Mh=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var i=t[e];this._stringToNumber[i]=e,this._numberToString[e]=i}};Mh.prototype.encode=function(t){return this._stringToNumber[t]},Mh.prototype.decode=function(t){return this._numberToString[t]};var Ph=function(t,e,i,a,h){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=i,t._y=a,this.properties=t.properties,this.id=h},Ec={geometry:{configurable:!0}};Ec.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Ec.geometry.set=function(t){this._geometry=t},Ph.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)e!=="_geometry"&&e!=="_vectorTileFeature"&&(t[e]=this[e]);return t},Object.defineProperties(Ph.prototype,Ec);var Ts=function(){this.state={},this.stateChanges={},this.deletedStates={}};Ts.prototype.updateState=function(t,e,i){var a=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][a]=this.stateChanges[t][a]||{},q(this.stateChanges[t][a],i),this.deletedStates[t]===null)for(var h in this.deletedStates[t]={},this.state[t])h!==a&&(this.deletedStates[t][h]=null);else if(this.deletedStates[t]&&this.deletedStates[t][a]===null)for(var c in this.deletedStates[t][a]={},this.state[t][a])i[c]||(this.deletedStates[t][a][c]=null);else for(var p in i)this.deletedStates[t]&&this.deletedStates[t][a]&&this.deletedStates[t][a][p]===null&&delete this.deletedStates[t][a][p]},Ts.prototype.removeFeatureState=function(t,e,i){if(this.deletedStates[t]!==null){var a=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},i&&e!==void 0)this.deletedStates[t][a]!==null&&(this.deletedStates[t][a]=this.deletedStates[t][a]||{},this.deletedStates[t][a][i]=null);else if(e!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][a])for(i in this.deletedStates[t][a]={},this.stateChanges[t][a])this.deletedStates[t][a][i]=null;else this.deletedStates[t][a]=null;else this.deletedStates[t]=null}},Ts.prototype.getState=function(t,e){var i=String(e),a=q({},(this.state[t]||{})[i],(this.stateChanges[t]||{})[i]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){var h=this.deletedStates[t][e];if(h===null)return{};for(var c in h)delete a[c]}return a},Ts.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Ts.prototype.coalesceChanges=function(t,e){var i={};for(var a in this.stateChanges){this.state[a]=this.state[a]||{};var h={};for(var c in this.stateChanges[a])this.state[a][c]||(this.state[a][c]={}),q(this.state[a][c],this.stateChanges[a][c]),h[c]=this.state[a][c];i[a]=h}for(var p in this.deletedStates){this.state[p]=this.state[p]||{};var m={};if(this.deletedStates[p]===null)for(var b in this.state[p])m[b]={},this.state[p][b]={};else for(var M in this.deletedStates[p]){if(this.deletedStates[p][M]===null)this.state[p][M]={};else for(var O=0,N=Object.keys(this.deletedStates[p][M]);O<N.length;O+=1)delete this.state[p][M][N[O]];m[M]=this.state[p][M]}i[p]=i[p]||{},q(i[p],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var nt in t)t[nt].setFeatureState(i,e)};var qo=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Gn(8192,16,0),this.grid3D=new Gn(8192,16,0),this.featureIndexArray=new H,this.promoteId=e};function Nu(t,e,i,a,h){return V(t,function(c,p){var m=e instanceof Ma?e.get(p):null;return m&&m.evaluate?m.evaluate(i,a,h):m})}function Vu(t){for(var e=1/0,i=1/0,a=-1/0,h=-1/0,c=0,p=t;c<p.length;c+=1){var m=p[c];e=Math.min(e,m.x),i=Math.min(i,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y)}return{minX:e,minY:i,maxX:a,maxY:h}}function af(t,e){return e-t}qo.prototype.insert=function(t,e,i,a,h,c){var p=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,a,h);for(var m=c?this.grid3D:this.grid,b=0;b<e.length;b++){for(var M=e[b],O=[1/0,1/0,-1/0,-1/0],N=0;N<M.length;N++){var nt=M[N];O[0]=Math.min(O[0],nt.x),O[1]=Math.min(O[1],nt.y),O[2]=Math.max(O[2],nt.x),O[3]=Math.max(O[3],nt.y)}O[0]<8192&&O[1]<8192&&O[2]>=0&&O[3]>=0&&m.insert(p,O[0],O[1],O[2],O[3])}},qo.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new fs.VectorTile(new vh(this.rawTileData)).layers,this.sourceLayerCoder=new Mh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},qo.prototype.query=function(t,e,i,a){var h=this;this.loadVTLayers();for(var c=t.params||{},p=8192/t.tileSize/t.scale,m=Ja(c.filter),b=t.queryGeometry,M=t.queryPadding*p,O=Vu(b),N=this.grid.query(O.minX-M,O.minY-M,O.maxX+M,O.maxY+M),nt=Vu(t.cameraQueryGeometry),ft=this.grid3D.query(nt.minX-M,nt.minY-M,nt.maxX+M,nt.maxY+M,function(he,ue,_e,ke){return function(Me,He,De,Je,Re){for(var yi=0,ni=Me;yi<ni.length;yi+=1){var We=ni[yi];if(He<=We.x&&De<=We.y&&Je>=We.x&&Re>=We.y)return!0}var _i=[new Lt(He,De),new Lt(He,Re),new Lt(Je,Re),new Lt(Je,De)];if(Me.length>2){for(var di=0,Ei=_i;di<Ei.length;di+=1)if(jn(Me,Ei[di]))return!0}for(var Qe=0;Qe<Me.length-1;Qe++)if(Da(Me[Qe],Me[Qe+1],_i))return!0;return!1}(t.cameraQueryGeometry,he-M,ue-M,_e+M,ke+M)}),It=0,Ot=ft;It<Ot.length;It+=1)N.push(Ot[It]);N.sort(af);for(var Wt,Gt={},ie=function(he){var ue=N[he];if(ue!==Wt){Wt=ue;var _e=h.featureIndexArray.get(ue),ke=null;h.loadMatchingFeature(Gt,_e.bucketIndex,_e.sourceLayerIndex,_e.featureIndex,m,c.layers,c.availableImages,e,i,a,function(Me,He,De){return ke||(ke=or(Me)),He.queryIntersectsFeature(b,Me,De,ke,h.z,t.transform,p,t.pixelPosMatrix)})}},ae=0;ae<N.length;ae++)ie(ae);return Gt},qo.prototype.loadMatchingFeature=function(t,e,i,a,h,c,p,m,b,M,O){var N=this.bucketLayerIDs[e];if(!c||function(Me,He){for(var De=0;De<Me.length;De++)if(He.indexOf(Me[De])>=0)return!0;return!1}(c,N)){var nt=this.sourceLayerCoder.decode(i),ft=this.vtLayers[nt].feature(a);if(h.needGeometry){var It=dr(ft,!0);if(!h.filter(new wi(this.tileID.overscaledZ),It,this.tileID.canonical))return}else if(!h.filter(new wi(this.tileID.overscaledZ),ft))return;for(var Ot=this.getId(ft,nt),Wt=0;Wt<N.length;Wt++){var Gt=N[Wt];if(!(c&&c.indexOf(Gt)<0)){var ie=m[Gt];if(ie){var ae={};Ot!==void 0&&M&&(ae=M.getState(ie.sourceLayer||"_geojsonTileLayer",Ot));var he=q({},b[Gt]);he.paint=Nu(he.paint,ie.paint,ft,ae,p),he.layout=Nu(he.layout,ie.layout,ft,ae,p);var ue=!O||O(ft,ie,ae);if(ue){var _e=new Ph(ft,this.z,this.x,this.y,Ot);_e.layer=he;var ke=t[Gt];ke===void 0&&(ke=t[Gt]=[]),ke.push({featureIndex:a,feature:_e,intersectionZ:ue})}}}}}},qo.prototype.lookupSymbolFeatures=function(t,e,i,a,h,c,p,m){var b={};this.loadVTLayers();for(var M=Ja(h),O=0,N=t;O<N.length;O+=1)this.loadMatchingFeature(b,i,a,N[O],M,c,p,m,e);return b},qo.prototype.hasLayer=function(t){for(var e=0,i=this.bucketLayerIDs;e<i.length;e+=1)for(var a=0,h=i[e];a<h.length;a+=1)if(t===h[a])return!0;return!1},qo.prototype.getId=function(t,e){var i=t.id;return this.promoteId&&typeof(i=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[e]])=="boolean"&&(i=Number(i)),i},Ve("FeatureIndex",qo,{omit:["rawTileData","sourceLayerCoder"]});var Lr=function(t,e){this.tileID=t,this.uid=U(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Lr.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<A.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},Lr.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Lr.prototype.loadVectorData=function(t,e,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var a in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(M,O){var N={};if(!O)return N;for(var nt=function(){var Ot=It[ft],Wt=Ot.layerIds.map(function(ae){return O.getLayer(ae)}).filter(Boolean);if(Wt.length!==0){Ot.layers=Wt,Ot.stateDependentLayerIds&&(Ot.stateDependentLayers=Ot.stateDependentLayerIds.map(function(ae){return Wt.filter(function(he){return he.id===ae})[0]}));for(var Gt=0,ie=Wt;Gt<ie.length;Gt+=1)N[ie[Gt].id]=Ot}},ft=0,It=M;ft<It.length;ft+=1)nt();return N}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var h=this.buckets[a];if(h instanceof Gi){if(this.hasSymbolBuckets=!0,!i)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var c in this.buckets){var p=this.buckets[c];if(p instanceof Gi&&p.hasRTLText){this.hasRTLText=!0,mn.isLoading()||mn.isLoaded()||rl()!=="deferred"||In();break}}for(var m in this.queryPadding=0,this.buckets){var b=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(m).queryRadius(b))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new o},Lr.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Lr.prototype.getBucket=function(t){return this.buckets[t.id]},Lr.prototype.upload=function(t){for(var e in this.buckets){var i=this.buckets[e];i.uploadPending()&&i.upload(t)}var a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ra(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ra(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)},Lr.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},Lr.prototype.queryRenderedFeatures=function(t,e,i,a,h,c,p,m,b,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:a,cameraQueryGeometry:h,scale:c,tileSize:this.tileSize,pixelPosMatrix:M,transform:m,params:p,queryPadding:this.queryPadding*b},t,e,i):{}},Lr.prototype.querySourceFeatures=function(t,e){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var a=i.loadVTLayers(),h=e?e.sourceLayer:"",c=a._geojsonTileLayer||a[h];if(c)for(var p=Ja(e&&e.filter),m=this.tileID.canonical,b=m.z,M=m.x,O=m.y,N={z:b,x:M,y:O},nt=0;nt<c.length;nt++){var ft=c.feature(nt);if(p.needGeometry){var It=dr(ft,!0);if(!p.filter(new wi(this.tileID.overscaledZ),It,this.tileID.canonical))continue}else if(!p.filter(new wi(this.tileID.overscaledZ),ft))continue;var Ot=i.getId(ft,h),Wt=new Ph(ft,b,M,O,Ot);Wt.tile=N,t.push(Wt)}}},Lr.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Lr.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Lr.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var i=y(t.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var a=Date.now(),h=!1;if(this.expirationTime>a)h=!1;else if(e)if(this.expirationTime<e)h=!0;else{var c=this.expirationTime-e;c?this.expirationTime=a+Math.max(c,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Lr.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Lr.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var a in this.buckets)if(e.style.hasLayer(a)){var h=this.buckets[a],c=h.layers[0].sourceLayer||"_geojsonTileLayer",p=i[c],m=t[c];if(p&&m&&Object.keys(m).length!==0){h.update(m,p,this.imageAtlas&&this.imageAtlas.patternPositions||{});var b=e&&e.style&&e.style.getLayer(a);b&&(this.queryPadding=Math.max(this.queryPadding,b.queryRadius(h)))}}}},Lr.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Lr.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<A.now()},Lr.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Lr.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=A.now()+t},Lr.prototype.setDependencies=function(t,e){for(var i={},a=0,h=e;a<h.length;a+=1)i[h[a]]=!0;this.dependencies[t]=i},Lr.prototype.hasDependency=function(t,e){for(var i=0,a=t;i<a.length;i+=1){var h=this.dependencies[a[i]];if(h){for(var c=0,p=e;c<p.length;c+=1)if(h[p[c]])return!0}}return!1};var ha=ut.performance,Gu=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},ha.mark(this._marks.start)};Gu.prototype.finish=function(){ha.mark(this._marks.end);var t=ha.getEntriesByName(this._marks.measure);return t.length===0&&(ha.measure(this._marks.measure,this._marks.start,this._marks.end),t=ha.getEntriesByName(this._marks.measure),ha.clearMarks(this._marks.start),ha.clearMarks(this._marks.end),ha.clearMeasures(this._marks.measure)),t},l.Actor=Ss,l.AlphaImage=Ba,l.CanonicalTileID=ja,l.CollisionBoxArray=o,l.Color=Bi,l.DEMData=Go,l.DataConstantProperty=Ye,l.DictionaryCoder=Mh,l.EXTENT=8192,l.ErrorEvent=Yt,l.EvaluationParameters=wi,l.Event=zt,l.Evented=$t,l.FeatureIndex=qo,l.FillBucket=Hn,l.FillExtrusionBucket=Zn,l.ImageAtlas=vl,l.ImagePosition=xh,l.LineBucket=rn,l.LngLat=er,l.LngLatBounds=wr,l.MercatorCoordinate=Fa,l.ONE_EM=24,l.OverscaledTileID=Sr,l.Point=Lt,l.Point$1=Lt,l.Properties=Fr,l.Protobuf=vh,l.RGBAImage=pn,l.RequestManager=Y,l.RequestPerformance=Gu,l.ResourceType=Ge,l.SegmentVector=vt,l.SourceFeatureState=Ts,l.StructArrayLayout1ui2=hl,l.StructArrayLayout2f1f2i16=jo,l.StructArrayLayout2i4=Fo,l.StructArrayLayout3ui6=lo,l.StructArrayLayout4i8=ol,l.SymbolBucket=Gi,l.Texture=Ra,l.Tile=Lr,l.Transitionable=Rr,l.Uniform1f=Ae,l.Uniform1i=xe,l.Uniform2f=Ce,l.Uniform3f=je,l.Uniform4f=Ke,l.UniformColor=ei,l.UniformMatrix4f=Mi,l.UnwrappedTileID=Uu,l.ValidationError=Ut,l.WritingMode=kn,l.ZoomHistory=Qs,l.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},l.addDynamicAttributes=Tc,l.asyncAll=function(t,e,i){if(!t.length)return i(null,[]);var a=t.length,h=new Array(t.length),c=null;t.forEach(function(p,m){e(p,function(b,M){b&&(c=b),h[m]=M,--a==0&&i(c,h)})})},l.bezier=Z,l.bindAll=_t,l.browser=A,l.cacheEntryPossiblyAdded=function(t){++Oe>ye&&(t.getActor().send("enforceCacheSizeLimit",Jt),Oe=0)},l.clamp=at,l.clearTileCache=function(t){var e=ut.caches.delete("mapbox-tiles");t&&e.catch(t).then(function(){return t()})},l.clipLine=Tu,l.clone=function(t){var e=new Ri(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},l.clone$1=I,l.clone$2=function(t){var e=new Ri(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},l.collisionCircleLayout=kd,l.config=B,l.create=function(){var t=new Ri(16);return Ri!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},l.create$1=function(){var t=new Ri(9);return Ri!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},l.create$2=function(){var t=new Ri(4);return Ri!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},l.createCommonjsModule=Zt,l.createExpression=Ya,l.createLayout=Pr,l.createStyleLayer=function(t){return t.type==="custom"?new nf(t):new of[t.type](t)},l.cross=function(t,e,i){var a=e[0],h=e[1],c=e[2],p=i[0],m=i[1],b=i[2];return t[0]=h*b-c*m,t[1]=c*p-a*b,t[2]=a*m-h*p,t},l.deepEqual=function t(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(var a=0;a<e.length;a++)if(!t(e[a],i[a]))return!1;return!0}if(typeof e=="object"&&e!==null&&i!==null){if(typeof i!="object"||Object.keys(e).length!==Object.keys(i).length)return!1;for(var h in e)if(!t(e[h],i[h]))return!1;return!0}return e===i},l.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},l.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},l.ease=lt,l.emitValidationErrors=Ca,l.endsWith=mt,l.enforceCacheSizeLimit=function(t){ze(),ht&&ht.then(function(e){e.keys().then(function(i){for(var a=0;a<i.length-t;a++)e.delete(i[a])})})},l.evaluateSizeForFeature=vu,l.evaluateSizeForZoom=_u,l.evaluateVariableOffset=Au,l.evented=il,l.extend=q,l.featureFilter=Ja,l.filterObject=rt,l.fromRotation=function(t,e){var i=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=i,t[2]=0,t[3]=-i,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},l.getAnchorAlignment=xc,l.getAnchorJustification=Sc,l.getArrayBuffer=cr,l.getImage=tt,l.getJSON=function(t,e){return Ni(q(t,{type:"json"}),e)},l.getRTLTextPluginStatus=rl,l.getReferrer=li,l.getVideo=function(t,e){var i,a,h=ut.document.createElement("video");h.muted=!0,h.onloadstart=function(){e(null,h)};for(var c=0;c<t.length;c++){var p=ut.document.createElement("source");i=t[c],a=void 0,(a=ut.document.createElement("a")).href=i,(a.protocol!==ut.document.location.protocol||a.host!==ut.document.location.host)&&(h.crossOrigin="Anonymous"),p.src=t[c],h.appendChild(p)}return{cancel:function(){}}},l.identity=gn,l.invert=function(t,e){var i=e[0],a=e[1],h=e[2],c=e[3],p=e[4],m=e[5],b=e[6],M=e[7],O=e[8],N=e[9],nt=e[10],ft=e[11],It=e[12],Ot=e[13],Wt=e[14],Gt=e[15],ie=i*m-a*p,ae=i*b-h*p,he=i*M-c*p,ue=a*b-h*m,_e=a*M-c*m,ke=h*M-c*b,Me=O*Ot-N*It,He=O*Wt-nt*It,De=O*Gt-ft*It,Je=N*Wt-nt*Ot,Re=N*Gt-ft*Ot,yi=nt*Gt-ft*Wt,ni=ie*yi-ae*Re+he*Je+ue*De-_e*He+ke*Me;return ni?(t[0]=(m*yi-b*Re+M*Je)*(ni=1/ni),t[1]=(h*Re-a*yi-c*Je)*ni,t[2]=(Ot*ke-Wt*_e+Gt*ue)*ni,t[3]=(nt*_e-N*ke-ft*ue)*ni,t[4]=(b*De-p*yi-M*He)*ni,t[5]=(i*yi-h*De+c*He)*ni,t[6]=(Wt*he-It*ke-Gt*ae)*ni,t[7]=(O*ke-nt*he+ft*ae)*ni,t[8]=(p*Re-m*De+M*Me)*ni,t[9]=(a*De-i*Re-c*Me)*ni,t[10]=(It*_e-Ot*he+Gt*ie)*ni,t[11]=(N*he-O*_e-ft*ie)*ni,t[12]=(m*He-p*Je-b*Me)*ni,t[13]=(i*Je-a*He+h*Me)*ni,t[14]=(Ot*ae-It*ue-Wt*ie)*ni,t[15]=(O*ue-N*ae+nt*ie)*ni,t):null},l.isChar=Ie,l.isMapboxURL=G,l.keysDifference=function(t,e){var i=[];for(var a in t)a in e||i.push(a);return i},l.makeRequest=Ni,l.mapObject=V,l.mercatorXfromLng=Ru,l.mercatorYfromLat=Fu,l.mercatorZfromAltitude=ju,l.mul=lc,l.multiply=en,l.mvt=fs,l.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},l.normalize=function(t,e){var i=e[0],a=e[1],h=e[2],c=i*i+a*a+h*h;return c>0&&(c=1/Math.sqrt(c)),t[0]=e[0]*c,t[1]=e[1]*c,t[2]=e[2]*c,t},l.number=yr,l.offscreenCanvasSupported=Ze,l.ortho=function(t,e,i,a,h,c,p){var m=1/(e-i),b=1/(a-h),M=1/(c-p);return t[0]=-2*m,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*b,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*M,t[11]=0,t[12]=(e+i)*m,t[13]=(h+a)*b,t[14]=(p+c)*M,t[15]=1,t},l.parseGlyphPBF=function(t){return new vh(t).readFields(Bd,[])},l.pbf=vh,l.performSymbolLayout=function(t,e,i,a,h,c,p){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var m=t.layers[0].layout,b=t.layers[0]._unevaluatedLayout._values,M={};if(t.textSizeData.kind==="composite"){var O=t.textSizeData,N=O.maxZoom;M.compositeTextSizes=[b["text-size"].possiblyEvaluate(new wi(O.minZoom),p),b["text-size"].possiblyEvaluate(new wi(N),p)]}if(t.iconSizeData.kind==="composite"){var nt=t.iconSizeData,ft=nt.maxZoom;M.compositeIconSizes=[b["icon-size"].possiblyEvaluate(new wi(nt.minZoom),p),b["icon-size"].possiblyEvaluate(new wi(ft),p)]}M.layoutTextSize=b["text-size"].possiblyEvaluate(new wi(t.zoom+1),p),M.layoutIconSize=b["icon-size"].possiblyEvaluate(new wi(t.zoom+1),p),M.textMaxSize=b["text-size"].possiblyEvaluate(new wi(18));for(var It=24*m.get("text-line-height"),Ot=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point",Wt=m.get("text-keep-upright"),Gt=m.get("text-size"),ie=function(){var ue=he[ae],_e=m.get("text-font").evaluate(ue,{},p).join(","),ke=Gt.evaluate(ue,{},p),Me=M.layoutTextSize.evaluate(ue,{},p),He=M.layoutIconSize.evaluate(ue,{},p),De={horizontal:{},vertical:void 0},Je=ue.text,Re=[0,0];if(Je){var yi=Je.toString(),ni=24*m.get("text-letter-spacing").evaluate(ue,{},p),We=function(Si){for(var Zi=0,Ui=Si;Zi<Ui.length;Zi+=1)if(Pi=Ui[Zi].charCodeAt(0),Ie.Arabic(Pi)||Ie["Arabic Supplement"](Pi)||Ie["Arabic Extended-A"](Pi)||Ie["Arabic Presentation Forms-A"](Pi)||Ie["Arabic Presentation Forms-B"](Pi))return!1;var Pi;return!0}(yi)?ni:0,_i=m.get("text-anchor").evaluate(ue,{},p),di=m.get("text-variable-anchor");if(!di){var Ei=m.get("text-radial-offset").evaluate(ue,{},p);Re=Ei?Au(_i,[24*Ei,wc]):m.get("text-offset").evaluate(ue,{},p).map(function(Si){return 24*Si})}var Qe=Ot?"center":m.get("text-justify").evaluate(ue,{},p),zi=m.get("symbol-placement"),ir=zi==="point"?24*m.get("text-max-width").evaluate(ue,{},p):0,lr=function(){t.allowVerticalPlacement&&tl(yi)&&(De.vertical=bh(Je,e,i,h,_e,ir,It,_i,"left",We,Re,kn.vertical,!0,zi,Me,ke))};if(!Ot&&di){for(var ar=Qe==="auto"?di.map(function(Si){return Sc(Si)}):[Qe],rr=!1,hr=0;hr<ar.length;hr++){var Cr=ar[hr];if(!De.horizontal[Cr])if(rr)De.horizontal[Cr]=De.horizontal[0];else{var Ar=bh(Je,e,i,h,_e,ir,It,"center",Cr,We,Re,kn.horizontal,!1,zi,Me,ke);Ar&&(De.horizontal[Cr]=Ar,rr=Ar.positionedLines.length===1)}}lr()}else{Qe==="auto"&&(Qe=Sc(_i));var Yr=bh(Je,e,i,h,_e,ir,It,_i,Qe,We,Re,kn.horizontal,!1,zi,Me,ke);Yr&&(De.horizontal[Qe]=Yr),lr(),tl(yi)&&Ot&&Wt&&(De.vertical=bh(Je,e,i,h,_e,ir,It,_i,Qe,We,Re,kn.vertical,!1,zi,Me,ke))}}var zr=void 0,Kr=!1;if(ue.icon&&ue.icon.name){var fr=a[ue.icon.name];fr&&(zr=function(Si,Zi,Ui){var Pi=xc(Ui),nn=Zi[0]-Si.displaySize[0]*Pi.horizontalAlign,Ur=Zi[1]-Si.displaySize[1]*Pi.verticalAlign;return{image:Si,top:Ur,bottom:Ur+Si.displaySize[1],left:nn,right:nn+Si.displaySize[0]}}(h[ue.icon.name],m.get("icon-offset").evaluate(ue,{},p),m.get("icon-anchor").evaluate(ue,{},p)),Kr=fr.sdf,t.sdfIcons===void 0?t.sdfIcons=fr.sdf:t.sdfIcons!==fr.sdf&&z("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fr.pixelRatio!==t.pixelRatio||m.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}var Dr=Mu(De.horizontal)||De.vertical;t.iconsInText=!!Dr&&Dr.iconsInText,(Dr||zr)&&function(Si,Zi,Ui,Pi,nn,Ur,$i,_r,Nr,Di,mo){var Cn=Ur.textMaxSize.evaluate(Zi,{});Cn===void 0&&(Cn=$i);var go,mr=Si.layers[0].layout,yo=mr.get("icon-offset").evaluate(Zi,{},mo),Nn=Mu(Ui.horizontal),ks=$i/24,Ua=Si.tilePixelRatio*ks,Cs=Si.tilePixelRatio*Cn/24,Xo=Si.tilePixelRatio*_r,As=Si.tilePixelRatio*mr.get("symbol-spacing"),Ih=mr.get("text-padding")*Si.tilePixelRatio,Es=mr.get("icon-padding")*Si.tilePixelRatio,bl=mr.get("text-max-angle")/180*Math.PI,Lh=mr.get("text-rotation-alignment")==="map"&&mr.get("symbol-placement")!=="point",zh=mr.get("icon-rotation-alignment")==="map"&&mr.get("symbol-placement")!=="point",Wo=mr.get("symbol-placement"),wl=As/2,Ms=mr.get("icon-text-fit");Pi&&Ms!=="none"&&(Si.allowVerticalPlacement&&Ui.vertical&&(go=yu(Pi,Ui.vertical,Ms,mr.get("icon-text-fit-padding"),yo,ks)),Nn&&(Pi=yu(Pi,Nn,Ms,mr.get("icon-text-fit-padding"),yo,ks)));var ca=function(sf,Pl){Pl.x<0||Pl.x>=8192||Pl.y<0||Pl.y>=8192||function(gr,Yn,lf,ua,Lc,Wu,jh,vo,Uh,Il,Nh,Vh,zc,Hu,Ll,Zu,Yu,Ku,Ju,$u,An,Gh,Qu,_o,hf){var tp,Va,Ds,Os,Bs,Rs=gr.addToLineVertexArray(Yn,lf),ep=0,ip=0,rp=0,np=0,Dc=-1,Oc=-1,Ho={},op=Pt(""),Bc=0,Rc=0;if(vo._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Bc=(tp=vo.layout.get("text-offset").evaluate(An,{},_o).map(function(Dl){return 24*Dl}))[0],Rc=tp[1]):(Bc=24*vo.layout.get("text-radial-offset").evaluate(An,{},_o),Rc=wc),gr.allowVerticalPlacement&&ua.vertical){var ap=vo.layout.get("text-rotate").evaluate(An,{},_o)+90;Os=new Ch(Uh,Yn,Il,Nh,Vh,ua.vertical,zc,Hu,Ll,ap),jh&&(Bs=new Ch(Uh,Yn,Il,Nh,Vh,jh,Yu,Ku,Ll,ap))}if(Lc){var Fc=vo.layout.get("icon-rotate").evaluate(An,{}),sp=vo.layout.get("icon-text-fit")!=="none",lp=ku(Lc,Fc,Qu,sp),jc=jh?ku(jh,Fc,Qu,sp):void 0;Ds=new Ch(Uh,Yn,Il,Nh,Vh,Lc,Yu,Ku,!1,Fc),ep=4*lp.length;var hp=gr.iconSizeData,zl=null;hp.kind==="source"?(zl=[128*vo.layout.get("icon-size").evaluate(An,{})])[0]>32640&&z(gr.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):hp.kind==="composite"&&((zl=[128*Gh.compositeIconSizes[0].evaluate(An,{},_o),128*Gh.compositeIconSizes[1].evaluate(An,{},_o)])[0]>32640||zl[1]>32640)&&z(gr.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),gr.addSymbols(gr.icon,lp,zl,$u,Ju,An,!1,Yn,Rs.lineStartIndex,Rs.lineLength,-1,_o),Dc=gr.icon.placedSymbolArray.length-1,jc&&(ip=4*jc.length,gr.addSymbols(gr.icon,jc,zl,$u,Ju,An,kn.vertical,Yn,Rs.lineStartIndex,Rs.lineLength,-1,_o),Oc=gr.icon.placedSymbolArray.length-1)}for(var cp in ua.horizontal){var qh=ua.horizontal[cp];if(!Va){op=Pt(qh.text);var cf=vo.layout.get("text-rotate").evaluate(An,{},_o);Va=new Ch(Uh,Yn,Il,Nh,Vh,qh,zc,Hu,Ll,cf)}var up=qh.positionedLines.length===1;if(rp+=Eu(gr,Yn,qh,Wu,vo,Ll,An,Zu,Rs,ua.vertical?kn.horizontal:kn.horizontalOnly,up?Object.keys(ua.horizontal):[cp],Ho,Dc,Gh,_o),up)break}ua.vertical&&(np+=Eu(gr,Yn,ua.vertical,Wu,vo,Ll,An,Zu,Rs,kn.vertical,["vertical"],Ho,Oc,Gh,_o));var uf=Va?Va.boxStartIndex:gr.collisionBoxArray.length,pf=Va?Va.boxEndIndex:gr.collisionBoxArray.length,df=Os?Os.boxStartIndex:gr.collisionBoxArray.length,ff=Os?Os.boxEndIndex:gr.collisionBoxArray.length,mf=Ds?Ds.boxStartIndex:gr.collisionBoxArray.length,gf=Ds?Ds.boxEndIndex:gr.collisionBoxArray.length,yf=Bs?Bs.boxStartIndex:gr.collisionBoxArray.length,vf=Bs?Bs.boxEndIndex:gr.collisionBoxArray.length,xo=-1,Xh=function(Dl,dp){return Dl&&Dl.circleDiameter?Math.max(Dl.circleDiameter,dp):dp};xo=Xh(Va,xo),xo=Xh(Os,xo),xo=Xh(Ds,xo);var pp=(xo=Xh(Bs,xo))>-1?1:0;pp&&(xo*=hf/24),gr.glyphOffsetArray.length>=Gi.MAX_GLYPHS&&z("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),An.sortKey!==void 0&&gr.addToSortKeyRanges(gr.symbolInstances.length,An.sortKey),gr.symbolInstances.emplaceBack(Yn.x,Yn.y,Ho.right>=0?Ho.right:-1,Ho.center>=0?Ho.center:-1,Ho.left>=0?Ho.left:-1,Ho.vertical||-1,Dc,Oc,op,uf,pf,df,ff,mf,gf,yf,vf,Il,rp,np,ep,ip,pp,0,zc,Bc,Rc,xo)}(Si,Pl,sf,Ui,Pi,nn,go,Si.layers[0],Si.collisionBoxArray,Zi.index,Zi.sourceLayerIndex,Si.index,Ua,Ih,Lh,Nr,Xo,Es,zh,yo,Zi,Ur,Di,mo,$i)};if(Wo==="line")for(var Ps=0,Dh=Tu(Zi.geometry,0,0,8192,8192);Ps<Dh.length;Ps+=1)for(var Oh=Dh[Ps],Sl=0,Tl=Gd(Oh,As,bl,Ui.vertical||Nn,Pi,24,Cs,Si.overscaling,8192);Sl<Tl.length;Sl+=1){var Bh=Tl[Sl];Nn&&Hd(Si,Nn.text,wl,Bh)||ca(Oh,Bh)}else if(Wo==="line-center")for(var kl=0,Cl=Zi.geometry;kl<Cl.length;kl+=1){var Al=Cl[kl];if(Al.length>1){var Rh=Vd(Al,bl,Ui.vertical||Nn,Pi,24,Cs);Rh&&ca(Al,Rh)}}else if(Zi.type==="Polygon")for(var Is=0,Fh=mc(Zi.geometry,0);Is<Fh.length;Is+=1){var Ls=Fh[Is],El=Xd(Ls,16);ca(Ls[0],new vs(El.x,El.y,0))}else if(Zi.type==="LineString")for(var Na=0,Ml=Zi.geometry;Na<Ml.length;Na+=1){var zs=Ml[Na];ca(zs,new vs(zs[0].x,zs[0].y,0))}else if(Zi.type==="Point")for(var Mc=0,qu=Zi.geometry;Mc<qu.length;Mc+=1)for(var Pc=0,Xu=qu[Mc];Pc<Xu.length;Pc+=1){var Ic=Xu[Pc];ca([Ic],new vs(Ic.x,Ic.y,0))}}(t,ue,De,zr,a,M,Me,He,Re,Kr,p)},ae=0,he=t.features;ae<he.length;ae+=1)ie();c&&t.generateCollisionDebugBuffers()},l.perspective=function(t,e,i,a,h){var c,p=1/Math.tan(e/2);return t[0]=p/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,h!=null&&h!==1/0?(t[10]=(h+a)*(c=1/(a-h)),t[14]=2*h*a*c):(t[10]=-1,t[14]=-2*a),t},l.pick=function(t,e){for(var i={},a=0;a<e.length;a++){var h=e[a];h in t&&(i[h]=t[h])}return i},l.plugin=mn,l.polygonIntersectsPolygon=uo,l.postMapLoadEvent=re,l.postTurnstileEvent=Ht,l.potpack=du,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.register=Ve,l.registerForPluginStateChange=function(t){return t({pluginStatus:hn,pluginURL:qn}),il.on("pluginStateChange",t),t},l.renderColorRamp=Zc,l.rotate=function(t,e,i){var a=e[0],h=e[1],c=e[2],p=e[3],m=Math.sin(i),b=Math.cos(i);return t[0]=a*b+c*m,t[1]=h*b+p*m,t[2]=a*-m+c*b,t[3]=h*-m+p*b,t},l.rotateX=function(t,e,i){var a=Math.sin(i),h=Math.cos(i),c=e[4],p=e[5],m=e[6],b=e[7],M=e[8],O=e[9],N=e[10],nt=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=c*h+M*a,t[5]=p*h+O*a,t[6]=m*h+N*a,t[7]=b*h+nt*a,t[8]=M*h-c*a,t[9]=O*h-p*a,t[10]=N*h-m*a,t[11]=nt*h-b*a,t},l.rotateZ=function(t,e,i){var a=Math.sin(i),h=Math.cos(i),c=e[0],p=e[1],m=e[2],b=e[3],M=e[4],O=e[5],N=e[6],nt=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=c*h+M*a,t[1]=p*h+O*a,t[2]=m*h+N*a,t[3]=b*h+nt*a,t[4]=M*h-c*a,t[5]=O*h-p*a,t[6]=N*h-m*a,t[7]=nt*h-b*a,t},l.scale=function(t,e,i){var a=i[0],h=i[1],c=i[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*h,t[5]=e[5]*h,t[6]=e[6]*h,t[7]=e[7]*h,t[8]=e[8]*c,t[9]=e[9]*c,t[10]=e[10]*c,t[11]=e[11]*c,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},l.scale$1=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},l.scale$2=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},l.setCacheLimits=function(t,e){Jt=t,ye=e},l.setRTLTextPlugin=function(t,e,i){if(i===void 0&&(i=!1),hn==="deferred"||hn==="loading"||hn==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");qn=A.resolveURL(t),hn="deferred",ns=e,Ea(),i||In()},l.sphericalToCartesian=function(t){var e=t[0],i=t[1],a=t[2];return i+=90,i*=Math.PI/180,a*=Math.PI/180,{x:e*Math.cos(i)*Math.sin(a),y:e*Math.sin(i)*Math.sin(a),z:e*Math.cos(a)}},l.sqrLen=function(t){var e=t[0],i=t[1];return e*e+i*i},l.styleSpec=yt,l.sub=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},l.symbolSize=Nd,l.transformMat3=function(t,e,i){var a=e[0],h=e[1],c=e[2];return t[0]=a*i[0]+h*i[3]+c*i[6],t[1]=a*i[1]+h*i[4]+c*i[7],t[2]=a*i[2]+h*i[5]+c*i[8],t},l.transformMat4=cs,l.translate=function(t,e,i){var a,h,c,p,m,b,M,O,N,nt,ft,It,Ot=i[0],Wt=i[1],Gt=i[2];return e===t?(t[12]=e[0]*Ot+e[4]*Wt+e[8]*Gt+e[12],t[13]=e[1]*Ot+e[5]*Wt+e[9]*Gt+e[13],t[14]=e[2]*Ot+e[6]*Wt+e[10]*Gt+e[14],t[15]=e[3]*Ot+e[7]*Wt+e[11]*Gt+e[15]):(h=e[1],c=e[2],p=e[3],m=e[4],b=e[5],M=e[6],O=e[7],N=e[8],nt=e[9],ft=e[10],It=e[11],t[0]=a=e[0],t[1]=h,t[2]=c,t[3]=p,t[4]=m,t[5]=b,t[6]=M,t[7]=O,t[8]=N,t[9]=nt,t[10]=ft,t[11]=It,t[12]=a*Ot+m*Wt+N*Gt+e[12],t[13]=h*Ot+b*Wt+nt*Gt+e[13],t[14]=c*Ot+M*Wt+ft*Gt+e[14],t[15]=p*Ot+O*Wt+It*Gt+e[15]),t},l.triggerPluginCompletionEvent=uh,l.uniqueId=U,l.validateCustomStyleLayer=function(t){var e=[],i=t.id;return i===void 0&&e.push({message:"layers."+i+': missing required property "id"'}),t.render===void 0&&e.push({message:"layers."+i+': missing required method "render"'}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),e},l.validateLight=ac,l.validateStyle=Ta,l.values=function(t){var e=[];for(var i in t)e.push(t[i]);return e},l.vectorTile=fs,l.version="1.13.3",l.warnOnce=z,l.webpSupported=K,l.window=ut,l.wrap=W}),At(["./shared"],function(l){function Zt(F){var tt=typeof F;if(tt==="number"||tt==="boolean"||tt==="string"||F==null)return JSON.stringify(F);if(Array.isArray(F)){for(var ct="[",St=0,zt=F;St<zt.length;St+=1)ct+=Zt(zt[St])+",";return ct+"]"}for(var Yt=Object.keys(F).sort(),$t="{",yt=0;yt<Yt.length;yt++)$t+=JSON.stringify(Yt[yt])+":"+Zt(F[Yt[yt]])+",";return $t+"}"}function dt(F){for(var tt="",ct=0,St=l.refProperties;ct<St.length;ct+=1)tt+="/"+Zt(F[St[ct]]);return tt}var Nt=function(F){this.keyCache={},F&&this.replace(F)};Nt.prototype.replace=function(F){this._layerConfigs={},this._layers={},this.update(F,[])},Nt.prototype.update=function(F,tt){for(var ct=this,St=0,zt=F;St<zt.length;St+=1){var Yt=zt[St];this._layerConfigs[Yt.id]=Yt;var $t=this._layers[Yt.id]=l.createStyleLayer(Yt);$t._featureFilter=l.featureFilter($t.filter),this.keyCache[Yt.id]&&delete this.keyCache[Yt.id]}for(var yt=0,Ut=tt;yt<Ut.length;yt+=1){var oe=Ut[yt];delete this.keyCache[oe],delete this._layerConfigs[oe],delete this._layers[oe]}this.familiesBySource={};for(var we=0,Te=function(Pe,Le){for(var vi={},Be=0;Be<Pe.length;Be++){var ki=Le&&Le[Pe[Be].id]||dt(Pe[Be]);Le&&(Le[Pe[Be].id]=ki);var Wi=vi[ki];Wi||(Wi=vi[ki]=[]),Wi.push(Pe[Be])}var bi=[];for(var Oi in vi)bi.push(vi[Oi]);return bi}(l.values(this._layerConfigs),this.keyCache);we<Te.length;we+=1){var fe=Te[we].map(function(Pe){return ct._layers[Pe.id]}),Se=fe[0];if(Se.visibility!=="none"){var qe=Se.source||"",Ne=this.familiesBySource[qe];Ne||(Ne=this.familiesBySource[qe]={});var me=Se.sourceLayer||"_geojsonTileLayer",Fe=Ne[me];Fe||(Fe=Ne[me]=[]),Fe.push(fe)}}};var Lt=function(F){var tt={},ct=[];for(var St in F){var zt=F[St],Yt=tt[St]={};for(var $t in zt){var yt=zt[+$t];if(yt&&yt.bitmap.width!==0&&yt.bitmap.height!==0){var Ut={x:0,y:0,w:yt.bitmap.width+2,h:yt.bitmap.height+2};ct.push(Ut),Yt[$t]={rect:Ut,metrics:yt.metrics}}}}var oe=l.potpack(ct),we=new l.AlphaImage({width:oe.w||1,height:oe.h||1});for(var Te in F){var fe=F[Te];for(var Se in fe){var qe=fe[+Se];if(qe&&qe.bitmap.width!==0&&qe.bitmap.height!==0){var Ne=tt[Te][Se].rect;l.AlphaImage.copy(qe.bitmap,we,{x:0,y:0},{x:Ne.x+1,y:Ne.y+1},qe.bitmap)}}}this.image=we,this.positions=tt};l.register("GlyphAtlas",Lt);var kt=function(F){this.tileID=new l.OverscaledTileID(F.tileID.overscaledZ,F.tileID.wrap,F.tileID.canonical.z,F.tileID.canonical.x,F.tileID.canonical.y),this.uid=F.uid,this.zoom=F.zoom,this.pixelRatio=F.pixelRatio,this.tileSize=F.tileSize,this.source=F.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=F.showCollisionBoxes,this.collectResourceTiming=!!F.collectResourceTiming,this.returnDependencies=!!F.returnDependencies,this.promoteId=F.promoteId};function ut(F,tt,ct){for(var St=new l.EvaluationParameters(tt),zt=0,Yt=F;zt<Yt.length;zt+=1)Yt[zt].recalculate(St,ct)}function Rt(F,tt){var ct=l.getArrayBuffer(F.request,function(St,zt,Yt,$t){St?tt(St):zt&&tt(null,{vectorTile:new l.vectorTile.VectorTile(new l.pbf(zt)),rawData:zt,cacheControl:Yt,expires:$t})});return function(){ct.cancel(),tt()}}kt.prototype.parse=function(F,tt,ct,St,zt){var Yt=this;this.status="parsing",this.data=F,this.collisionBoxArray=new l.CollisionBoxArray;var $t=new l.DictionaryCoder(Object.keys(F.layers).sort()),yt=new l.FeatureIndex(this.tileID,this.promoteId);yt.bucketLayerIDs=[];var Ut,oe,we,Te,fe={},Se={featureIndex:yt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ct},qe=tt.familiesBySource[this.source];for(var Ne in qe){var me=F.layers[Ne];if(me){me.version===1&&l.warnOnce('Vector tile source "'+this.source+'" layer "'+Ne+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Fe=$t.encode(Ne),Pe=[],Le=0;Le<me.length;Le++){var vi=me.feature(Le),Be=yt.getId(vi,Ne);Pe.push({feature:vi,id:Be,index:Le,sourceLayerIndex:Fe})}for(var ki=0,Wi=qe[Ne];ki<Wi.length;ki+=1){var bi=Wi[ki],Oi=bi[0];Oi.minzoom&&this.zoom<Math.floor(Oi.minzoom)||Oi.maxzoom&&this.zoom>=Oi.maxzoom||Oi.visibility!=="none"&&(ut(bi,this.zoom,ct),(fe[Oi.id]=Oi.createBucket({index:yt.bucketLayerIDs.length,layers:bi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Fe,sourceID:this.source})).populate(Pe,Se,this.tileID.canonical),yt.bucketLayerIDs.push(bi.map(function(Vi){return Vi.id})))}}}var Ai=l.mapObject(Se.glyphDependencies,function(Vi){return Object.keys(Vi).map(Number)});Object.keys(Ai).length?St.send("getGlyphs",{uid:this.uid,stacks:Ai},function(Vi,Ti){Ut||(Ut=Vi,oe=Ti,ur.call(Yt))}):oe={};var Vr=Object.keys(Se.iconDependencies);Vr.length?St.send("getImages",{icons:Vr,source:this.source,tileID:this.tileID,type:"icons"},function(Vi,Ti){Ut||(Ut=Vi,we=Ti,ur.call(Yt))}):we={};var Fi=Object.keys(Se.patternDependencies);function ur(){if(Ut)return zt(Ut);if(oe&&we&&Te){var Vi=new Lt(oe),Ti=new l.ImageAtlas(we,Te);for(var Bi in fe){var $r=fe[Bi];$r instanceof l.SymbolBucket?(ut($r.layers,this.zoom,ct),l.performSymbolLayout($r,oe,Vi.positions,we,Ti.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):$r.hasPattern&&($r instanceof l.LineBucket||$r instanceof l.FillBucket||$r instanceof l.FillExtrusionBucket)&&(ut($r.layers,this.zoom,ct),$r.addFeatures(Se,this.tileID.canonical,Ti.patternPositions))}this.status="done",zt(null,{buckets:l.values(fe).filter(function(pa){return!pa.isEmpty()}),featureIndex:yt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Vi.image,imageAtlas:Ti,glyphMap:this.returnDependencies?oe:null,iconMap:this.returnDependencies?we:null,glyphPositions:this.returnDependencies?Vi.positions:null})}}Fi.length?St.send("getImages",{icons:Fi,source:this.source,tileID:this.tileID,type:"patterns"},function(Vi,Ti){Ut||(Ut=Vi,Te=Ti,ur.call(Yt))}):Te={},ur.call(this)};var Z=function(F,tt,ct,St){this.actor=F,this.layerIndex=tt,this.availableImages=ct,this.loadVectorData=St||Rt,this.loading={},this.loaded={}};Z.prototype.loadTile=function(F,tt){var ct=this,St=F.uid;this.loading||(this.loading={});var zt=!!(F&&F.request&&F.request.collectResourceTiming)&&new l.RequestPerformance(F.request),Yt=this.loading[St]=new kt(F);Yt.abort=this.loadVectorData(F,function($t,yt){if(delete ct.loading[St],$t||!yt)return Yt.status="done",ct.loaded[St]=Yt,tt($t);var Ut=yt.rawData,oe={};yt.expires&&(oe.expires=yt.expires),yt.cacheControl&&(oe.cacheControl=yt.cacheControl);var we={};if(zt){var Te=zt.finish();Te&&(we.resourceTiming=JSON.parse(JSON.stringify(Te)))}Yt.vectorTile=yt.vectorTile,Yt.parse(yt.vectorTile,ct.layerIndex,ct.availableImages,ct.actor,function(fe,Se){if(fe||!Se)return tt(fe);tt(null,l.extend({rawTileData:Ut.slice(0)},Se,oe,we))}),ct.loaded=ct.loaded||{},ct.loaded[St]=Yt})},Z.prototype.reloadTile=function(F,tt){var ct=this,St=this.loaded,zt=F.uid,Yt=this;if(St&&St[zt]){var $t=St[zt];$t.showCollisionBoxes=F.showCollisionBoxes;var yt=function(Ut,oe){var we=$t.reloadCallback;we&&(delete $t.reloadCallback,$t.parse($t.vectorTile,Yt.layerIndex,ct.availableImages,Yt.actor,we)),tt(Ut,oe)};$t.status==="parsing"?$t.reloadCallback=yt:$t.status==="done"&&($t.vectorTile?$t.parse($t.vectorTile,this.layerIndex,this.availableImages,this.actor,yt):yt())}},Z.prototype.abortTile=function(F,tt){var ct=this.loading,St=F.uid;ct&&ct[St]&&ct[St].abort&&(ct[St].abort(),delete ct[St]),tt()},Z.prototype.removeTile=function(F,tt){var ct=this.loaded,St=F.uid;ct&&ct[St]&&delete ct[St],tt()};var lt=l.window.ImageBitmap,at=function(){this.loaded={}};function W(F,tt){if(F.length!==0){q(F[0],tt);for(var ct=1;ct<F.length;ct++)q(F[ct],!tt)}}function q(F,tt){for(var ct=0,St=0,zt=0,Yt=F.length,$t=Yt-1;zt<Yt;$t=zt++){var yt=(F[zt][0]-F[$t][0])*(F[$t][1]+F[zt][1]),Ut=ct+yt;St+=Math.abs(ct)>=Math.abs(yt)?ct-Ut+yt:yt-Ut+ct,ct=Ut}ct+St>=0!=!!tt&&F.reverse()}at.prototype.loadTile=function(F,tt){var ct=F.uid,St=F.encoding,zt=F.rawImageData,Yt=lt&&zt instanceof lt?this.getImageData(zt):zt,$t=new l.DEMData(ct,Yt,St);this.loaded=this.loaded||{},this.loaded[ct]=$t,tt(null,$t)},at.prototype.getImageData=function(F){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(F.width,F.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=F.width,this.offscreenCanvas.height=F.height,this.offscreenCanvasContext.drawImage(F,0,0,F.width,F.height);var tt=this.offscreenCanvasContext.getImageData(-1,-1,F.width+2,F.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:tt.width,height:tt.height},tt.data)},at.prototype.removeTile=function(F){var tt=this.loaded,ct=F.uid;tt&&tt[ct]&&delete tt[ct]};var $=l.vectorTile.VectorTileFeature.prototype.toGeoJSON,U=function(F){this._feature=F,this.extent=l.EXTENT,this.type=F.type,this.properties=F.tags,"id"in F&&!isNaN(F.id)&&(this.id=parseInt(F.id,10))};U.prototype.loadGeometry=function(){if(this._feature.type===1){for(var F=[],tt=0,ct=this._feature.geometry;tt<ct.length;tt+=1){var St=ct[tt];F.push([new l.Point$1(St[0],St[1])])}return F}for(var zt=[],Yt=0,$t=this._feature.geometry;Yt<$t.length;Yt+=1){for(var yt=[],Ut=0,oe=$t[Yt];Ut<oe.length;Ut+=1){var we=oe[Ut];yt.push(new l.Point$1(we[0],we[1]))}zt.push(yt)}return zt},U.prototype.toGeoJSON=function(F,tt,ct){return $.call(this,F,tt,ct)};var j=function(F){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=F.length,this._features=F};j.prototype.feature=function(F){return new U(this._features[F])};var et=l.vectorTile.VectorTileFeature,_t=mt;function mt(F,tt){this.options=tt||{},this.features=F,this.length=F.length}function V(F,tt){this.id=typeof F.id=="number"?F.id:void 0,this.type=F.type,this.rawGeometry=F.type===1?[F.geometry]:F.geometry,this.properties=F.tags,this.extent=tt||4096}mt.prototype.feature=function(F){return new V(this.features[F],this.options.extent)},V.prototype.loadGeometry=function(){var F=this.rawGeometry;this.geometry=[];for(var tt=0;tt<F.length;tt++){for(var ct=F[tt],St=[],zt=0;zt<ct.length;zt++)St.push(new l.Point$1(ct[zt][0],ct[zt][1]));this.geometry.push(St)}return this.geometry},V.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var F=this.geometry,tt=1/0,ct=-1/0,St=1/0,zt=-1/0,Yt=0;Yt<F.length;Yt++)for(var $t=F[Yt],yt=0;yt<$t.length;yt++){var Ut=$t[yt];tt=Math.min(tt,Ut.x),ct=Math.max(ct,Ut.x),St=Math.min(St,Ut.y),zt=Math.max(zt,Ut.y)}return[tt,St,ct,zt]},V.prototype.toGeoJSON=et.prototype.toGeoJSON;var rt=C,I=_t;function C(F){var tt=new l.pbf;return function(ct,St){for(var zt in ct.layers)St.writeMessage(3,z,ct.layers[zt])}(F,tt),tt.finish()}function z(F,tt){var ct;tt.writeVarintField(15,F.version||1),tt.writeStringField(1,F.name||""),tt.writeVarintField(5,F.extent||4096);var St={keys:[],values:[],keycache:{},valuecache:{}};for(ct=0;ct<F.length;ct++)St.feature=F.feature(ct),tt.writeMessage(2,S,St);var zt=St.keys;for(ct=0;ct<zt.length;ct++)tt.writeStringField(3,zt[ct]);var Yt=St.values;for(ct=0;ct<Yt.length;ct++)tt.writeMessage(4,k,Yt[ct])}function S(F,tt){var ct=F.feature;ct.id!==void 0&&tt.writeVarintField(1,ct.id),tt.writeMessage(2,g,F),tt.writeVarintField(3,ct.type),tt.writeMessage(4,T,ct)}function g(F,tt){var ct=F.feature,St=F.keys,zt=F.values,Yt=F.keycache,$t=F.valuecache;for(var yt in ct.properties){var Ut=Yt[yt];Ut===void 0&&(St.push(yt),Yt[yt]=Ut=St.length-1),tt.writeVarint(Ut);var oe=ct.properties[yt],we=typeof oe;we!=="string"&&we!=="boolean"&&we!=="number"&&(oe=JSON.stringify(oe));var Te=we+":"+oe,fe=$t[Te];fe===void 0&&(zt.push(oe),$t[Te]=fe=zt.length-1),tt.writeVarint(fe)}}function v(F,tt){return(tt<<3)+(7&F)}function y(F){return F<<1^F>>31}function T(F,tt){for(var ct=F.loadGeometry(),St=F.type,zt=0,Yt=0,$t=ct.length,yt=0;yt<$t;yt++){var Ut=ct[yt],oe=1;St===1&&(oe=Ut.length),tt.writeVarint(v(1,oe));for(var we=St===3?Ut.length-1:Ut.length,Te=0;Te<we;Te++){Te===1&&St!==1&&tt.writeVarint(v(2,we-1));var fe=Ut[Te].x-zt,Se=Ut[Te].y-Yt;tt.writeVarint(y(fe)),tt.writeVarint(y(Se)),zt+=fe,Yt+=Se}St===3&&tt.writeVarint(v(7,1))}}function k(F,tt){var ct=typeof F;ct==="string"?tt.writeStringField(1,F):ct==="boolean"?tt.writeBooleanField(7,F):ct==="number"&&(F%1!=0?tt.writeDoubleField(3,F):F<0?tt.writeSVarintField(6,F):tt.writeVarintField(5,F))}function E(F,tt,ct,St){w(F,ct,St),w(tt,2*ct,2*St),w(tt,2*ct+1,2*St+1)}function w(F,tt,ct){var St=F[tt];F[tt]=F[ct],F[ct]=St}function R(F,tt,ct,St){var zt=F-ct,Yt=tt-St;return zt*zt+Yt*Yt}rt.fromVectorTileJs=C,rt.fromGeojsonVt=function(F,tt){tt=tt||{};var ct={};for(var St in F)ct[St]=new _t(F[St].features,tt),ct[St].name=St,ct[St].version=tt.version,ct[St].extent=tt.extent;return C({layers:ct})},rt.GeoJSONWrapper=I;var J=function(F){return F[0]},wt=function(F){return F[1]},ot=function(F,tt,ct,St,zt){tt===void 0&&(tt=J),ct===void 0&&(ct=wt),St===void 0&&(St=64),zt===void 0&&(zt=Float64Array),this.nodeSize=St,this.points=F;for(var Yt=F.length<65536?Uint16Array:Uint32Array,$t=this.ids=new Yt(F.length),yt=this.coords=new zt(2*F.length),Ut=0;Ut<F.length;Ut++)$t[Ut]=Ut,yt[2*Ut]=tt(F[Ut]),yt[2*Ut+1]=ct(F[Ut]);(function oe(we,Te,fe,Se,qe,Ne){if(!(qe-Se<=fe)){var me=Se+qe>>1;(function Fe(Pe,Le,vi,Be,ki,Wi){for(;ki>Be;){if(ki-Be>600){var bi=ki-Be+1,Oi=vi-Be+1,Ai=Math.log(bi),Vr=.5*Math.exp(2*Ai/3),Fi=.5*Math.sqrt(Ai*Vr*(bi-Vr)/bi)*(Oi-bi/2<0?-1:1);Fe(Pe,Le,vi,Math.max(Be,Math.floor(vi-Oi*Vr/bi+Fi)),Math.min(ki,Math.floor(vi+(bi-Oi)*Vr/bi+Fi)),Wi)}var ur=Le[2*vi+Wi],Vi=Be,Ti=ki;for(E(Pe,Le,Be,vi),Le[2*ki+Wi]>ur&&E(Pe,Le,Be,ki);Vi<Ti;){for(E(Pe,Le,Vi,Ti),Vi++,Ti--;Le[2*Vi+Wi]<ur;)Vi++;for(;Le[2*Ti+Wi]>ur;)Ti--}Le[2*Be+Wi]===ur?E(Pe,Le,Be,Ti):E(Pe,Le,++Ti,ki),Ti<=vi&&(Be=Ti+1),vi<=Ti&&(ki=Ti-1)}})(we,Te,me,Se,qe,Ne%2),oe(we,Te,fe,Se,me-1,Ne+1),oe(we,Te,fe,me+1,qe,Ne+1)}})($t,yt,St,0,$t.length-1,0)};ot.prototype.range=function(F,tt,ct,St){return function(zt,Yt,$t,yt,Ut,oe,we){for(var Te,fe,Se=[0,zt.length-1,0],qe=[];Se.length;){var Ne=Se.pop(),me=Se.pop(),Fe=Se.pop();if(me-Fe<=we)for(var Pe=Fe;Pe<=me;Pe++)fe=Yt[2*Pe+1],(Te=Yt[2*Pe])>=$t&&Te<=Ut&&fe>=yt&&fe<=oe&&qe.push(zt[Pe]);else{var Le=Math.floor((Fe+me)/2);fe=Yt[2*Le+1],(Te=Yt[2*Le])>=$t&&Te<=Ut&&fe>=yt&&fe<=oe&&qe.push(zt[Le]);var vi=(Ne+1)%2;(Ne===0?$t<=Te:yt<=fe)&&(Se.push(Fe),Se.push(Le-1),Se.push(vi)),(Ne===0?Ut>=Te:oe>=fe)&&(Se.push(Le+1),Se.push(me),Se.push(vi))}}return qe}(this.ids,this.coords,F,tt,ct,St,this.nodeSize)},ot.prototype.within=function(F,tt,ct){return function(St,zt,Yt,$t,yt,Ut){for(var oe=[0,St.length-1,0],we=[],Te=yt*yt;oe.length;){var fe=oe.pop(),Se=oe.pop(),qe=oe.pop();if(Se-qe<=Ut)for(var Ne=qe;Ne<=Se;Ne++)R(zt[2*Ne],zt[2*Ne+1],Yt,$t)<=Te&&we.push(St[Ne]);else{var me=Math.floor((qe+Se)/2),Fe=zt[2*me],Pe=zt[2*me+1];R(Fe,Pe,Yt,$t)<=Te&&we.push(St[me]);var Le=(fe+1)%2;(fe===0?Yt-yt<=Fe:$t-yt<=Pe)&&(oe.push(qe),oe.push(me-1),oe.push(Le)),(fe===0?Yt+yt>=Fe:$t+yt>=Pe)&&(oe.push(me+1),oe.push(Se),oe.push(Le))}}return we}(this.ids,this.coords,F,tt,ct,this.nodeSize)};var it={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(F){return F}},Q=function(F){this.options=D(Object.create(it),F),this.trees=new Array(this.options.maxZoom+1)};function A(F,tt,ct,St,zt){return{x:F,y:tt,zoom:1/0,id:ct,parentId:-1,numPoints:St,properties:zt}}function B(F,tt){var ct=F.geometry.coordinates,St=ct[1];return{x:_(ct[0]),y:P(St),zoom:1/0,index:tt,parentId:-1}}function K(F){return{type:"Feature",id:F.id,properties:pt(F),geometry:{type:"Point",coordinates:[(St=F.x,360*(St-.5)),(tt=F.y,ct=(180-360*tt)*Math.PI/180,360*Math.atan(Math.exp(ct))/Math.PI-90)]}};var tt,ct,St}function pt(F){var tt=F.numPoints,ct=tt>=1e4?Math.round(tt/1e3)+"k":tt>=1e3?Math.round(tt/100)/10+"k":tt;return D(D({},F.properties),{cluster:!0,cluster_id:F.id,point_count:tt,point_count_abbreviated:ct})}function _(F){return F/360+.5}function P(F){var tt=Math.sin(F*Math.PI/180),ct=.5-.25*Math.log((1+tt)/(1-tt))/Math.PI;return ct<0?0:ct>1?1:ct}function D(F,tt){for(var ct in tt)F[ct]=tt[ct];return F}function Y(F){return F.x}function G(F){return F.y}function xt(F,tt,ct,St,zt,Yt){var $t=zt-ct,yt=Yt-St;if($t!==0||yt!==0){var Ut=((F-ct)*$t+(tt-St)*yt)/($t*$t+yt*yt);Ut>1?(ct=zt,St=Yt):Ut>0&&(ct+=$t*Ut,St+=yt*Ut)}return($t=F-ct)*$t+(yt=tt-St)*yt}function Ct(F,tt,ct,St){var zt={id:F===void 0?null:F,type:tt,geometry:ct,tags:St,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Yt){var $t=Yt.geometry,yt=Yt.type;if(yt==="Point"||yt==="MultiPoint"||yt==="LineString")Dt(Yt,$t);else if(yt==="Polygon"||yt==="MultiLineString")for(var Ut=0;Ut<$t.length;Ut++)Dt(Yt,$t[Ut]);else if(yt==="MultiPolygon")for(Ut=0;Ut<$t.length;Ut++)for(var oe=0;oe<$t[Ut].length;oe++)Dt(Yt,$t[Ut][oe])}(zt),zt}function Dt(F,tt){for(var ct=0;ct<tt.length;ct+=3)F.minX=Math.min(F.minX,tt[ct]),F.minY=Math.min(F.minY,tt[ct+1]),F.maxX=Math.max(F.maxX,tt[ct]),F.maxY=Math.max(F.maxY,tt[ct+1])}function jt(F,tt,ct,St){if(tt.geometry){var zt=tt.geometry.coordinates,Yt=tt.geometry.type,$t=Math.pow(ct.tolerance/((1<<ct.maxZoom)*ct.extent),2),yt=[],Ut=tt.id;if(ct.promoteId?Ut=tt.properties[ct.promoteId]:ct.generateId&&(Ut=St||0),Yt==="Point")Kt(zt,yt);else if(Yt==="MultiPoint")for(var oe=0;oe<zt.length;oe++)Kt(zt[oe],yt);else if(Yt==="LineString")ee(zt,yt,$t,!1);else if(Yt==="MultiLineString"){if(ct.lineMetrics){for(oe=0;oe<zt.length;oe++)ee(zt[oe],yt=[],$t,!1),F.push(Ct(Ut,"LineString",yt,tt.properties));return}le(zt,yt,$t,!1)}else if(Yt==="Polygon")le(zt,yt,$t,!0);else{if(Yt!=="MultiPolygon"){if(Yt==="GeometryCollection"){for(oe=0;oe<tt.geometry.geometries.length;oe++)jt(F,{id:Ut,geometry:tt.geometry.geometries[oe],properties:tt.properties},ct,St);return}throw new Error("Input data is not a valid GeoJSON object.")}for(oe=0;oe<zt.length;oe++){var we=[];le(zt[oe],we,$t,!0),yt.push(we)}}F.push(Ct(Ut,Yt,yt,tt.properties))}}function Kt(F,tt){tt.push(ht(F[0])),tt.push(st(F[1])),tt.push(0)}function ee(F,tt,ct,St){for(var zt,Yt,$t=0,yt=0;yt<F.length;yt++){var Ut=ht(F[yt][0]),oe=st(F[yt][1]);tt.push(Ut),tt.push(oe),tt.push(0),yt>0&&($t+=St?(zt*oe-Ut*Yt)/2:Math.sqrt(Math.pow(Ut-zt,2)+Math.pow(oe-Yt,2))),zt=Ut,Yt=oe}var we=tt.length-3;tt[2]=1,function Te(fe,Se,qe,Ne){for(var me,Fe=Ne,Pe=qe-Se>>1,Le=qe-Se,vi=fe[Se],Be=fe[Se+1],ki=fe[qe],Wi=fe[qe+1],bi=Se+3;bi<qe;bi+=3){var Oi=xt(fe[bi],fe[bi+1],vi,Be,ki,Wi);if(Oi>Fe)me=bi,Fe=Oi;else if(Oi===Fe){var Ai=Math.abs(bi-Pe);Ai<Le&&(me=bi,Le=Ai)}}Fe>Ne&&(me-Se>3&&Te(fe,Se,me,Ne),fe[me+2]=Fe,qe-me>3&&Te(fe,me,qe,Ne))}(tt,0,we,ct),tt[we+2]=1,tt.size=Math.abs($t),tt.start=0,tt.end=tt.size}function le(F,tt,ct,St){for(var zt=0;zt<F.length;zt++){var Yt=[];ee(F[zt],Yt,ct,St),tt.push(Yt)}}function ht(F){return F/360+.5}function st(F){var tt=Math.sin(F*Math.PI/180),ct=.5-.25*Math.log((1+tt)/(1-tt))/Math.PI;return ct<0?0:ct>1?1:ct}function Tt(F,tt,ct,St,zt,Yt,$t,yt){if(St/=tt,Yt>=(ct/=tt)&&$t<St)return F;if($t<ct||Yt>=St)return null;for(var Ut=[],oe=0;oe<F.length;oe++){var we=F[oe],Te=we.geometry,fe=we.type,Se=zt===0?we.minX:we.minY,qe=zt===0?we.maxX:we.maxY;if(Se>=ct&&qe<St)Ut.push(we);else if(!(qe<ct||Se>=St)){var Ne=[];if(fe==="Point"||fe==="MultiPoint")Mt(Te,Ne,ct,St,zt);else if(fe==="LineString")Ht(Te,Ne,ct,St,zt,!1,yt.lineMetrics);else if(fe==="MultiLineString")re(Te,Ne,ct,St,zt,!1);else if(fe==="Polygon")re(Te,Ne,ct,St,zt,!0);else if(fe==="MultiPolygon")for(var me=0;me<Te.length;me++){var Fe=[];re(Te[me],Fe,ct,St,zt,!0),Fe.length&&Ne.push(Fe)}if(Ne.length){if(yt.lineMetrics&&fe==="LineString"){for(me=0;me<Ne.length;me++)Ut.push(Ct(we.id,fe,Ne[me],we.tags));continue}fe!=="LineString"&&fe!=="MultiLineString"||(Ne.length===1?(fe="LineString",Ne=Ne[0]):fe="MultiLineString"),fe!=="Point"&&fe!=="MultiPoint"||(fe=Ne.length===3?"Point":"MultiPoint"),Ut.push(Ct(we.id,fe,Ne,we.tags))}}}return Ut.length?Ut:null}function Mt(F,tt,ct,St,zt){for(var Yt=0;Yt<F.length;Yt+=3){var $t=F[Yt+zt];$t>=ct&&$t<=St&&(tt.push(F[Yt]),tt.push(F[Yt+1]),tt.push(F[Yt+2]))}}function Ht(F,tt,ct,St,zt,Yt,$t){for(var yt,Ut,oe=Vt(F),we=zt===0?ye:ze,Te=F.start,fe=0;fe<F.length-3;fe+=3){var Se=F[fe],qe=F[fe+1],Ne=F[fe+2],me=F[fe+3],Fe=F[fe+4],Pe=zt===0?Se:qe,Le=zt===0?me:Fe,vi=!1;$t&&(yt=Math.sqrt(Math.pow(Se-me,2)+Math.pow(qe-Fe,2))),Pe<ct?Le>ct&&(Ut=we(oe,Se,qe,me,Fe,ct),$t&&(oe.start=Te+yt*Ut)):Pe>St?Le<St&&(Ut=we(oe,Se,qe,me,Fe,St),$t&&(oe.start=Te+yt*Ut)):Jt(oe,Se,qe,Ne),Le<ct&&Pe>=ct&&(Ut=we(oe,Se,qe,me,Fe,ct),vi=!0),Le>St&&Pe<=St&&(Ut=we(oe,Se,qe,me,Fe,St),vi=!0),!Yt&&vi&&($t&&(oe.end=Te+yt*Ut),tt.push(oe),oe=Vt(F)),$t&&(Te+=yt)}var Be=F.length-3;Se=F[Be],qe=F[Be+1],Ne=F[Be+2],(Pe=zt===0?Se:qe)>=ct&&Pe<=St&&Jt(oe,Se,qe,Ne),Be=oe.length-3,Yt&&Be>=3&&(oe[Be]!==oe[0]||oe[Be+1]!==oe[1])&&Jt(oe,oe[0],oe[1],oe[2]),oe.length&&tt.push(oe)}function Vt(F){var tt=[];return tt.size=F.size,tt.start=F.start,tt.end=F.end,tt}function re(F,tt,ct,St,zt,Yt){for(var $t=0;$t<F.length;$t++)Ht(F[$t],tt,ct,St,zt,Yt,!1)}function Jt(F,tt,ct,St){F.push(tt),F.push(ct),F.push(St)}function ye(F,tt,ct,St,zt,Yt){var $t=(Yt-tt)/(St-tt);return F.push(Yt),F.push(ct+(zt-ct)*$t),F.push(1),$t}function ze(F,tt,ct,St,zt,Yt){var $t=(Yt-ct)/(zt-ct);return F.push(tt+(St-tt)*$t),F.push(Yt),F.push(1),$t}function ge(F,tt){for(var ct=[],St=0;St<F.length;St++){var zt,Yt=F[St],$t=Yt.type;if($t==="Point"||$t==="MultiPoint"||$t==="LineString")zt=be(Yt.geometry,tt);else if($t==="MultiLineString"||$t==="Polygon"){zt=[];for(var yt=0;yt<Yt.geometry.length;yt++)zt.push(be(Yt.geometry[yt],tt))}else if($t==="MultiPolygon")for(zt=[],yt=0;yt<Yt.geometry.length;yt++){for(var Ut=[],oe=0;oe<Yt.geometry[yt].length;oe++)Ut.push(be(Yt.geometry[yt][oe],tt));zt.push(Ut)}ct.push(Ct(Yt.id,$t,zt,Yt.tags))}return ct}function be(F,tt){var ct=[];ct.size=F.size,F.start!==void 0&&(ct.start=F.start,ct.end=F.end);for(var St=0;St<F.length;St+=3)ct.push(F[St]+tt,F[St+1],F[St+2]);return ct}function Oe(F,tt){if(F.transformed)return F;var ct,St,zt,Yt=1<<F.z,$t=F.x,yt=F.y;for(ct=0;ct<F.features.length;ct++){var Ut=F.features[ct],oe=Ut.geometry,we=Ut.type;if(Ut.geometry=[],we===1)for(St=0;St<oe.length;St+=2)Ut.geometry.push(Ze(oe[St],oe[St+1],tt,Yt,$t,yt));else for(St=0;St<oe.length;St++){var Te=[];for(zt=0;zt<oe[St].length;zt+=2)Te.push(Ze(oe[St][zt],oe[St][zt+1],tt,Yt,$t,yt));Ut.geometry.push(Te)}}return F.transformed=!0,F}function Ze(F,tt,ct,St,zt,Yt){return[Math.round(ct*(F*St-zt)),Math.round(ct*(tt*St-Yt))]}function Ge(F,tt,ct,St,zt){for(var Yt=tt===zt.maxZoom?0:zt.tolerance/((1<<tt)*zt.extent),$t={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ct,y:St,z:tt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},yt=0;yt<F.length;yt++){$t.numFeatures++,Ee($t,F[yt],Yt,zt);var Ut=F[yt].minX,oe=F[yt].minY,we=F[yt].maxX,Te=F[yt].maxY;Ut<$t.minX&&($t.minX=Ut),oe<$t.minY&&($t.minY=oe),we>$t.maxX&&($t.maxX=we),Te>$t.maxY&&($t.maxY=Te)}return $t}function Ee(F,tt,ct,St){var zt=tt.geometry,Yt=tt.type,$t=[];if(Yt==="Point"||Yt==="MultiPoint")for(var yt=0;yt<zt.length;yt+=3)$t.push(zt[yt]),$t.push(zt[yt+1]),F.numPoints++,F.numSimplified++;else if(Yt==="LineString")li($t,zt,F,ct,!1,!1);else if(Yt==="MultiLineString"||Yt==="Polygon")for(yt=0;yt<zt.length;yt++)li($t,zt[yt],F,ct,Yt==="Polygon",yt===0);else if(Yt==="MultiPolygon")for(var Ut=0;Ut<zt.length;Ut++){var oe=zt[Ut];for(yt=0;yt<oe.length;yt++)li($t,oe[yt],F,ct,!0,yt===0)}if($t.length){var we=tt.tags||null;if(Yt==="LineString"&&St.lineMetrics){for(var Te in we={},tt.tags)we[Te]=tt.tags[Te];we.mapbox_clip_start=zt.start/zt.size,we.mapbox_clip_end=zt.end/zt.size}var fe={geometry:$t,type:Yt==="Polygon"||Yt==="MultiPolygon"?3:Yt==="LineString"||Yt==="MultiLineString"?2:1,tags:we};tt.id!==null&&(fe.id=tt.id),F.features.push(fe)}}function li(F,tt,ct,St,zt,Yt){var $t=St*St;if(St>0&&tt.size<(zt?$t:St))ct.numPoints+=tt.length/3;else{for(var yt=[],Ut=0;Ut<tt.length;Ut+=3)(St===0||tt[Ut+2]>$t)&&(ct.numSimplified++,yt.push(tt[Ut]),yt.push(tt[Ut+1])),ct.numPoints++;zt&&function(oe,we){for(var Te=0,fe=0,Se=oe.length,qe=Se-2;fe<Se;qe=fe,fe+=2)Te+=(oe[fe]-oe[qe])*(oe[fe+1]+oe[qe+1]);if(Te>0===we)for(fe=0,Se=oe.length;fe<Se/2;fe+=2){var Ne=oe[fe],me=oe[fe+1];oe[fe]=oe[Se-2-fe],oe[fe+1]=oe[Se-1-fe],oe[Se-2-fe]=Ne,oe[Se-1-fe]=me}}(yt,Yt),F.push(yt)}}function ii(F,tt){var ct=(tt=this.options=function(zt,Yt){for(var $t in Yt)zt[$t]=Yt[$t];return zt}(Object.create(this.options),tt)).debug;if(ct&&console.time("preprocess data"),tt.maxZoom<0||tt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(tt.promoteId&&tt.generateId)throw new Error("promoteId and generateId cannot be used together.");var St=function(zt,Yt){var $t=[];if(zt.type==="FeatureCollection")for(var yt=0;yt<zt.features.length;yt++)jt($t,zt.features[yt],Yt,yt);else jt($t,zt.type==="Feature"?zt:{geometry:zt},Yt);return $t}(F,tt);this.tiles={},this.tileCoords=[],ct&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",tt.indexMaxZoom,tt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(St=function(zt,Yt){var $t=Yt.buffer/Yt.extent,yt=zt,Ut=Tt(zt,1,-1-$t,$t,0,-1,2,Yt),oe=Tt(zt,1,1-$t,2+$t,0,-1,2,Yt);return(Ut||oe)&&(yt=Tt(zt,1,-$t,1+$t,0,-1,2,Yt)||[],Ut&&(yt=ge(Ut,1).concat(yt)),oe&&(yt=yt.concat(ge(oe,-1)))),yt}(St,tt)).length&&this.splitTile(St,0,0,0),ct&&(St.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xi(F,tt,ct){return 32*((1<<F)*ct+tt)+F}function Ni(F,tt){var ct=F.tileID.canonical;if(!this._geoJSONIndex)return tt(null,null);var St=this._geoJSONIndex.getTile(ct.z,ct.x,ct.y);if(!St)return tt(null,null);var zt=new j(St.features),Yt=rt(zt);Yt.byteOffset===0&&Yt.byteLength===Yt.buffer.byteLength||(Yt=new Uint8Array(Yt)),tt(null,{vectorTile:zt,rawData:Yt.buffer})}Q.prototype.load=function(F){var tt=this.options,ct=tt.log,St=tt.minZoom,zt=tt.maxZoom,Yt=tt.nodeSize;ct&&console.time("total time");var $t="prepare "+F.length+" points";ct&&console.time($t),this.points=F;for(var yt=[],Ut=0;Ut<F.length;Ut++)F[Ut].geometry&&yt.push(B(F[Ut],Ut));this.trees[zt+1]=new ot(yt,Y,G,Yt,Float32Array),ct&&console.timeEnd($t);for(var oe=zt;oe>=St;oe--){var we=+Date.now();yt=this._cluster(yt,oe),this.trees[oe]=new ot(yt,Y,G,Yt,Float32Array),ct&&console.log("z%d: %d clusters in %dms",oe,yt.length,+Date.now()-we)}return ct&&console.timeEnd("total time"),this},Q.prototype.getClusters=function(F,tt){var ct=((F[0]+180)%360+360)%360-180,St=Math.max(-90,Math.min(90,F[1])),zt=F[2]===180?180:((F[2]+180)%360+360)%360-180,Yt=Math.max(-90,Math.min(90,F[3]));if(F[2]-F[0]>=360)ct=-180,zt=180;else if(ct>zt){var $t=this.getClusters([ct,St,180,Yt],tt),yt=this.getClusters([-180,St,zt,Yt],tt);return $t.concat(yt)}for(var Ut=this.trees[this._limitZoom(tt)],oe=[],we=0,Te=Ut.range(_(ct),P(Yt),_(zt),P(St));we<Te.length;we+=1){var fe=Ut.points[Te[we]];oe.push(fe.numPoints?K(fe):this.points[fe.index])}return oe},Q.prototype.getChildren=function(F){var tt=this._getOriginId(F),ct=this._getOriginZoom(F),St="No cluster with the specified id.",zt=this.trees[ct];if(!zt)throw new Error(St);var Yt=zt.points[tt];if(!Yt)throw new Error(St);for(var $t=this.options.radius/(this.options.extent*Math.pow(2,ct-1)),yt=[],Ut=0,oe=zt.within(Yt.x,Yt.y,$t);Ut<oe.length;Ut+=1){var we=zt.points[oe[Ut]];we.parentId===F&&yt.push(we.numPoints?K(we):this.points[we.index])}if(yt.length===0)throw new Error(St);return yt},Q.prototype.getLeaves=function(F,tt,ct){var St=[];return this._appendLeaves(St,F,tt=tt||10,ct=ct||0,0),St},Q.prototype.getTile=function(F,tt,ct){var St=this.trees[this._limitZoom(F)],zt=Math.pow(2,F),Yt=this.options,$t=Yt.radius/Yt.extent,yt=(ct-$t)/zt,Ut=(ct+1+$t)/zt,oe={features:[]};return this._addTileFeatures(St.range((tt-$t)/zt,yt,(tt+1+$t)/zt,Ut),St.points,tt,ct,zt,oe),tt===0&&this._addTileFeatures(St.range(1-$t/zt,yt,1,Ut),St.points,zt,ct,zt,oe),tt===zt-1&&this._addTileFeatures(St.range(0,yt,$t/zt,Ut),St.points,-1,ct,zt,oe),oe.features.length?oe:null},Q.prototype.getClusterExpansionZoom=function(F){for(var tt=this._getOriginZoom(F)-1;tt<=this.options.maxZoom;){var ct=this.getChildren(F);if(tt++,ct.length!==1)break;F=ct[0].properties.cluster_id}return tt},Q.prototype._appendLeaves=function(F,tt,ct,St,zt){for(var Yt=0,$t=this.getChildren(tt);Yt<$t.length;Yt+=1){var yt=$t[Yt],Ut=yt.properties;if(Ut&&Ut.cluster?zt+Ut.point_count<=St?zt+=Ut.point_count:zt=this._appendLeaves(F,Ut.cluster_id,ct,St,zt):zt<St?zt++:F.push(yt),F.length===ct)break}return zt},Q.prototype._addTileFeatures=function(F,tt,ct,St,zt,Yt){for(var $t=0,yt=F;$t<yt.length;$t+=1){var Ut=tt[yt[$t]],oe=Ut.numPoints,we={type:1,geometry:[[Math.round(this.options.extent*(Ut.x*zt-ct)),Math.round(this.options.extent*(Ut.y*zt-St))]],tags:oe?pt(Ut):this.points[Ut.index].properties},Te=void 0;oe?Te=Ut.id:this.options.generateId?Te=Ut.index:this.points[Ut.index].id&&(Te=this.points[Ut.index].id),Te!==void 0&&(we.id=Te),Yt.features.push(we)}},Q.prototype._limitZoom=function(F){return Math.max(this.options.minZoom,Math.min(+F,this.options.maxZoom+1))},Q.prototype._cluster=function(F,tt){for(var ct=[],St=this.options,zt=St.reduce,Yt=St.minPoints,$t=St.radius/(St.extent*Math.pow(2,tt)),yt=0;yt<F.length;yt++){var Ut=F[yt];if(!(Ut.zoom<=tt)){Ut.zoom=tt;for(var oe=this.trees[tt+1],we=oe.within(Ut.x,Ut.y,$t),Te=Ut.numPoints||1,fe=Te,Se=0,qe=we;Se<qe.length;Se+=1){var Ne=oe.points[qe[Se]];Ne.zoom>tt&&(fe+=Ne.numPoints||1)}if(fe>=Yt){for(var me=Ut.x*Te,Fe=Ut.y*Te,Pe=zt&&Te>1?this._map(Ut,!0):null,Le=(yt<<5)+(tt+1)+this.points.length,vi=0,Be=we;vi<Be.length;vi+=1){var ki=oe.points[Be[vi]];if(!(ki.zoom<=tt)){ki.zoom=tt;var Wi=ki.numPoints||1;me+=ki.x*Wi,Fe+=ki.y*Wi,ki.parentId=Le,zt&&(Pe||(Pe=this._map(Ut,!0)),zt(Pe,this._map(ki)))}}Ut.parentId=Le,ct.push(A(me/fe,Fe/fe,Le,fe,Pe))}else if(ct.push(Ut),fe>1)for(var bi=0,Oi=we;bi<Oi.length;bi+=1){var Ai=oe.points[Oi[bi]];Ai.zoom<=tt||(Ai.zoom=tt,ct.push(Ai))}}}return ct},Q.prototype._getOriginId=function(F){return F-this.points.length>>5},Q.prototype._getOriginZoom=function(F){return(F-this.points.length)%32},Q.prototype._map=function(F,tt){if(F.numPoints)return tt?D({},F.properties):F.properties;var ct=this.points[F.index].properties,St=this.options.map(ct);return tt&&St===ct?D({},St):St},ii.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ii.prototype.splitTile=function(F,tt,ct,St,zt,Yt,$t){for(var yt=[F,tt,ct,St],Ut=this.options,oe=Ut.debug;yt.length;){St=yt.pop(),ct=yt.pop(),tt=yt.pop(),F=yt.pop();var we=1<<tt,Te=xi(tt,ct,St),fe=this.tiles[Te];if(!fe&&(oe>1&&console.time("creation"),fe=this.tiles[Te]=Ge(F,tt,ct,St,Ut),this.tileCoords.push({z:tt,x:ct,y:St}),oe)){oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",tt,ct,St,fe.numFeatures,fe.numPoints,fe.numSimplified),console.timeEnd("creation"));var Se="z"+tt;this.stats[Se]=(this.stats[Se]||0)+1,this.total++}if(fe.source=F,zt){if(tt===Ut.maxZoom||tt===zt)continue;var qe=1<<zt-tt;if(ct!==Math.floor(Yt/qe)||St!==Math.floor($t/qe))continue}else if(tt===Ut.indexMaxZoom||fe.numPoints<=Ut.indexMaxPoints)continue;if(fe.source=null,F.length!==0){oe>1&&console.time("clipping");var Ne,me,Fe,Pe,Le,vi,Be=.5*Ut.buffer/Ut.extent,ki=.5-Be,Wi=.5+Be,bi=1+Be;Ne=me=Fe=Pe=null,Le=Tt(F,we,ct-Be,ct+Wi,0,fe.minX,fe.maxX,Ut),vi=Tt(F,we,ct+ki,ct+bi,0,fe.minX,fe.maxX,Ut),F=null,Le&&(Ne=Tt(Le,we,St-Be,St+Wi,1,fe.minY,fe.maxY,Ut),me=Tt(Le,we,St+ki,St+bi,1,fe.minY,fe.maxY,Ut),Le=null),vi&&(Fe=Tt(vi,we,St-Be,St+Wi,1,fe.minY,fe.maxY,Ut),Pe=Tt(vi,we,St+ki,St+bi,1,fe.minY,fe.maxY,Ut),vi=null),oe>1&&console.timeEnd("clipping"),yt.push(Ne||[],tt+1,2*ct,2*St),yt.push(me||[],tt+1,2*ct,2*St+1),yt.push(Fe||[],tt+1,2*ct+1,2*St),yt.push(Pe||[],tt+1,2*ct+1,2*St+1)}}},ii.prototype.getTile=function(F,tt,ct){var St=this.options,zt=St.extent,Yt=St.debug;if(F<0||F>24)return null;var $t=1<<F,yt=xi(F,tt=(tt%$t+$t)%$t,ct);if(this.tiles[yt])return Oe(this.tiles[yt],zt);Yt>1&&console.log("drilling down to z%d-%d-%d",F,tt,ct);for(var Ut,oe=F,we=tt,Te=ct;!Ut&&oe>0;)oe--,we=Math.floor(we/2),Te=Math.floor(Te/2),Ut=this.tiles[xi(oe,we,Te)];return Ut&&Ut.source?(Yt>1&&console.log("found parent tile z%d-%d-%d",oe,we,Te),Yt>1&&console.time("drilling down"),this.splitTile(Ut.source,oe,we,Te,F,tt,ct),Yt>1&&console.timeEnd("drilling down"),this.tiles[yt]?Oe(this.tiles[yt],zt):null):null};var cr=function(F){function tt(ct,St,zt,Yt){F.call(this,ct,St,zt,Ni),Yt&&(this.loadGeoJSON=Yt)}return F&&(tt.__proto__=F),(tt.prototype=Object.create(F&&F.prototype)).constructor=tt,tt.prototype.loadData=function(ct,St){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=St,this._pendingLoadDataParams=ct,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},tt.prototype._loadData=function(){var ct=this;if(this._pendingCallback&&this._pendingLoadDataParams){var St=this._pendingCallback,zt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Yt=!!(zt&&zt.request&&zt.request.collectResourceTiming)&&new l.RequestPerformance(zt.request);this.loadGeoJSON(zt,function($t,yt){if($t||!yt)return St($t);if(typeof yt!="object")return St(new Error("Input data given to '"+zt.source+"' is not a valid GeoJSON object."));(function fe(Se,qe){var Ne,me=Se&&Se.type;if(me==="FeatureCollection")for(Ne=0;Ne<Se.features.length;Ne++)fe(Se.features[Ne],qe);else if(me==="GeometryCollection")for(Ne=0;Ne<Se.geometries.length;Ne++)fe(Se.geometries[Ne],qe);else if(me==="Feature")fe(Se.geometry,qe);else if(me==="Polygon")W(Se.coordinates,qe);else if(me==="MultiPolygon")for(Ne=0;Ne<Se.coordinates.length;Ne++)W(Se.coordinates[Ne],qe);return Se})(yt,!0);try{if(zt.filter){var Ut=l.createExpression(zt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ut.result==="error")throw new Error(Ut.value.map(function(fe){return fe.key+": "+fe.message}).join(", "));var oe=yt.features.filter(function(fe){return Ut.value.evaluate({zoom:0},fe)});yt={type:"FeatureCollection",features:oe}}ct._geoJSONIndex=zt.cluster?new Q(function(fe){var Se=fe.superclusterOptions,qe=fe.clusterProperties;if(!qe||!Se)return Se;for(var Ne={},me={},Fe={accumulated:null,zoom:0},Pe={properties:null},Le=Object.keys(qe),vi=0,Be=Le;vi<Be.length;vi+=1){var ki=Be[vi],Wi=qe[ki],bi=Wi[0],Oi=l.createExpression(Wi[1]),Ai=l.createExpression(typeof bi=="string"?[bi,["accumulated"],["get",ki]]:bi);Ne[ki]=Oi.value,me[ki]=Ai.value}return Se.map=function(Vr){Pe.properties=Vr;for(var Fi={},ur=0,Vi=Le;ur<Vi.length;ur+=1){var Ti=Vi[ur];Fi[Ti]=Ne[Ti].evaluate(Fe,Pe)}return Fi},Se.reduce=function(Vr,Fi){Pe.properties=Fi;for(var ur=0,Vi=Le;ur<Vi.length;ur+=1){var Ti=Vi[ur];Fe.accumulated=Vr[Ti],Vr[Ti]=me[Ti].evaluate(Fe,Pe)}},Se}(zt)).load(yt.features):function(fe,Se){return new ii(fe,Se)}(yt,zt.geojsonVtOptions)}catch(fe){return St(fe)}ct.loaded={};var we={};if(Yt){var Te=Yt.finish();Te&&(we.resourceTiming={},we.resourceTiming[zt.source]=JSON.parse(JSON.stringify(Te)))}St(null,we)})}},tt.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},tt.prototype.reloadTile=function(ct,St){var zt=this.loaded;return zt&&zt[ct.uid]?F.prototype.reloadTile.call(this,ct,St):this.loadTile(ct,St)},tt.prototype.loadGeoJSON=function(ct,St){if(ct.request)l.getJSON(ct.request,St);else{if(typeof ct.data!="string")return St(new Error("Input data given to '"+ct.source+"' is not a valid GeoJSON object."));try{return St(null,JSON.parse(ct.data))}catch{return St(new Error("Input data given to '"+ct.source+"' is not a valid GeoJSON object."))}}},tt.prototype.removeSource=function(ct,St){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),St()},tt.prototype.getClusterExpansionZoom=function(ct,St){try{St(null,this._geoJSONIndex.getClusterExpansionZoom(ct.clusterId))}catch(zt){St(zt)}},tt.prototype.getClusterChildren=function(ct,St){try{St(null,this._geoJSONIndex.getChildren(ct.clusterId))}catch(zt){St(zt)}},tt.prototype.getClusterLeaves=function(ct,St){try{St(null,this._geoJSONIndex.getLeaves(ct.clusterId,ct.limit,ct.offset))}catch(zt){St(zt)}},tt}(Z),Li=function(F){var tt=this;this.self=F,this.actor=new l.Actor(F,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Z,geojson:cr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(ct,St){if(tt.workerSourceTypes[ct])throw new Error('Worker source with name "'+ct+'" already registered.');tt.workerSourceTypes[ct]=St},this.self.registerRTLTextPlugin=function(ct){if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=ct.applyArabicShaping,l.plugin.processBidirectionalText=ct.processBidirectionalText,l.plugin.processStyledBidirectionalText=ct.processStyledBidirectionalText}};return Li.prototype.setReferrer=function(F,tt){this.referrer=tt},Li.prototype.setImages=function(F,tt,ct){for(var St in this.availableImages[F]=tt,this.workerSources[F]){var zt=this.workerSources[F][St];for(var Yt in zt)zt[Yt].availableImages=tt}ct()},Li.prototype.setLayers=function(F,tt,ct){this.getLayerIndex(F).replace(tt),ct()},Li.prototype.updateLayers=function(F,tt,ct){this.getLayerIndex(F).update(tt.layers,tt.removedIds),ct()},Li.prototype.loadTile=function(F,tt,ct){this.getWorkerSource(F,tt.type,tt.source).loadTile(tt,ct)},Li.prototype.loadDEMTile=function(F,tt,ct){this.getDEMWorkerSource(F,tt.source).loadTile(tt,ct)},Li.prototype.reloadTile=function(F,tt,ct){this.getWorkerSource(F,tt.type,tt.source).reloadTile(tt,ct)},Li.prototype.abortTile=function(F,tt,ct){this.getWorkerSource(F,tt.type,tt.source).abortTile(tt,ct)},Li.prototype.removeTile=function(F,tt,ct){this.getWorkerSource(F,tt.type,tt.source).removeTile(tt,ct)},Li.prototype.removeDEMTile=function(F,tt){this.getDEMWorkerSource(F,tt.source).removeTile(tt)},Li.prototype.removeSource=function(F,tt,ct){if(this.workerSources[F]&&this.workerSources[F][tt.type]&&this.workerSources[F][tt.type][tt.source]){var St=this.workerSources[F][tt.type][tt.source];delete this.workerSources[F][tt.type][tt.source],St.removeSource!==void 0?St.removeSource(tt,ct):ct()}},Li.prototype.loadWorkerSource=function(F,tt,ct){try{this.self.importScripts(tt.url),ct()}catch(St){ct(St.toString())}},Li.prototype.syncRTLPluginState=function(F,tt,ct){try{l.plugin.setState(tt);var St=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&St!=null){this.self.importScripts(St);var zt=l.plugin.isParsed();ct(zt?void 0:new Error("RTL Text Plugin failed to import scripts from "+St),zt)}}catch(Yt){ct(Yt.toString())}},Li.prototype.getAvailableImages=function(F){var tt=this.availableImages[F];return tt||(tt=[]),tt},Li.prototype.getLayerIndex=function(F){var tt=this.layerIndexes[F];return tt||(tt=this.layerIndexes[F]=new Nt),tt},Li.prototype.getWorkerSource=function(F,tt,ct){var St=this;return this.workerSources[F]||(this.workerSources[F]={}),this.workerSources[F][tt]||(this.workerSources[F][tt]={}),this.workerSources[F][tt][ct]||(this.workerSources[F][tt][ct]=new this.workerSourceTypes[tt]({send:function(zt,Yt,$t){St.actor.send(zt,Yt,$t,F)}},this.getLayerIndex(F),this.getAvailableImages(F))),this.workerSources[F][tt][ct]},Li.prototype.getDEMWorkerSource=function(F,tt){return this.demWorkerSources[F]||(this.demWorkerSources[F]={}),this.demWorkerSources[F][tt]||(this.demWorkerSources[F][tt]=new at),this.demWorkerSources[F][tt]},Li.prototype.enforceCacheSizeLimit=function(F,tt){l.enforceCacheSizeLimit(tt)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Li(self)),Li}),At(["./shared"],function(l){var Zt=l.createCommonjsModule(function(r){function o(u){return!n(u)}function n(u){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var f,x,L=new Blob([""],{type:"text/javascript"}),H=URL.createObjectURL(L);try{x=new Worker(H),f=!0}catch{f=!1}return x&&x.terminate(),URL.revokeObjectURL(H),f}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var f=document.createElement("canvas");f.width=f.height=1;var x=f.getContext("2d");if(!x)return!1;var L=x.getImageData(0,0,1,1);return L&&L.width===f.width}()?(s[d=u&&u.failIfMajorPerformanceCaveat]===void 0&&(s[d]=function(f){var x=function(H){var gt=document.createElement("canvas"),vt=Object.create(o.webGLContextAttributes);return vt.failIfMajorPerformanceCaveat=H,gt.probablySupportsContext?gt.probablySupportsContext("webgl",vt)||gt.probablySupportsContext("experimental-webgl",vt):gt.supportsContext?gt.supportsContext("webgl",vt)||gt.supportsContext("experimental-webgl",vt):gt.getContext("webgl",vt)||gt.getContext("experimental-webgl",vt)}(f);if(!x)return!1;var L=x.createShader(x.VERTEX_SHADER);return!(!L||x.isContextLost())&&(x.shaderSource(L,"void main() {}"),x.compileShader(L),x.getShaderParameter(L,x.COMPILE_STATUS)===!0)}(d)),s[d]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var d}r.exports?r.exports=o:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=o,window.mapboxgl.notSupportedReason=n);var s={};o.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),dt={create:function(r,o,n){var s=l.window.document.createElement(r);return o!==void 0&&(s.className=o),n&&n.appendChild(s),s},createNS:function(r,o){return l.window.document.createElementNS(r,o)}},Nt=l.window.document&&l.window.document.documentElement.style;function Lt(r){if(!Nt)return r[0];for(var o=0;o<r.length;o++)if(r[o]in Nt)return r[o];return r[0]}var kt,ut=Lt(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);dt.disableDrag=function(){Nt&&ut&&(kt=Nt[ut],Nt[ut]="none")},dt.enableDrag=function(){Nt&&ut&&(Nt[ut]=kt)};var Rt=Lt(["transform","WebkitTransform"]);dt.setTransform=function(r,o){r.style[Rt]=o};var Z=!1;try{var lt=Object.defineProperty({},"passive",{get:function(){Z=!0}});l.window.addEventListener("test",lt,lt),l.window.removeEventListener("test",lt,lt)}catch{Z=!1}dt.addEventListener=function(r,o,n,s){s===void 0&&(s={}),r.addEventListener(o,n,"passive"in s&&Z?s:s.capture)},dt.removeEventListener=function(r,o,n,s){s===void 0&&(s={}),r.removeEventListener(o,n,"passive"in s&&Z?s:s.capture)};var at=function(r){r.preventDefault(),r.stopPropagation(),l.window.removeEventListener("click",at,!0)};function W(r){var o=r.userImage;return!!(o&&o.render&&o.render())&&(r.data.replace(new Uint8Array(o.data.buffer)),!0)}dt.suppressClick=function(){l.window.addEventListener("click",at,!0),l.window.setTimeout(function(){l.window.removeEventListener("click",at,!0)},0)},dt.mousePos=function(r,o){var n=r.getBoundingClientRect();return new l.Point(o.clientX-n.left-r.clientLeft,o.clientY-n.top-r.clientTop)},dt.touchPos=function(r,o){for(var n=r.getBoundingClientRect(),s=[],u=0;u<o.length;u++)s.push(new l.Point(o[u].clientX-n.left-r.clientLeft,o[u].clientY-n.top-r.clientTop));return s},dt.mouseButton=function(r){return l.window.InstallTrigger!==void 0&&r.button===2&&r.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:r.button},dt.remove=function(r){r.parentNode&&r.parentNode.removeChild(r)};var q=function(r){function o(){r.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.isLoaded=function(){return this.loaded},o.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var s=0,u=this.requestors;s<u.length;s+=1){var d=u[s];this._notify(d.ids,d.callback)}this.requestors=[]}},o.prototype.getImage=function(n){return this.images[n]},o.prototype.addImage=function(n,s){this._validate(n,s)&&(this.images[n]=s)},o.prototype._validate=function(n,s){var u=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new l.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),u=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new l.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),u=!1),this._validateContent(s.content,s)||(this.fire(new l.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),u=!1),u},o.prototype._validateStretch=function(n,s){if(!n)return!0;for(var u=0,d=0,f=n;d<f.length;d+=1){var x=f[d];if(x[0]<u||x[1]<x[0]||s<x[1])return!1;u=x[1]}return!0},o.prototype._validateContent=function(n,s){return!(n&&(n.length!==4||n[0]<0||s.data.width<n[0]||n[1]<0||s.data.height<n[1]||n[2]<0||s.data.width<n[2]||n[3]<0||s.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},o.prototype.updateImage=function(n,s){s.version=this.images[n].version+1,this.images[n]=s,this.updatedImages[n]=!0},o.prototype.removeImage=function(n){var s=this.images[n];delete this.images[n],delete this.patterns[n],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()},o.prototype.listImages=function(){return Object.keys(this.images)},o.prototype.getImages=function(n,s){var u=!0;if(!this.isLoaded())for(var d=0,f=n;d<f.length;d+=1)this.images[f[d]]||(u=!1);this.isLoaded()||u?this._notify(n,s):this.requestors.push({ids:n,callback:s})},o.prototype._notify=function(n,s){for(var u={},d=0,f=n;d<f.length;d+=1){var x=f[d];this.images[x]||this.fire(new l.Event("styleimagemissing",{id:x}));var L=this.images[x];L?u[x]={data:L.data.clone(),pixelRatio:L.pixelRatio,sdf:L.sdf,version:L.version,stretchX:L.stretchX,stretchY:L.stretchY,content:L.content,hasRenderCallback:!!(L.userImage&&L.userImage.render)}:l.warnOnce('Image "'+x+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}s(null,u)},o.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},o.prototype.getPattern=function(n){var s=this.patterns[n],u=this.getImage(n);if(!u)return null;if(s&&s.position.version===u.version)return s.position;if(s)s.position.version=u.version;else{var d={w:u.data.width+2,h:u.data.height+2,x:0,y:0},f=new l.ImagePosition(d,u);this.patterns[n]={bin:d,position:f}}return this._updatePatternAtlas(),this.patterns[n].position},o.prototype.bind=function(n){var s=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(n,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)},o.prototype._updatePatternAtlas=function(){var n=[];for(var s in this.patterns)n.push(this.patterns[s].bin);var u=l.potpack(n),d=u.w,f=u.h,x=this.atlasImage;for(var L in x.resize({width:d||1,height:f||1}),this.patterns){var H=this.patterns[L].bin,gt=H.x+1,vt=H.y+1,bt=this.images[L].data,Ft=bt.width,Bt=bt.height;l.RGBAImage.copy(bt,x,{x:0,y:0},{x:gt,y:vt},{width:Ft,height:Bt}),l.RGBAImage.copy(bt,x,{x:0,y:Bt-1},{x:gt,y:vt-1},{width:Ft,height:1}),l.RGBAImage.copy(bt,x,{x:0,y:0},{x:gt,y:vt+Bt},{width:Ft,height:1}),l.RGBAImage.copy(bt,x,{x:Ft-1,y:0},{x:gt-1,y:vt},{width:1,height:Bt}),l.RGBAImage.copy(bt,x,{x:0,y:0},{x:gt+Ft,y:vt},{width:1,height:Bt})}this.dirty=!0},o.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},o.prototype.dispatchRenderCallbacks=function(n){for(var s=0,u=n;s<u.length;s+=1){var d=u[s];if(!this.callbackDispatchedThisFrame[d]){this.callbackDispatchedThisFrame[d]=!0;var f=this.images[d];W(f)&&this.updateImage(d,f)}}},o}(l.Evented),$=et,U=et,j=1e20;function et(r,o,n,s,u,d){this.fontSize=r||24,this.buffer=o===void 0?3:o,this.cutoff=s||.25,this.fontFamily=u||"sans-serif",this.fontWeight=d||"normal",this.radius=n||8;var f=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=f,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(f*f),this.gridInner=new Float64Array(f*f),this.f=new Float64Array(f),this.d=new Float64Array(f),this.z=new Float64Array(f+1),this.v=new Int16Array(f),this.middle=Math.round(f/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function _t(r,o,n,s,u,d,f){for(var x=0;x<o;x++){for(var L=0;L<n;L++)s[L]=r[L*o+x];for(mt(s,u,d,f,n),L=0;L<n;L++)r[L*o+x]=u[L]}for(L=0;L<n;L++){for(x=0;x<o;x++)s[x]=r[L*o+x];for(mt(s,u,d,f,o),x=0;x<o;x++)r[L*o+x]=Math.sqrt(u[x])}}function mt(r,o,n,s,u){n[0]=0,s[0]=-j,s[1]=+j;for(var d=1,f=0;d<u;d++){for(var x=(r[d]+d*d-(r[n[f]]+n[f]*n[f]))/(2*d-2*n[f]);x<=s[f];)f--,x=(r[d]+d*d-(r[n[f]]+n[f]*n[f]))/(2*d-2*n[f]);n[++f]=d,s[f]=x,s[f+1]=+j}for(d=0,f=0;d<u;d++){for(;s[f+1]<d;)f++;o[d]=(d-n[f])*(d-n[f])+r[n[f]]}}et.prototype.draw=function(r){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(r,this.buffer,this.middle);for(var o=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),s=0;s<this.size*this.size;s++){var u=o.data[4*s+3]/255;this.gridOuter[s]=u===1?0:u===0?j:Math.pow(Math.max(0,.5-u),2),this.gridInner[s]=u===1?j:u===0?0:Math.pow(Math.max(0,u-.5),2)}for(_t(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),_t(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),s=0;s<this.size*this.size;s++)n[s]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[s]-this.gridInner[s])/this.radius+this.cutoff))));return n},$.default=U;var V=function(r,o){this.requestManager=r,this.localIdeographFontFamily=o,this.entries={}};V.prototype.setURL=function(r){this.url=r},V.prototype.getGlyphs=function(r,o){var n=this,s=[];for(var u in r)for(var d=0,f=r[u];d<f.length;d+=1)s.push({stack:u,id:f[d]});l.asyncAll(s,function(x,L){var H=x.stack,gt=x.id,vt=n.entries[H];vt||(vt=n.entries[H]={glyphs:{},requests:{},ranges:{}});var bt=vt.glyphs[gt];if(bt===void 0){if(bt=n._tinySDF(vt,H,gt))return vt.glyphs[gt]=bt,void L(null,{stack:H,id:gt,glyph:bt});var Ft=Math.floor(gt/256);if(256*Ft>65535)L(new Error("glyphs > 65535 not supported"));else if(vt.ranges[Ft])L(null,{stack:H,id:gt,glyph:bt});else{var Bt=vt.requests[Ft];Bt||(Bt=vt.requests[Ft]=[],V.loadGlyphRange(H,Ft,n.url,n.requestManager,function(Xt,Pt){if(Pt){for(var qt in Pt)n._doesCharSupportLocalGlyph(+qt)||(vt.glyphs[+qt]=Pt[+qt]);vt.ranges[Ft]=!0}for(var Qt=0,ne=Bt;Qt<ne.length;Qt+=1)(0,ne[Qt])(Xt,Pt);delete vt.requests[Ft]})),Bt.push(function(Xt,Pt){Xt?L(Xt):Pt&&L(null,{stack:H,id:gt,glyph:Pt[gt]||null})})}}else L(null,{stack:H,id:gt,glyph:bt})},function(x,L){if(x)o(x);else if(L){for(var H={},gt=0,vt=L;gt<vt.length;gt+=1){var bt=vt[gt],Ft=bt.stack,Bt=bt.id,Xt=bt.glyph;(H[Ft]||(H[Ft]={}))[Bt]=Xt&&{id:Xt.id,bitmap:Xt.bitmap.clone(),metrics:Xt.metrics}}o(null,H)}})},V.prototype._doesCharSupportLocalGlyph=function(r){return!!this.localIdeographFontFamily&&(l.isChar["CJK Unified Ideographs"](r)||l.isChar["Hangul Syllables"](r)||l.isChar.Hiragana(r)||l.isChar.Katakana(r))},V.prototype._tinySDF=function(r,o,n){var s=this.localIdeographFontFamily;if(s&&this._doesCharSupportLocalGlyph(n)){var u=r.tinySDF;if(!u){var d="400";/bold/i.test(o)?d="900":/medium/i.test(o)?d="500":/light/i.test(o)&&(d="200"),u=r.tinySDF=new V.TinySDF(24,3,8,.25,s,d)}return{id:n,bitmap:new l.AlphaImage({width:30,height:30},u.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},V.loadGlyphRange=function(r,o,n,s,u){var d=256*o,f=d+255,x=s.transformRequest(s.normalizeGlyphsURL(n).replace("{fontstack}",r).replace("{range}",d+"-"+f),l.ResourceType.Glyphs);l.getArrayBuffer(x,function(L,H){if(L)u(L);else if(H){for(var gt={},vt=0,bt=l.parseGlyphPBF(H);vt<bt.length;vt+=1){var Ft=bt[vt];gt[Ft.id]=Ft}u(null,gt)}})},V.TinySDF=$;var rt=function(){this.specification=l.styleSpec.light.position};rt.prototype.possiblyEvaluate=function(r,o){return l.sphericalToCartesian(r.expression.evaluate(o))},rt.prototype.interpolate=function(r,o,n){return{x:l.number(r.x,o.x,n),y:l.number(r.y,o.y,n),z:l.number(r.z,o.z,n)}};var I=new l.Properties({anchor:new l.DataConstantProperty(l.styleSpec.light.anchor),position:new rt,color:new l.DataConstantProperty(l.styleSpec.light.color),intensity:new l.DataConstantProperty(l.styleSpec.light.intensity)}),C=function(r){function o(n){r.call(this),this._transitionable=new l.Transitionable(I),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getLight=function(){return this._transitionable.serialize()},o.prototype.setLight=function(n,s){if(s===void 0&&(s={}),!this._validate(l.validateLight,n,s))for(var u in n){var d=n[u];l.endsWith(u,"-transition")?this._transitionable.setTransition(u.slice(0,-11),d):this._transitionable.setValue(u,d)}},o.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},o.prototype.hasTransition=function(){return this._transitioning.hasTransition()},o.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},o.prototype._validate=function(n,s,u){return(!u||u.validate!==!1)&&l.emitValidationErrors(this,n.call(l.validateStyle,l.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:l.styleSpec})))},o}(l.Evented),z=function(r,o){this.width=r,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};z.prototype.getDash=function(r,o){var n=r.join(",")+String(o);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(r,o)),this.dashEntry[n]},z.prototype.getDashRanges=function(r,o,n){var s=[],u=r.length%2==1?-r[r.length-1]*n:0,d=r[0]*n,f=!0;s.push({left:u,right:d,isDash:f,zeroLength:r[0]===0});for(var x=r[0],L=1;L<r.length;L++){var H=r[L];s.push({left:u=x*n,right:d=(x+=H)*n,isDash:f=!f,zeroLength:H===0})}return s},z.prototype.addRoundDash=function(r,o,n){for(var s=o/2,u=-n;u<=n;u++)for(var d=this.width*(this.nextRow+n+u),f=0,x=r[f],L=0;L<this.width;L++){L/x.right>1&&(x=r[++f]);var H=Math.abs(L-x.left),gt=Math.abs(L-x.right),vt=Math.min(H,gt),bt=void 0,Ft=u/n*(s+1);if(x.isDash){var Bt=s-Math.abs(Ft);bt=Math.sqrt(vt*vt+Bt*Bt)}else bt=s-Math.sqrt(vt*vt+Ft*Ft);this.data[d+L]=Math.max(0,Math.min(255,bt+128))}},z.prototype.addRegularDash=function(r){for(var o=r.length-1;o>=0;--o){var n=r[o],s=r[o+1];n.zeroLength?r.splice(o,1):s&&s.isDash===n.isDash&&(s.left=n.left,r.splice(o,1))}var u=r[0],d=r[r.length-1];u.isDash===d.isDash&&(u.left=d.left-this.width,d.right=u.right+this.width);for(var f=this.width*this.nextRow,x=0,L=r[x],H=0;H<this.width;H++){H/L.right>1&&(L=r[++x]);var gt=Math.abs(H-L.left),vt=Math.abs(H-L.right),bt=Math.min(gt,vt);this.data[f+H]=Math.max(0,Math.min(255,(L.isDash?bt:-bt)+128))}},z.prototype.addDash=function(r,o){var n=o?7:0,s=2*n+1;if(this.nextRow+s>this.height)return l.warnOnce("LineAtlas out of space"),null;for(var u=0,d=0;d<r.length;d++)u+=r[d];if(u!==0){var f=this.width/u,x=this.getDashRanges(r,this.width,f);o?this.addRoundDash(x,f,n):this.addRegularDash(x)}var L={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:u};return this.nextRow+=s,this.dirty=!0,L},z.prototype.bind=function(r){var o=r.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))};var S=function r(o,n){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=l.uniqueId();for(var s=this.workerPool.acquire(this.id),u=0;u<s.length;u++){var d=new r.Actor(s[u],n,this.id);d.name="Worker "+u,this.actors.push(d)}};function g(r,o,n){var s=function(u,d){if(u)return n(u);if(d){var f=l.pick(l.extend(d,r),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);d.vector_layers&&(f.vectorLayers=d.vector_layers,f.vectorLayerIds=f.vectorLayers.map(function(x){return x.id})),f.tiles=o.canonicalizeTileset(f,r.url),n(null,f)}};return r.url?l.getJSON(o.transformRequest(o.normalizeSourceURL(r.url),l.ResourceType.Source),s):l.browser.frame(function(){return s(null,r)})}S.prototype.broadcast=function(r,o,n){l.asyncAll(this.actors,function(s,u){s.send(r,o,u)},n=n||function(){})},S.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},S.prototype.remove=function(){this.actors.forEach(function(r){r.remove()}),this.actors=[],this.workerPool.release(this.id)},S.Actor=l.Actor;var v=function(r,o,n){this.bounds=l.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=o||0,this.maxzoom=n||24};v.prototype.validateBounds=function(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]},v.prototype.contains=function(r){var o=Math.pow(2,r.z),n=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*o),s=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*o),u=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*o),d=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*o);return r.x>=n&&r.x<u&&r.y>=s&&r.y<d};var y=function(r){function o(n,s,u,d){if(r.call(this),this.id=n,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(s,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=g(this._options,this.map._requestManager,function(s,u){n._tileJSONRequest=null,n._loaded=!0,s?n.fire(new l.ErrorEvent(s)):u&&(l.extend(n,u),u.bounds&&(n.tileBounds=new v(u.bounds,n.minzoom,n.maxzoom)),l.postTurnstileEvent(u.tiles,n.map._requestManager._customAccessToken),l.postMapLoadEvent(u.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},o.prototype.loaded=function(){return this._loaded},o.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},o.prototype.onAdd=function(n){this.map=n,this.load()},o.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},o.prototype.setTiles=function(n){var s=this;return this.setSourceProperty(function(){s._options.tiles=n}),this},o.prototype.setUrl=function(n){var s=this;return this.setSourceProperty(function(){s.url=n,s._options.url=n}),this},o.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},o.prototype.serialize=function(){return l.extend({},this._options)},o.prototype.loadTile=function(n,s){var u=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),d={request:this.map._requestManager.transformRequest(u,l.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function f(x,L){return delete n.request,n.aborted?s(null):x&&x.status!==404?s(x):(L&&L.resourceTiming&&(n.resourceTiming=L.resourceTiming),this.map._refreshExpiredTiles&&L&&n.setExpiryData(L),n.loadVectorData(L,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),s(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}d.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=s:n.request=n.actor.send("reloadTile",d,f.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",d,f.bind(this)))},o.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},o.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},o.prototype.hasTransition=function(){return!1},o}(l.Evented),T=function(r){function o(n,s,u,d){r.call(this),this.id=n,this.dispatcher=u,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},s),l.extend(this,l.pick(s,["url","scheme","tileSize"]))}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=g(this._options,this.map._requestManager,function(s,u){n._tileJSONRequest=null,n._loaded=!0,s?n.fire(new l.ErrorEvent(s)):u&&(l.extend(n,u),u.bounds&&(n.tileBounds=new v(u.bounds,n.minzoom,n.maxzoom)),l.postTurnstileEvent(u.tiles),l.postMapLoadEvent(u.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},o.prototype.loaded=function(){return this._loaded},o.prototype.onAdd=function(n){this.map=n,this.load()},o.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},o.prototype.serialize=function(){return l.extend({},this._options)},o.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},o.prototype.loadTile=function(n,s){var u=this,d=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=l.getImage(this.map._requestManager.transformRequest(d,l.ResourceType.Tile),function(f,x){if(delete n.request,n.aborted)n.state="unloaded",s(null);else if(f)n.state="errored",s(f);else if(x){u.map._refreshExpiredTiles&&n.setExpiryData(x),delete x.cacheControl,delete x.expires;var L=u.map.painter.context,H=L.gl;n.texture=u.map.painter.getTileTexture(x.width),n.texture?n.texture.update(x,{useMipmap:!0}):(n.texture=new l.Texture(L,x,H.RGBA,{useMipmap:!0}),n.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),L.extTextureFilterAnisotropic&&H.texParameterf(H.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax)),n.state="loaded",l.cacheEntryPossiblyAdded(u.dispatcher),s(null)}})},o.prototype.abortTile=function(n,s){n.request&&(n.request.cancel(),delete n.request),s()},o.prototype.unloadTile=function(n,s){n.texture&&this.map.painter.saveTileTexture(n.texture),s()},o.prototype.hasTransition=function(){return!1},o}(l.Evented),k=function(r){function o(n,s,u,d){r.call(this,n,s,u,d),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},o.prototype.loadTile=function(n,s){var u=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function d(f,x){f&&(n.state="errored",s(f)),x&&(n.dem=x,n.needsHillshadePrepare=!0,n.state="loaded",s(null))}n.request=l.getImage(this.map._requestManager.transformRequest(u,l.ResourceType.Tile),(function(f,x){if(delete n.request,n.aborted)n.state="unloaded",s(null);else if(f)n.state="errored",s(f);else if(x){this.map._refreshExpiredTiles&&n.setExpiryData(x),delete x.cacheControl,delete x.expires;var L=l.window.ImageBitmap&&x instanceof l.window.ImageBitmap&&l.offscreenCanvasSupported()?x:l.browser.getImageData(x,1),H={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:L,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",H,d.bind(this)))}}).bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},o.prototype._getNeighboringTiles=function(n){var s=n.canonical,u=Math.pow(2,s.z),d=(s.x-1+u)%u,f=s.x===0?n.wrap-1:n.wrap,x=(s.x+1+u)%u,L=s.x+1===u?n.wrap+1:n.wrap,H={};return H[new l.OverscaledTileID(n.overscaledZ,f,s.z,d,s.y).key]={backfilled:!1},H[new l.OverscaledTileID(n.overscaledZ,L,s.z,x,s.y).key]={backfilled:!1},s.y>0&&(H[new l.OverscaledTileID(n.overscaledZ,f,s.z,d,s.y-1).key]={backfilled:!1},H[new l.OverscaledTileID(n.overscaledZ,n.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},H[new l.OverscaledTileID(n.overscaledZ,L,s.z,x,s.y-1).key]={backfilled:!1}),s.y+1<u&&(H[new l.OverscaledTileID(n.overscaledZ,f,s.z,d,s.y+1).key]={backfilled:!1},H[new l.OverscaledTileID(n.overscaledZ,n.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},H[new l.OverscaledTileID(n.overscaledZ,L,s.z,x,s.y+1).key]={backfilled:!1}),H},o.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},o}(T),E=function(r){function o(n,s,u,d){r.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(d),this._data=s.data,this._options=l.extend({},s),this._collectResourceTiming=s.collectResourceTiming,this._resourceTiming=[],s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;var f=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*f,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*f,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?Math.min(s.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:l.EXTENT,radius:(s.clusterRadius||50)*f,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.load=function(){var n=this;this.fire(new l.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(s){if(s)n.fire(new l.ErrorEvent(s));else{var u={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(u.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new l.Event("data",u))}})},o.prototype.onAdd=function(n){this.map=n,this.load()},o.prototype.setData=function(n){var s=this;return this._data=n,this.fire(new l.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(u){if(u)s.fire(new l.ErrorEvent(u));else{var d={dataType:"source",sourceDataType:"content"};s._collectResourceTiming&&s._resourceTiming&&s._resourceTiming.length>0&&(d.resourceTiming=s._resourceTiming,s._resourceTiming=[]),s.fire(new l.Event("data",d))}}),this},o.prototype.getClusterExpansionZoom=function(n,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},s),this},o.prototype.getClusterChildren=function(n,s){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},s),this},o.prototype.getClusterLeaves=function(n,s,u,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:s,offset:u},d),this},o.prototype._updateWorkerData=function(n){var s=this;this._loaded=!1;var u=l.extend({},this.workerOptions),d=this._data;typeof d=="string"?(u.request=this.map._requestManager.transformRequest(l.browser.resolveURL(d),l.ResourceType.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(d),this.actor.send(this.type+".loadData",u,function(f,x){s._removed||x&&x.abandoned||(s._loaded=!0,x&&x.resourceTiming&&x.resourceTiming[s.id]&&(s._resourceTiming=x.resourceTiming[s.id].slice(0)),s.actor.send(s.type+".coalesce",{source:u.source},null),n(f))})},o.prototype.loaded=function(){return this._loaded},o.prototype.loadTile=function(n,s){var u=this,d=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(d,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(f,x){return delete n.request,n.unloadVectorData(),n.aborted?s(null):f?s(f):(n.loadVectorData(x,u.map.painter,d==="reloadTile"),s(null))})},o.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},o.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},o.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},o.prototype.serialize=function(){return l.extend({},this._options,{type:this.type,data:this._data})},o.prototype.hasTransition=function(){return!1},o}(l.Evented),w=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),R=function(r){function o(n,s,u,d){r.call(this),this.id=n,this.dispatcher=u,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=s}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.load=function(n,s){var u=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),function(d,f){u._loaded=!0,d?u.fire(new l.ErrorEvent(d)):f&&(u.image=f,n&&(u.coordinates=n),s&&s(),u._finishLoading())})},o.prototype.loaded=function(){return this._loaded},o.prototype.updateImage=function(n){var s=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){s.texture=null}),this):this},o.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))},o.prototype.onAdd=function(n){this.map=n,this.load()},o.prototype.setCoordinates=function(n){var s=this;this.coordinates=n;var u=n.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(f){for(var x=1/0,L=1/0,H=-1/0,gt=-1/0,vt=0,bt=f;vt<bt.length;vt+=1){var Ft=bt[vt];x=Math.min(x,Ft.x),L=Math.min(L,Ft.y),H=Math.max(H,Ft.x),gt=Math.max(gt,Ft.y)}var Bt=Math.max(H-x,gt-L),Xt=Math.max(0,Math.floor(-Math.log(Bt)/Math.LN2)),Pt=Math.pow(2,Xt);return new l.CanonicalTileID(Xt,Math.floor((x+H)/2*Pt),Math.floor((L+gt)/2*Pt))}(u),this.minzoom=this.maxzoom=this.tileID.z;var d=u.map(function(f){return s.tileID.getTilePoint(f)._round()});return this._boundsArray=new l.StructArrayLayout4i8,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(d[2].x,d[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this},o.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,s=n.gl;for(var u in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,w.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new l.Texture(n,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this.tiles){var d=this.tiles[u];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}},o.prototype.loadTile=function(n,s){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},s(null)):(n.state="errored",s(null))},o.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},o.prototype.hasTransition=function(){return!1},o}(l.Evented),J=function(r){function o(n,s,u,d){r.call(this,n,s,u,d),this.roundZoom=!0,this.type="video",this.options=s}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.load=function(){var n=this;this._loaded=!1;var s=this.options;this.urls=[];for(var u=0,d=s.urls;u<d.length;u+=1)this.urls.push(this.map._requestManager.transformRequest(d[u],l.ResourceType.Source).url);l.getVideo(this.urls,function(f,x){n._loaded=!0,f?n.fire(new l.ErrorEvent(f)):x&&(n.video=x,n.video.loop=!0,n.video.setAttribute("playsinline",""),n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},o.prototype.pause=function(){this.video&&this.video.pause()},o.prototype.play=function(){this.video&&this.video.play()},o.prototype.seek=function(n){if(this.video){var s=this.video.seekable;n<s.start(0)||n>s.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+s.start(0)+" and "+s.end(0)+"-second mark."))):this.video.currentTime=n}},o.prototype.getVideo=function(){return this.video},o.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},o.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,s=n.gl;for(var u in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,w.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(n,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this.tiles){var d=this.tiles[u];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}},o.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},o.prototype.hasTransition=function(){return this.video&&!this.video.paused},o}(R),wt=function(r){function o(n,s,u,d){r.call(this,n,s,u,d),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(function(f){return!Array.isArray(f)||f.length!==2||f.some(function(x){return typeof x!="number"})})||this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},o.prototype.getCanvas=function(){return this.canvas},o.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},o.prototype.onRemove=function(){this.pause()},o.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var s=this.map.painter.context,u=s.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,w.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(s,this.canvas,u.RGBA,{premultiply:!0}),this.tiles){var f=this.tiles[d];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture)}}},o.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},o.prototype.hasTransition=function(){return this._playing},o.prototype._hasInvalidDimensions=function(){for(var n=0,s=[this.canvas.width,this.canvas.height];n<s.length;n+=1){var u=s[n];if(isNaN(u)||u<=0)return!0}return!1},o}(R),ot={vector:y,raster:T,"raster-dem":k,geojson:E,video:J,image:R,canvas:wt};function it(r,o){var n=l.identity([]);return l.translate(n,n,[1,1,0]),l.scale(n,n,[.5*r.width,.5*r.height,1]),l.multiply(n,n,r.calculatePosMatrix(o.toUnwrapped()))}function Q(r,o,n,s,u,d){var f=function(Xt,Pt,qt){if(Xt)for(var Qt=0,ne=Xt;Qt<ne.length;Qt+=1){var pe=Pt[ne[Qt]];if(pe&&pe.source===qt&&pe.type==="fill-extrusion")return!0}else for(var ce in Pt){var de=Pt[ce];if(de.source===qt&&de.type==="fill-extrusion")return!0}return!1}(u&&u.layers,o,r.id),x=d.maxPitchScaleFactor(),L=r.tilesIn(s,x,f);L.sort(A);for(var H=[],gt=0,vt=L;gt<vt.length;gt+=1){var bt=vt[gt];H.push({wrappedTileID:bt.tileID.wrapped().key,queryResults:bt.tile.queryRenderedFeatures(o,n,r._state,bt.queryGeometry,bt.cameraQueryGeometry,bt.scale,u,d,x,it(r.transform,bt.tileID))})}var Ft=function(Xt){for(var Pt={},qt={},Qt=0,ne=Xt;Qt<ne.length;Qt+=1){var pe=ne[Qt],ce=pe.queryResults,de=pe.wrappedTileID,xe=qt[de]=qt[de]||{};for(var Ae in ce)for(var Ce=ce[Ae],je=xe[Ae]=xe[Ae]||{},Ke=Pt[Ae]=Pt[Ae]||[],ei=0,ti=Ce;ei<ti.length;ei+=1){var Mi=ti[ei];je[Mi.featureIndex]||(je[Mi.featureIndex]=!0,Ke.push(Mi))}}return Pt}(H);for(var Bt in Ft)Ft[Bt].forEach(function(Xt){var Pt=Xt.feature,qt=r.getFeatureState(Pt.layer["source-layer"],Pt.id);Pt.source=Pt.layer.source,Pt.layer["source-layer"]&&(Pt.sourceLayer=Pt.layer["source-layer"]),Pt.state=qt});return Ft}function A(r,o){var n=r.tileID,s=o.tileID;return n.overscaledZ-s.overscaledZ||n.canonical.y-s.canonical.y||n.wrap-s.wrap||n.canonical.x-s.canonical.x}var B=function(r,o){this.max=r,this.onRemove=o,this.reset()};B.prototype.reset=function(){for(var r in this.data)for(var o=0,n=this.data[r];o<n.length;o+=1){var s=n[o];s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value)}return this.data={},this.order=[],this},B.prototype.add=function(r,o,n){var s=this,u=r.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);var d={value:o,timeout:void 0};if(n!==void 0&&(d.timeout=setTimeout(function(){s.remove(r,d)},n)),this.data[u].push(d),this.order.push(u),this.order.length>this.max){var f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this},B.prototype.has=function(r){return r.wrapped().key in this.data},B.prototype.getAndRemove=function(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null},B.prototype._getAndRemoveByKey=function(r){var o=this.data[r].shift();return o.timeout&&clearTimeout(o.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),o.value},B.prototype.getByKey=function(r){var o=this.data[r];return o?o[0].value:null},B.prototype.get=function(r){return this.has(r)?this.data[r.wrapped().key][0].value:null},B.prototype.remove=function(r,o){if(!this.has(r))return this;var n=r.wrapped().key,s=o===void 0?0:this.data[n].indexOf(o),u=this.data[n][s];return this.data[n].splice(s,1),u.timeout&&clearTimeout(u.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(u.value),this.order.splice(this.order.indexOf(n),1),this},B.prototype.setMaxSize=function(r){for(this.max=r;this.order.length>this.max;){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this},B.prototype.filter=function(r){var o=[];for(var n in this.data)for(var s=0,u=this.data[n];s<u.length;s+=1){var d=u[s];r(d.value)||o.push(d)}for(var f=0,x=o;f<x.length;f+=1){var L=x[f];this.remove(L.value.tileID,L)}};var K=function(r,o,n){this.context=r;var s=r.gl;this.buffer=s.createBuffer(),this.dynamicDraw=!!n,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),s.bufferData(s.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?s.DYNAMIC_DRAW:s.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer};K.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},K.prototype.updateData=function(r){var o=this.context.gl;this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)},K.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var pt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},_=function(r,o,n,s){this.length=o.length,this.attributes=n,this.itemSize=o.bytesPerElement,this.dynamicDraw=s,this.context=r;var u=r.gl;this.buffer=u.createBuffer(),r.bindVertexBuffer.set(this.buffer),u.bufferData(u.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer};_.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},_.prototype.updateData=function(r){var o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,r.arrayBuffer)},_.prototype.enableAttributes=function(r,o){for(var n=0;n<this.attributes.length;n++){var s=o.attributes[this.attributes[n].name];s!==void 0&&r.enableVertexAttribArray(s)}},_.prototype.setVertexAttribPointers=function(r,o,n){for(var s=0;s<this.attributes.length;s++){var u=this.attributes[s],d=o.attributes[u.name];d!==void 0&&r.vertexAttribPointer(d,u.components,r[pt[u.type]],!1,this.itemSize,u.offset+this.itemSize*(n||0))}},_.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var P=function(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};P.prototype.get=function(){return this.current},P.prototype.set=function(r){},P.prototype.getDefault=function(){return this.default},P.prototype.setDefault=function(){this.set(this.default)};var D=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return l.Color.transparent},o.prototype.set=function(n){var s=this.current;(n.r!==s.r||n.g!==s.g||n.b!==s.b||n.a!==s.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},o}(P),Y=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return 1},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},o}(P),G=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return 0},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},o}(P),xt=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return[!0,!0,!0,!0]},o.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},o}(P),Ct=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return!0},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},o}(P),Dt=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return 255},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},o}(P),jt=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},o.prototype.set=function(n){var s=this.current;(n.func!==s.func||n.ref!==s.ref||n.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},o}(P),Kt=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},o.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},o}(P),ee=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=n,this.dirty=!1}},o}(P),le=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return[0,1]},o.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},o}(P),ht=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=n,this.dirty=!1}},o}(P),st=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.LESS},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},o}(P),Tt=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.BLEND):s.disable(s.BLEND),this.current=n,this.dirty=!1}},o}(P),Mt=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},o.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},o}(P),Ht=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return l.Color.transparent},o.prototype.set=function(n){var s=this.current;(n.r!==s.r||n.g!==s.g||n.b!==s.b||n.a!==s.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},o}(P),Vt=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.FUNC_ADD},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},o}(P),re=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;n?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=n,this.dirty=!1}},o}(P),Jt=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.BACK},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},o}(P),ye=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.CCW},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},o}(P),ze=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},o}(P),ge=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return this.gl.TEXTURE0},o.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},o}(P),be=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},o.prototype.set=function(n){var s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},o}(P),Oe=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},o}(P),Ze=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,n),this.current=n,this.dirty=!1}},o}(P),Ge=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindTexture(s.TEXTURE_2D,n),this.current=n,this.dirty=!1}},o}(P),Ee=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},o}(P),li=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){var s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},o}(P),ii=function(r){function o(n){r.call(this,n),this.vao=n.extVertexArrayObject}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},o}(P),xi=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return 4},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},o}(P),Ni=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},o}(P),cr=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return!1},o.prototype.set=function(n){if(n!==this.current||this.dirty){var s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},o}(P),Li=function(r){function o(n,s){r.call(this,n),this.context=n,this.parent=s}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getDefault=function(){return null},o}(P),F=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.setDirty=function(){this.dirty=!0},o.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},o}(Li),tt=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,n),this.current=n,this.dirty=!1}},o}(Li),ct=function(r,o,n,s){this.context=r,this.width=o,this.height=n;var u=this.framebuffer=r.gl.createFramebuffer();this.colorAttachment=new F(r,u),s&&(this.depthAttachment=new tt(r,u))};ct.prototype.destroy=function(){var r=this.context.gl,o=this.colorAttachment.get();if(o&&r.deleteTexture(o),this.depthAttachment){var n=this.depthAttachment.get();n&&r.deleteRenderbuffer(n)}r.deleteFramebuffer(this.framebuffer)};var St=function(r,o,n){this.func=r,this.mask=o,this.range=n};St.ReadOnly=!1,St.ReadWrite=!0,St.disabled=new St(519,St.ReadOnly,[0,1]);var zt=function(r,o,n,s,u,d){this.test=r,this.ref=o,this.mask=n,this.fail=s,this.depthFail=u,this.pass=d};zt.disabled=new zt({func:519,mask:0},0,0,7680,7680,7680);var Yt=function(r,o,n){this.blendFunction=r,this.blendColor=o,this.mask=n};Yt.disabled=new Yt(Yt.Replace=[1,0],l.Color.transparent,[!1,!1,!1,!1]),Yt.unblended=new Yt(Yt.Replace,l.Color.transparent,[!0,!0,!0,!0]),Yt.alphaBlended=new Yt([1,771],l.Color.transparent,[!0,!0,!0,!0]);var $t=function(r,o,n){this.enable=r,this.mode=o,this.frontFace=n};$t.disabled=new $t(!1,1029,2305),$t.backCCW=new $t(!0,1029,2305);var yt=function(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new D(this),this.clearDepth=new Y(this),this.clearStencil=new G(this),this.colorMask=new xt(this),this.depthMask=new Ct(this),this.stencilMask=new Dt(this),this.stencilFunc=new jt(this),this.stencilOp=new Kt(this),this.stencilTest=new ee(this),this.depthRange=new le(this),this.depthTest=new ht(this),this.depthFunc=new st(this),this.blend=new Tt(this),this.blendFunc=new Mt(this),this.blendColor=new Ht(this),this.blendEquation=new Vt(this),this.cullFace=new re(this),this.cullFaceSide=new Jt(this),this.frontFace=new ye(this),this.program=new ze(this),this.activeTexture=new ge(this),this.viewport=new be(this),this.bindFramebuffer=new Oe(this),this.bindRenderbuffer=new Ze(this),this.bindTexture=new Ge(this),this.bindVertexBuffer=new Ee(this),this.bindElementBuffer=new li(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ii(this),this.pixelStoreUnpack=new xi(this),this.pixelStoreUnpackPremultiplyAlpha=new Ni(this),this.pixelStoreUnpackFlipY=new cr(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)};yt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},yt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},yt.prototype.createIndexBuffer=function(r,o){return new K(this,r,o)},yt.prototype.createVertexBuffer=function(r,o,n){return new _(this,r,o,n)},yt.prototype.createRenderbuffer=function(r,o,n){var s=this.gl,u=s.createRenderbuffer();return this.bindRenderbuffer.set(u),s.renderbufferStorage(s.RENDERBUFFER,r,o,n),this.bindRenderbuffer.set(null),u},yt.prototype.createFramebuffer=function(r,o,n){return new ct(this,r,o,n)},yt.prototype.clear=function(r){var o=r.color,n=r.depth,s=this.gl,u=0;o&&(u|=s.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(u|=s.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),s.clear(u)},yt.prototype.setCullFace=function(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))},yt.prototype.setDepthMode=function(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)},yt.prototype.setStencilMode=function(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)},yt.prototype.setColorMode=function(r){l.deepEqual(r.blendFunction,Yt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)},yt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ut=function(r){function o(n,s,u){var d=this;r.call(this),this.id=n,this.dispatcher=u,this.on("data",function(f){f.dataType==="source"&&f.sourceDataType==="metadata"&&(d._sourceLoaded=!0),d._sourceLoaded&&!d._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(d.reload(),d.transform&&d.update(d.transform))}),this.on("error",function(){d._sourceErrored=!0}),this._source=function(f,x,L,H){var gt=new ot[x.type](f,x,L,H);if(gt.id!==f)throw new Error("Expected Source id to be "+f+" instead of "+gt.id);return l.bindAll(["load","abort","unload","serialize","prepare"],gt),gt}(n,s,u,this),this._tiles={},this._cache=new B(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new l.SourceFeatureState}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},o.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},o.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var n in this._tiles){var s=this._tiles[n];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0},o.prototype.getSource=function(){return this._source},o.prototype.pause=function(){this._paused=!0},o.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},o.prototype._loadTile=function(n,s){return this._source.loadTile(n,s)},o.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},o.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},o.prototype.serialize=function(){return this._source.serialize()},o.prototype.prepare=function(n){for(var s in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var u=this._tiles[s];u.upload(n),u.prepare(this.map.style.imageManager)}},o.prototype.getIds=function(){return l.values(this._tiles).map(function(n){return n.tileID}).sort(oe).map(function(n){return n.key})},o.prototype.getRenderableIds=function(n){var s=this,u=[];for(var d in this._tiles)this._isIdRenderable(d,n)&&u.push(this._tiles[d]);return n?u.sort(function(f,x){var L=f.tileID,H=x.tileID,gt=new l.Point(L.canonical.x,L.canonical.y)._rotate(s.transform.angle),vt=new l.Point(H.canonical.x,H.canonical.y)._rotate(s.transform.angle);return L.overscaledZ-H.overscaledZ||vt.y-gt.y||vt.x-gt.x}).map(function(f){return f.tileID.key}):u.map(function(f){return f.tileID}).sort(oe).map(function(f){return f.key})},o.prototype.hasRenderableParent=function(n){var s=this.findLoadedParent(n,0);return!!s&&this._isIdRenderable(s.tileID.key)},o.prototype._isIdRenderable=function(n,s){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(s||!this._tiles[n].holdingForFade())},o.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},o.prototype._reloadTile=function(n,s){var u=this._tiles[n];u&&(u.state!=="loading"&&(u.state=s),this._loadTile(u,this._tileLoaded.bind(this,u,n,s)))},o.prototype._tileLoaded=function(n,s,u,d){if(d)return n.state="errored",void(d.status!==404?this._source.fire(new l.ErrorEvent(d,{tile:n})):this.update(this.transform));n.timeAdded=l.browser.now(),u==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(s,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new l.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},o.prototype._backfillDEM=function(n){for(var s=this.getRenderableIds(),u=0;u<s.length;u++){var d=s[u];if(n.neighboringTiles&&n.neighboringTiles[d]){var f=this.getTileByID(d);x(n,f),x(f,n)}}function x(L,H){L.needsHillshadePrepare=!0;var gt=H.tileID.canonical.x-L.tileID.canonical.x,vt=H.tileID.canonical.y-L.tileID.canonical.y,bt=Math.pow(2,L.tileID.canonical.z),Ft=H.tileID.key;gt===0&&vt===0||Math.abs(vt)>1||(Math.abs(gt)>1&&(Math.abs(gt+bt)===1?gt+=bt:Math.abs(gt-bt)===1&&(gt-=bt)),H.dem&&L.dem&&(L.dem.backfillBorder(H.dem,gt,vt),L.neighboringTiles&&L.neighboringTiles[Ft]&&(L.neighboringTiles[Ft].backfilled=!0)))}},o.prototype.getTile=function(n){return this.getTileByID(n.key)},o.prototype.getTileByID=function(n){return this._tiles[n]},o.prototype._retainLoadedChildren=function(n,s,u,d){for(var f in this._tiles){var x=this._tiles[f];if(!(d[f]||!x.hasData()||x.tileID.overscaledZ<=s||x.tileID.overscaledZ>u)){for(var L=x.tileID;x&&x.tileID.overscaledZ>s+1;){var H=x.tileID.scaledTo(x.tileID.overscaledZ-1);(x=this._tiles[H.key])&&x.hasData()&&(L=H)}for(var gt=L;gt.overscaledZ>s;)if(n[(gt=gt.scaledTo(gt.overscaledZ-1)).key]){d[L.key]=L;break}}}},o.prototype.findLoadedParent=function(n,s){if(n.key in this._loadedParentTiles){var u=this._loadedParentTiles[n.key];return u&&u.tileID.overscaledZ>=s?u:null}for(var d=n.overscaledZ-1;d>=s;d--){var f=n.scaledTo(d),x=this._getLoadedTile(f);if(x)return x}},o.prototype._getLoadedTile=function(n){var s=this._tiles[n.key];return s&&s.hasData()?s:this._cache.getByKey(n.wrapped().key)},o.prototype.updateCacheSize=function(n){var s=Math.ceil(n.width/this._source.tileSize)+1,u=Math.ceil(n.height/this._source.tileSize)+1,d=Math.floor(s*u*5),f=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(f)},o.prototype.handleWrapJump=function(n){var s=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,s){var u={};for(var d in this._tiles){var f=this._tiles[d];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+s),u[f.tileID.key]=f}for(var x in this._tiles=u,this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(var L in this._tiles)this._setTileReloadTimer(L,this._tiles[L])}},o.prototype.update=function(n){var s=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var u;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?u=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(xe){return new l.OverscaledTileID(xe.canonical.z,xe.wrap,xe.canonical.z,xe.canonical.x,xe.canonical.y)}):(u=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(u=u.filter(function(xe){return s._source.hasTile(xe)}))):u=[];var d=n.coveringZoomLevel(this._source),f=Math.max(d-o.maxOverzooming,this._source.minzoom),x=Math.max(d+o.maxUnderzooming,this._source.minzoom),L=this._updateRetainedTiles(u,d);if(we(this._source.type)){for(var H={},gt={},vt=0,bt=Object.keys(L);vt<bt.length;vt+=1){var Ft=bt[vt],Bt=L[Ft],Xt=this._tiles[Ft];if(Xt&&!(Xt.fadeEndTime&&Xt.fadeEndTime<=l.browser.now())){var Pt=this.findLoadedParent(Bt,f);Pt&&(this._addTile(Pt.tileID),H[Pt.tileID.key]=Pt.tileID),gt[Ft]=Bt}}for(var qt in this._retainLoadedChildren(gt,d,x,L),H)L[qt]||(this._coveredTiles[qt]=!0,L[qt]=H[qt])}for(var Qt in L)this._tiles[Qt].clearFadeHold();for(var ne=0,pe=l.keysDifference(this._tiles,L);ne<pe.length;ne+=1){var ce=pe[ne],de=this._tiles[ce];de.hasSymbolBuckets&&!de.holdingForFade()?de.setHoldDuration(this.map._fadeDuration):de.hasSymbolBuckets&&!de.symbolFadeFinished()||this._removeTile(ce)}this._updateLoadedParentTileCache()}},o.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},o.prototype._updateRetainedTiles=function(n,s){for(var u={},d={},f=Math.max(s-o.maxOverzooming,this._source.minzoom),x=Math.max(s+o.maxUnderzooming,this._source.minzoom),L={},H=0,gt=n;H<gt.length;H+=1){var vt=gt[H],bt=this._addTile(vt);u[vt.key]=vt,bt.hasData()||s<this._source.maxzoom&&(L[vt.key]=vt)}this._retainLoadedChildren(L,s,x,u);for(var Ft=0,Bt=n;Ft<Bt.length;Ft+=1){var Xt=Bt[Ft],Pt=this._tiles[Xt.key];if(!Pt.hasData()){if(s+1>this._source.maxzoom){var qt=Xt.children(this._source.maxzoom)[0],Qt=this.getTile(qt);if(Qt&&Qt.hasData()){u[qt.key]=qt;continue}}else{var ne=Xt.children(this._source.maxzoom);if(u[ne[0].key]&&u[ne[1].key]&&u[ne[2].key]&&u[ne[3].key])continue}for(var pe=Pt.wasRequested(),ce=Xt.overscaledZ-1;ce>=f;--ce){var de=Xt.scaledTo(ce);if(d[de.key]||(d[de.key]=!0,!(Pt=this.getTile(de))&&pe&&(Pt=this._addTile(de)),Pt&&(u[de.key]=de,pe=Pt.wasRequested(),Pt.hasData())))break}}}return u},o.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var s=[],u=void 0,d=this._tiles[n].tileID;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){u=this._loadedParentTiles[d.key];break}s.push(d.key);var f=d.scaledTo(d.overscaledZ-1);if(u=this._getLoadedTile(f))break;d=f}for(var x=0,L=s;x<L.length;x+=1)this._loadedParentTiles[L[x]]=u}},o.prototype._addTile=function(n){var s=this._tiles[n.key];if(s)return s;(s=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,s),s.tileID=n,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,s)));var u=!!s;return u||(s=new l.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(s,this._tileLoaded.bind(this,s,n.key,s.state))),s?(s.uses++,this._tiles[n.key]=s,u||this._source.fire(new l.Event("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null},o.prototype._setTileReloadTimer=function(n,s){var u=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var d=s.getExpiryTimeout();d&&(this._timers[n]=setTimeout(function(){u._reloadTile(n,"expired"),delete u._timers[n]},d))},o.prototype._removeTile=function(n){var s=this._tiles[n];s&&(s.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))},o.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},o.prototype.tilesIn=function(n,s,u){var d=this,f=[],x=this.transform;if(!x)return f;for(var L=u?x.getCameraQueryGeometry(n):n,H=n.map(function(ce){return x.pointCoordinate(ce)}),gt=L.map(function(ce){return x.pointCoordinate(ce)}),vt=this.getIds(),bt=1/0,Ft=1/0,Bt=-1/0,Xt=-1/0,Pt=0,qt=gt;Pt<qt.length;Pt+=1){var Qt=qt[Pt];bt=Math.min(bt,Qt.x),Ft=Math.min(Ft,Qt.y),Bt=Math.max(Bt,Qt.x),Xt=Math.max(Xt,Qt.y)}for(var ne=function(ce){var de=d._tiles[vt[ce]];if(!de.holdingForFade()){var xe=de.tileID,Ae=Math.pow(2,x.zoom-de.tileID.overscaledZ),Ce=s*de.queryPadding*l.EXTENT/de.tileSize/Ae,je=[xe.getTilePoint(new l.MercatorCoordinate(bt,Ft)),xe.getTilePoint(new l.MercatorCoordinate(Bt,Xt))];if(je[0].x-Ce<l.EXTENT&&je[0].y-Ce<l.EXTENT&&je[1].x+Ce>=0&&je[1].y+Ce>=0){var Ke=H.map(function(ti){return xe.getTilePoint(ti)}),ei=gt.map(function(ti){return xe.getTilePoint(ti)});f.push({tile:de,tileID:xe,queryGeometry:Ke,cameraQueryGeometry:ei,scale:Ae})}}},pe=0;pe<vt.length;pe++)ne(pe);return f},o.prototype.getVisibleCoordinates=function(n){for(var s=this,u=this.getRenderableIds(n).map(function(L){return s._tiles[L].tileID}),d=0,f=u;d<f.length;d+=1){var x=f[d];x.posMatrix=this.transform.calculatePosMatrix(x.toUnwrapped())}return u},o.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(we(this._source.type))for(var n in this._tiles){var s=this._tiles[n];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=l.browser.now())return!0}return!1},o.prototype.setFeatureState=function(n,s,u){this._state.updateState(n=n||"_geojsonTileLayer",s,u)},o.prototype.removeFeatureState=function(n,s,u){this._state.removeFeatureState(n=n||"_geojsonTileLayer",s,u)},o.prototype.getFeatureState=function(n,s){return this._state.getState(n=n||"_geojsonTileLayer",s)},o.prototype.setDependencies=function(n,s,u){var d=this._tiles[n];d&&d.setDependencies(s,u)},o.prototype.reloadTilesForDependencies=function(n,s){for(var u in this._tiles)this._tiles[u].hasDependency(n,s)&&this._reloadTile(u,"reloading");this._cache.filter(function(d){return!d.hasDependency(n,s)})},o}(l.Evented);function oe(r,o){var n=Math.abs(2*r.wrap)-+(r.wrap<0),s=Math.abs(2*o.wrap)-+(o.wrap<0);return r.overscaledZ-o.overscaledZ||s-n||o.canonical.y-r.canonical.y||o.canonical.x-r.canonical.x}function we(r){return r==="raster"||r==="image"||r==="video"}function Te(){return new l.window.Worker(hs.workerUrl)}Ut.maxOverzooming=10,Ut.maxUnderzooming=3;var fe="mapboxgl_preloaded_worker_pool",Se=function(){this.active={}};Se.prototype.acquire=function(r){if(!this.workers)for(this.workers=[];this.workers.length<Se.workerCount;)this.workers.push(new Te);return this.active[r]=!0,this.workers.slice()},Se.prototype.release=function(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(function(o){o.terminate()}),this.workers=null)},Se.prototype.isPreloaded=function(){return!!this.active[fe]},Se.prototype.numActive=function(){return Object.keys(this.active).length};var qe,Ne=Math.floor(l.browser.hardwareConcurrency/2);function me(){return qe||(qe=new Se),qe}function Fe(r,o){var n={};for(var s in r)s!=="ref"&&(n[s]=r[s]);return l.refProperties.forEach(function(u){u in o&&(n[u]=o[u])}),n}function Pe(r){r=r.slice();for(var o=Object.create(null),n=0;n<r.length;n++)o[r[n].id]=r[n];for(var s=0;s<r.length;s++)"ref"in r[s]&&(r[s]=Fe(r[s],o[r[s].ref]));return r}Se.workerCount=Math.max(Math.min(Ne,6),1);var Le={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function vi(r,o,n){n.push({command:Le.addSource,args:[r,o[r]]})}function Be(r,o,n){o.push({command:Le.removeSource,args:[r]}),n[r]=!0}function ki(r,o,n,s){Be(r,n,s),vi(r,o,n)}function Wi(r,o,n){var s;for(s in r[n])if(r[n].hasOwnProperty(s)&&s!=="data"&&!l.deepEqual(r[n][s],o[n][s]))return!1;for(s in o[n])if(o[n].hasOwnProperty(s)&&s!=="data"&&!l.deepEqual(r[n][s],o[n][s]))return!1;return!0}function bi(r,o,n,s,u,d){var f;for(f in o=o||{},r=r||{})r.hasOwnProperty(f)&&(l.deepEqual(r[f],o[f])||n.push({command:d,args:[s,f,o[f],u]}));for(f in o)o.hasOwnProperty(f)&&!r.hasOwnProperty(f)&&(l.deepEqual(r[f],o[f])||n.push({command:d,args:[s,f,o[f],u]}))}function Oi(r){return r.id}function Ai(r,o){return r[o.id]=o,r}var Vr=function(r,o){this.reset(r,o)};Vr.prototype.reset=function(r,o){this.points=r||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Vr.prototype.lerp=function(r){if(this.points.length===1)return this.points[0];r=l.clamp(r,0,1);for(var o=1,n=this._distances[o],s=r*this.paddedLength+this.padding;n<s&&o<this._distances.length;)n=this._distances[++o];var u=o-1,d=this._distances[u],f=n-d,x=f>0?(s-d)/f:0;return this.points[u].mult(1-x).add(this.points[o].mult(x))};var Fi=function(r,o,n){var s=this.boxCells=[],u=this.circleCells=[];this.xCellCount=Math.ceil(r/n),this.yCellCount=Math.ceil(o/n);for(var d=0;d<this.xCellCount*this.yCellCount;d++)s.push([]),u.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=o,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0};function ur(r,o,n,s,u){var d=l.create();return o?(l.scale(d,d,[1/u,1/u,1]),n||l.rotateZ(d,d,s.angle)):l.multiply(d,s.labelPlaneMatrix,r),d}function Vi(r,o,n,s,u){if(o){var d=l.clone(r);return l.scale(d,d,[u,u,1]),n||l.rotateZ(d,d,-s.angle),d}return s.glCoordMatrix}function Ti(r,o){var n=[r.x,r.y,0,1];Mr(n,n,o);var s=n[3];return{point:new l.Point(n[0]/s,n[1]/s),signedDistanceFromCamera:s}}function Bi(r,o){return .5+r/o*.5}function $r(r,o){var n=r[0]/r[3],s=r[1]/r[3];return n>=-o[0]&&n<=o[0]&&s>=-o[1]&&s<=o[1]}function pa(r,o,n,s,u,d,f,x){var L=s?r.textSizeData:r.iconSizeData,H=l.evaluateSizeForZoom(L,n.transform.zoom),gt=[256/n.width*2+1,256/n.height*2+1],vt=s?r.text.dynamicLayoutVertexArray:r.icon.dynamicLayoutVertexArray;vt.clear();for(var bt=r.lineVertexArray,Ft=s?r.text.placedSymbolArray:r.icon.placedSymbolArray,Bt=n.transform.width/n.transform.height,Xt=!1,Pt=0;Pt<Ft.length;Pt++){var qt=Ft.get(Pt);if(qt.hidden||qt.writingMode===l.WritingMode.vertical&&!Xt)Gr(qt.numGlyphs,vt);else{Xt=!1;var Qt=[qt.anchorX,qt.anchorY,0,1];if(l.transformMat4(Qt,Qt,o),$r(Qt,gt)){var ne=Bi(n.transform.cameraToCenterDistance,Qt[3]),pe=l.evaluateSizeForFeature(L,H,qt),ce=f?pe/ne:pe*ne,de=new l.Point(qt.anchorX,qt.anchorY),xe=Ti(de,u).point,Ae={},Ce=js(qt,ce,!1,x,o,u,d,r.glyphOffsetArray,bt,vt,xe,de,Ae,Bt);Xt=Ce.useVertical,(Ce.notEnoughRoom||Xt||Ce.needsFlipping&&js(qt,ce,!0,x,o,u,d,r.glyphOffsetArray,bt,vt,xe,de,Ae,Bt).notEnoughRoom)&&Gr(qt.numGlyphs,vt)}else Gr(qt.numGlyphs,vt)}}s?r.text.dynamicLayoutVertexBuffer.updateData(vt):r.icon.dynamicLayoutVertexBuffer.updateData(vt)}function Er(r,o,n,s,u,d,f,x,L,H,gt){var vt=x.glyphStartIndex+x.numGlyphs,bt=x.lineStartIndex,Ft=x.lineStartIndex+x.lineLength,Bt=o.getoffsetX(x.glyphStartIndex),Xt=o.getoffsetX(vt-1),Pt=pr(r*Bt,n,s,u,d,f,x.segment,bt,Ft,L,H,gt);if(!Pt)return null;var qt=pr(r*Xt,n,s,u,d,f,x.segment,bt,Ft,L,H,gt);return qt?{first:Pt,last:qt}:null}function Qr(r,o,n,s){return r===l.WritingMode.horizontal&&Math.abs(n.y-o.y)>Math.abs(n.x-o.x)*s?{useVertical:!0}:(r===l.WritingMode.vertical?o.y<n.y:o.x>n.x)?{needsFlipping:!0}:null}function js(r,o,n,s,u,d,f,x,L,H,gt,vt,bt,Ft){var Bt,Xt=o/24,Pt=r.lineOffsetX*Xt,qt=r.lineOffsetY*Xt;if(r.numGlyphs>1){var Qt=r.glyphStartIndex+r.numGlyphs,ne=r.lineStartIndex,pe=r.lineStartIndex+r.lineLength,ce=Er(Xt,x,Pt,qt,n,gt,vt,r,L,d,bt);if(!ce)return{notEnoughRoom:!0};var de=Ti(ce.first.point,f).point,xe=Ti(ce.last.point,f).point;if(s&&!n){var Ae=Qr(r.writingMode,de,xe,Ft);if(Ae)return Ae}Bt=[ce.first];for(var Ce=r.glyphStartIndex+1;Ce<Qt-1;Ce++)Bt.push(pr(Xt*x.getoffsetX(Ce),Pt,qt,n,gt,vt,r.segment,ne,pe,L,d,bt));Bt.push(ce.last)}else{if(s&&!n){var je=Ti(vt,u).point,Ke=r.lineStartIndex+r.segment+1,ei=new l.Point(L.getx(Ke),L.gety(Ke)),ti=Ti(ei,u),Mi=ti.signedDistanceFromCamera>0?ti.point:da(vt,ei,je,1,u),Ue=Qr(r.writingMode,je,Mi,Ft);if(Ue)return Ue}var hi=pr(Xt*x.getoffsetX(r.glyphStartIndex),Pt,qt,n,gt,vt,r.segment,r.lineStartIndex,r.lineStartIndex+r.lineLength,L,d,bt);if(!hi)return{notEnoughRoom:!0};Bt=[hi]}for(var gi=0,si=Bt;gi<si.length;gi+=1){var ai=si[gi];l.addDynamicAttributes(H,ai.point,ai.angle)}return{}}function da(r,o,n,s,u){var d=Ti(r.add(r.sub(o)._unit()),u).point,f=n.sub(d);return n.add(f._mult(s/f.mag()))}function pr(r,o,n,s,u,d,f,x,L,H,gt,vt){var bt=s?r-o:r+o,Ft=bt>0?1:-1,Bt=0;s&&(Ft*=-1,Bt=Math.PI),Ft<0&&(Bt+=Math.PI);for(var Xt=Ft>0?x+f:x+f+1,Pt=u,qt=u,Qt=0,ne=0,pe=Math.abs(bt),ce=[];Qt+ne<=pe;){if((Xt+=Ft)<x||Xt>=L)return null;if(qt=Pt,ce.push(Pt),(Pt=vt[Xt])===void 0){var de=new l.Point(H.getx(Xt),H.gety(Xt)),xe=Ti(de,gt);if(xe.signedDistanceFromCamera>0)Pt=vt[Xt]=xe.point;else{var Ae=Xt-Ft;Pt=da(Qt===0?d:new l.Point(H.getx(Ae),H.gety(Ae)),de,qt,pe-Qt+1,gt)}}Qt+=ne,ne=qt.dist(Pt)}var Ce=(pe-Qt)/ne,je=Pt.sub(qt),Ke=je.mult(Ce)._add(qt);Ke._add(je._unit()._perp()._mult(n*Ft));var ei=Bt+Math.atan2(Pt.y-qt.y,Pt.x-qt.x);return ce.push(Ke),{point:Ke,angle:ei,path:ce}}Fi.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Fi.prototype.insert=function(r,o,n,s,u){this._forEachCell(o,n,s,u,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(o),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(u)},Fi.prototype.insertCircle=function(r,o,n,s){this._forEachCell(o-s,n-s,o+s,n+s,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(o),this.circles.push(n),this.circles.push(s)},Fi.prototype._insertBoxCell=function(r,o,n,s,u,d){this.boxCells[u].push(d)},Fi.prototype._insertCircleCell=function(r,o,n,s,u,d){this.circleCells[u].push(d)},Fi.prototype._query=function(r,o,n,s,u,d){if(n<0||r>this.width||s<0||o>this.height)return!u&&[];var f=[];if(r<=0&&o<=0&&this.width<=n&&this.height<=s){if(u)return!0;for(var x=0;x<this.boxKeys.length;x++)f.push({key:this.boxKeys[x],x1:this.bboxes[4*x],y1:this.bboxes[4*x+1],x2:this.bboxes[4*x+2],y2:this.bboxes[4*x+3]});for(var L=0;L<this.circleKeys.length;L++){var H=this.circles[3*L],gt=this.circles[3*L+1],vt=this.circles[3*L+2];f.push({key:this.circleKeys[L],x1:H-vt,y1:gt-vt,x2:H+vt,y2:gt+vt})}return d?f.filter(d):f}return this._forEachCell(r,o,n,s,this._queryCell,f,{hitTest:u,seenUids:{box:{},circle:{}}},d),u?f.length>0:f},Fi.prototype._queryCircle=function(r,o,n,s,u){var d=r-n,f=r+n,x=o-n,L=o+n;if(f<0||d>this.width||L<0||x>this.height)return!s&&[];var H=[];return this._forEachCell(d,x,f,L,this._queryCellCircle,H,{hitTest:s,circle:{x:r,y:o,radius:n},seenUids:{box:{},circle:{}}},u),s?H.length>0:H},Fi.prototype.query=function(r,o,n,s,u){return this._query(r,o,n,s,!1,u)},Fi.prototype.hitTest=function(r,o,n,s,u){return this._query(r,o,n,s,!0,u)},Fi.prototype.hitTestCircle=function(r,o,n,s){return this._queryCircle(r,o,n,!0,s)},Fi.prototype._queryCell=function(r,o,n,s,u,d,f,x){var L=f.seenUids,H=this.boxCells[u];if(H!==null)for(var gt=this.bboxes,vt=0,bt=H;vt<bt.length;vt+=1){var Ft=bt[vt];if(!L.box[Ft]){L.box[Ft]=!0;var Bt=4*Ft;if(r<=gt[Bt+2]&&o<=gt[Bt+3]&&n>=gt[Bt+0]&&s>=gt[Bt+1]&&(!x||x(this.boxKeys[Ft]))){if(f.hitTest)return d.push(!0),!0;d.push({key:this.boxKeys[Ft],x1:gt[Bt],y1:gt[Bt+1],x2:gt[Bt+2],y2:gt[Bt+3]})}}}var Xt=this.circleCells[u];if(Xt!==null)for(var Pt=this.circles,qt=0,Qt=Xt;qt<Qt.length;qt+=1){var ne=Qt[qt];if(!L.circle[ne]){L.circle[ne]=!0;var pe=3*ne;if(this._circleAndRectCollide(Pt[pe],Pt[pe+1],Pt[pe+2],r,o,n,s)&&(!x||x(this.circleKeys[ne]))){if(f.hitTest)return d.push(!0),!0;var ce=Pt[pe],de=Pt[pe+1],xe=Pt[pe+2];d.push({key:this.circleKeys[ne],x1:ce-xe,y1:de-xe,x2:ce+xe,y2:de+xe})}}}},Fi.prototype._queryCellCircle=function(r,o,n,s,u,d,f,x){var L=f.circle,H=f.seenUids,gt=this.boxCells[u];if(gt!==null)for(var vt=this.bboxes,bt=0,Ft=gt;bt<Ft.length;bt+=1){var Bt=Ft[bt];if(!H.box[Bt]){H.box[Bt]=!0;var Xt=4*Bt;if(this._circleAndRectCollide(L.x,L.y,L.radius,vt[Xt+0],vt[Xt+1],vt[Xt+2],vt[Xt+3])&&(!x||x(this.boxKeys[Bt])))return d.push(!0),!0}}var Pt=this.circleCells[u];if(Pt!==null)for(var qt=this.circles,Qt=0,ne=Pt;Qt<ne.length;Qt+=1){var pe=ne[Qt];if(!H.circle[pe]){H.circle[pe]=!0;var ce=3*pe;if(this._circlesCollide(qt[ce],qt[ce+1],qt[ce+2],L.x,L.y,L.radius)&&(!x||x(this.circleKeys[pe])))return d.push(!0),!0}}},Fi.prototype._forEachCell=function(r,o,n,s,u,d,f,x){for(var L=this._convertToXCellCoord(r),H=this._convertToYCellCoord(o),gt=this._convertToXCellCoord(n),vt=this._convertToYCellCoord(s),bt=L;bt<=gt;bt++)for(var Ft=H;Ft<=vt;Ft++)if(u.call(this,r,o,n,s,this.xCellCount*Ft+bt,d,f,x))return},Fi.prototype._convertToXCellCoord=function(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))},Fi.prototype._convertToYCellCoord=function(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))},Fi.prototype._circlesCollide=function(r,o,n,s,u,d){var f=s-r,x=u-o,L=n+d;return L*L>f*f+x*x},Fi.prototype._circleAndRectCollide=function(r,o,n,s,u,d,f){var x=(d-s)/2,L=Math.abs(r-(s+x));if(L>x+n)return!1;var H=(f-u)/2,gt=Math.abs(o-(u+H));if(gt>H+n)return!1;if(L<=x||gt<=H)return!0;var vt=L-x,bt=gt-H;return vt*vt+bt*bt<=n*n};var fa=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Gr(r,o){for(var n=0;n<r;n++){var s=o.length;o.resize(s+4),o.float32.set(fa,3*s)}}function Mr(r,o,n){var s=o[0],u=o[1];return r[0]=n[0]*s+n[4]*u+n[12],r[1]=n[1]*s+n[5]*u+n[13],r[3]=n[3]*s+n[7]*u+n[15],r}var vn=function(r,o,n){o===void 0&&(o=new Fi(r.width+200,r.height+200,25)),n===void 0&&(n=new Fi(r.width+200,r.height+200,25)),this.transform=r,this.grid=o,this.ignoredGrid=n,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+100,this.screenBottomBoundary=r.height+100,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200};function Qi(r,o,n){return o*(l.EXTENT/(r.tileSize*Math.pow(2,n-r.tileID.overscaledZ)))}vn.prototype.placeCollisionBox=function(r,o,n,s,u){var d=this.projectAndGetPerspectiveRatio(s,r.anchorPointX,r.anchorPointY),f=n*d.perspectiveRatio,x=r.x1*f+d.point.x,L=r.y1*f+d.point.y,H=r.x2*f+d.point.x,gt=r.y2*f+d.point.y;return!this.isInsideGrid(x,L,H,gt)||!o&&this.grid.hitTest(x,L,H,gt,u)?{box:[],offscreen:!1}:{box:[x,L,H,gt],offscreen:this.isOffscreen(x,L,H,gt)}},vn.prototype.placeCollisionCircles=function(r,o,n,s,u,d,f,x,L,H,gt,vt,bt){var Ft=[],Bt=new l.Point(o.anchorX,o.anchorY),Xt=Ti(Bt,d),Pt=Bi(this.transform.cameraToCenterDistance,Xt.signedDistanceFromCamera),qt=(H?u/Pt:u*Pt)/l.ONE_EM,Qt=Ti(Bt,f).point,ne=Er(qt,s,o.lineOffsetX*qt,o.lineOffsetY*qt,!1,Qt,Bt,o,n,f,{}),pe=!1,ce=!1,de=!0;if(ne){for(var xe=.5*vt*Pt+bt,Ae=new l.Point(-100,-100),Ce=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),je=new Vr,Ke=ne.first,ei=ne.last,ti=[],Mi=Ke.path.length-1;Mi>=1;Mi--)ti.push(Ke.path[Mi]);for(var Ue=1;Ue<ei.path.length;Ue++)ti.push(ei.path[Ue]);var hi=2.5*xe;if(x){var gi=ti.map(function(Tn){return Ti(Tn,x)});ti=gi.some(function(Tn){return Tn.signedDistanceFromCamera<=0})?[]:gi.map(function(Tn){return Tn.point})}var si=[];if(ti.length>0){for(var ai=ti[0].clone(),mi=ti[0].clone(),oi=1;oi<ti.length;oi++)ai.x=Math.min(ai.x,ti[oi].x),ai.y=Math.min(ai.y,ti[oi].y),mi.x=Math.max(mi.x,ti[oi].x),mi.y=Math.max(mi.y,ti[oi].y);si=ai.x>=Ae.x&&mi.x<=Ce.x&&ai.y>=Ae.y&&mi.y<=Ce.y?[ti]:mi.x<Ae.x||ai.x>Ce.x||mi.y<Ae.y||ai.y>Ce.y?[]:l.clipLine([ti],Ae.x,Ae.y,Ce.x,Ce.y)}for(var ri=0,Tr=si;ri<Tr.length;ri+=1){var sr;je.reset(Tr[ri],.25*xe),sr=je.length<=.5*xe?1:Math.ceil(je.paddedLength/hi)+1;for(var jr=0;jr<sr;jr++){var Ir=jr/Math.max(sr-1,1),or=je.lerp(Ir),dr=or.x+100,un=or.y+100;Ft.push(dr,un,xe,0);var Hr=dr-xe,uo=un-xe,tn=dr+xe,Dn=un+xe;if(de=de&&this.isOffscreen(Hr,uo,tn,Dn),ce=ce||this.isInsideGrid(Hr,uo,tn,Dn),!r&&this.grid.hitTestCircle(dr,un,xe,gt)&&(pe=!0,!L))return{circles:[],offscreen:!1,collisionDetected:pe}}}}return{circles:!L&&pe||!ce?[]:Ft,offscreen:de,collisionDetected:pe}},vn.prototype.queryRenderedSymbols=function(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var o=[],n=1/0,s=1/0,u=-1/0,d=-1/0,f=0,x=r;f<x.length;f+=1){var L=x[f],H=new l.Point(L.x+100,L.y+100);n=Math.min(n,H.x),s=Math.min(s,H.y),u=Math.max(u,H.x),d=Math.max(d,H.y),o.push(H)}for(var gt={},vt={},bt=0,Ft=this.grid.query(n,s,u,d).concat(this.ignoredGrid.query(n,s,u,d));bt<Ft.length;bt+=1){var Bt=Ft[bt],Xt=Bt.key;if(gt[Xt.bucketInstanceId]===void 0&&(gt[Xt.bucketInstanceId]={}),!gt[Xt.bucketInstanceId][Xt.featureIndex]){var Pt=[new l.Point(Bt.x1,Bt.y1),new l.Point(Bt.x2,Bt.y1),new l.Point(Bt.x2,Bt.y2),new l.Point(Bt.x1,Bt.y2)];l.polygonIntersectsPolygon(o,Pt)&&(gt[Xt.bucketInstanceId][Xt.featureIndex]=!0,vt[Xt.bucketInstanceId]===void 0&&(vt[Xt.bucketInstanceId]=[]),vt[Xt.bucketInstanceId].push(Xt.featureIndex))}}return vt},vn.prototype.insertCollisionBox=function(r,o,n,s,u){(o?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:s,collisionGroupID:u},r[0],r[1],r[2],r[3])},vn.prototype.insertCollisionCircles=function(r,o,n,s,u){for(var d=o?this.ignoredGrid:this.grid,f={bucketInstanceId:n,featureIndex:s,collisionGroupID:u},x=0;x<r.length;x+=4)d.insertCircle(f,r[x],r[x+1],r[x+2])},vn.prototype.projectAndGetPerspectiveRatio=function(r,o,n){var s=[o,n,0,1];return Mr(s,s,r),{point:new l.Point((s[0]/s[3]+1)/2*this.transform.width+100,(-s[1]/s[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/s[3]*.5}},vn.prototype.isOffscreen=function(r,o,n,s){return n<100||r>=this.screenRightBoundary||s<100||o>this.screenBottomBoundary},vn.prototype.isInsideGrid=function(r,o,n,s){return n>=0&&r<this.gridRightBoundary&&s>=0&&o<this.gridBottomBoundary},vn.prototype.getViewportMatrix=function(){var r=l.identity([]);return l.translate(r,r,[-100,-100,0]),r};var En=function(r,o,n,s){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?o:-o))):s&&n?1:0,this.placed=n};En.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var dn=function(r,o,n,s,u){this.text=new En(r?r.text:null,o,n,u),this.icon=new En(r?r.icon:null,o,s,u)};dn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Bl=function(r,o,n){this.text=r,this.icon=o,this.skipFade=n},_n=function(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]},Zh=function(r,o,n,s,u){this.bucketInstanceId=r,this.featureIndex=o,this.sourceLayerIndex=n,this.bucketIndex=s,this.tileID=u},Vn=function(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}};function Or(r,o,n,s,u){var d=l.getAnchorAlignment(r),f=-(d.horizontalAlign-.5)*o,x=-(d.verticalAlign-.5)*n,L=l.evaluateVariableOffset(r,s);return new l.Point(f+L[0]*u,x+L[1]*u)}function On(r,o,n,s,u,d){var f=r.x1,x=r.x2,L=r.y1,H=r.y2,gt=r.anchorPointX,vt=r.anchorPointY,bt=new l.Point(o,n);return s&&bt._rotate(u?d:-d),{x1:f+bt.x,y1:L+bt.y,x2:x+bt.x,y2:H+bt.y,anchorPointX:gt,anchorPointY:vt}}Vn.prototype.get=function(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){var o=++this.maxGroupID;this.collisionGroups[r]={ID:o,predicate:function(n){return n.collisionGroupID===o}}}return this.collisionGroups[r]};var qr=function(r,o,n,s){this.transform=r.clone(),this.collisionIndex=new vn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=o,this.retainedQueryData={},this.collisionGroups=new Vn(n),this.collisionCircleArrays={},this.prevPlacement=s,s&&(s.prevPlacement=void 0),this.placedOrientations={}};function So(r,o,n,s,u){r.emplaceBack(o?1:0,n?1:0,s||0,u||0),r.emplaceBack(o?1:0,n?1:0,s||0,u||0),r.emplaceBack(o?1:0,n?1:0,s||0,u||0),r.emplaceBack(o?1:0,n?1:0,s||0,u||0)}qr.prototype.getBucketParts=function(r,o,n,s){var u=n.getBucket(o),d=n.latestFeatureIndex;if(u&&d&&o.id===u.layerIds[0]){var f=n.collisionBoxArray,x=u.layers[0].layout,L=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),H=n.tileSize/l.EXTENT,gt=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),vt=x.get("text-pitch-alignment")==="map",bt=x.get("text-rotation-alignment")==="map",Ft=Qi(n,1,this.transform.zoom),Bt=ur(gt,vt,bt,this.transform,Ft),Xt=null;if(vt){var Pt=Vi(gt,vt,bt,this.transform,Ft);Xt=l.multiply([],this.transform.labelPlaneMatrix,Pt)}this.retainedQueryData[u.bucketInstanceId]=new Zh(u.bucketInstanceId,d,u.sourceLayerIndex,u.index,n.tileID);var qt={bucket:u,layout:x,posMatrix:gt,textLabelPlaneMatrix:Bt,labelToScreenMatrix:Xt,scale:L,textPixelRatio:H,holdingForFade:n.holdingForFade(),collisionBoxArray:f,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(u.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(u.sourceID)};if(s)for(var Qt=0,ne=u.sortKeyRanges;Qt<ne.length;Qt+=1){var pe=ne[Qt];r.push({sortKey:pe.sortKey,symbolInstanceStart:pe.symbolInstanceStart,symbolInstanceEnd:pe.symbolInstanceEnd,parameters:qt})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:u.symbolInstances.length,parameters:qt})}},qr.prototype.attemptAnchorPlacement=function(r,o,n,s,u,d,f,x,L,H,gt,vt,bt,Ft,Bt){var Xt,Pt=[vt.textOffset0,vt.textOffset1],qt=Or(r,n,s,Pt,u),Qt=this.collisionIndex.placeCollisionBox(On(o,qt.x,qt.y,d,f,this.transform.angle),gt,x,L,H.predicate);if(!Bt||this.collisionIndex.placeCollisionBox(On(Bt,qt.x,qt.y,d,f,this.transform.angle),gt,x,L,H.predicate).box.length!==0)return Qt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[vt.crossTileID]&&this.prevPlacement.placements[vt.crossTileID]&&this.prevPlacement.placements[vt.crossTileID].text&&(Xt=this.prevPlacement.variableOffsets[vt.crossTileID].anchor),this.variableOffsets[vt.crossTileID]={textOffset:Pt,width:n,height:s,anchor:r,textBoxScale:u,prevAnchor:Xt},this.markUsedJustification(bt,r,vt,Ft),bt.allowVerticalPlacement&&(this.markUsedOrientation(bt,Ft,vt),this.placedOrientations[vt.crossTileID]=Ft),{shift:qt,placedGlyphBoxes:Qt}):void 0},qr.prototype.placeLayerBucketPart=function(r,o,n){var s=this,u=r.parameters,d=u.bucket,f=u.layout,x=u.posMatrix,L=u.textLabelPlaneMatrix,H=u.labelToScreenMatrix,gt=u.textPixelRatio,vt=u.holdingForFade,bt=u.collisionBoxArray,Ft=u.partiallyEvaluatedTextSize,Bt=u.collisionGroup,Xt=f.get("text-optional"),Pt=f.get("icon-optional"),qt=f.get("text-allow-overlap"),Qt=f.get("icon-allow-overlap"),ne=f.get("text-rotation-alignment")==="map",pe=f.get("text-pitch-alignment")==="map",ce=f.get("icon-text-fit")!=="none",de=f.get("symbol-z-order")==="viewport-y",xe=qt&&(Qt||!d.hasIconData()||Pt),Ae=Qt&&(qt||!d.hasTextData()||Xt);!d.collisionArrays&&bt&&d.deserializeCollisionBoxes(bt);var Ce=function(Ue,hi){if(!o[Ue.crossTileID])if(vt)s.placements[Ue.crossTileID]=new Bl(!1,!1,!1);else{var gi,si=!1,ai=!1,mi=!0,oi=null,ri={box:null,offscreen:null},Tr={box:null,offscreen:null},sr=null,jr=null,Ir=0,or=0,dr=0;hi.textFeatureIndex?Ir=hi.textFeatureIndex:Ue.useRuntimeCollisionCircles&&(Ir=Ue.featureIndex),hi.verticalTextFeatureIndex&&(or=hi.verticalTextFeatureIndex);var un=hi.textBox;if(un){var Hr=function(Ri){var gn=l.WritingMode.horizontal;if(d.allowVerticalPlacement&&!Ri&&s.prevPlacement){var en=s.prevPlacement.placedOrientations[Ue.crossTileID];en&&(s.placedOrientations[Ue.crossTileID]=en,s.markUsedOrientation(d,gn=en,Ue))}return gn},uo=function(Ri,gn){if(d.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&hi.verticalTextBox)for(var en=0,No=d.writingModes;en<No.length&&(No[en]===l.WritingMode.vertical?(ri=gn(),Tr=ri):ri=Ri(),!(ri&&ri.box&&ri.box.length));en+=1);else ri=Ri()};if(f.get("text-variable-anchor")){var tn=f.get("text-variable-anchor");if(s.prevPlacement&&s.prevPlacement.variableOffsets[Ue.crossTileID]){var Dn=s.prevPlacement.variableOffsets[Ue.crossTileID];tn.indexOf(Dn.anchor)>0&&(tn=tn.filter(function(Ri){return Ri!==Dn.anchor})).unshift(Dn.anchor)}var Tn=function(Ri,gn,en){for(var No=Ri.x2-Ri.x1,lc=Ri.y2-Ri.y1,cs=Ue.textBoxScale,hc=ce&&!Qt?gn:null,Oa={box:[],offscreen:!1},dh=qt?2*tn.length:tn.length,sa=0;sa<dh;++sa){var us=s.attemptAnchorPlacement(tn[sa%tn.length],Ri,No,lc,cs,ne,pe,gt,x,Bt,sa>=tn.length,Ue,d,en,hc);if(us&&(Oa=us.placedGlyphBoxes)&&Oa.box&&Oa.box.length){si=!0,oi=us.shift;break}}return Oa};uo(function(){return Tn(un,hi.iconBox,l.WritingMode.horizontal)},function(){var Ri=hi.verticalTextBox;return d.allowVerticalPlacement&&!(ri&&ri.box&&ri.box.length)&&Ue.numVerticalGlyphVertices>0&&Ri?Tn(Ri,hi.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),ri&&(si=ri.box,mi=ri.offscreen);var La=Hr(ri&&ri.box);if(!si&&s.prevPlacement){var oa=s.prevPlacement.variableOffsets[Ue.crossTileID];oa&&(s.variableOffsets[Ue.crossTileID]=oa,s.markUsedJustification(d,oa.anchor,Ue,La))}}else{var po=function(Ri,gn){var en=s.collisionIndex.placeCollisionBox(Ri,qt,gt,x,Bt.predicate);return en&&en.box&&en.box.length&&(s.markUsedOrientation(d,gn,Ue),s.placedOrientations[Ue.crossTileID]=gn),en};uo(function(){return po(un,l.WritingMode.horizontal)},function(){var Ri=hi.verticalTextBox;return d.allowVerticalPlacement&&Ue.numVerticalGlyphVertices>0&&Ri?po(Ri,l.WritingMode.vertical):{box:null,offscreen:null}}),Hr(ri&&ri.box&&ri.box.length)}}if(si=(gi=ri)&&gi.box&&gi.box.length>0,mi=gi&&gi.offscreen,Ue.useRuntimeCollisionCircles){var aa=d.text.placedSymbolArray.get(Ue.centerJustifiedTextSymbolIndex),za=l.evaluateSizeForFeature(d.textSizeData,Ft,aa),jn=f.get("text-padding");sr=s.collisionIndex.placeCollisionCircles(qt,aa,d.lineVertexArray,d.glyphOffsetArray,za,x,L,H,n,pe,Bt.predicate,Ue.collisionCircleDiameter,jn),si=qt||sr.circles.length>0&&!sr.collisionDetected,mi=mi&&sr.offscreen}if(hi.iconFeatureIndex&&(dr=hi.iconFeatureIndex),hi.iconBox){var Da=function(Ri){var gn=ce&&oi?On(Ri,oi.x,oi.y,ne,pe,s.transform.angle):Ri;return s.collisionIndex.placeCollisionBox(gn,Qt,gt,x,Bt.predicate)};ai=Tr&&Tr.box&&Tr.box.length&&hi.verticalIconBox?(jr=Da(hi.verticalIconBox)).box.length>0:(jr=Da(hi.iconBox)).box.length>0,mi=mi&&jr.offscreen}var Un=Xt||Ue.numHorizontalGlyphVertices===0&&Ue.numVerticalGlyphVertices===0,kr=Pt||Ue.numIconVertices===0;if(Un||kr?kr?Un||(ai=ai&&si):si=ai&&si:ai=si=ai&&si,si&&gi&&gi.box&&s.collisionIndex.insertCollisionBox(gi.box,f.get("text-ignore-placement"),d.bucketInstanceId,Tr&&Tr.box&&or?or:Ir,Bt.ID),ai&&jr&&s.collisionIndex.insertCollisionBox(jr.box,f.get("icon-ignore-placement"),d.bucketInstanceId,dr,Bt.ID),sr&&(si&&s.collisionIndex.insertCollisionCircles(sr.circles,f.get("text-ignore-placement"),d.bucketInstanceId,Ir,Bt.ID),n)){var Wn=d.bucketInstanceId,fo=s.collisionCircleArrays[Wn];fo===void 0&&(fo=s.collisionCircleArrays[Wn]=new _n);for(var Uo=0;Uo<sr.circles.length;Uo+=4)fo.circles.push(sr.circles[Uo+0]),fo.circles.push(sr.circles[Uo+1]),fo.circles.push(sr.circles[Uo+2]),fo.circles.push(sr.collisionDetected?1:0)}s.placements[Ue.crossTileID]=new Bl(si||xe,ai||Ae,mi||d.justReloaded),o[Ue.crossTileID]=!0}};if(de)for(var je=d.getSortedSymbolIndexes(this.transform.angle),Ke=je.length-1;Ke>=0;--Ke){var ei=je[Ke];Ce(d.symbolInstances.get(ei),d.collisionArrays[ei])}else for(var ti=r.symbolInstanceStart;ti<r.symbolInstanceEnd;ti++)Ce(d.symbolInstances.get(ti),d.collisionArrays[ti]);if(n&&d.bucketInstanceId in this.collisionCircleArrays){var Mi=this.collisionCircleArrays[d.bucketInstanceId];l.invert(Mi.invProjMatrix,x),Mi.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1},qr.prototype.markUsedJustification=function(r,o,n,s){var u;u=s===l.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(o)];for(var d=0,f=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];d<f.length;d+=1){var x=f[d];x>=0&&(r.text.placedSymbolArray.get(x).crossTileID=u>=0&&x!==u?0:n.crossTileID)}},qr.prototype.markUsedOrientation=function(r,o,n){for(var s=o===l.WritingMode.horizontal||o===l.WritingMode.horizontalOnly?o:0,u=o===l.WritingMode.vertical?o:0,d=0,f=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];d<f.length;d+=1)r.text.placedSymbolArray.get(f[d]).placedOrientation=s;n.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=u)},qr.prototype.commit=function(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;var o=this.prevPlacement,n=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;var s=o?o.symbolFadeChange(r):1,u=o?o.opacities:{},d=o?o.variableOffsets:{},f=o?o.placedOrientations:{};for(var x in this.placements){var L=this.placements[x],H=u[x];H?(this.opacities[x]=new dn(H,s,L.text,L.icon),n=n||L.text!==H.text.placed||L.icon!==H.icon.placed):(this.opacities[x]=new dn(null,s,L.text,L.icon,L.skipFade),n=n||L.text||L.icon)}for(var gt in u){var vt=u[gt];if(!this.opacities[gt]){var bt=new dn(vt,s,!1,!1);bt.isHidden()||(this.opacities[gt]=bt,n=n||vt.text.placed||vt.icon.placed)}}for(var Ft in d)this.variableOffsets[Ft]||!this.opacities[Ft]||this.opacities[Ft].isHidden()||(this.variableOffsets[Ft]=d[Ft]);for(var Bt in f)this.placedOrientations[Bt]||!this.opacities[Bt]||this.opacities[Bt].isHidden()||(this.placedOrientations[Bt]=f[Bt]);n?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:r)},qr.prototype.updateLayerOpacities=function(r,o){for(var n={},s=0,u=o;s<u.length;s+=1){var d=u[s],f=d.getBucket(r);f&&d.latestFeatureIndex&&r.id===f.layerIds[0]&&this.updateBucketOpacities(f,n,d.collisionBoxArray)}},qr.prototype.updateBucketOpacities=function(r,o,n){var s=this;r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();var u=r.layers[0].layout,d=new dn(null,0,!1,!1,!0),f=u.get("text-allow-overlap"),x=u.get("icon-allow-overlap"),L=u.get("text-variable-anchor"),H=u.get("text-rotation-alignment")==="map",gt=u.get("text-pitch-alignment")==="map",vt=u.get("icon-text-fit")!=="none",bt=new dn(null,0,f&&(x||!r.hasIconData()||u.get("icon-optional")),x&&(f||!r.hasTextData()||u.get("text-optional")),!0);!r.collisionArrays&&n&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(n);for(var Ft=function(qt,Qt,ne){for(var pe=0;pe<Qt/4;pe++)qt.opacityVertexArray.emplaceBack(ne)},Bt=function(qt){var Qt=r.symbolInstances.get(qt),ne=Qt.numHorizontalGlyphVertices,pe=Qt.numVerticalGlyphVertices,ce=Qt.crossTileID,de=s.opacities[ce];o[ce]?de=d:de||(s.opacities[ce]=de=bt),o[ce]=!0;var xe=Qt.numIconVertices>0,Ae=s.placedOrientations[Qt.crossTileID],Ce=Ae===l.WritingMode.vertical,je=Ae===l.WritingMode.horizontal||Ae===l.WritingMode.horizontalOnly;if(ne>0||pe>0){var Ke=jl(de.text);Ft(r.text,ne,Ce?Zo:Ke),Ft(r.text,pe,je?Zo:Ke);var ei=de.text.isHidden();[Qt.rightJustifiedTextSymbolIndex,Qt.centerJustifiedTextSymbolIndex,Qt.leftJustifiedTextSymbolIndex].forEach(function(ri){ri>=0&&(r.text.placedSymbolArray.get(ri).hidden=ei||Ce?1:0)}),Qt.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(Qt.verticalPlacedTextSymbolIndex).hidden=ei||je?1:0);var ti=s.variableOffsets[Qt.crossTileID];ti&&s.markUsedJustification(r,ti.anchor,Qt,Ae);var Mi=s.placedOrientations[Qt.crossTileID];Mi&&(s.markUsedJustification(r,"left",Qt,Mi),s.markUsedOrientation(r,Mi,Qt))}if(xe){var Ue=jl(de.icon),hi=!(vt&&Qt.verticalPlacedIconSymbolIndex&&Ce);Qt.placedIconSymbolIndex>=0&&(Ft(r.icon,Qt.numIconVertices,hi?Ue:Zo),r.icon.placedSymbolArray.get(Qt.placedIconSymbolIndex).hidden=de.icon.isHidden()),Qt.verticalPlacedIconSymbolIndex>=0&&(Ft(r.icon,Qt.numVerticalIconVertices,hi?Zo:Ue),r.icon.placedSymbolArray.get(Qt.verticalPlacedIconSymbolIndex).hidden=de.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){var gi=r.collisionArrays[qt];if(gi){var si=new l.Point(0,0);if(gi.textBox||gi.verticalTextBox){var ai=!0;if(L){var mi=s.variableOffsets[ce];mi?(si=Or(mi.anchor,mi.width,mi.height,mi.textOffset,mi.textBoxScale),H&&si._rotate(gt?s.transform.angle:-s.transform.angle)):ai=!1}gi.textBox&&So(r.textCollisionBox.collisionVertexArray,de.text.placed,!ai||Ce,si.x,si.y),gi.verticalTextBox&&So(r.textCollisionBox.collisionVertexArray,de.text.placed,!ai||je,si.x,si.y)}var oi=!!(!je&&gi.verticalIconBox);gi.iconBox&&So(r.iconCollisionBox.collisionVertexArray,de.icon.placed,oi,vt?si.x:0,vt?si.y:0),gi.verticalIconBox&&So(r.iconCollisionBox.collisionVertexArray,de.icon.placed,!oi,vt?si.x:0,vt?si.y:0)}}},Xt=0;Xt<r.symbolInstances.length;Xt++)Bt(Xt);if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){var Pt=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=Pt.invProjMatrix,r.placementViewportMatrix=Pt.viewportMatrix,r.collisionCircleArray=Pt.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}},qr.prototype.symbolFadeChange=function(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},qr.prototype.zoomAdjustment=function(r){return Math.max(0,(this.transform.zoom-r)/1.5)},qr.prototype.hasTransitions=function(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration},qr.prototype.stillRecent=function(r,o){var n=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*n>r},qr.prototype.setStale=function(){this.stale=!0};var Yh=Math.pow(2,25),Kh=Math.pow(2,24),Us=Math.pow(2,17),Jh=Math.pow(2,16),Rl=Math.pow(2,9),$h=Math.pow(2,8),Fl=Math.pow(2,1);function jl(r){if(r.opacity===0&&!r.placed)return 0;if(r.opacity===1&&r.placed)return 4294967295;var o=r.placed?1:0,n=Math.floor(127*r.opacity);return n*Yh+o*Kh+n*Us+o*Jh+n*Rl+o*$h+n*Fl+o}var Zo=0,Ns=function(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ns.prototype.continuePlacement=function(r,o,n,s,u){for(var d=this._bucketParts;this._currentTileIndex<r.length;)if(o.getBucketParts(d,s,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,u())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,d.sort(function(f,x){return f.sortKey-x.sortKey}));this._currentPartIndex<d.length;)if(o.placeLayerBucketPart(d[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,u())return!0;return!1};var ma=function(r,o,n,s,u,d,f){this.placement=new qr(r,u,d,f),this._currentPlacementIndex=o.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=s,this._done=!1};ma.prototype.isDone=function(){return this._done},ma.prototype.continuePlacement=function(r,o,n){for(var s=this,u=l.browser.now(),d=function(){var L=l.browser.now()-u;return!s._forceFullPlacement&&L>2};this._currentPlacementIndex>=0;){var f=o[r[this._currentPlacementIndex]],x=this.placement.collisionIndex.transform.zoom;if(f.type==="symbol"&&(!f.minzoom||f.minzoom<=x)&&(!f.maxzoom||f.maxzoom>x)){if(this._inProgressLayer||(this._inProgressLayer=new Ns(f)),this._inProgressLayer.continuePlacement(n[f.source],this.placement,this._showCollisionBoxes,f,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ma.prototype.commit=function(r){return this.placement.commit(r),this.placement};var Ul=512/l.EXTENT/2,qa=function(r,o,n){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var s=0;s<o.length;s++){var u=o.get(s),d=u.key;this.indexedSymbolInstances[d]||(this.indexedSymbolInstances[d]=[]),this.indexedSymbolInstances[d].push({crossTileID:u.crossTileID,coord:this.getScaledCoordinates(u,r)})}};qa.prototype.getScaledCoordinates=function(r,o){var n=Ul/Math.pow(2,o.canonical.z-this.tileID.canonical.z);return{x:Math.floor((o.canonical.x*l.EXTENT+r.anchorX)*n),y:Math.floor((o.canonical.y*l.EXTENT+r.anchorY)*n)}},qa.prototype.findMatches=function(r,o,n){for(var s=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z),u=0;u<r.length;u++){var d=r.get(u);if(!d.crossTileID){var f=this.indexedSymbolInstances[d.key];if(f)for(var x=this.getScaledCoordinates(d,o),L=0,H=f;L<H.length;L+=1){var gt=H[L];if(Math.abs(gt.coord.x-x.x)<=s&&Math.abs(gt.coord.y-x.y)<=s&&!n[gt.crossTileID]){n[gt.crossTileID]=!0,d.crossTileID=gt.crossTileID;break}}}}};var xn=function(){this.maxCrossTileID=0};xn.prototype.generate=function(){return++this.maxCrossTileID};var Jn=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Jn.prototype.handleWrapJump=function(r){var o=Math.round((r-this.lng)/360);if(o!==0)for(var n in this.indexes){var s=this.indexes[n],u={};for(var d in s){var f=s[d];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+o),u[f.tileID.key]=f}this.indexes[n]=u}this.lng=r},Jn.prototype.addBucket=function(r,o,n){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(var s=0;s<o.symbolInstances.length;s++)o.symbolInstances.get(s).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});var u=this.usedCrossTileIDs[r.overscaledZ];for(var d in this.indexes){var f=this.indexes[d];if(Number(d)>r.overscaledZ)for(var x in f){var L=f[x];L.tileID.isChildOf(r)&&L.findMatches(o.symbolInstances,r,u)}else{var H=f[r.scaledTo(Number(d)).key];H&&H.findMatches(o.symbolInstances,r,u)}}for(var gt=0;gt<o.symbolInstances.length;gt++){var vt=o.symbolInstances.get(gt);vt.crossTileID||(vt.crossTileID=n.generate(),u[vt.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new qa(r,o.symbolInstances,o.bucketInstanceId),!0},Jn.prototype.removeBucketCrossTileIDs=function(r,o){for(var n in o.indexedSymbolInstances)for(var s=0,u=o.indexedSymbolInstances[n];s<u.length;s+=1)delete this.usedCrossTileIDs[r][u[s].crossTileID]},Jn.prototype.removeStaleBuckets=function(r){var o=!1;for(var n in this.indexes){var s=this.indexes[n];for(var u in s)r[s[u].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,s[u]),delete s[u],o=!0)}return o};var $n=function(){this.layerIndexes={},this.crossTileIDs=new xn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};$n.prototype.addLayer=function(r,o,n){var s=this.layerIndexes[r.id];s===void 0&&(s=this.layerIndexes[r.id]=new Jn);var u=!1,d={};s.handleWrapJump(n);for(var f=0,x=o;f<x.length;f+=1){var L=x[f],H=L.getBucket(r);H&&r.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),s.addBucket(L.tileID,H,this.crossTileIDs)&&(u=!0),d[H.bucketInstanceId]=!0)}return s.removeStaleBuckets(d)&&(u=!0),u},$n.prototype.pruneUnusedLayers=function(r){var o={};for(var n in r.forEach(function(s){o[s]=!0}),this.layerIndexes)o[n]||delete this.layerIndexes[n]};var To=function(r,o){return l.emitValidationErrors(r,o&&o.filter(function(n){return n.identifier!=="source.canvas"}))},Qn=l.pick(Le,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),to=l.pick(Le,["setCenter","setZoom","setBearing","setPitch"]),Xa=function(){var r={},o=l.styleSpec.$version;for(var n in l.styleSpec.$root){var s,u=l.styleSpec.$root[n];u.required&&(s=n==="version"?o:u.type==="array"?[]:{})!=null&&(r[n]=s)}return r}(),on=function(r){function o(n,s){var u=this;s===void 0&&(s={}),r.call(this),this.map=n,this.dispatcher=new S(me(),this),this.imageManager=new q,this.imageManager.setEventedParent(this),this.glyphManager=new V(n._requestManager,s.localIdeographFontFamily),this.lineAtlas=new z(256,512),this.crossTileSymbolIndex=new $n,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());var d=this;this._rtlTextPluginCallback=o.registerForPluginStateChange(function(f){d.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:f.pluginStatus,pluginURL:f.pluginURL},function(x,L){if(l.triggerPluginCompletionEvent(x),L&&L.every(function(gt){return gt}))for(var H in d.sourceCaches)d.sourceCaches[H].reload()})}),this.on("data",function(f){if(f.dataType==="source"&&f.sourceDataType==="metadata"){var x=u.sourceCaches[f.sourceId];if(x){var L=x.getSource();if(L&&L.vectorLayerIds)for(var H in u._layers){var gt=u._layers[H];gt.source===L.id&&u._validateLayer(gt)}}}})}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.loadURL=function(n,s){var u=this;s===void 0&&(s={}),this.fire(new l.Event("dataloading",{dataType:"style"}));var d=typeof s.validate=="boolean"?s.validate:!l.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,s.accessToken);var f=this.map._requestManager.transformRequest(n,l.ResourceType.Style);this._request=l.getJSON(f,function(x,L){u._request=null,x?u.fire(new l.ErrorEvent(x)):L&&u._load(L,d)})},o.prototype.loadJSON=function(n,s){var u=this;s===void 0&&(s={}),this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.browser.frame(function(){u._request=null,u._load(n,s.validate!==!1)})},o.prototype.loadEmpty=function(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(Xa,!1)},o.prototype._load=function(n,s){if(!s||!To(this,l.validateStyle(n))){for(var u in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(u,n.sources[u],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var d=Pe(this.stylesheet.layers);this._order=d.map(function(H){return H.id}),this._layers={},this._serializedLayers={};for(var f=0,x=d;f<x.length;f+=1){var L=x[f];(L=l.createStyleLayer(L)).setEventedParent(this,{layer:{id:L.id}}),this._layers[L.id]=L,this._serializedLayers[L.id]=L.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new C(this.stylesheet.light),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}},o.prototype._loadSprite=function(n){var s=this;this._spriteRequest=function(u,d,f){var x,L,H,gt=l.browser.devicePixelRatio>1?"@2x":"",vt=l.getJSON(d.transformRequest(d.normalizeSpriteURL(u,gt,".json"),l.ResourceType.SpriteJSON),function(Bt,Xt){vt=null,H||(H=Bt,x=Xt,Ft())}),bt=l.getImage(d.transformRequest(d.normalizeSpriteURL(u,gt,".png"),l.ResourceType.SpriteImage),function(Bt,Xt){bt=null,H||(H=Bt,L=Xt,Ft())});function Ft(){if(H)f(H);else if(x&&L){var Bt=l.browser.getImageData(L),Xt={};for(var Pt in x){var qt=x[Pt],Qt=qt.width,ne=qt.height,pe=qt.x,ce=qt.y,de=qt.sdf,xe=qt.pixelRatio,Ae=qt.stretchX,Ce=qt.stretchY,je=qt.content,Ke=new l.RGBAImage({width:Qt,height:ne});l.RGBAImage.copy(Bt,Ke,{x:pe,y:ce},{x:0,y:0},{width:Qt,height:ne}),Xt[Pt]={data:Ke,pixelRatio:xe,sdf:de,stretchX:Ae,stretchY:Ce,content:je}}f(null,Xt)}}return{cancel:function(){vt&&(vt.cancel(),vt=null),bt&&(bt.cancel(),bt=null)}}}(n,this.map._requestManager,function(u,d){if(s._spriteRequest=null,u)s.fire(new l.ErrorEvent(u));else if(d)for(var f in d)s.imageManager.addImage(f,d[f]);s.imageManager.setLoaded(!0),s._availableImages=s.imageManager.listImages(),s.dispatcher.broadcast("setImages",s._availableImages),s.fire(new l.Event("data",{dataType:"style"}))})},o.prototype._validateLayer=function(n){var s=this.sourceCaches[n.source];if(s){var u=n.sourceLayer;if(u){var d=s.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(u)===-1)&&this.fire(new l.ErrorEvent(new Error('Source layer "'+u+'" does not exist on source "'+d.id+'" as specified by style layer "'+n.id+'"')))}}},o.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},o.prototype._serializeLayers=function(n){for(var s=[],u=0,d=n;u<d.length;u+=1){var f=this._layers[d[u]];f.type!=="custom"&&s.push(f.serialize())}return s},o.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var s in this._layers)if(this._layers[s].hasTransition())return!0;return!1},o.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},o.prototype.update=function(n){if(this._loaded){var s=this._changed;if(this._changed){var u=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);for(var f in(u.length||d.length)&&this._updateWorkerLayers(u,d),this._updatedSources){var x=this._updatedSources[f];x==="reload"?this._reloadSource(f):x==="clear"&&this._clearSource(f)}for(var L in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[L].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var H={};for(var gt in this.sourceCaches){var vt=this.sourceCaches[gt];H[gt]=vt.used,vt.used=!1}for(var bt=0,Ft=this._order;bt<Ft.length;bt+=1){var Bt=this._layers[Ft[bt]];Bt.recalculate(n,this._availableImages),!Bt.isHidden(n.zoom)&&Bt.source&&(this.sourceCaches[Bt.source].used=!0)}for(var Xt in H){var Pt=this.sourceCaches[Xt];H[Xt]!==Pt.used&&Pt.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Xt}))}this.light.recalculate(n),this.z=n.zoom,s&&this.fire(new l.Event("data",{dataType:"style"}))}},o.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},o.prototype._updateWorkerLayers=function(n,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:s})},o.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},o.prototype.setState=function(n){var s=this;if(this._checkLoaded(),To(this,l.validateStyle(n)))return!1;(n=l.clone$1(n)).layers=Pe(n.layers);var u=function(f,x){if(!f)return[{command:Le.setStyle,args:[x]}];var L=[];try{if(!l.deepEqual(f.version,x.version))return[{command:Le.setStyle,args:[x]}];l.deepEqual(f.center,x.center)||L.push({command:Le.setCenter,args:[x.center]}),l.deepEqual(f.zoom,x.zoom)||L.push({command:Le.setZoom,args:[x.zoom]}),l.deepEqual(f.bearing,x.bearing)||L.push({command:Le.setBearing,args:[x.bearing]}),l.deepEqual(f.pitch,x.pitch)||L.push({command:Le.setPitch,args:[x.pitch]}),l.deepEqual(f.sprite,x.sprite)||L.push({command:Le.setSprite,args:[x.sprite]}),l.deepEqual(f.glyphs,x.glyphs)||L.push({command:Le.setGlyphs,args:[x.glyphs]}),l.deepEqual(f.transition,x.transition)||L.push({command:Le.setTransition,args:[x.transition]}),l.deepEqual(f.light,x.light)||L.push({command:Le.setLight,args:[x.light]});var H={},gt=[];(function(bt,Ft,Bt,Xt){var Pt;for(Pt in Ft=Ft||{},bt=bt||{})bt.hasOwnProperty(Pt)&&(Ft.hasOwnProperty(Pt)||Be(Pt,Bt,Xt));for(Pt in Ft)Ft.hasOwnProperty(Pt)&&(bt.hasOwnProperty(Pt)?l.deepEqual(bt[Pt],Ft[Pt])||(bt[Pt].type==="geojson"&&Ft[Pt].type==="geojson"&&Wi(bt,Ft,Pt)?Bt.push({command:Le.setGeoJSONSourceData,args:[Pt,Ft[Pt].data]}):ki(Pt,Ft,Bt,Xt)):vi(Pt,Ft,Bt))})(f.sources,x.sources,gt,H);var vt=[];f.layers&&f.layers.forEach(function(bt){H[bt.source]?L.push({command:Le.removeLayer,args:[bt.id]}):vt.push(bt)}),L=L.concat(gt),function(bt,Ft,Bt){Ft=Ft||[];var Xt,Pt,qt,Qt,ne,pe,ce,de=(bt=bt||[]).map(Oi),xe=Ft.map(Oi),Ae=bt.reduce(Ai,{}),Ce=Ft.reduce(Ai,{}),je=de.slice(),Ke=Object.create(null);for(Xt=0,Pt=0;Xt<de.length;Xt++)Ce.hasOwnProperty(qt=de[Xt])?Pt++:(Bt.push({command:Le.removeLayer,args:[qt]}),je.splice(je.indexOf(qt,Pt),1));for(Xt=0,Pt=0;Xt<xe.length;Xt++)je[je.length-1-Xt]!==(qt=xe[xe.length-1-Xt])&&(Ae.hasOwnProperty(qt)?(Bt.push({command:Le.removeLayer,args:[qt]}),je.splice(je.lastIndexOf(qt,je.length-Pt),1)):Pt++,Bt.push({command:Le.addLayer,args:[Ce[qt],pe=je[je.length-Xt]]}),je.splice(je.length-Xt,0,qt),Ke[qt]=!0);for(Xt=0;Xt<xe.length;Xt++)if(Qt=Ae[qt=xe[Xt]],ne=Ce[qt],!Ke[qt]&&!l.deepEqual(Qt,ne))if(l.deepEqual(Qt.source,ne.source)&&l.deepEqual(Qt["source-layer"],ne["source-layer"])&&l.deepEqual(Qt.type,ne.type)){for(ce in bi(Qt.layout,ne.layout,Bt,qt,null,Le.setLayoutProperty),bi(Qt.paint,ne.paint,Bt,qt,null,Le.setPaintProperty),l.deepEqual(Qt.filter,ne.filter)||Bt.push({command:Le.setFilter,args:[qt,ne.filter]}),l.deepEqual(Qt.minzoom,ne.minzoom)&&l.deepEqual(Qt.maxzoom,ne.maxzoom)||Bt.push({command:Le.setLayerZoomRange,args:[qt,ne.minzoom,ne.maxzoom]}),Qt)Qt.hasOwnProperty(ce)&&ce!=="layout"&&ce!=="paint"&&ce!=="filter"&&ce!=="metadata"&&ce!=="minzoom"&&ce!=="maxzoom"&&(ce.indexOf("paint.")===0?bi(Qt[ce],ne[ce],Bt,qt,ce.slice(6),Le.setPaintProperty):l.deepEqual(Qt[ce],ne[ce])||Bt.push({command:Le.setLayerProperty,args:[qt,ce,ne[ce]]}));for(ce in ne)ne.hasOwnProperty(ce)&&!Qt.hasOwnProperty(ce)&&ce!=="layout"&&ce!=="paint"&&ce!=="filter"&&ce!=="metadata"&&ce!=="minzoom"&&ce!=="maxzoom"&&(ce.indexOf("paint.")===0?bi(Qt[ce],ne[ce],Bt,qt,ce.slice(6),Le.setPaintProperty):l.deepEqual(Qt[ce],ne[ce])||Bt.push({command:Le.setLayerProperty,args:[qt,ce,ne[ce]]}))}else Bt.push({command:Le.removeLayer,args:[qt]}),pe=je[je.lastIndexOf(qt)+1],Bt.push({command:Le.addLayer,args:[ne,pe]})}(vt,x.layers,L)}catch(bt){console.warn("Unable to compute style diff:",bt),L=[{command:Le.setStyle,args:[x]}]}return L}(this.serialize(),n).filter(function(f){return!(f.command in to)});if(u.length===0)return!1;var d=u.filter(function(f){return!(f.command in Qn)});if(d.length>0)throw new Error("Unimplemented: "+d.map(function(f){return f.command}).join(", ")+".");return u.forEach(function(f){f.command!=="setTransition"&&s[f.command].apply(s,f.args)}),this.stylesheet=n,!0},o.prototype.addImage=function(n,s){if(this.getImage(n))return this.fire(new l.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,s),this._afterImageUpdated(n)},o.prototype.updateImage=function(n,s){this.imageManager.updateImage(n,s)},o.prototype.getImage=function(n){return this.imageManager.getImage(n)},o.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new l.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},o.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))},o.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},o.prototype.addSource=function(n,s,u){var d=this;if(u===void 0&&(u={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!s.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(s).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(l.validateStyle.source,"sources."+n,s,null,u))){this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);var f=this.sourceCaches[n]=new Ut(n,s,this.dispatcher);f.style=this,f.setEventedParent(this,function(){return{isSourceLoaded:d.loaded(),source:f.serialize(),sourceId:n}}),f.onAdd(this.map),this._changed=!0}},o.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var s in this._layers)if(this._layers[s].source===n)return this.fire(new l.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+s+'" is using it.')));var u=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],u.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),u.setEventedParent(null),u.clearTiles(),u.onRemove&&u.onRemove(this.map),this._changed=!0},o.prototype.setGeoJSONSourceData=function(n,s){this._checkLoaded(),this.sourceCaches[n].getSource().setData(s),this._changed=!0},o.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},o.prototype.addLayer=function(n,s,u){u===void 0&&(u={}),this._checkLoaded();var d=n.id;if(this.getLayer(d))this.fire(new l.ErrorEvent(new Error('Layer with id "'+d+'" already exists on this map')));else{var f;if(n.type==="custom"){if(To(this,l.validateCustomStyleLayer(n)))return;f=l.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(d,n.source),n=l.clone$1(n),n=l.extend(n,{source:d})),this._validate(l.validateStyle.layer,"layers."+d,n,{arrayIndex:-1},u))return;f=l.createStyleLayer(n),this._validateLayer(f),f.setEventedParent(this,{layer:{id:d}}),this._serializedLayers[f.id]=f.serialize()}var x=s?this._order.indexOf(s):this._order.length;if(s&&x===-1)this.fire(new l.ErrorEvent(new Error('Layer with id "'+s+'" does not exist on this map.')));else{if(this._order.splice(x,0,d),this._layerOrderChanged=!0,this._layers[d]=f,this._removedLayers[d]&&f.source&&f.type!=="custom"){var L=this._removedLayers[d];delete this._removedLayers[d],L.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map)}}},o.prototype.moveLayer=function(n,s){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==s){var u=this._order.indexOf(n);this._order.splice(u,1);var d=s?this._order.indexOf(s):this._order.length;s&&d===-1?this.fire(new l.ErrorEvent(new Error('Layer with id "'+s+'" does not exist on this map.'))):(this._order.splice(d,0,n),this._layerOrderChanged=!0)}}else this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},o.prototype.removeLayer=function(n){this._checkLoaded();var s=this._layers[n];if(s){s.setEventedParent(null);var u=this._order.indexOf(n);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=s,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],s.onRemove&&s.onRemove(this.map)}else this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},o.prototype.getLayer=function(n){return this._layers[n]},o.prototype.hasLayer=function(n){return n in this._layers},o.prototype.setLayerZoomRange=function(n,s,u){this._checkLoaded();var d=this.getLayer(n);d?d.minzoom===s&&d.maxzoom===u||(s!=null&&(d.minzoom=s),u!=null&&(d.maxzoom=u),this._updateLayer(d)):this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},o.prototype.setFilter=function(n,s,u){u===void 0&&(u={}),this._checkLoaded();var d=this.getLayer(n);if(d){if(!l.deepEqual(d.filter,s))return s==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(l.validateStyle.filter,"layers."+d.id+".filter",s,null,u)||(d.filter=l.clone$1(s),this._updateLayer(d)))}else this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},o.prototype.getFilter=function(n){return l.clone$1(this.getLayer(n).filter)},o.prototype.setLayoutProperty=function(n,s,u,d){d===void 0&&(d={}),this._checkLoaded();var f=this.getLayer(n);f?l.deepEqual(f.getLayoutProperty(s),u)||(f.setLayoutProperty(s,u,d),this._updateLayer(f)):this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getLayoutProperty=function(n,s){var u=this.getLayer(n);if(u)return u.getLayoutProperty(s);this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},o.prototype.setPaintProperty=function(n,s,u,d){d===void 0&&(d={}),this._checkLoaded();var f=this.getLayer(n);f?l.deepEqual(f.getPaintProperty(s),u)||(f.setPaintProperty(s,u,d)&&this._updateLayer(f),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new l.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},o.prototype.getPaintProperty=function(n,s){return this.getLayer(n).getPaintProperty(s)},o.prototype.setFeatureState=function(n,s){this._checkLoaded();var u=n.source,d=n.sourceLayer,f=this.sourceCaches[u];if(f!==void 0){var x=f.getSource().type;x==="geojson"&&d?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||d?(n.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),f.setFeatureState(d,n.id,s)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},o.prototype.removeFeatureState=function(n,s){this._checkLoaded();var u=n.source,d=this.sourceCaches[u];if(d!==void 0){var f=d.getSource().type,x=f==="vector"?n.sourceLayer:void 0;f!=="vector"||x?s&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(x,n.id,s):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},o.prototype.getFeatureState=function(n){this._checkLoaded();var s=n.source,u=n.sourceLayer,d=this.sourceCaches[s];if(d!==void 0){if(d.getSource().type!=="vector"||u)return n.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),d.getFeatureState(u,n.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+s+"' does not exist in the map's style.")))},o.prototype.getTransition=function(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},o.prototype.serialize=function(){return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:l.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},o.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},o.prototype._flattenAndSortRenderedFeatures=function(n){for(var s=this,u=function(Ae){return s._layers[Ae].type==="fill-extrusion"},d={},f=[],x=this._order.length-1;x>=0;x--){var L=this._order[x];if(u(L)){d[L]=x;for(var H=0,gt=n;H<gt.length;H+=1){var vt=gt[H][L];if(vt)for(var bt=0,Ft=vt;bt<Ft.length;bt+=1)f.push(Ft[bt])}}}f.sort(function(Ae,Ce){return Ce.intersectionZ-Ae.intersectionZ});for(var Bt=[],Xt=this._order.length-1;Xt>=0;Xt--){var Pt=this._order[Xt];if(u(Pt))for(var qt=f.length-1;qt>=0;qt--){var Qt=f[qt].feature;if(d[Qt.layer.id]<Xt)break;Bt.push(Qt),f.pop()}else for(var ne=0,pe=n;ne<pe.length;ne+=1){var ce=pe[ne][Pt];if(ce)for(var de=0,xe=ce;de<xe.length;de+=1)Bt.push(xe[de].feature)}}return Bt},o.prototype.queryRenderedFeatures=function(n,s,u){s&&s.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",s.filter,null,s);var d={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var f=0,x=s.layers;f<x.length;f+=1){var L=x[f],H=this._layers[L];if(!H)return this.fire(new l.ErrorEvent(new Error("The layer '"+L+"' does not exist in the map's style and cannot be queried for features."))),[];d[H.source]=!0}}var gt=[];for(var vt in s.availableImages=this._availableImages,this.sourceCaches)s.layers&&!d[vt]||gt.push(Q(this.sourceCaches[vt],this._layers,this._serializedLayers,n,s,u));return this.placement&&gt.push(function(bt,Ft,Bt,Xt,Pt,qt,Qt){for(var ne={},pe=qt.queryRenderedSymbols(Xt),ce=[],de=0,xe=Object.keys(pe).map(Number);de<xe.length;de+=1)ce.push(Qt[xe[de]]);ce.sort(A);for(var Ae=function(){var ti=je[Ce],Mi=ti.featureIndex.lookupSymbolFeatures(pe[ti.bucketInstanceId],Ft,ti.bucketIndex,ti.sourceLayerIndex,Pt.filter,Pt.layers,Pt.availableImages,bt);for(var Ue in Mi){var hi=ne[Ue]=ne[Ue]||[],gi=Mi[Ue];gi.sort(function(mi,oi){var ri=ti.featureSortOrder;if(ri){var Tr=ri.indexOf(mi.featureIndex);return ri.indexOf(oi.featureIndex)-Tr}return oi.featureIndex-mi.featureIndex});for(var si=0,ai=gi;si<ai.length;si+=1)hi.push(ai[si])}},Ce=0,je=ce;Ce<je.length;Ce+=1)Ae();var Ke=function(ti){ne[ti].forEach(function(Mi){var Ue=Mi.feature,hi=Bt[bt[ti].source].getFeatureState(Ue.layer["source-layer"],Ue.id);Ue.source=Ue.layer.source,Ue.layer["source-layer"]&&(Ue.sourceLayer=Ue.layer["source-layer"]),Ue.state=hi})};for(var ei in ne)Ke(ei);return ne}(this._layers,this._serializedLayers,this.sourceCaches,n,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(gt)},o.prototype.querySourceFeatures=function(n,s){s&&s.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",s.filter,null,s);var u=this.sourceCaches[n];return u?function(d,f){for(var x=d.getRenderableIds().map(function(Ft){return d.getTileByID(Ft)}),L=[],H={},gt=0;gt<x.length;gt++){var vt=x[gt],bt=vt.tileID.canonical.key;H[bt]||(H[bt]=!0,vt.querySourceFeatures(L,f))}return L}(u,s):[]},o.prototype.addSourceType=function(n,s,u){return o.getSourceType(n)?u(new Error('A source type called "'+n+'" already exists.')):(o.setSourceType(n,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:s.workerSourceURL},u):u(null,null))},o.prototype.getLight=function(){return this.light.getLight()},o.prototype.setLight=function(n,s){s===void 0&&(s={}),this._checkLoaded();var u=this.light.getLight(),d=!1;for(var f in n)if(!l.deepEqual(n[f],u[f])){d=!0;break}if(d){var x={now:l.browser.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,s),this.light.updateTransitions(x)}},o.prototype._validate=function(n,s,u,d,f){return f===void 0&&(f={}),(!f||f.validate!==!1)&&To(this,n.call(l.validateStyle,l.extend({key:s,style:this.serialize(),value:u,styleSpec:l.styleSpec},d)))},o.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var s in this.sourceCaches)this.sourceCaches[s].clearTiles(),this.sourceCaches[s].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},o.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},o.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},o.prototype._updateSources=function(n){for(var s in this.sourceCaches)this.sourceCaches[s].update(n)},o.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},o.prototype._updatePlacement=function(n,s,u,d,f){f===void 0&&(f=!1);for(var x=!1,L=!1,H={},gt=0,vt=this._order;gt<vt.length;gt+=1){var bt=this._layers[vt[gt]];if(bt.type==="symbol"){if(!H[bt.source]){var Ft=this.sourceCaches[bt.source];H[bt.source]=Ft.getRenderableIds(!0).map(function(Qt){return Ft.getTileByID(Qt)}).sort(function(Qt,ne){return ne.tileID.overscaledZ-Qt.tileID.overscaledZ||(Qt.tileID.isLessThan(ne.tileID)?-1:1)})}var Bt=this.crossTileSymbolIndex.addLayer(bt,H[bt.source],n.center.lng);x=x||Bt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((f=f||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.browser.now(),n.zoom))&&(this.pauseablePlacement=new ma(n,this._order,f,s,u,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,H),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.browser.now()),L=!0),x&&this.pauseablePlacement.placement.setStale()),L||x)for(var Xt=0,Pt=this._order;Xt<Pt.length;Xt+=1){var qt=this._layers[Pt[Xt]];qt.type==="symbol"&&this.placement.updateLayerOpacities(qt,H[qt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.browser.now())},o.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},o.prototype.getImages=function(n,s,u){this.imageManager.getImages(s.icons,u),this._updateTilesForChangedImages();var d=this.sourceCaches[s.source];d&&d.setDependencies(s.tileID.key,s.type,s.icons)},o.prototype.getGlyphs=function(n,s,u){this.glyphManager.getGlyphs(s.stacks,u)},o.prototype.getResource=function(n,s,u){return l.makeRequest(s,u)},o}(l.Evented);on.getSourceType=function(r){return ot[r]},on.setSourceType=function(r,o){ot[r]=o},on.registerForPluginStateChange=l.registerForPluginStateChange;var yr=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),Yo=Hi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Nl=Hi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Qh=Hi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),tc=Hi(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Vs=Hi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Gs=Hi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),qs=Hi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Xs=Hi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Vl=Hi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Gl=Hi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),ec=Hi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),ga=Hi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ya=Hi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ql=Hi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Br=Hi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Ws=Hi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),eo=Hi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),io=Hi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ko=Hi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Co=Hi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),ro=Hi(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Ao=Hi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Eo=Hi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),no=Hi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Xl=Hi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Wl=Hi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Hi(r,o){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,s=o.match(/attribute ([\w]+) ([\w]+)/g),u=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),f=d?d.concat(u):u,x={};return{fragmentSource:r=r.replace(n,function(L,H,gt,vt,bt){return x[bt]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_`+bt+`
varying `+gt+" "+vt+" "+bt+`;
#else
uniform `+gt+" "+vt+" u_"+bt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+bt+`
    `+gt+" "+vt+" "+bt+" = u_"+bt+`;
#endif
`}),vertexSource:o=o.replace(n,function(L,H,gt,vt,bt){var Ft=vt==="float"?"vec2":"vec4",Bt=bt.match(/color/)?"color":Ft;return x[bt]?H==="define"?`
#ifndef HAS_UNIFORM_u_`+bt+`
uniform lowp float u_`+bt+`_t;
attribute `+gt+" "+Ft+" a_"+bt+`;
varying `+gt+" "+vt+" "+bt+`;
#else
uniform `+gt+" "+vt+" u_"+bt+`;
#endif
`:Bt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+bt+`
    `+bt+" = a_"+bt+`;
#else
    `+gt+" "+vt+" "+bt+" = u_"+bt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+bt+`
    `+bt+" = unpack_mix_"+Bt+"(a_"+bt+", u_"+bt+`_t);
#else
    `+gt+" "+vt+" "+bt+" = u_"+bt+`;
#endif
`:H==="define"?`
#ifndef HAS_UNIFORM_u_`+bt+`
uniform lowp float u_`+bt+`_t;
attribute `+gt+" "+Ft+" a_"+bt+`;
#else
uniform `+gt+" "+vt+" u_"+bt+`;
#endif
`:Bt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+bt+`
    `+gt+" "+vt+" "+bt+" = a_"+bt+`;
#else
    `+gt+" "+vt+" "+bt+" = u_"+bt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+bt+`
    `+gt+" "+vt+" "+bt+" = unpack_mix_"+Bt+"(a_"+bt+", u_"+bt+`_t);
#else
    `+gt+" "+vt+" "+bt+" = u_"+bt+`;
#endif
`}),staticAttributes:s,staticUniforms:f}}var ic=Object.freeze({__proto__:null,prelude:Yo,background:Nl,backgroundPattern:Qh,circle:tc,clippingMask:Vs,heatmap:Gs,heatmapTexture:qs,collisionBox:Xs,collisionCircle:Vl,debug:Gl,fill:ec,fillOutline:ga,fillOutlinePattern:ya,fillPattern:ql,fillExtrusion:Br,fillExtrusionPattern:Ws,hillshadePrepare:eo,hillshade:io,line:ko,lineGradient:Co,linePattern:ro,lineSDF:Ao,raster:Eo,symbolIcon:no,symbolSDF:Xl,symbolTextAndIcon:Wl}),Wa=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Hl(r){for(var o=[],n=0;n<r.length;n++)if(r[n]!==null){var s=r[n].split(" ");o.push(s.pop())}return o}Wa.prototype.bind=function(r,o,n,s,u,d,f,x){this.context=r;for(var L=this.boundPaintVertexBuffers.length!==s.length,H=0;!L&&H<s.length;H++)this.boundPaintVertexBuffers[H]!==s[H]&&(L=!0);r.extVertexArrayObject&&this.vao&&this.boundProgram===o&&this.boundLayoutVertexBuffer===n&&!L&&this.boundIndexBuffer===u&&this.boundVertexOffset===d&&this.boundDynamicVertexBuffer===f&&this.boundDynamicVertexBuffer2===x?(r.bindVertexArrayOES.set(this.vao),f&&f.bind(),u&&u.dynamicDraw&&u.bind(),x&&x.bind()):this.freshBind(o,n,s,u,d,f,x)},Wa.prototype.freshBind=function(r,o,n,s,u,d,f){var x,L=r.numAttributes,H=this.context,gt=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),x=0,this.boundProgram=r,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=s,this.boundVertexOffset=u,this.boundDynamicVertexBuffer=d,this.boundDynamicVertexBuffer2=f;else{x=H.currentNumAttributes||0;for(var vt=L;vt<x;vt++)gt.disableVertexAttribArray(vt)}o.enableAttributes(gt,r);for(var bt=0,Ft=n;bt<Ft.length;bt+=1)Ft[bt].enableAttributes(gt,r);d&&d.enableAttributes(gt,r),f&&f.enableAttributes(gt,r),o.bind(),o.setVertexAttribPointers(gt,r,u);for(var Bt=0,Xt=n;Bt<Xt.length;Bt+=1){var Pt=Xt[Bt];Pt.bind(),Pt.setVertexAttribPointers(gt,r,u)}d&&(d.bind(),d.setVertexAttribPointers(gt,r,u)),s&&s.bind(),f&&(f.bind(),f.setVertexAttribPointers(gt,r,u)),H.currentNumAttributes=L},Wa.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Zl=function(r,o,n,s,u,d){var f=r.gl;this.program=f.createProgram();for(var x=Hl(n.staticAttributes),L=s?s.getBinderAttributes():[],H=x.concat(L),gt=n.staticUniforms?Hl(n.staticUniforms):[],vt=s?s.getBinderUniforms():[],bt=[],Ft=0,Bt=gt.concat(vt);Ft<Bt.length;Ft+=1){var Xt=Bt[Ft];bt.indexOf(Xt)<0&&bt.push(Xt)}var Pt=s?s.defines():[];d&&Pt.push("#define OVERDRAW_INSPECTOR;");var qt=Pt.concat(Yo.fragmentSource,n.fragmentSource).join(`
`),Qt=Pt.concat(Yo.vertexSource,n.vertexSource).join(`
`),ne=f.createShader(f.FRAGMENT_SHADER);if(f.isContextLost())this.failedToCreate=!0;else{f.shaderSource(ne,qt),f.compileShader(ne),f.attachShader(this.program,ne);var pe=f.createShader(f.VERTEX_SHADER);if(f.isContextLost())this.failedToCreate=!0;else{f.shaderSource(pe,Qt),f.compileShader(pe),f.attachShader(this.program,pe),this.attributes={};var ce={};this.numAttributes=H.length;for(var de=0;de<this.numAttributes;de++)H[de]&&(f.bindAttribLocation(this.program,de,H[de]),this.attributes[H[de]]=de);f.linkProgram(this.program),f.deleteShader(pe),f.deleteShader(ne);for(var xe=0;xe<bt.length;xe++){var Ae=bt[xe];if(Ae&&!ce[Ae]){var Ce=f.getUniformLocation(this.program,Ae);Ce&&(ce[Ae]=Ce)}}this.fixedUniforms=u(r,ce),this.binderUniforms=s?s.getUniforms(r,ce):[]}}};function Yl(r,o,n){var s=1/Qi(n,1,o.transform.tileZoom),u=Math.pow(2,n.tileID.overscaledZ),d=n.tileSize*Math.pow(2,o.transform.tileZoom)/u,f=d*(n.tileID.canonical.x+n.tileID.wrap*u),x=d*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[s,r.fromScale,r.toScale],u_fade:r.t,u_pixel_coord_upper:[f>>16,x>>16],u_pixel_coord_lower:[65535&f,65535&x]}}Zl.prototype.draw=function(r,o,n,s,u,d,f,x,L,H,gt,vt,bt,Ft,Bt,Xt){var Pt,qt=r.gl;if(!this.failedToCreate){for(var Qt in r.program.set(this.program),r.setDepthMode(n),r.setStencilMode(s),r.setColorMode(u),r.setCullFace(d),this.fixedUniforms)this.fixedUniforms[Qt].set(f[Qt]);Ft&&Ft.setUniforms(r,this.binderUniforms,vt,{zoom:bt});for(var ne=(Pt={},Pt[qt.LINES]=2,Pt[qt.TRIANGLES]=3,Pt[qt.LINE_STRIP]=1,Pt)[o],pe=0,ce=gt.get();pe<ce.length;pe+=1){var de=ce[pe],xe=de.vaos||(de.vaos={});(xe[x]||(xe[x]=new Wa)).bind(r,this,L,Ft?Ft.getPaintVertexBuffers():[],H,de.vertexOffset,Bt,Xt),qt.drawElements(o,de.primitiveLength*ne,qt.UNSIGNED_SHORT,de.primitiveOffset*ne*2)}}};var Kl=function(r,o,n,s){var u=o.style.light,d=u.properties.get("position"),f=[d.x,d.y,d.z],x=l.create$1();u.properties.get("anchor")==="viewport"&&l.fromRotation(x,-o.transform.angle),l.transformMat3(f,f,x);var L=u.properties.get("color");return{u_matrix:r,u_lightpos:f,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[L.r,L.g,L.b],u_vertical_gradient:+n,u_opacity:s}},Mo=function(r,o,n,s,u,d,f){return l.extend(Kl(r,o,n,s),Yl(d,o,f),{u_height_factor:-Math.pow(2,u.overscaledZ)/f.tileSize/8})},oo=function(r){return{u_matrix:r}},Po=function(r,o,n,s){return l.extend(oo(r),Yl(n,o,s))},Jl=function(r,o){return{u_matrix:r,u_world:o}},$l=function(r,o,n,s,u){return l.extend(Po(r,o,n,s),{u_world:u})},Hs=function(r,o,n,s){var u,d,f=r.transform;if(s.paint.get("circle-pitch-alignment")==="map"){var x=Qi(n,1,f.zoom);u=!0,d=[x,x]}else u=!1,d=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(s.paint.get("circle-pitch-scale")==="map"),u_matrix:r.translatePosMatrix(o.posMatrix,n,s.paint.get("circle-translate"),s.paint.get("circle-translate-anchor")),u_pitch_with_map:+u,u_device_pixel_ratio:l.browser.devicePixelRatio,u_extrude_scale:d}},Io=function(r,o,n){var s=Qi(n,1,o.zoom),u=Math.pow(2,o.zoom-n.tileID.overscaledZ),d=n.tileID.overscaleFactor();return{u_matrix:r,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:s,u_extrude_scale:[o.pixelsToGLUnits[0]/(s*u),o.pixelsToGLUnits[1]/(s*u)],u_overscale_factor:d}},Ql=function(r,o,n){return{u_matrix:r,u_inv_matrix:o,u_camera_to_center_distance:n.cameraToCenterDistance,u_viewport_size:[n.width,n.height]}},Lo=function(r,o,n){return n===void 0&&(n=1),{u_matrix:r,u_color:o,u_overlay:0,u_overlay_scale:n}},zo=function(r){return{u_matrix:r}},th=function(r,o,n,s){return{u_matrix:r,u_extrude_scale:Qi(o,1,n),u_intensity:s}},va=function(r,o,n){var s=r.transform;return{u_matrix:eh(r,o,n),u_ratio:1/Qi(o,1,s.zoom),u_device_pixel_ratio:l.browser.devicePixelRatio,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},Yi=function(r,o,n,s){return l.extend(va(r,o,n),{u_image:0,u_image_height:s})},Ha=function(r,o,n,s){var u=r.transform,d=Ko(o,u);return{u_matrix:eh(r,o,n),u_texsize:o.imageAtlasTexture.size,u_ratio:1/Qi(o,1,u.zoom),u_device_pixel_ratio:l.browser.devicePixelRatio,u_image:0,u_scale:[d,s.fromScale,s.toScale],u_fade:s.t,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},rc=function(r,o,n,s,u){var d=r.lineAtlas,f=Ko(o,r.transform),x=n.layout.get("line-cap")==="round",L=d.getDash(s.from,x),H=d.getDash(s.to,x),gt=L.width*u.fromScale,vt=H.width*u.toScale;return l.extend(va(r,o,n),{u_patternscale_a:[f/gt,-L.height/2],u_patternscale_b:[f/vt,-H.height/2],u_sdfgamma:d.width/(256*Math.min(gt,vt)*l.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:L.y,u_tex_y_b:H.y,u_mix:u.t})};function Ko(r,o){return 1/Qi(r,1,o.tileZoom)}function eh(r,o,n){return r.translatePosMatrix(o.tileID.posMatrix,o,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var nc=function(r,o,n,s,u){return{u_matrix:r,u_tl_parent:o,u_scale_parent:n,u_buffer_scale:1,u_fade_t:s.mix,u_opacity:s.opacity*u.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:u.paint.get("raster-brightness-min"),u_brightness_high:u.paint.get("raster-brightness-max"),u_saturation_factor:(f=u.paint.get("raster-saturation"),f>0?1-1/(1.001-f):-f),u_contrast_factor:(d=u.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:ih(u.paint.get("raster-hue-rotate"))};var d,f};function ih(r){r*=Math.PI/180;var o=Math.sin(r),n=Math.cos(r);return[(2*n+1)/3,(-Math.sqrt(3)*o-n+1)/3,(Math.sqrt(3)*o-n+1)/3]}var Za,Jo=function(r,o,n,s,u,d,f,x,L,H){var gt=u.transform;return{u_is_size_zoom_constant:+(r==="constant"||r==="source"),u_is_size_feature_constant:+(r==="constant"||r==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:gt.cameraToCenterDistance,u_pitch:gt.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:gt.width/gt.height,u_fade_change:u.options.fadeDuration?u.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:f,u_coord_matrix:x,u_is_text:+L,u_pitch_with_map:+s,u_texsize:H,u_texture:0}},_a=function(r,o,n,s,u,d,f,x,L,H,gt){var vt=u.transform;return l.extend(Jo(r,o,n,s,u,d,f,x,L,H),{u_gamma_scale:s?Math.cos(vt._pitch)*vt.cameraToCenterDistance:1,u_device_pixel_ratio:l.browser.devicePixelRatio,u_is_halo:+gt})},Ya=function(r,o,n,s,u,d,f,x,L,H){return l.extend(_a(r,o,n,s,u,d,f,x,!0,L,!0),{u_texsize_icon:H,u_texture_icon:1})},xa=function(r,o,n){return{u_matrix:r,u_opacity:o,u_color:n}},$o=function(r,o,n,s,u,d){return l.extend(function(f,x,L,H){var gt=L.imageManager.getPattern(f.from.toString()),vt=L.imageManager.getPattern(f.to.toString()),bt=L.imageManager.getPixelSize(),Ft=bt.width,Bt=bt.height,Xt=Math.pow(2,H.tileID.overscaledZ),Pt=H.tileSize*Math.pow(2,L.transform.tileZoom)/Xt,qt=Pt*(H.tileID.canonical.x+H.tileID.wrap*Xt),Qt=Pt*H.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:gt.tl,u_pattern_br_a:gt.br,u_pattern_tl_b:vt.tl,u_pattern_br_b:vt.br,u_texsize:[Ft,Bt],u_mix:x.t,u_pattern_size_a:gt.displaySize,u_pattern_size_b:vt.displaySize,u_scale_a:x.fromScale,u_scale_b:x.toScale,u_tile_units_to_pixels:1/Qi(H,1,L.transform.tileZoom),u_pixel_coord_upper:[qt>>16,Qt>>16],u_pixel_coord_lower:[65535&qt,65535&Qt]}}(s,d,n,u),{u_matrix:r,u_opacity:o})},rh={fillExtrusion:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_lightpos:new l.Uniform3f(r,o.u_lightpos),u_lightintensity:new l.Uniform1f(r,o.u_lightintensity),u_lightcolor:new l.Uniform3f(r,o.u_lightcolor),u_vertical_gradient:new l.Uniform1f(r,o.u_vertical_gradient),u_opacity:new l.Uniform1f(r,o.u_opacity)}},fillExtrusionPattern:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_lightpos:new l.Uniform3f(r,o.u_lightpos),u_lightintensity:new l.Uniform1f(r,o.u_lightintensity),u_lightcolor:new l.Uniform3f(r,o.u_lightcolor),u_vertical_gradient:new l.Uniform1f(r,o.u_vertical_gradient),u_height_factor:new l.Uniform1f(r,o.u_height_factor),u_image:new l.Uniform1i(r,o.u_image),u_texsize:new l.Uniform2f(r,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(r,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(r,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(r,o.u_scale),u_fade:new l.Uniform1f(r,o.u_fade),u_opacity:new l.Uniform1f(r,o.u_opacity)}},fill:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix)}},fillPattern:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_image:new l.Uniform1i(r,o.u_image),u_texsize:new l.Uniform2f(r,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(r,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(r,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(r,o.u_scale),u_fade:new l.Uniform1f(r,o.u_fade)}},fillOutline:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_world:new l.Uniform2f(r,o.u_world)}},fillOutlinePattern:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_world:new l.Uniform2f(r,o.u_world),u_image:new l.Uniform1i(r,o.u_image),u_texsize:new l.Uniform2f(r,o.u_texsize),u_pixel_coord_upper:new l.Uniform2f(r,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(r,o.u_pixel_coord_lower),u_scale:new l.Uniform3f(r,o.u_scale),u_fade:new l.Uniform1f(r,o.u_fade)}},circle:function(r,o){return{u_camera_to_center_distance:new l.Uniform1f(r,o.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(r,o.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(r,o.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(r,o.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(r,o.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(r,o.u_matrix)}},collisionBox:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_camera_to_center_distance:new l.Uniform1f(r,o.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(r,o.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(r,o.u_extrude_scale),u_overscale_factor:new l.Uniform1f(r,o.u_overscale_factor)}},collisionCircle:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_inv_matrix:new l.UniformMatrix4f(r,o.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(r,o.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(r,o.u_viewport_size)}},debug:function(r,o){return{u_color:new l.UniformColor(r,o.u_color),u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_overlay:new l.Uniform1i(r,o.u_overlay),u_overlay_scale:new l.Uniform1f(r,o.u_overlay_scale)}},clippingMask:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix)}},heatmap:function(r,o){return{u_extrude_scale:new l.Uniform1f(r,o.u_extrude_scale),u_intensity:new l.Uniform1f(r,o.u_intensity),u_matrix:new l.UniformMatrix4f(r,o.u_matrix)}},heatmapTexture:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_world:new l.Uniform2f(r,o.u_world),u_image:new l.Uniform1i(r,o.u_image),u_color_ramp:new l.Uniform1i(r,o.u_color_ramp),u_opacity:new l.Uniform1f(r,o.u_opacity)}},hillshade:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_image:new l.Uniform1i(r,o.u_image),u_latrange:new l.Uniform2f(r,o.u_latrange),u_light:new l.Uniform2f(r,o.u_light),u_shadow:new l.UniformColor(r,o.u_shadow),u_highlight:new l.UniformColor(r,o.u_highlight),u_accent:new l.UniformColor(r,o.u_accent)}},hillshadePrepare:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_image:new l.Uniform1i(r,o.u_image),u_dimension:new l.Uniform2f(r,o.u_dimension),u_zoom:new l.Uniform1f(r,o.u_zoom),u_unpack:new l.Uniform4f(r,o.u_unpack)}},line:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_ratio:new l.Uniform1f(r,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(r,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(r,o.u_units_to_pixels)}},lineGradient:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_ratio:new l.Uniform1f(r,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(r,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(r,o.u_units_to_pixels),u_image:new l.Uniform1i(r,o.u_image),u_image_height:new l.Uniform1f(r,o.u_image_height)}},linePattern:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_texsize:new l.Uniform2f(r,o.u_texsize),u_ratio:new l.Uniform1f(r,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(r,o.u_device_pixel_ratio),u_image:new l.Uniform1i(r,o.u_image),u_units_to_pixels:new l.Uniform2f(r,o.u_units_to_pixels),u_scale:new l.Uniform3f(r,o.u_scale),u_fade:new l.Uniform1f(r,o.u_fade)}},lineSDF:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_ratio:new l.Uniform1f(r,o.u_ratio),u_device_pixel_ratio:new l.Uniform1f(r,o.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(r,o.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(r,o.u_patternscale_a),u_patternscale_b:new l.Uniform2f(r,o.u_patternscale_b),u_sdfgamma:new l.Uniform1f(r,o.u_sdfgamma),u_image:new l.Uniform1i(r,o.u_image),u_tex_y_a:new l.Uniform1f(r,o.u_tex_y_a),u_tex_y_b:new l.Uniform1f(r,o.u_tex_y_b),u_mix:new l.Uniform1f(r,o.u_mix)}},raster:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_tl_parent:new l.Uniform2f(r,o.u_tl_parent),u_scale_parent:new l.Uniform1f(r,o.u_scale_parent),u_buffer_scale:new l.Uniform1f(r,o.u_buffer_scale),u_fade_t:new l.Uniform1f(r,o.u_fade_t),u_opacity:new l.Uniform1f(r,o.u_opacity),u_image0:new l.Uniform1i(r,o.u_image0),u_image1:new l.Uniform1i(r,o.u_image1),u_brightness_low:new l.Uniform1f(r,o.u_brightness_low),u_brightness_high:new l.Uniform1f(r,o.u_brightness_high),u_saturation_factor:new l.Uniform1f(r,o.u_saturation_factor),u_contrast_factor:new l.Uniform1f(r,o.u_contrast_factor),u_spin_weights:new l.Uniform3f(r,o.u_spin_weights)}},symbolIcon:function(r,o){return{u_is_size_zoom_constant:new l.Uniform1i(r,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(r,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(r,o.u_size_t),u_size:new l.Uniform1f(r,o.u_size),u_camera_to_center_distance:new l.Uniform1f(r,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(r,o.u_pitch),u_rotate_symbol:new l.Uniform1i(r,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(r,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(r,o.u_fade_change),u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(r,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(r,o.u_coord_matrix),u_is_text:new l.Uniform1i(r,o.u_is_text),u_pitch_with_map:new l.Uniform1i(r,o.u_pitch_with_map),u_texsize:new l.Uniform2f(r,o.u_texsize),u_texture:new l.Uniform1i(r,o.u_texture)}},symbolSDF:function(r,o){return{u_is_size_zoom_constant:new l.Uniform1i(r,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(r,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(r,o.u_size_t),u_size:new l.Uniform1f(r,o.u_size),u_camera_to_center_distance:new l.Uniform1f(r,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(r,o.u_pitch),u_rotate_symbol:new l.Uniform1i(r,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(r,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(r,o.u_fade_change),u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(r,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(r,o.u_coord_matrix),u_is_text:new l.Uniform1i(r,o.u_is_text),u_pitch_with_map:new l.Uniform1i(r,o.u_pitch_with_map),u_texsize:new l.Uniform2f(r,o.u_texsize),u_texture:new l.Uniform1i(r,o.u_texture),u_gamma_scale:new l.Uniform1f(r,o.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(r,o.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(r,o.u_is_halo)}},symbolTextAndIcon:function(r,o){return{u_is_size_zoom_constant:new l.Uniform1i(r,o.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(r,o.u_is_size_feature_constant),u_size_t:new l.Uniform1f(r,o.u_size_t),u_size:new l.Uniform1f(r,o.u_size),u_camera_to_center_distance:new l.Uniform1f(r,o.u_camera_to_center_distance),u_pitch:new l.Uniform1f(r,o.u_pitch),u_rotate_symbol:new l.Uniform1i(r,o.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(r,o.u_aspect_ratio),u_fade_change:new l.Uniform1f(r,o.u_fade_change),u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(r,o.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(r,o.u_coord_matrix),u_is_text:new l.Uniform1i(r,o.u_is_text),u_pitch_with_map:new l.Uniform1i(r,o.u_pitch_with_map),u_texsize:new l.Uniform2f(r,o.u_texsize),u_texsize_icon:new l.Uniform2f(r,o.u_texsize_icon),u_texture:new l.Uniform1i(r,o.u_texture),u_texture_icon:new l.Uniform1i(r,o.u_texture_icon),u_gamma_scale:new l.Uniform1f(r,o.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(r,o.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(r,o.u_is_halo)}},background:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_opacity:new l.Uniform1f(r,o.u_opacity),u_color:new l.UniformColor(r,o.u_color)}},backgroundPattern:function(r,o){return{u_matrix:new l.UniformMatrix4f(r,o.u_matrix),u_opacity:new l.Uniform1f(r,o.u_opacity),u_image:new l.Uniform1i(r,o.u_image),u_pattern_tl_a:new l.Uniform2f(r,o.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(r,o.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(r,o.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(r,o.u_pattern_br_b),u_texsize:new l.Uniform2f(r,o.u_texsize),u_mix:new l.Uniform1f(r,o.u_mix),u_pattern_size_a:new l.Uniform2f(r,o.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(r,o.u_pattern_size_b),u_scale_a:new l.Uniform1f(r,o.u_scale_a),u_scale_b:new l.Uniform1f(r,o.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(r,o.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(r,o.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(r,o.u_tile_units_to_pixels)}}};function Qo(r,o,n,s,u,d,f){for(var x=r.context,L=x.gl,H=r.useProgram("collisionBox"),gt=[],vt=0,bt=0,Ft=0;Ft<s.length;Ft++){var Bt=s[Ft],Xt=o.getTile(Bt),Pt=Xt.getBucket(n);if(Pt){var qt=Bt.posMatrix;u[0]===0&&u[1]===0||(qt=r.translatePosMatrix(Bt.posMatrix,Xt,u,d));var Qt=f?Pt.textCollisionBox:Pt.iconCollisionBox,ne=Pt.collisionCircleArray;if(ne.length>0){var pe=l.create(),ce=qt;l.mul(pe,Pt.placementInvProjMatrix,r.transform.glCoordMatrix),l.mul(pe,pe,Pt.placementViewportMatrix),gt.push({circleArray:ne,circleOffset:bt,transform:ce,invTransform:pe}),bt=vt+=ne.length/4}Qt&&H.draw(x,L.LINES,St.disabled,zt.disabled,r.colorModeForRenderPass(),$t.disabled,Io(qt,r.transform,Xt),n.id,Qt.layoutVertexBuffer,Qt.indexBuffer,Qt.segments,null,r.transform.zoom,null,null,Qt.collisionVertexBuffer)}}if(f&&gt.length){var de=r.useProgram("collisionCircle"),xe=new l.StructArrayLayout2f1f2i16;xe.resize(4*vt),xe._trim();for(var Ae=0,Ce=0,je=gt;Ce<je.length;Ce+=1)for(var Ke=je[Ce],ei=0;ei<Ke.circleArray.length/4;ei++){var ti=4*ei,Mi=Ke.circleArray[ti+0],Ue=Ke.circleArray[ti+1],hi=Ke.circleArray[ti+2],gi=Ke.circleArray[ti+3];xe.emplace(Ae++,Mi,Ue,hi,gi,0),xe.emplace(Ae++,Mi,Ue,hi,gi,1),xe.emplace(Ae++,Mi,Ue,hi,gi,2),xe.emplace(Ae++,Mi,Ue,hi,gi,3)}(!Za||Za.length<2*vt)&&(Za=function(sr){var jr=2*sr,Ir=new l.StructArrayLayout3ui6;Ir.resize(jr),Ir._trim();for(var or=0;or<jr;or++){var dr=6*or;Ir.uint16[dr+0]=4*or+0,Ir.uint16[dr+1]=4*or+1,Ir.uint16[dr+2]=4*or+2,Ir.uint16[dr+3]=4*or+2,Ir.uint16[dr+4]=4*or+3,Ir.uint16[dr+5]=4*or+0}return Ir}(vt));for(var si=x.createIndexBuffer(Za,!0),ai=x.createVertexBuffer(xe,l.collisionCircleLayout.members,!0),mi=0,oi=gt;mi<oi.length;mi+=1){var ri=oi[mi],Tr=Ql(ri.transform,ri.invTransform,r.transform);de.draw(x,L.TRIANGLES,St.disabled,zt.disabled,r.colorModeForRenderPass(),$t.disabled,Tr,n.id,ai,si,l.SegmentVector.simpleSegment(0,2*ri.circleOffset,ri.circleArray.length,ri.circleArray.length/2),null,r.transform.zoom,null,null,null)}ai.destroy(),si.destroy()}}var Mn=l.identity(new Float32Array(16));function nh(r,o,n,s,u,d){var f=l.getAnchorAlignment(r),x=-(f.horizontalAlign-.5)*o,L=-(f.verticalAlign-.5)*n,H=l.evaluateVariableOffset(r,s);return new l.Point((x/u+H[0])*d,(L/u+H[1])*d)}function oh(r,o,n,s,u,d,f,x,L,H,gt){var vt=r.text.placedSymbolArray,bt=r.text.dynamicLayoutVertexArray,Ft=r.icon.dynamicLayoutVertexArray,Bt={};bt.clear();for(var Xt=0;Xt<vt.length;Xt++){var Pt=vt.get(Xt),qt=Pt.hidden||!Pt.crossTileID||r.allowVerticalPlacement&&!Pt.placedOrientation?null:s[Pt.crossTileID];if(qt){var Qt=new l.Point(Pt.anchorX,Pt.anchorY),ne=Ti(Qt,n?x:f),pe=Bi(d.cameraToCenterDistance,ne.signedDistanceFromCamera),ce=u.evaluateSizeForFeature(r.textSizeData,H,Pt)*pe/l.ONE_EM;n&&(ce*=r.tilePixelRatio/L);for(var de=nh(qt.anchor,qt.width,qt.height,qt.textOffset,qt.textBoxScale,ce),xe=n?Ti(Qt.add(de),f).point:ne.point.add(o?de.rotate(-d.angle):de),Ae=r.allowVerticalPlacement&&Pt.placedOrientation===l.WritingMode.vertical?Math.PI/2:0,Ce=0;Ce<Pt.numGlyphs;Ce++)l.addDynamicAttributes(bt,xe,Ae);gt&&Pt.associatedIconIndex>=0&&(Bt[Pt.associatedIconIndex]={shiftedAnchor:xe,angle:Ae})}else Gr(Pt.numGlyphs,bt)}if(gt){Ft.clear();for(var je=r.icon.placedSymbolArray,Ke=0;Ke<je.length;Ke++){var ei=je.get(Ke);if(ei.hidden)Gr(ei.numGlyphs,Ft);else{var ti=Bt[Ke];if(ti)for(var Mi=0;Mi<ei.numGlyphs;Mi++)l.addDynamicAttributes(Ft,ti.shiftedAnchor,ti.angle);else Gr(ei.numGlyphs,Ft)}}r.icon.dynamicLayoutVertexBuffer.updateData(Ft)}r.text.dynamicLayoutVertexBuffer.updateData(bt)}function ah(r,o,n){return n.iconsInText&&o?"symbolTextAndIcon":r?"symbolSDF":"symbolIcon"}function Do(r,o,n,s,u,d,f,x,L,H,gt,vt){for(var bt=r.context,Ft=bt.gl,Bt=r.transform,Xt=x==="map",Pt=L==="map",qt=Xt&&n.layout.get("symbol-placement")!=="point",Qt=Xt&&!Pt&&!qt,ne=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,pe=!1,ce=r.depthModeForSublayer(0,St.ReadOnly),de=n.layout.get("text-variable-anchor"),xe=[],Ae=0,Ce=s;Ae<Ce.length;Ae+=1){var je=Ce[Ae],Ke=o.getTile(je),ei=Ke.getBucket(n);if(ei){var ti=u?ei.text:ei.icon;if(ti&&ti.segments.get().length){var Mi=ti.programConfigurations.get(n.id),Ue=u||ei.sdfIcons,hi=u?ei.textSizeData:ei.iconSizeData,gi=Pt||Bt.pitch!==0,si=r.useProgram(ah(Ue,u,ei),Mi),ai=l.evaluateSizeForZoom(hi,Bt.zoom),mi=void 0,oi=[0,0],ri=void 0,Tr=void 0,sr=null,jr=void 0;if(u)ri=Ke.glyphAtlasTexture,Tr=Ft.LINEAR,mi=Ke.glyphAtlasTexture.size,ei.iconsInText&&(oi=Ke.imageAtlasTexture.size,sr=Ke.imageAtlasTexture,jr=gi||r.options.rotating||r.options.zooming||hi.kind==="composite"||hi.kind==="camera"?Ft.LINEAR:Ft.NEAREST);else{var Ir=n.layout.get("icon-size").constantOr(0)!==1||ei.iconsNeedLinear;ri=Ke.imageAtlasTexture,Tr=Ue||r.options.rotating||r.options.zooming||Ir||gi?Ft.LINEAR:Ft.NEAREST,mi=Ke.imageAtlasTexture.size}var or=Qi(Ke,1,r.transform.zoom),dr=ur(je.posMatrix,Pt,Xt,r.transform,or),un=Vi(je.posMatrix,Pt,Xt,r.transform,or),Hr=de&&ei.hasTextData(),uo=n.layout.get("icon-text-fit")!=="none"&&Hr&&ei.hasIconData();qt&&pa(ei,je.posMatrix,r,u,dr,un,Pt,H);var tn=r.translatePosMatrix(je.posMatrix,Ke,d,f),Dn=qt||u&&de||uo?Mn:dr,Tn=r.translatePosMatrix(un,Ke,d,f,!0),La=Ue&&n.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0,oa={program:si,buffers:ti,uniformValues:Ue?ei.iconsInText?Ya(hi.kind,ai,Qt,Pt,r,tn,Dn,Tn,mi,oi):_a(hi.kind,ai,Qt,Pt,r,tn,Dn,Tn,u,mi,!0):Jo(hi.kind,ai,Qt,Pt,r,tn,Dn,Tn,u,mi),atlasTexture:ri,atlasTextureIcon:sr,atlasInterpolation:Tr,atlasInterpolationIcon:jr,isSDF:Ue,hasHalo:La};if(ne&&ei.canOverlap){pe=!0;for(var po=0,aa=ti.segments.get();po<aa.length;po+=1){var za=aa[po];xe.push({segments:new l.SegmentVector([za]),sortKey:za.sortKey,state:oa})}}else xe.push({segments:ti.segments,sortKey:0,state:oa})}}}pe&&xe.sort(function(fo,Uo){return fo.sortKey-Uo.sortKey});for(var jn=0,Da=xe;jn<Da.length;jn+=1){var Un=Da[jn],kr=Un.state;if(bt.activeTexture.set(Ft.TEXTURE0),kr.atlasTexture.bind(kr.atlasInterpolation,Ft.CLAMP_TO_EDGE),kr.atlasTextureIcon&&(bt.activeTexture.set(Ft.TEXTURE1),kr.atlasTextureIcon&&kr.atlasTextureIcon.bind(kr.atlasInterpolationIcon,Ft.CLAMP_TO_EDGE)),kr.isSDF){var Wn=kr.uniformValues;kr.hasHalo&&(Wn.u_is_halo=1,ba(kr.buffers,Un.segments,n,r,kr.program,ce,gt,vt,Wn)),Wn.u_is_halo=0}ba(kr.buffers,Un.segments,n,r,kr.program,ce,gt,vt,kr.uniformValues)}}function ba(r,o,n,s,u,d,f,x,L){var H=s.context;u.draw(H,H.gl.TRIANGLES,d,f,x,$t.disabled,L,n.id,r.layoutVertexBuffer,r.indexBuffer,o,n.paint,s.transform.zoom,r.programConfigurations.get(n.id),r.dynamicLayoutVertexBuffer,r.opacityVertexBuffer)}function Ka(r,o,n,s,u,d,f){var x,L,H,gt,vt,bt=r.context.gl,Ft=n.paint.get("fill-pattern"),Bt=Ft&&Ft.constantOr(1),Xt=n.getCrossfadeParameters();f?(L=Bt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",x=bt.LINES):(L=Bt?"fillPattern":"fill",x=bt.TRIANGLES);for(var Pt=0,qt=s;Pt<qt.length;Pt+=1){var Qt=qt[Pt],ne=o.getTile(Qt);if(!Bt||ne.patternsLoaded()){var pe=ne.getBucket(n);if(pe){var ce=pe.programConfigurations.get(n.id),de=r.useProgram(L,ce);Bt&&(r.context.activeTexture.set(bt.TEXTURE0),ne.imageAtlasTexture.bind(bt.LINEAR,bt.CLAMP_TO_EDGE),ce.updatePaintBuffers(Xt));var xe=Ft.constantOr(null);if(xe&&ne.imageAtlas){var Ae=ne.imageAtlas,Ce=Ae.patternPositions[xe.to.toString()],je=Ae.patternPositions[xe.from.toString()];Ce&&je&&ce.setConstantPatternPositions(Ce,je)}var Ke=r.translatePosMatrix(Qt.posMatrix,ne,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(f){gt=pe.indexBuffer2,vt=pe.segments2;var ei=[bt.drawingBufferWidth,bt.drawingBufferHeight];H=L==="fillOutlinePattern"&&Bt?$l(Ke,r,Xt,ne,ei):Jl(Ke,ei)}else gt=pe.indexBuffer,vt=pe.segments,H=Bt?Po(Ke,r,Xt,ne):oo(Ke);de.draw(r.context,x,u,r.stencilModeForClipping(Qt),d,$t.disabled,H,n.id,pe.layoutVertexBuffer,gt,vt,n.paint,r.transform.zoom,ce)}}}}function Zs(r,o,n,s,u,d,f){for(var x=r.context,L=x.gl,H=n.paint.get("fill-extrusion-pattern"),gt=H.constantOr(1),vt=n.getCrossfadeParameters(),bt=n.paint.get("fill-extrusion-opacity"),Ft=0,Bt=s;Ft<Bt.length;Ft+=1){var Xt=Bt[Ft],Pt=o.getTile(Xt),qt=Pt.getBucket(n);if(qt){var Qt=qt.programConfigurations.get(n.id),ne=r.useProgram(gt?"fillExtrusionPattern":"fillExtrusion",Qt);gt&&(r.context.activeTexture.set(L.TEXTURE0),Pt.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),Qt.updatePaintBuffers(vt));var pe=H.constantOr(null);if(pe&&Pt.imageAtlas){var ce=Pt.imageAtlas,de=ce.patternPositions[pe.to.toString()],xe=ce.patternPositions[pe.from.toString()];de&&xe&&Qt.setConstantPatternPositions(de,xe)}var Ae=r.translatePosMatrix(Xt.posMatrix,Pt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Ce=n.paint.get("fill-extrusion-vertical-gradient"),je=gt?Mo(Ae,r,Ce,bt,Xt,vt,Pt):Kl(Ae,r,Ce,bt);ne.draw(x,x.gl.TRIANGLES,u,d,f,$t.backCCW,je,n.id,qt.layoutVertexBuffer,qt.indexBuffer,qt.segments,n.paint,r.transform.zoom,Qt)}}}function Ja(r,o,n,s,u,d){var f=r.context,x=f.gl,L=o.fbo;if(L){var H=r.useProgram("hillshade");f.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,L.colorAttachment.get());var gt=function(vt,bt,Ft){var Bt=Ft.paint.get("hillshade-shadow-color"),Xt=Ft.paint.get("hillshade-highlight-color"),Pt=Ft.paint.get("hillshade-accent-color"),qt=Ft.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ft.paint.get("hillshade-illumination-anchor")==="viewport"&&(qt-=vt.transform.angle);var Qt,ne,pe,ce=!vt.options.moving;return{u_matrix:vt.transform.calculatePosMatrix(bt.tileID.toUnwrapped(),ce),u_image:0,u_latrange:(Qt=bt.tileID,ne=Math.pow(2,Qt.canonical.z),pe=Qt.canonical.y,[new l.MercatorCoordinate(0,pe/ne).toLngLat().lat,new l.MercatorCoordinate(0,(pe+1)/ne).toLngLat().lat]),u_light:[Ft.paint.get("hillshade-exaggeration"),qt],u_shadow:Bt,u_highlight:Xt,u_accent:Pt}}(r,o,n);H.draw(f,x.TRIANGLES,s,u,d,$t.disabled,gt,n.id,r.rasterBoundsBuffer,r.quadTriangleIndexBuffer,r.rasterBoundsSegments)}}function oc(r,o,n,s,u,d){var f=r.context,x=f.gl,L=o.dem;if(L&&L.data){var H=L.dim,gt=L.stride,vt=L.getPixels();if(f.activeTexture.set(x.TEXTURE1),f.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||r.getTileTexture(gt),o.demTexture){var bt=o.demTexture;bt.update(vt,{premultiply:!1}),bt.bind(x.NEAREST,x.CLAMP_TO_EDGE)}else o.demTexture=new l.Texture(f,vt,x.RGBA,{premultiply:!1}),o.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);f.activeTexture.set(x.TEXTURE0);var Ft=o.fbo;if(!Ft){var Bt=new l.Texture(f,{width:H,height:H,data:null},x.RGBA);Bt.bind(x.LINEAR,x.CLAMP_TO_EDGE),(Ft=o.fbo=f.createFramebuffer(H,H,!0)).colorAttachment.set(Bt.texture)}f.bindFramebuffer.set(Ft.framebuffer),f.viewport.set([0,0,H,H]),r.useProgram("hillshadePrepare").draw(f,x.TRIANGLES,s,u,d,$t.disabled,function(Xt,Pt){var qt=Pt.stride,Qt=l.create();return l.ortho(Qt,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(Qt,Qt,[0,-l.EXTENT,0]),{u_matrix:Qt,u_image:1,u_dimension:[qt,qt],u_zoom:Xt.overscaledZ,u_unpack:Pt.getUnpackVector()}}(o.tileID,L),n.id,r.rasterBoundsBuffer,r.quadTriangleIndexBuffer,r.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function $a(r,o,n,s,u){var d=s.paint.get("raster-fade-duration");if(d>0){var f=l.browser.now(),x=(f-r.timeAdded)/d,L=o?(f-o.timeAdded)/d:-1,H=n.getSource(),gt=u.coveringZoomLevel({tileSize:H.tileSize,roundZoom:H.roundZoom}),vt=!o||Math.abs(o.tileID.overscaledZ-gt)>Math.abs(r.tileID.overscaledZ-gt),bt=vt&&r.refreshedUponExpiration?1:l.clamp(vt?x:1-L,0,1);return r.refreshedUponExpiration&&x>=1&&(r.refreshedUponExpiration=!1),o?{opacity:1,mix:1-bt}:{opacity:bt,mix:0}}return{opacity:1,mix:0}}var Ys=new l.Color(1,0,0,1),sh=new l.Color(0,1,0,1),lh=new l.Color(0,0,1,1),Qa=new l.Color(1,0,1,1),Ks=new l.Color(0,1,1,1);function Js(r,o,n,s){wa(r,0,o+n/2,r.transform.width,n,s)}function $s(r,o,n,s){wa(r,o-n/2,0,n,r.transform.height,s)}function wa(r,o,n,s,u,d){var f=r.context,x=f.gl;x.enable(x.SCISSOR_TEST),x.scissor(o*l.browser.devicePixelRatio,n*l.browser.devicePixelRatio,s*l.browser.devicePixelRatio,u*l.browser.devicePixelRatio),f.clear({color:d}),x.disable(x.SCISSOR_TEST)}function hh(r,o,n){var s=r.context,u=s.gl,d=n.posMatrix,f=r.useProgram("debug"),x=St.disabled,L=zt.disabled,H=r.colorModeForRenderPass();s.activeTexture.set(u.TEXTURE0),r.emptyTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),f.draw(s,u.LINE_STRIP,x,L,H,$t.disabled,Lo(d,l.Color.red),"$debug",r.debugBuffer,r.tileBorderIndexBuffer,r.debugSegments);var gt=o.getTileByID(n.key).latestRawTileData,vt=Math.floor((gt&&gt.byteLength||0)/1024),bt=o.getTile(n).tileSize,Ft=512/Math.min(bt,512)*(n.overscaledZ/r.transform.zoom)*.5,Bt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Bt+=" => "+n.overscaledZ),function(Xt,Pt){Xt.initDebugOverlayCanvas();var qt=Xt.debugOverlayCanvas,Qt=Xt.context.gl,ne=Xt.debugOverlayCanvas.getContext("2d");ne.clearRect(0,0,qt.width,qt.height),ne.shadowColor="white",ne.shadowBlur=2,ne.lineWidth=1.5,ne.strokeStyle="white",ne.textBaseline="top",ne.font="bold 36px Open Sans, sans-serif",ne.fillText(Pt,5,5),ne.strokeText(Pt,5,5),Xt.debugOverlayTexture.update(qt),Xt.debugOverlayTexture.bind(Qt.LINEAR,Qt.CLAMP_TO_EDGE)}(r,Bt+" "+vt+"kb"),f.draw(s,u.TRIANGLES,x,L,Yt.alphaBlended,$t.disabled,Lo(d,l.Color.transparent,Ft),"$debug",r.debugBuffer,r.quadTriangleIndexBuffer,r.debugSegments)}var Oo={symbol:function(r,o,n,s,u){if(r.renderPass==="translucent"){var d=zt.disabled,f=r.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(x,L,H,gt,vt,bt,Ft){for(var Bt=L.transform,Xt=vt==="map",Pt=bt==="map",qt=0,Qt=x;qt<Qt.length;qt+=1){var ne=Qt[qt],pe=gt.getTile(ne),ce=pe.getBucket(H);if(ce&&ce.text&&ce.text.segments.get().length){var de=l.evaluateSizeForZoom(ce.textSizeData,Bt.zoom),xe=Qi(pe,1,L.transform.zoom),Ae=ur(ne.posMatrix,Pt,Xt,L.transform,xe),Ce=H.layout.get("icon-text-fit")!=="none"&&ce.hasIconData();if(de){var je=Math.pow(2,Bt.zoom-pe.tileID.overscaledZ);oh(ce,Xt,Pt,Ft,l.symbolSize,Bt,Ae,ne.posMatrix,je,de,Ce)}}}}(s,r,n,o,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),u),n.paint.get("icon-opacity").constantOr(1)!==0&&Do(r,o,n,s,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),d,f),n.paint.get("text-opacity").constantOr(1)!==0&&Do(r,o,n,s,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),d,f),o.map.showCollisionBoxes&&(Qo(r,o,n,s,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),Qo(r,o,n,s,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))}},circle:function(r,o,n,s){if(r.renderPass==="translucent"){var u=n.paint.get("circle-opacity"),d=n.paint.get("circle-stroke-width"),f=n.paint.get("circle-stroke-opacity"),x=n.layout.get("circle-sort-key").constantOr(1)!==void 0;if(u.constantOr(1)!==0||d.constantOr(1)!==0&&f.constantOr(1)!==0){for(var L=r.context,H=L.gl,gt=r.depthModeForSublayer(0,St.ReadOnly),vt=zt.disabled,bt=r.colorModeForRenderPass(),Ft=[],Bt=0;Bt<s.length;Bt++){var Xt=s[Bt],Pt=o.getTile(Xt),qt=Pt.getBucket(n);if(qt){var Qt=qt.programConfigurations.get(n.id),ne={programConfiguration:Qt,program:r.useProgram("circle",Qt),layoutVertexBuffer:qt.layoutVertexBuffer,indexBuffer:qt.indexBuffer,uniformValues:Hs(r,Xt,Pt,n)};if(x)for(var pe=0,ce=qt.segments.get();pe<ce.length;pe+=1){var de=ce[pe];Ft.push({segments:new l.SegmentVector([de]),sortKey:de.sortKey,state:ne})}else Ft.push({segments:qt.segments,sortKey:0,state:ne})}}x&&Ft.sort(function(Ke,ei){return Ke.sortKey-ei.sortKey});for(var xe=0,Ae=Ft;xe<Ae.length;xe+=1){var Ce=Ae[xe],je=Ce.state;je.program.draw(L,H.TRIANGLES,gt,vt,bt,$t.disabled,je.uniformValues,n.id,je.layoutVertexBuffer,je.indexBuffer,Ce.segments,n.paint,r.transform.zoom,je.programConfiguration)}}}},heatmap:function(r,o,n,s){if(n.paint.get("heatmap-opacity")!==0)if(r.renderPass==="offscreen"){var u=r.context,d=u.gl,f=zt.disabled,x=new Yt([d.ONE,d.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(Ft,Bt,Xt){var Pt=Ft.gl;Ft.activeTexture.set(Pt.TEXTURE1),Ft.viewport.set([0,0,Bt.width/4,Bt.height/4]);var qt=Xt.heatmapFbo;if(qt)Pt.bindTexture(Pt.TEXTURE_2D,qt.colorAttachment.get()),Ft.bindFramebuffer.set(qt.framebuffer);else{var Qt=Pt.createTexture();Pt.bindTexture(Pt.TEXTURE_2D,Qt),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_WRAP_S,Pt.CLAMP_TO_EDGE),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_WRAP_T,Pt.CLAMP_TO_EDGE),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_MIN_FILTER,Pt.LINEAR),Pt.texParameteri(Pt.TEXTURE_2D,Pt.TEXTURE_MAG_FILTER,Pt.LINEAR),qt=Xt.heatmapFbo=Ft.createFramebuffer(Bt.width/4,Bt.height/4,!1),function(ne,pe,ce,de){var xe=ne.gl;xe.texImage2D(xe.TEXTURE_2D,0,xe.RGBA,pe.width/4,pe.height/4,0,xe.RGBA,ne.extRenderToTextureHalfFloat?ne.extTextureHalfFloat.HALF_FLOAT_OES:xe.UNSIGNED_BYTE,null),de.colorAttachment.set(ce)}(Ft,Bt,Qt,qt)}})(u,r,n),u.clear({color:l.Color.transparent});for(var L=0;L<s.length;L++){var H=s[L];if(!o.hasRenderableParent(H)){var gt=o.getTile(H),vt=gt.getBucket(n);if(vt){var bt=vt.programConfigurations.get(n.id);r.useProgram("heatmap",bt).draw(u,d.TRIANGLES,St.disabled,f,x,$t.disabled,th(H.posMatrix,gt,r.transform.zoom,n.paint.get("heatmap-intensity")),n.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,n.paint,r.transform.zoom,bt)}}}u.viewport.set([0,0,r.width,r.height])}else r.renderPass==="translucent"&&(r.context.setColorMode(r.colorModeForRenderPass()),function(Ft,Bt){var Xt=Ft.context,Pt=Xt.gl,qt=Bt.heatmapFbo;if(qt){Xt.activeTexture.set(Pt.TEXTURE0),Pt.bindTexture(Pt.TEXTURE_2D,qt.colorAttachment.get()),Xt.activeTexture.set(Pt.TEXTURE1);var Qt=Bt.colorRampTexture;Qt||(Qt=Bt.colorRampTexture=new l.Texture(Xt,Bt.colorRamp,Pt.RGBA)),Qt.bind(Pt.LINEAR,Pt.CLAMP_TO_EDGE),Ft.useProgram("heatmapTexture").draw(Xt,Pt.TRIANGLES,St.disabled,zt.disabled,Ft.colorModeForRenderPass(),$t.disabled,function(ne,pe,ce,de){var xe=l.create();l.ortho(xe,0,ne.width,ne.height,0,0,1);var Ae=ne.context.gl;return{u_matrix:xe,u_world:[Ae.drawingBufferWidth,Ae.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:pe.paint.get("heatmap-opacity")}}(Ft,Bt),Bt.id,Ft.viewportBuffer,Ft.quadTriangleIndexBuffer,Ft.viewportSegments,Bt.paint,Ft.transform.zoom)}}(r,n))},line:function(r,o,n,s){if(r.renderPass==="translucent"){var u=n.paint.get("line-opacity"),d=n.paint.get("line-width");if(u.constantOr(1)!==0&&d.constantOr(1)!==0)for(var f=r.depthModeForSublayer(0,St.ReadOnly),x=r.colorModeForRenderPass(),L=n.paint.get("line-dasharray"),H=n.paint.get("line-pattern"),gt=H.constantOr(1),vt=n.paint.get("line-gradient"),bt=n.getCrossfadeParameters(),Ft=gt?"linePattern":L?"lineSDF":vt?"lineGradient":"line",Bt=r.context,Xt=Bt.gl,Pt=!0,qt=0,Qt=s;qt<Qt.length;qt+=1){var ne=Qt[qt],pe=o.getTile(ne);if(!gt||pe.patternsLoaded()){var ce=pe.getBucket(n);if(ce){var de=ce.programConfigurations.get(n.id),xe=r.context.program.get(),Ae=r.useProgram(Ft,de),Ce=Pt||Ae.program!==xe,je=H.constantOr(null);if(je&&pe.imageAtlas){var Ke=pe.imageAtlas,ei=Ke.patternPositions[je.to.toString()],ti=Ke.patternPositions[je.from.toString()];ei&&ti&&de.setConstantPatternPositions(ei,ti)}var Mi=gt?Ha(r,pe,n,bt):L?rc(r,pe,n,L,bt):vt?Yi(r,pe,n,ce.lineClipsArray.length):va(r,pe,n);if(gt)Bt.activeTexture.set(Xt.TEXTURE0),pe.imageAtlasTexture.bind(Xt.LINEAR,Xt.CLAMP_TO_EDGE),de.updatePaintBuffers(bt);else if(L&&(Ce||r.lineAtlas.dirty))Bt.activeTexture.set(Xt.TEXTURE0),r.lineAtlas.bind(Bt);else if(vt){var Ue=ce.gradients[n.id],hi=Ue.texture;if(n.gradientVersion!==Ue.version){var gi=256;if(n.stepInterpolant){var si=o.getSource().maxzoom,ai=ne.canonical.z===si?Math.ceil(1<<r.transform.maxZoom-ne.canonical.z):1;gi=l.clamp(l.nextPowerOfTwo(ce.maxLineLength/l.EXTENT*1024*ai),256,Bt.maxTextureSize)}Ue.gradient=l.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:gi,image:Ue.gradient||void 0,clips:ce.lineClipsArray}),Ue.texture?Ue.texture.update(Ue.gradient):Ue.texture=new l.Texture(Bt,Ue.gradient,Xt.RGBA),Ue.version=n.gradientVersion,hi=Ue.texture}Bt.activeTexture.set(Xt.TEXTURE0),hi.bind(n.stepInterpolant?Xt.NEAREST:Xt.LINEAR,Xt.CLAMP_TO_EDGE)}Ae.draw(Bt,Xt.TRIANGLES,f,r.stencilModeForClipping(ne),x,$t.disabled,Mi,n.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,n.paint,r.transform.zoom,de,ce.layoutVertexBuffer2),Pt=!1}}}}},fill:function(r,o,n,s){var u=n.paint.get("fill-color"),d=n.paint.get("fill-opacity");if(d.constantOr(1)!==0){var f=r.colorModeForRenderPass(),x=n.paint.get("fill-pattern"),L=r.opaquePassEnabledForLayer()&&!x.constantOr(1)&&u.constantOr(l.Color.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(r.renderPass===L){var H=r.depthModeForSublayer(1,r.renderPass==="opaque"?St.ReadWrite:St.ReadOnly);Ka(r,o,n,s,H,f,!1)}if(r.renderPass==="translucent"&&n.paint.get("fill-antialias")){var gt=r.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,St.ReadOnly);Ka(r,o,n,s,gt,f,!0)}}},"fill-extrusion":function(r,o,n,s){var u=n.paint.get("fill-extrusion-opacity");if(u!==0&&r.renderPass==="translucent"){var d=new St(r.context.gl.LEQUAL,St.ReadWrite,r.depthRangeFor3D);if(u!==1||n.paint.get("fill-extrusion-pattern").constantOr(1))Zs(r,o,n,s,d,zt.disabled,Yt.disabled),Zs(r,o,n,s,d,r.stencilModeFor3D(),r.colorModeForRenderPass());else{var f=r.colorModeForRenderPass();Zs(r,o,n,s,d,zt.disabled,f)}}},hillshade:function(r,o,n,s){if(r.renderPass==="offscreen"||r.renderPass==="translucent"){for(var u=r.context,d=r.depthModeForSublayer(0,St.ReadOnly),f=r.colorModeForRenderPass(),x=r.renderPass==="translucent"?r.stencilConfigForOverlap(s):[{},s],L=x[0],H=0,gt=x[1];H<gt.length;H+=1){var vt=gt[H],bt=o.getTile(vt);bt.needsHillshadePrepare&&r.renderPass==="offscreen"?oc(r,bt,n,d,zt.disabled,f):r.renderPass==="translucent"&&Ja(r,bt,n,d,L[vt.overscaledZ],f)}u.viewport.set([0,0,r.width,r.height])}},raster:function(r,o,n,s){if(r.renderPass==="translucent"&&n.paint.get("raster-opacity")!==0&&s.length)for(var u=r.context,d=u.gl,f=o.getSource(),x=r.useProgram("raster"),L=r.colorModeForRenderPass(),H=f instanceof R?[{},s]:r.stencilConfigForOverlap(s),gt=H[0],vt=H[1],bt=vt[vt.length-1].overscaledZ,Ft=!r.options.moving,Bt=0,Xt=vt;Bt<Xt.length;Bt+=1){var Pt=Xt[Bt],qt=r.depthModeForSublayer(Pt.overscaledZ-bt,n.paint.get("raster-opacity")===1?St.ReadWrite:St.ReadOnly,d.LESS),Qt=o.getTile(Pt),ne=r.transform.calculatePosMatrix(Pt.toUnwrapped(),Ft);Qt.registerFadeDuration(n.paint.get("raster-fade-duration"));var pe=o.findLoadedParent(Pt,0),ce=$a(Qt,pe,o,n,r.transform),de=void 0,xe=void 0,Ae=n.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;u.activeTexture.set(d.TEXTURE0),Qt.texture.bind(Ae,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),u.activeTexture.set(d.TEXTURE1),pe?(pe.texture.bind(Ae,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),de=Math.pow(2,pe.tileID.overscaledZ-Qt.tileID.overscaledZ),xe=[Qt.tileID.canonical.x*de%1,Qt.tileID.canonical.y*de%1]):Qt.texture.bind(Ae,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);var Ce=nc(ne,xe||[0,0],de||1,ce,n);f instanceof R?x.draw(u,d.TRIANGLES,qt,zt.disabled,L,$t.disabled,Ce,n.id,f.boundsBuffer,r.quadTriangleIndexBuffer,f.boundsSegments):x.draw(u,d.TRIANGLES,qt,gt[Pt.overscaledZ],L,$t.disabled,Ce,n.id,r.rasterBoundsBuffer,r.quadTriangleIndexBuffer,r.rasterBoundsSegments)}},background:function(r,o,n){var s=n.paint.get("background-color"),u=n.paint.get("background-opacity");if(u!==0){var d=r.context,f=d.gl,x=r.transform,L=x.tileSize,H=n.paint.get("background-pattern");if(!r.isPatternMissing(H)){var gt=!H&&s.a===1&&u===1&&r.opaquePassEnabledForLayer()?"opaque":"translucent";if(r.renderPass===gt){var vt=zt.disabled,bt=r.depthModeForSublayer(0,gt==="opaque"?St.ReadWrite:St.ReadOnly),Ft=r.colorModeForRenderPass(),Bt=r.useProgram(H?"backgroundPattern":"background"),Xt=x.coveringTiles({tileSize:L});H&&(d.activeTexture.set(f.TEXTURE0),r.imageManager.bind(r.context));for(var Pt=n.getCrossfadeParameters(),qt=0,Qt=Xt;qt<Qt.length;qt+=1){var ne=Qt[qt],pe=r.transform.calculatePosMatrix(ne.toUnwrapped()),ce=H?$o(pe,u,r,H,{tileID:ne,tileSize:L},Pt):xa(pe,u,s);Bt.draw(d,f.TRIANGLES,bt,vt,Ft,$t.disabled,ce,n.id,r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments)}}}}},debug:function(r,o,n){for(var s=0;s<n.length;s++)hh(r,o,n[s])},custom:function(r,o,n){var s=r.context,u=n.implementation;if(r.renderPass==="offscreen"){var d=u.prerender;d&&(r.setCustomLayerDefaults(),s.setColorMode(r.colorModeForRenderPass()),d.call(u,s.gl,r.transform.customLayerMatrix()),s.setDirty(),r.setBaseState())}else if(r.renderPass==="translucent"){r.setCustomLayerDefaults(),s.setColorMode(r.colorModeForRenderPass()),s.setStencilMode(zt.disabled);var f=u.renderingMode==="3d"?new St(r.context.gl.LEQUAL,St.ReadWrite,r.depthRangeFor3D):r.depthModeForSublayer(0,St.ReadOnly);s.setDepthMode(f),u.render(s.gl,r.transform.customLayerMatrix()),s.setDirty(),r.setBaseState(),s.bindFramebuffer.set(null)}}},tr=function(r,o){this.context=new yt(r),this.transform=o,this._tileTextures={},this.setup(),this.numSublayers=Ut.maxUnderzooming+Ut.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new $n,this.gpuTimers={}};tr.prototype.resize=function(r,o){if(this.width=r*l.browser.devicePixelRatio,this.height=o*l.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,s=this.style._order;n<s.length;n+=1)this.style._layers[s[n]].resize()},tr.prototype.setup=function(){var r=this.context,o=new l.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(l.EXTENT,0),o.emplaceBack(0,l.EXTENT),o.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(o,yr.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);var n=new l.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(l.EXTENT,0),n.emplaceBack(0,l.EXTENT),n.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=r.createVertexBuffer(n,yr.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);var s=new l.StructArrayLayout4i8;s.emplaceBack(0,0,0,0),s.emplaceBack(l.EXTENT,0,l.EXTENT,0),s.emplaceBack(0,l.EXTENT,0,l.EXTENT),s.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=r.createVertexBuffer(s,w.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);var u=new l.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(1,0),u.emplaceBack(0,1),u.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(u,yr.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);var d=new l.StructArrayLayout1ui2;d.emplaceBack(0),d.emplaceBack(1),d.emplaceBack(3),d.emplaceBack(2),d.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(d);var f=new l.StructArrayLayout3ui6;f.emplaceBack(0,1,2),f.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(f),this.emptyTexture=new l.Texture(r,{width:1,height:1,data:new Uint8Array([0,0,0,0])},r.gl.RGBA);var x=this.context.gl;this.stencilClearMode=new zt({func:x.ALWAYS,mask:0},0,255,x.ZERO,x.ZERO,x.ZERO)},tr.prototype.clearStencil=function(){var r=this.context,o=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=l.create();l.ortho(n,0,this.width,this.height,0,0,1),l.scale(n,n,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,o.TRIANGLES,St.disabled,this.stencilClearMode,Yt.disabled,$t.disabled,zo(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},tr.prototype._renderTileClippingMasks=function(r,o){if(this.currentStencilSource!==r.source&&r.isTileClipped()&&o&&o.length){this.currentStencilSource=r.source;var n=this.context,s=n.gl;this.nextStencilID+o.length>256&&this.clearStencil(),n.setColorMode(Yt.disabled),n.setDepthMode(St.disabled);var u=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var d=0,f=o;d<f.length;d+=1){var x=f[d],L=this._tileClippingMaskIDs[x.key]=this.nextStencilID++;u.draw(n,s.TRIANGLES,St.disabled,new zt({func:s.ALWAYS,mask:0},L,255,s.KEEP,s.KEEP,s.REPLACE),Yt.disabled,$t.disabled,zo(x.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},tr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var r=this.nextStencilID++,o=this.context.gl;return new zt({func:o.NOTEQUAL,mask:255},r,255,o.KEEP,o.KEEP,o.REPLACE)},tr.prototype.stencilModeForClipping=function(r){var o=this.context.gl;return new zt({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,o.KEEP,o.KEEP,o.REPLACE)},tr.prototype.stencilConfigForOverlap=function(r){var o,n=this.context.gl,s=r.sort(function(L,H){return H.overscaledZ-L.overscaledZ}),u=s[s.length-1].overscaledZ,d=s[0].overscaledZ-u+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();for(var f={},x=0;x<d;x++)f[x+u]=new zt({func:n.GEQUAL,mask:255},x+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=d,[f,s]}return[(o={},o[u]=zt.disabled,o),s]},tr.prototype.colorModeForRenderPass=function(){var r=this.context.gl;return this._showOverdrawInspector?new Yt([r.CONSTANT_COLOR,r.ONE],new l.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Yt.unblended:Yt.alphaBlended},tr.prototype.depthModeForSublayer=function(r,o,n){if(!this.opaquePassEnabledForLayer())return St.disabled;var s=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new St(n||this.context.gl.LEQUAL,o,[s,s])},tr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},tr.prototype.render=function(r,o){var n=this;this.style=r,this.options=o,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(l.browser.now()),this.imageManager.beginFrame();var s=this.style._order,u=this.style.sourceCaches;for(var d in u){var f=u[d];f.used&&f.prepare(this.context)}var x,L,H={},gt={},vt={};for(var bt in u){var Ft=u[bt];H[bt]=Ft.getVisibleCoordinates(),gt[bt]=H[bt].slice().reverse(),vt[bt]=Ft.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Bt=0;Bt<s.length;Bt++)if(this.style._layers[s[Bt]].is3D()){this.opaquePassCutoff=Bt;break}this.renderPass="offscreen";for(var Xt=0,Pt=s;Xt<Pt.length;Xt+=1){var qt=this.style._layers[Pt[Xt]];if(qt.hasOffscreenPass()&&!qt.isHidden(this.transform.zoom)){var Qt=gt[qt.source];(qt.type==="custom"||Qt.length)&&this.renderLayer(this,u[qt.source],qt,Qt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=s.length-1;this.currentLayer>=0;this.currentLayer--){var ne=this.style._layers[s[this.currentLayer]],pe=u[ne.source],ce=H[ne.source];this._renderTileClippingMasks(ne,ce),this.renderLayer(this,pe,ne,ce)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<s.length;this.currentLayer++){var de=this.style._layers[s[this.currentLayer]],xe=u[de.source],Ae=(de.type==="symbol"?vt:gt)[de.source];this._renderTileClippingMasks(de,H[de.source]),this.renderLayer(this,xe,de,Ae)}this.options.showTileBoundaries&&(l.values(this.style._layers).forEach(function(Ce){Ce.source&&!Ce.isHidden(n.transform.zoom)&&(Ce.source!==(L&&L.id)&&(L=n.style.sourceCaches[Ce.source]),(!x||x.getSource().maxzoom<L.getSource().maxzoom)&&(x=L))}),x&&Oo.debug(this,x,x.getVisibleCoordinates())),this.options.showPadding&&function(Ce){var je=Ce.transform.padding;Js(Ce,Ce.transform.height-(je.top||0),3,Ys),Js(Ce,je.bottom||0,3,sh),$s(Ce,je.left||0,3,lh),$s(Ce,Ce.transform.width-(je.right||0),3,Qa);var Ke=Ce.transform.centerPoint;(function(ei,ti,Mi,Ue){wa(ei,ti-1,Mi-10,2,20,Ue),wa(ei,ti-10,Mi-1,20,2,Ue)})(Ce,Ke.x,Ce.transform.height-Ke.y,Ks)}(this),this.context.setDefault()},tr.prototype.renderLayer=function(r,o,n,s){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||s.length)&&(this.id=n.id,this.gpuTimingStart(n),Oo[n.type](r,o,n,s,this.style.placement.variableOffsets),this.gpuTimingEnd())},tr.prototype.gpuTimingStart=function(r){if(this.options.gpuTiming){var o=this.context.extTimerQuery,n=this.gpuTimers[r.id];n||(n=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:o.createQueryEXT()}),n.calls++,o.beginQueryEXT(o.TIME_ELAPSED_EXT,n.query)}},tr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}},tr.prototype.collectGpuTimers=function(){var r=this.gpuTimers;return this.gpuTimers={},r},tr.prototype.queryGpuTimers=function(r){var o={};for(var n in r){var s=r[n],u=this.context.extTimerQuery,d=u.getQueryObjectEXT(s.query,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(s.query),o[n]=d}return o},tr.prototype.translatePosMatrix=function(r,o,n,s,u){if(!n[0]&&!n[1])return r;var d=u?s==="map"?this.transform.angle:0:s==="viewport"?-this.transform.angle:0;if(d){var f=Math.sin(d),x=Math.cos(d);n=[n[0]*x-n[1]*f,n[0]*f+n[1]*x]}var L=[u?n[0]:Qi(o,n[0],this.transform.zoom),u?n[1]:Qi(o,n[1],this.transform.zoom),0],H=new Float32Array(16);return l.translate(H,r,L),H},tr.prototype.saveTileTexture=function(r){var o=this._tileTextures[r.size[0]];o?o.push(r):this._tileTextures[r.size[0]]=[r]},tr.prototype.getTileTexture=function(r){var o=this._tileTextures[r];return o&&o.length>0?o.pop():null},tr.prototype.isPatternMissing=function(r){if(!r)return!1;if(!r.from||!r.to)return!0;var o=this.imageManager.getPattern(r.from.toString()),n=this.imageManager.getPattern(r.to.toString());return!o||!n},tr.prototype.useProgram=function(r,o){this.cache=this.cache||{};var n=""+r+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new Zl(this.context,r,ic[r],o,rh[r],this._showOverdrawInspector)),this.cache[n]},tr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},tr.prototype.setBaseState=function(){var r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)},tr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},tr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ts=function(r,o){this.points=r,this.planes=o};ts.fromInvProjectionMatrix=function(r,o,n){var s=Math.pow(2,n),u=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(f){return l.transformMat4([],f,r)}).map(function(f){return l.scale$1([],f,1/f[3]/o*s)}),d=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(f){var x=l.sub([],u[f[0]],u[f[1]]),L=l.sub([],u[f[2]],u[f[1]]),H=l.normalize([],l.cross([],x,L)),gt=-l.dot(H,u[f[1]]);return H.concat(gt)});return new ts(u,d)};var Bo=function(r,o){this.min=r,this.max=o,this.center=l.scale$2([],l.add([],this.min,this.max),.5)};Bo.prototype.quadrant=function(r){for(var o=[r%2==0,r<2],n=l.clone$2(this.min),s=l.clone$2(this.max),u=0;u<o.length;u++)n[u]=o[u]?this.min[u]:this.center[u],s[u]=o[u]?this.center[u]:this.max[u];return s[2]=this.max[2],new Bo(n,s)},Bo.prototype.distanceX=function(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]},Bo.prototype.distanceY=function(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]},Bo.prototype.intersects=function(r){for(var o=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,s=0;s<r.planes.length;s++){for(var u=r.planes[s],d=0,f=0;f<o.length;f++)d+=l.dot$1(u,o[f])>=0;if(d===0)return 0;d!==o.length&&(n=!1)}if(n)return 2;for(var x=0;x<3;x++){for(var L=Number.MAX_VALUE,H=-Number.MAX_VALUE,gt=0;gt<r.points.length;gt++){var vt=r.points[gt][x]-this.min[x];L=Math.min(L,vt),H=Math.max(H,vt)}if(H<0||L>this.max[x]-this.min[x])return 0}return 1};var ao=function(r,o,n,s){if(r===void 0&&(r=0),o===void 0&&(o=0),n===void 0&&(n=0),s===void 0&&(s=0),isNaN(r)||r<0||isNaN(o)||o<0||isNaN(n)||n<0||isNaN(s)||s<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=o,this.left=n,this.right=s};ao.prototype.interpolate=function(r,o,n){return o.top!=null&&r.top!=null&&(this.top=l.number(r.top,o.top,n)),o.bottom!=null&&r.bottom!=null&&(this.bottom=l.number(r.bottom,o.bottom,n)),o.left!=null&&r.left!=null&&(this.left=l.number(r.left,o.left,n)),o.right!=null&&r.right!=null&&(this.right=l.number(r.right,o.right,n)),this},ao.prototype.getCenter=function(r,o){var n=l.clamp((this.left+r-this.right)/2,0,r),s=l.clamp((this.top+o-this.bottom)/2,0,o);return new l.Point(n,s)},ao.prototype.equals=function(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right},ao.prototype.clone=function(){return new ao(this.top,this.bottom,this.left,this.right)},ao.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ci=function(r,o,n,s,u){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=u===void 0||u,this._minZoom=r||0,this._maxZoom=o||22,this._minPitch=n??0,this._maxPitch=s??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ao,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ki={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ci.prototype.clone=function(){var r=new Ci(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.tileSize=this.tileSize,r.latRange=this.latRange,r.width=this.width,r.height=this.height,r._center=this._center,r.zoom=this.zoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._calcMatrices(),r},Ki.minZoom.get=function(){return this._minZoom},Ki.minZoom.set=function(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))},Ki.maxZoom.get=function(){return this._maxZoom},Ki.maxZoom.set=function(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))},Ki.minPitch.get=function(){return this._minPitch},Ki.minPitch.set=function(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))},Ki.maxPitch.get=function(){return this._maxPitch},Ki.maxPitch.set=function(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))},Ki.renderWorldCopies.get=function(){return this._renderWorldCopies},Ki.renderWorldCopies.set=function(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r},Ki.worldSize.get=function(){return this.tileSize*this.scale},Ki.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ki.size.get=function(){return new l.Point(this.width,this.height)},Ki.bearing.get=function(){return-this.angle/Math.PI*180},Ki.bearing.set=function(r){var o=-l.wrap(r,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=l.create$2(),l.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ki.pitch.get=function(){return this._pitch/Math.PI*180},Ki.pitch.set=function(r){var o=l.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())},Ki.fov.get=function(){return this._fov/Math.PI*180},Ki.fov.set=function(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())},Ki.zoom.get=function(){return this._zoom},Ki.zoom.set=function(r){var o=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom,this._constrain(),this._calcMatrices())},Ki.center.get=function(){return this._center},Ki.center.set=function(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())},Ki.padding.get=function(){return this._edgeInsets.toJSON()},Ki.padding.set=function(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())},Ki.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ci.prototype.isPaddingEqual=function(r){return this._edgeInsets.equals(r)},Ci.prototype.interpolatePadding=function(r,o,n){this._unmodified=!1,this._edgeInsets.interpolate(r,o,n),this._constrain(),this._calcMatrices()},Ci.prototype.coveringZoomLevel=function(r){var o=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,o)},Ci.prototype.getVisibleUnwrappedCoordinates=function(r){var o=[new l.UnwrappedTileID(0,r)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new l.Point(0,0)),s=this.pointCoordinate(new l.Point(this.width,0)),u=this.pointCoordinate(new l.Point(this.width,this.height)),d=this.pointCoordinate(new l.Point(0,this.height)),f=Math.floor(Math.min(n.x,s.x,u.x,d.x)),x=Math.floor(Math.max(n.x,s.x,u.x,d.x)),L=f-1;L<=x+1;L++)L!==0&&o.push(new l.UnwrappedTileID(L,r));return o},Ci.prototype.coveringTiles=function(r){var o=this.coveringZoomLevel(r),n=o;if(r.minzoom!==void 0&&o<r.minzoom)return[];r.maxzoom!==void 0&&o>r.maxzoom&&(o=r.maxzoom);var s=l.MercatorCoordinate.fromLngLat(this.center),u=Math.pow(2,o),d=[u*s.x,u*s.y,0],f=ts.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o),x=r.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(x=o);var L=function(Ce){return{aabb:new Bo([Ce*u,0,0],[(Ce+1)*u,u,0]),zoom:0,x:0,y:0,wrap:Ce,fullyVisible:!1}},H=[],gt=[],vt=o,bt=r.reparseOverscaled?n:o;if(this._renderWorldCopies)for(var Ft=1;Ft<=3;Ft++)H.push(L(-Ft)),H.push(L(Ft));for(H.push(L(0));H.length>0;){var Bt=H.pop(),Xt=Bt.x,Pt=Bt.y,qt=Bt.fullyVisible;if(!qt){var Qt=Bt.aabb.intersects(f);if(Qt===0)continue;qt=Qt===2}var ne=Bt.aabb.distanceX(d),pe=Bt.aabb.distanceY(d),ce=Math.max(Math.abs(ne),Math.abs(pe));if(Bt.zoom===vt||ce>3+(1<<vt-Bt.zoom)-2&&Bt.zoom>=x)gt.push({tileID:new l.OverscaledTileID(Bt.zoom===vt?bt:Bt.zoom,Bt.wrap,Bt.zoom,Xt,Pt),distanceSq:l.sqrLen([d[0]-.5-Xt,d[1]-.5-Pt])});else for(var de=0;de<4;de++){var xe=(Xt<<1)+de%2,Ae=(Pt<<1)+(de>>1);H.push({aabb:Bt.aabb.quadrant(de),zoom:Bt.zoom+1,x:xe,y:Ae,wrap:Bt.wrap,fullyVisible:qt})}}return gt.sort(function(Ce,je){return Ce.distanceSq-je.distanceSq}).map(function(Ce){return Ce.tileID})},Ci.prototype.resize=function(r,o){this.width=r,this.height=o,this.pixelsToGLUnits=[2/r,-2/o],this._constrain(),this._calcMatrices()},Ki.unmodified.get=function(){return this._unmodified},Ci.prototype.zoomScale=function(r){return Math.pow(2,r)},Ci.prototype.scaleZoom=function(r){return Math.log(r)/Math.LN2},Ci.prototype.project=function(r){var o=l.clamp(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(r.lng)*this.worldSize,l.mercatorYfromLat(o)*this.worldSize)},Ci.prototype.unproject=function(r){return new l.MercatorCoordinate(r.x/this.worldSize,r.y/this.worldSize).toLngLat()},Ki.point.get=function(){return this.project(this.center)},Ci.prototype.setLocationAtPoint=function(r,o){var n=this.pointCoordinate(o),s=this.pointCoordinate(this.centerPoint),u=this.locationCoordinate(r),d=new l.MercatorCoordinate(u.x-(n.x-s.x),u.y-(n.y-s.y));this.center=this.coordinateLocation(d),this._renderWorldCopies&&(this.center=this.center.wrap())},Ci.prototype.locationPoint=function(r){return this.coordinatePoint(this.locationCoordinate(r))},Ci.prototype.pointLocation=function(r){return this.coordinateLocation(this.pointCoordinate(r))},Ci.prototype.locationCoordinate=function(r){return l.MercatorCoordinate.fromLngLat(r)},Ci.prototype.coordinateLocation=function(r){return r.toLngLat()},Ci.prototype.pointCoordinate=function(r){var o=[r.x,r.y,0,1],n=[r.x,r.y,1,1];l.transformMat4(o,o,this.pixelMatrixInverse),l.transformMat4(n,n,this.pixelMatrixInverse);var s=o[3],u=n[3],d=o[1]/s,f=n[1]/u,x=o[2]/s,L=n[2]/u,H=x===L?0:(0-x)/(L-x);return new l.MercatorCoordinate(l.number(o[0]/s,n[0]/u,H)/this.worldSize,l.number(d,f,H)/this.worldSize)},Ci.prototype.coordinatePoint=function(r){var o=[r.x*this.worldSize,r.y*this.worldSize,0,1];return l.transformMat4(o,o,this.pixelMatrix),new l.Point(o[0]/o[3],o[1]/o[3])},Ci.prototype.getBounds=function(){return new l.LngLatBounds().extend(this.pointLocation(new l.Point(0,0))).extend(this.pointLocation(new l.Point(this.width,0))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))},Ci.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new l.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ci.prototype.setMaxBounds=function(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ci.prototype.calculatePosMatrix=function(r,o){o===void 0&&(o=!1);var n=r.key,s=o?this._alignedPosMatrixCache:this._posMatrixCache;if(s[n])return s[n];var u=r.canonical,d=this.worldSize/this.zoomScale(u.z),f=u.x+Math.pow(2,u.z)*r.wrap,x=l.identity(new Float64Array(16));return l.translate(x,x,[f*d,u.y*d,0]),l.scale(x,x,[d/l.EXTENT,d/l.EXTENT,1]),l.multiply(x,o?this.alignedProjMatrix:this.projMatrix,x),s[n]=new Float32Array(x),s[n]},Ci.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ci.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var r,o,n,s,u=-90,d=90,f=-180,x=180,L=this.size,H=this._unmodified;if(this.latRange){var gt=this.latRange;u=l.mercatorYfromLat(gt[1])*this.worldSize,r=(d=l.mercatorYfromLat(gt[0])*this.worldSize)-u<L.y?L.y/(d-u):0}if(this.lngRange){var vt=this.lngRange;f=l.mercatorXfromLng(vt[0])*this.worldSize,o=(x=l.mercatorXfromLng(vt[1])*this.worldSize)-f<L.x?L.x/(x-f):0}var bt=this.point,Ft=Math.max(o||0,r||0);if(Ft)return this.center=this.unproject(new l.Point(o?(x+f)/2:bt.x,r?(d+u)/2:bt.y)),this.zoom+=this.scaleZoom(Ft),this._unmodified=H,void(this._constraining=!1);if(this.latRange){var Bt=bt.y,Xt=L.y/2;Bt-Xt<u&&(s=u+Xt),Bt+Xt>d&&(s=d-Xt)}if(this.lngRange){var Pt=bt.x,qt=L.x/2;Pt-qt<f&&(n=f+qt),Pt+qt>x&&(n=x-qt)}n===void 0&&s===void 0||(this.center=this.unproject(new l.Point(n!==void 0?n:bt.x,s!==void 0?s:bt.y))),this._unmodified=H,this._constraining=!1}},Ci.prototype._calcMatrices=function(){if(this.height){var r=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var o=Math.PI/2+this._pitch,n=this._fov*(.5+r.y/this.height),s=Math.sin(n)*this.cameraToCenterDistance/Math.sin(l.clamp(Math.PI-o-n,.01,Math.PI-.01)),u=this.point,d=u.x,f=u.y,x=1.01*(Math.cos(Math.PI/2-this._pitch)*s+this.cameraToCenterDistance),L=this.height/50,H=new Float64Array(16);l.perspective(H,this._fov,this.width/this.height,L,x),H[8]=2*-r.x/this.width,H[9]=2*r.y/this.height,l.scale(H,H,[1,-1,1]),l.translate(H,H,[0,0,-this.cameraToCenterDistance]),l.rotateX(H,H,this._pitch),l.rotateZ(H,H,this.angle),l.translate(H,H,[-d,-f,0]),this.mercatorMatrix=l.scale([],H,[this.worldSize,this.worldSize,this.worldSize]),l.scale(H,H,[1,1,l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=H,this.invProjMatrix=l.invert([],this.projMatrix);var gt=this.width%2/2,vt=this.height%2/2,bt=Math.cos(this.angle),Ft=Math.sin(this.angle),Bt=d-Math.round(d)+bt*gt+Ft*vt,Xt=f-Math.round(f)+bt*vt+Ft*gt,Pt=new Float64Array(H);if(l.translate(Pt,Pt,[Bt>.5?Bt-1:Bt,Xt>.5?Xt-1:Xt,0]),this.alignedProjMatrix=Pt,H=l.create(),l.scale(H,H,[this.width/2,-this.height/2,1]),l.translate(H,H,[1,-1,0]),this.labelPlaneMatrix=H,H=l.create(),l.scale(H,H,[1,-1,1]),l.translate(H,H,[-1,-1,0]),l.scale(H,H,[2/this.width,2/this.height,1]),this.glCoordMatrix=H,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(H=l.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=H,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ci.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var r=this.pointCoordinate(new l.Point(0,0)),o=[r.x*this.worldSize,r.y*this.worldSize,0,1];return l.transformMat4(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ci.prototype.getCameraPoint=function(){var r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,r))},Ci.prototype.getCameraQueryGeometry=function(r){var o=this.getCameraPoint();if(r.length===1)return[r[0],o];for(var n=o.x,s=o.y,u=o.x,d=o.y,f=0,x=r;f<x.length;f+=1){var L=x[f];n=Math.min(n,L.x),s=Math.min(s,L.y),u=Math.max(u,L.x),d=Math.max(d,L.y)}return[new l.Point(n,s),new l.Point(u,s),new l.Point(u,d),new l.Point(n,d),new l.Point(n,s)]},Object.defineProperties(Ci.prototype,Ki);var fn=function(r){var o,n,s,u;this._hashName=r&&encodeURIComponent(r),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(o=this._updateHashUnthrottled.bind(this),n=!1,s=null,u=function(){s=null,n&&(o(),s=setTimeout(u,300),n=!1)},function(){return n=!0,s||u(),s})};fn.prototype.addTo=function(r){return this._map=r,l.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},fn.prototype.remove=function(){return l.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},fn.prototype.getHashString=function(r){var o=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,s=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),u=Math.pow(10,s),d=Math.round(o.lng*u)/u,f=Math.round(o.lat*u)/u,x=this._map.getBearing(),L=this._map.getPitch(),H="";if(H+=r?"/"+d+"/"+f+"/"+n:n+"/"+f+"/"+d,(x||L)&&(H+="/"+Math.round(10*x)/10),L&&(H+="/"+Math.round(L)),this._hashName){var gt=this._hashName,vt=!1,bt=l.window.location.hash.slice(1).split("&").map(function(Ft){var Bt=Ft.split("=")[0];return Bt===gt?(vt=!0,Bt+"="+H):Ft}).filter(function(Ft){return Ft});return vt||bt.push(gt+"="+H),"#"+bt.join("&")}return"#"+H},fn.prototype._getCurrentHash=function(){var r,o=this,n=l.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(s){return s.split("=")}).forEach(function(s){s[0]===o._hashName&&(r=s)}),(r&&r[1]||"").split("/")):n.split("/")},fn.prototype._onHashChange=function(){var r=this._getCurrentHash();if(r.length>=3&&!r.some(function(n){return isNaN(n)})){var o=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:o,pitch:+(r[4]||0)}),!0}return!1},fn.prototype._updateHashUnthrottled=function(){var r=l.window.location.href.replace(/(#.+)?$/,this.getHashString());try{l.window.history.replaceState(l.window.history.state,null,r)}catch{}};var Sa={linearity:.3,easing:l.bezier(0,0,.3,1)},ta=l.extend({deceleration:2500,maxSpeed:1400},Sa),Ta=l.extend({deceleration:20,maxSpeed:1400},Sa),ac=l.extend({deceleration:1e3,maxSpeed:360},Sa),sc=l.extend({deceleration:1e3,maxSpeed:90},Sa),ka=function(r){this._map=r,this.clear()};function Ca(r,o){(!r.duration||r.duration<o.duration)&&(r.duration=o.duration,r.easing=o.easing)}function Gn(r,o,n){var s=n.maxSpeed,u=n.linearity,d=n.deceleration,f=l.clamp(r*u/(o/1e3),-s,s),x=Math.abs(f)/(d*u);return{easing:n.easing,duration:1e3*x,amount:f*(x/2)}}ka.prototype.clear=function(){this._inertiaBuffer=[]},ka.prototype.record=function(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.browser.now(),settings:r})},ka.prototype._drainInertiaBuffer=function(){for(var r=this._inertiaBuffer,o=l.browser.now();r.length>0&&o-r[0].time>160;)r.shift()},ka.prototype._onMoveEnd=function(r){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var o={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0},n=0,s=this._inertiaBuffer;n<s.length;n+=1){var u=s[n].settings;o.zoom+=u.zoomDelta||0,o.bearing+=u.bearingDelta||0,o.pitch+=u.pitchDelta||0,u.panDelta&&o.pan._add(u.panDelta),u.around&&(o.around=u.around),u.pinchAround&&(o.pinchAround=u.pinchAround)}var d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(o.pan.mag()){var x=Gn(o.pan.mag(),d,l.extend({},ta,r||{}));f.offset=o.pan.mult(x.amount/o.pan.mag()),f.center=this._map.transform.center,Ca(f,x)}if(o.zoom){var L=Gn(o.zoom,d,Ta);f.zoom=this._map.transform.zoom+L.amount,Ca(f,L)}if(o.bearing){var H=Gn(o.bearing,d,ac);f.bearing=this._map.transform.bearing+l.clamp(H.amount,-179,179),Ca(f,H)}if(o.pitch){var gt=Gn(o.pitch,d,sc);f.pitch=this._map.transform.pitch+gt.amount,Ca(f,gt)}if(f.zoom||f.bearing){var vt=o.pinchAround===void 0?o.around:o.pinchAround;f.around=vt?this._map.unproject(vt):this._map.getCenter()}return this.clear(),l.extend(f,{noMoveStart:!0})}};var xr=function(r){function o(s,u,d,f){f===void 0&&(f={});var x=dt.mousePos(u.getCanvasContainer(),d),L=u.unproject(x);r.call(this,s,l.extend({point:x,lngLat:L,originalEvent:d},f)),this._defaultPrevented=!1,this.target=u}r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o;var n={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,n),o}(l.Event),Aa=function(r){function o(s,u,d){var f=s==="touchend"?d.changedTouches:d.touches,x=dt.touchPos(u.getCanvasContainer(),f),L=x.map(function(vt){return u.unproject(vt)}),H=x.reduce(function(vt,bt,Ft,Bt){return vt.add(bt.div(Bt.length))},new l.Point(0,0)),gt=u.unproject(H);r.call(this,s,{points:x,point:H,lngLats:L,lngLat:gt,originalEvent:d}),this._defaultPrevented=!1}r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o;var n={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,n),o}(l.Event),ch=function(r){function o(s,u,d){r.call(this,s,{originalEvent:d}),this._defaultPrevented=!1}r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o;var n={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,n),o}(l.Event),vr=function(r,o){this._map=r,this._clickTolerance=o.clickTolerance};vr.prototype.reset=function(){delete this._mousedownPos},vr.prototype.wheel=function(r){return this._firePreventable(new ch(r.type,this._map,r))},vr.prototype.mousedown=function(r,o){return this._mousedownPos=o,this._firePreventable(new xr(r.type,this._map,r))},vr.prototype.mouseup=function(r){this._map.fire(new xr(r.type,this._map,r))},vr.prototype.click=function(r,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new xr(r.type,this._map,r))},vr.prototype.dblclick=function(r){return this._firePreventable(new xr(r.type,this._map,r))},vr.prototype.mouseover=function(r){this._map.fire(new xr(r.type,this._map,r))},vr.prototype.mouseout=function(r){this._map.fire(new xr(r.type,this._map,r))},vr.prototype.touchstart=function(r){return this._firePreventable(new Aa(r.type,this._map,r))},vr.prototype.touchmove=function(r){this._map.fire(new Aa(r.type,this._map,r))},vr.prototype.touchend=function(r){this._map.fire(new Aa(r.type,this._map,r))},vr.prototype.touchcancel=function(r){this._map.fire(new Aa(r.type,this._map,r))},vr.prototype._firePreventable=function(r){if(this._map.fire(r),r.defaultPrevented)return{}},vr.prototype.isEnabled=function(){return!0},vr.prototype.isActive=function(){return!1},vr.prototype.enable=function(){},vr.prototype.disable=function(){};var Ve=function(r){this._map=r};Ve.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Ve.prototype.mousemove=function(r){this._map.fire(new xr(r.type,this._map,r))},Ve.prototype.mousedown=function(){this._delayContextMenu=!0},Ve.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Ve.prototype.contextmenu=function(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new xr(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()},Ve.prototype.isEnabled=function(){return!0},Ve.prototype.isActive=function(){return!1},Ve.prototype.enable=function(){},Ve.prototype.disable=function(){};var an=function(r,o){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=o.clickTolerance||1};function es(r,o){for(var n={},s=0;s<r.length;s++)n[r[s].identifier]=o[s];return n}an.prototype.isEnabled=function(){return!!this._enabled},an.prototype.isActive=function(){return!!this._active},an.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},an.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},an.prototype.mousedown=function(r,o){this.isEnabled()&&r.shiftKey&&r.button===0&&(dt.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)},an.prototype.mousemoveWindow=function(r,o){if(this._active){var n=o;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var s=this._startPos;this._lastPos=n,this._box||(this._box=dt.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));var u=Math.min(s.x,n.x),d=Math.max(s.x,n.x),f=Math.min(s.y,n.y),x=Math.max(s.y,n.y);dt.setTransform(this._box,"translate("+u+"px,"+f+"px)"),this._box.style.width=d-u+"px",this._box.style.height=x-f+"px"}}},an.prototype.mouseupWindow=function(r,o){var n=this;if(this._active&&r.button===0){var s=this._startPos,u=o;if(this.reset(),dt.suppressClick(),s.x!==u.x||s.y!==u.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:function(d){return d.fitScreenCoordinates(s,u,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",r)}},an.prototype.keydown=function(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))},an.prototype.blur=function(){this.reset()},an.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(dt.remove(this._box),this._box=null),dt.enableDrag(),delete this._startPos,delete this._lastPos},an.prototype._fireEvent=function(r,o){return this._map.fire(new l.Event(r,{originalEvent:o}))};var ea=function(r){this.reset(),this.numTouches=r.numTouches};ea.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},ea.prototype.touchstart=function(r,o,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),n.length===this.numTouches&&(this.centroid=function(s){for(var u=new l.Point(0,0),d=0,f=s;d<f.length;d+=1)u._add(f[d]);return u.div(s.length)}(o),this.touches=es(n,o)))},ea.prototype.touchmove=function(r,o,n){if(!this.aborted&&this.centroid){var s=es(n,o);for(var u in this.touches){var d=s[u];(!d||d.dist(this.touches[u])>30)&&(this.aborted=!0)}}},ea.prototype.touchend=function(r,o,n){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var s=!this.aborted&&this.centroid;if(this.reset(),s)return s}};var Pn=function(r){this.singleTap=new ea(r),this.numTaps=r.numTaps,this.reset()};Pn.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Pn.prototype.touchstart=function(r,o,n){this.singleTap.touchstart(r,o,n)},Pn.prototype.touchmove=function(r,o,n){this.singleTap.touchmove(r,o,n)},Pn.prototype.touchend=function(r,o,n){var s=this.singleTap.touchend(r,o,n);if(s){var u=r.timeStamp-this.lastTime<500,d=!this.lastTap||this.lastTap.dist(s)<30;if(u&&d||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=s,this.count===this.numTaps)return this.reset(),s}};var sn=function(){this._zoomIn=new Pn({numTouches:1,numTaps:2}),this._zoomOut=new Pn({numTouches:2,numTaps:1}),this.reset()};sn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},sn.prototype.touchstart=function(r,o,n){this._zoomIn.touchstart(r,o,n),this._zoomOut.touchstart(r,o,n)},sn.prototype.touchmove=function(r,o,n){this._zoomIn.touchmove(r,o,n),this._zoomOut.touchmove(r,o,n)},sn.prototype.touchend=function(r,o,n){var s=this,u=this._zoomIn.touchend(r,o,n),d=this._zoomOut.touchend(r,o,n);return u?(this._active=!0,r.preventDefault(),setTimeout(function(){return s.reset()},0),{cameraAnimation:function(f){return f.easeTo({duration:300,zoom:f.getZoom()+1,around:f.unproject(u)},{originalEvent:r})}}):d?(this._active=!0,r.preventDefault(),setTimeout(function(){return s.reset()},0),{cameraAnimation:function(f){return f.easeTo({duration:300,zoom:f.getZoom()-1,around:f.unproject(d)},{originalEvent:r})}}):void 0},sn.prototype.touchcancel=function(){this.reset()},sn.prototype.enable=function(){this._enabled=!0},sn.prototype.disable=function(){this._enabled=!1,this.reset()},sn.prototype.isEnabled=function(){return this._enabled},sn.prototype.isActive=function(){return this._active};var Qs={0:1,2:2},Ie=function(r){this.reset(),this._clickTolerance=r.clickTolerance||1};Ie.prototype.blur=function(){this.reset()},Ie.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ie.prototype._correctButton=function(r,o){return!1},Ie.prototype._move=function(r,o){return{}},Ie.prototype.mousedown=function(r,o){if(!this._lastPoint){var n=dt.mouseButton(r);this._correctButton(r,n)&&(this._lastPoint=o,this._eventButton=n)}},Ie.prototype.mousemoveWindow=function(r,o){var n=this._lastPoint;if(n){if(r.preventDefault(),function(s,u){var d=Qs[u];return s.buttons===void 0||(s.buttons&d)!==d}(r,this._eventButton))this.reset();else if(this._moved||!(o.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=o,this._move(n,o)}},Ie.prototype.mouseupWindow=function(r){this._lastPoint&&dt.mouseButton(r)===this._eventButton&&(this._moved&&dt.suppressClick(),this.reset())},Ie.prototype.enable=function(){this._enabled=!0},Ie.prototype.disable=function(){this._enabled=!1,this.reset()},Ie.prototype.isEnabled=function(){return this._enabled},Ie.prototype.isActive=function(){return this._active};var tl=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.mousedown=function(n,s){r.prototype.mousedown.call(this,n,s),this._lastPoint&&(this._active=!0)},o.prototype._correctButton=function(n,s){return s===0&&!n.ctrlKey},o.prototype._move=function(n,s){return{around:s,panDelta:s.sub(n)}},o}(Ie),is=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype._correctButton=function(n,s){return s===0&&n.ctrlKey||s===2},o.prototype._move=function(n,s){var u=.8*(s.x-n.x);if(u)return this._active=!0,{bearingDelta:u}},o.prototype.contextmenu=function(n){n.preventDefault()},o}(Ie),el=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype._correctButton=function(n,s){return s===0&&n.ctrlKey||s===2},o.prototype._move=function(n,s){var u=-.5*(s.y-n.y);if(u)return this._active=!0,{pitchDelta:u}},o.prototype.contextmenu=function(n){n.preventDefault()},o}(Ie),bn=function(r){this._minTouches=1,this._clickTolerance=r.clickTolerance||1,this.reset()};bn.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new l.Point(0,0)},bn.prototype.touchstart=function(r,o,n){return this._calculateTransform(r,o,n)},bn.prototype.touchmove=function(r,o,n){if(this._active&&!(n.length<this._minTouches))return r.preventDefault(),this._calculateTransform(r,o,n)},bn.prototype.touchend=function(r,o,n){this._calculateTransform(r,o,n),this._active&&n.length<this._minTouches&&this.reset()},bn.prototype.touchcancel=function(){this.reset()},bn.prototype._calculateTransform=function(r,o,n){n.length>0&&(this._active=!0);var s=es(n,o),u=new l.Point(0,0),d=new l.Point(0,0),f=0;for(var x in s){var L=s[x],H=this._touches[x];H&&(u._add(L),d._add(L.sub(H)),f++,s[x]=L)}if(this._touches=s,!(f<this._minTouches)&&d.mag()){var gt=d.div(f);if(this._sum._add(gt),!(this._sum.mag()<this._clickTolerance))return{around:u.div(f),panDelta:gt}}},bn.prototype.enable=function(){this._enabled=!0},bn.prototype.disable=function(){this._enabled=!1,this.reset()},bn.prototype.isEnabled=function(){return this._enabled},bn.prototype.isActive=function(){return this._active};var ln=function(){this.reset()};function rs(r,o,n){for(var s=0;s<r.length;s++)if(r[s].identifier===n)return o[s]}function ns(r,o){return Math.log(r/o)/Math.LN2}ln.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},ln.prototype._start=function(r){},ln.prototype._move=function(r,o,n){return{}},ln.prototype.touchstart=function(r,o,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([o[0],o[1]]))},ln.prototype.touchmove=function(r,o,n){if(this._firstTwoTouches){r.preventDefault();var s=this._firstTwoTouches,u=s[1],d=rs(n,o,s[0]),f=rs(n,o,u);if(d&&f){var x=this._aroundCenter?null:d.add(f).div(2);return this._move([d,f],x,r)}}},ln.prototype.touchend=function(r,o,n){if(this._firstTwoTouches){var s=this._firstTwoTouches,u=s[1],d=rs(n,o,s[0]),f=rs(n,o,u);d&&f||(this._active&&dt.suppressClick(),this.reset())}},ln.prototype.touchcancel=function(){this.reset()},ln.prototype.enable=function(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"},ln.prototype.disable=function(){this._enabled=!1,this.reset()},ln.prototype.isEnabled=function(){return this._enabled},ln.prototype.isActive=function(){return this._active};var hn=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.reset=function(){r.prototype.reset.call(this),delete this._distance,delete this._startDistance},o.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},o.prototype._move=function(n,s){var u=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(ns(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ns(this._distance,u),pinchAround:s}},o}(ln);function qn(r,o){return 180*r.angleWith(o)/Math.PI}var uh=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.reset=function(){r.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},o.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},o.prototype._move=function(n,s){var u=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:qn(this._vector,u),pinchAround:s}},o.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var s=25/(Math.PI*this._minDiameter)*360,u=qn(n,this._startVector);return Math.abs(u)<s},o}(ln);function Ea(r){return Math.abs(r.y)>Math.abs(r.x)}var il=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.reset=function(){r.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},o.prototype._start=function(n){this._lastPoints=n,Ea(n[0].sub(n[1]))&&(this._valid=!1)},o.prototype._move=function(n,s,u){var d=n[0].sub(this._lastPoints[0]),f=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(d,f,u.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(d.y+f.y)/2*-.5}},o.prototype.gestureBeginsVertically=function(n,s,u){if(this._valid!==void 0)return this._valid;var d=n.mag()>=2,f=s.mag()>=2;if(d||f){if(!d||!f)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;var x=n.y>0==s.y>0;return Ea(n)&&Ea(s)&&x}},o}(ln),rl={panStep:100,bearingStep:15,pitchStep:10},In=function(){var r=rl;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1};function mn(r){return r*(2-r)}In.prototype.blur=function(){this.reset()},In.prototype.reset=function(){this._active=!1},In.prototype.keydown=function(r){var o=this;if(!(r.altKey||r.ctrlKey||r.metaKey)){var n=0,s=0,u=0,d=0,f=0;switch(r.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:r.shiftKey?s=-1:(r.preventDefault(),d=-1);break;case 39:r.shiftKey?s=1:(r.preventDefault(),d=1);break;case 38:r.shiftKey?u=1:(r.preventDefault(),f=-1);break;case 40:r.shiftKey?u=-1:(r.preventDefault(),f=1);break;default:return}return this._rotationDisabled&&(s=0,u=0),{cameraAnimation:function(x){var L=x.getZoom();x.easeTo({duration:300,easeId:"keyboardHandler",easing:mn,zoom:n?Math.round(L)+n*(r.shiftKey?2:1):L,bearing:x.getBearing()+s*o._bearingStep,pitch:x.getPitch()+u*o._pitchStep,offset:[-d*o._panStep,-f*o._panStep],center:x.getCenter()},{originalEvent:r})}}}},In.prototype.enable=function(){this._enabled=!0},In.prototype.disable=function(){this._enabled=!1,this.reset()},In.prototype.isEnabled=function(){return this._enabled},In.prototype.isActive=function(){return this._active},In.prototype.disableRotation=function(){this._rotationDisabled=!0},In.prototype.enableRotation=function(){this._rotationDisabled=!1};var wi=function(r,o){this._map=r,this._el=r.getCanvasContainer(),this._handler=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,l.bindAll(["_onTimeout"],this)};wi.prototype.setZoomRate=function(r){this._defaultZoomRate=r},wi.prototype.setWheelZoomRate=function(r){this._wheelZoomRate=r},wi.prototype.isEnabled=function(){return!!this._enabled},wi.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},wi.prototype.isZooming=function(){return!!this._zooming},wi.prototype.enable=function(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=r&&r.around==="center")},wi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},wi.prototype.wheel=function(r){if(this.isEnabled()){var o=r.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY,n=l.browser.now(),s=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,o!==0&&o%4.000244140625==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":s>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(s*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),r.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=r,this._delta-=o,this._active||this._start(r)),r.preventDefault()}},wi.prototype._onTimeout=function(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)},wi.prototype._start=function(r){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var o=dt.mousePos(this._el,r);this._around=l.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(o)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},wi.prototype.renderFrame=function(){var r=this;if(this._frameId&&(this._frameId=null,this.isActive())){var o=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,s=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&s!==0&&(s=1/s);var u=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(u*s))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var d,f=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,x=this._startZoom,L=this._easing,H=!1;if(this._type==="wheel"&&x&&L){var gt=Math.min((l.browser.now()-this._lastWheelEventTime)/200,1),vt=L(gt);d=l.number(x,f,vt),gt<1?this._frameId||(this._frameId=!0):H=!0}else d=f,H=!0;return this._active=!0,H&&(this._active=!1,this._finishTimeout=setTimeout(function(){r._zooming=!1,r._handler._triggerRenderFrame(),delete r._targetZoom,delete r._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!H,zoomDelta:d-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},wi.prototype._smoothOutEasing=function(r){var o=l.ease;if(this._prevEase){var n=this._prevEase,s=(l.browser.now()-n.start)/n.duration,u=n.easing(s+.01)-n.easing(s),d=.27/Math.sqrt(u*u+1e-4)*.01,f=Math.sqrt(.0729-d*d);o=l.bezier(d,f,.25,1)}return this._prevEase={start:l.browser.now(),duration:r,easing:o},o},wi.prototype.blur=function(){this.reset()},wi.prototype.reset=function(){this._active=!1};var Bn=function(r,o){this._clickZoom=r,this._tapZoom=o};Bn.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Bn.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Bn.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Bn.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var wn=function(){this.reset()};wn.prototype.reset=function(){this._active=!1},wn.prototype.blur=function(){this.reset()},wn.prototype.dblclick=function(r,o){return r.preventDefault(),{cameraAnimation:function(n){n.easeTo({duration:300,zoom:n.getZoom()+(r.shiftKey?-1:1),around:n.unproject(o)},{originalEvent:r})}}},wn.prototype.enable=function(){this._enabled=!0},wn.prototype.disable=function(){this._enabled=!1,this.reset()},wn.prototype.isEnabled=function(){return this._enabled},wn.prototype.isActive=function(){return this._active};var Rr=function(){this._tap=new Pn({numTouches:1,numTaps:1}),this.reset()};Rr.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Rr.prototype.touchstart=function(r,o,n){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=o[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(r,o,n))},Rr.prototype.touchmove=function(r,o,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var s=o[0],u=s.y-this._swipePoint.y;return this._swipePoint=s,r.preventDefault(),this._active=!0,{zoomDelta:u/128}}}else this._tap.touchmove(r,o,n)},Rr.prototype.touchend=function(r,o,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(r,o,n)&&(this._tapTime=r.timeStamp)},Rr.prototype.touchcancel=function(){this.reset()},Rr.prototype.enable=function(){this._enabled=!0},Rr.prototype.disable=function(){this._enabled=!1,this.reset()},Rr.prototype.isEnabled=function(){return this._enabled},Rr.prototype.isActive=function(){return this._active};var Ro=function(r,o,n){this._el=r,this._mousePan=o,this._touchPan=n};Ro.prototype.enable=function(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Ro.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Ro.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Ro.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var so=function(r,o,n){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=o,this._mousePitch=n};so.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},so.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},so.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},so.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Ln=function(r,o,n,s){this._el=r,this._touchZoom=o,this._touchRotate=n,this._tapDragZoom=s,this._rotationDisabled=!1,this._enabled=!0};Ln.prototype.enable=function(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Ln.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Ln.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Ln.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Ln.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Ln.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Xr=function(r){return r.zoom||r.drag||r.pitch||r.rotate},Ma=function(r){function o(){r.apply(this,arguments)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o}(l.Event);function Ye(r){return r.panDelta&&r.panDelta.mag()||r.zoomDelta||r.bearingDelta||r.pitchDelta}var Xe=function(r,o){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ka(r),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o),l.bindAll(["handleEvent","handleWindowEvent"],this);var n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[l.window,"blur",void 0]];for(var s=0,u=this._listeners;s<u.length;s+=1){var d=u[s],f=d[0];dt.addEventListener(f,d[1],f===l.window.document?this.handleWindowEvent:this.handleEvent,d[2])}};Xe.prototype.destroy=function(){for(var r=0,o=this._listeners;r<o.length;r+=1){var n=o[r],s=n[0];dt.removeEventListener(s,n[1],s===l.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},Xe.prototype._addDefaultHandlers=function(r){var o=this._map,n=o.getCanvasContainer();this._add("mapEvent",new vr(o,r));var s=o.boxZoom=new an(o,r);this._add("boxZoom",s);var u=new sn,d=new wn;o.doubleClickZoom=new Bn(d,u),this._add("tapZoom",u),this._add("clickZoom",d);var f=new Rr;this._add("tapDragZoom",f);var x=o.touchPitch=new il;this._add("touchPitch",x);var L=new is(r),H=new el(r);o.dragRotate=new so(r,L,H),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);var gt=new tl(r),vt=new bn(r);o.dragPan=new Ro(n,gt,vt),this._add("mousePan",gt),this._add("touchPan",vt,["touchZoom","touchRotate"]);var bt=new uh,Ft=new hn;o.touchZoomRotate=new Ln(n,Ft,bt,f),this._add("touchRotate",bt,["touchPan","touchZoom"]),this._add("touchZoom",Ft,["touchPan","touchRotate"]);var Bt=o.scrollZoom=new wi(o,this);this._add("scrollZoom",Bt,["mousePan"]);var Xt=o.keyboard=new In;this._add("keyboard",Xt),this._add("blockableMapEvent",new Ve(o));for(var Pt=0,qt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Pt<qt.length;Pt+=1){var Qt=qt[Pt];r.interactive&&r[Qt]&&o[Qt].enable(r[Qt])}},Xe.prototype._add=function(r,o,n){this._handlers.push({handlerName:r,handler:o,allowed:n}),this._handlersById[r]=o},Xe.prototype.stop=function(r){if(!this._updatingCamera){for(var o=0,n=this._handlers;o<n.length;o+=1)n[o].handler.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}},Xe.prototype.isActive=function(){for(var r=0,o=this._handlers;r<o.length;r+=1)if(o[r].handler.isActive())return!0;return!1},Xe.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Xe.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Xe.prototype.isMoving=function(){return!!Xr(this._eventsInProgress)||this.isZooming()},Xe.prototype._blockedByActive=function(r,o,n){for(var s in r)if(s!==n&&(!o||o.indexOf(s)<0))return!0;return!1},Xe.prototype.handleWindowEvent=function(r){this.handleEvent(r,r.type+"Window")},Xe.prototype._getMapTouches=function(r){for(var o=[],n=0,s=r;n<s.length;n+=1){var u=s[n];this._el.contains(u.target)&&o.push(u)}return o},Xe.prototype.handleEvent=function(r,o){this._updatingCamera=!0;for(var n=r.type==="renderFrame"?void 0:r,s={needsRenderFrame:!1},u={},d={},f=r.touches?this._getMapTouches(r.touches):void 0,x=f?dt.touchPos(this._el,f):dt.mousePos(this._el,r),L=0,H=this._handlers;L<H.length;L+=1){var gt=H[L],vt=gt.handlerName,bt=gt.handler,Ft=gt.allowed;if(bt.isEnabled()){var Bt=void 0;this._blockedByActive(d,Ft,vt)?bt.reset():bt[o||r.type]&&(Bt=bt[o||r.type](r,x,f),this.mergeHandlerResult(s,u,Bt,vt,n),Bt&&Bt.needsRenderFrame&&this._triggerRenderFrame()),(Bt||bt.isActive())&&(d[vt]=bt)}}var Xt={};for(var Pt in this._previousActiveHandlers)d[Pt]||(Xt[Pt]=n);this._previousActiveHandlers=d,(Object.keys(Xt).length||Ye(s))&&(this._changes.push([s,u,Xt]),this._triggerRenderFrame()),(Object.keys(d).length||Ye(s))&&this._map._stop(!0),this._updatingCamera=!1;var qt=s.cameraAnimation;qt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],qt(this._map))},Xe.prototype.mergeHandlerResult=function(r,o,n,s,u){if(n){l.extend(r,n);var d={handlerName:s,originalEvent:n.originalEvent||u};n.zoomDelta!==void 0&&(o.zoom=d),n.panDelta!==void 0&&(o.drag=d),n.pitchDelta!==void 0&&(o.pitch=d),n.bearingDelta!==void 0&&(o.rotate=d)}},Xe.prototype._applyChanges=function(){for(var r={},o={},n={},s=0,u=this._changes;s<u.length;s+=1){var d=u[s],f=d[0],x=d[1],L=d[2];f.panDelta&&(r.panDelta=(r.panDelta||new l.Point(0,0))._add(f.panDelta)),f.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(r.around=f.around),f.pinchAround!==void 0&&(r.pinchAround=f.pinchAround),f.noInertia&&(r.noInertia=f.noInertia),l.extend(o,x),l.extend(n,L)}this._updateMapTransform(r,o,n),this._changes=[]},Xe.prototype._updateMapTransform=function(r,o,n){var s=this._map,u=s.transform;if(!Ye(r))return this._fireEvents(o,n,!0);var d=r.panDelta,f=r.zoomDelta,x=r.bearingDelta,L=r.pitchDelta,H=r.around,gt=r.pinchAround;gt!==void 0&&(H=gt),s._stop(!0),H=H||s.transform.centerPoint;var vt=u.pointLocation(d?H.sub(d):H);x&&(u.bearing+=x),L&&(u.pitch+=L),f&&(u.zoom+=f),u.setLocationAtPoint(vt,H),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(o,n,!0)},Xe.prototype._fireEvents=function(r,o,n){var s=this,u=Xr(this._eventsInProgress),d=Xr(r),f={};for(var x in r)this._eventsInProgress[x]||(f[x+"start"]=r[x].originalEvent),this._eventsInProgress[x]=r[x];for(var L in!u&&d&&this._fireEvent("movestart",d.originalEvent),f)this._fireEvent(L,f[L]);for(var H in d&&this._fireEvent("move",d.originalEvent),r)this._fireEvent(H,r[H].originalEvent);var gt,vt={};for(var bt in this._eventsInProgress){var Ft=this._eventsInProgress[bt],Bt=Ft.handlerName,Xt=Ft.originalEvent;this._handlersById[Bt].isActive()||(delete this._eventsInProgress[bt],vt[bt+"end"]=gt=o[Bt]||Xt)}for(var Pt in vt)this._fireEvent(Pt,vt[Pt]);var qt=Xr(this._eventsInProgress);if(n&&(u||d)&&!qt){this._updatingCamera=!0;var Qt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ne=function(pe){return pe!==0&&-s._bearingSnap<pe&&pe<s._bearingSnap};Qt?(ne(Qt.bearing||this._map.getBearing())&&(Qt.bearing=0),this._map.easeTo(Qt,{originalEvent:gt})):(this._map.fire(new l.Event("moveend",{originalEvent:gt})),ne(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Xe.prototype._fireEvent=function(r,o){this._map.fire(new l.Event(r,o?{originalEvent:o}:{}))},Xe.prototype._requestFrame=function(){var r=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(o){delete r._frameId,r.handleEvent(new Ma("renderFrame",{timeStamp:o})),r._applyChanges()})},Xe.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var os=function(r){function o(n,s){r.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=s.bearingSnap,l.bindAll(["_renderFrameCallback"],this)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.getCenter=function(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)},o.prototype.setCenter=function(n,s){return this.jumpTo({center:n},s)},o.prototype.panBy=function(n,s,u){return n=l.Point.convert(n).mult(-1),this.panTo(this.transform.center,l.extend({offset:n},s),u)},o.prototype.panTo=function(n,s,u){return this.easeTo(l.extend({center:n},s),u)},o.prototype.getZoom=function(){return this.transform.zoom},o.prototype.setZoom=function(n,s){return this.jumpTo({zoom:n},s),this},o.prototype.zoomTo=function(n,s,u){return this.easeTo(l.extend({zoom:n},s),u)},o.prototype.zoomIn=function(n,s){return this.zoomTo(this.getZoom()+1,n,s),this},o.prototype.zoomOut=function(n,s){return this.zoomTo(this.getZoom()-1,n,s),this},o.prototype.getBearing=function(){return this.transform.bearing},o.prototype.setBearing=function(n,s){return this.jumpTo({bearing:n},s),this},o.prototype.getPadding=function(){return this.transform.padding},o.prototype.setPadding=function(n,s){return this.jumpTo({padding:n},s),this},o.prototype.rotateTo=function(n,s,u){return this.easeTo(l.extend({bearing:n},s),u)},o.prototype.resetNorth=function(n,s){return this.rotateTo(0,l.extend({duration:1e3},n),s),this},o.prototype.resetNorthPitch=function(n,s){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},n),s),this},o.prototype.snapToNorth=function(n,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,s):this},o.prototype.getPitch=function(){return this.transform.pitch},o.prototype.setPitch=function(n,s){return this.jumpTo({pitch:n},s),this},o.prototype.cameraForBounds=function(n,s){n=l.LngLatBounds.convert(n);var u=s&&s.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),u,s)},o.prototype._cameraForBoxAndBearing=function(n,s,u,d){var f={top:0,bottom:0,right:0,left:0};if(typeof(d=l.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){var x=d.padding;d.padding={top:x,bottom:x,right:x,left:x}}d.padding=l.extend(f,d.padding);var L=this.transform,H=L.padding,gt=L.project(l.LngLat.convert(n)),vt=L.project(l.LngLat.convert(s)),bt=gt.rotate(-u*Math.PI/180),Ft=vt.rotate(-u*Math.PI/180),Bt=new l.Point(Math.max(bt.x,Ft.x),Math.max(bt.y,Ft.y)),Xt=new l.Point(Math.min(bt.x,Ft.x),Math.min(bt.y,Ft.y)),Pt=Bt.sub(Xt),qt=(L.width-(H.left+H.right+d.padding.left+d.padding.right))/Pt.x,Qt=(L.height-(H.top+H.bottom+d.padding.top+d.padding.bottom))/Pt.y;if(!(Qt<0||qt<0)){var ne=Math.min(L.scaleZoom(L.scale*Math.min(qt,Qt)),d.maxZoom),pe=typeof d.offset.x=="number"?new l.Point(d.offset.x,d.offset.y):l.Point.convert(d.offset),ce=new l.Point((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(u*Math.PI/180),de=pe.add(ce).mult(L.scale/L.zoomScale(ne));return{center:L.unproject(gt.add(vt).div(2).sub(de)),zoom:ne,bearing:u}}l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},o.prototype.fitBounds=function(n,s,u){return this._fitInternal(this.cameraForBounds(n,s),s,u)},o.prototype.fitScreenCoordinates=function(n,s,u,d,f){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(n)),this.transform.pointLocation(l.Point.convert(s)),u,d),d,f)},o.prototype._fitInternal=function(n,s,u){return n?(delete(s=l.extend(n,s)).padding,s.linear?this.easeTo(s,u):this.flyTo(s,u)):this},o.prototype.jumpTo=function(n,s){this.stop();var u=this.transform,d=!1,f=!1,x=!1;return"zoom"in n&&u.zoom!==+n.zoom&&(d=!0,u.zoom=+n.zoom),n.center!==void 0&&(u.center=l.LngLat.convert(n.center)),"bearing"in n&&u.bearing!==+n.bearing&&(f=!0,u.bearing=+n.bearing),"pitch"in n&&u.pitch!==+n.pitch&&(x=!0,u.pitch=+n.pitch),n.padding==null||u.isPaddingEqual(n.padding)||(u.padding=n.padding),this.fire(new l.Event("movestart",s)).fire(new l.Event("move",s)),d&&this.fire(new l.Event("zoomstart",s)).fire(new l.Event("zoom",s)).fire(new l.Event("zoomend",s)),f&&this.fire(new l.Event("rotatestart",s)).fire(new l.Event("rotate",s)).fire(new l.Event("rotateend",s)),x&&this.fire(new l.Event("pitchstart",s)).fire(new l.Event("pitch",s)).fire(new l.Event("pitchend",s)),this.fire(new l.Event("moveend",s))},o.prototype.easeTo=function(n,s){var u=this;this._stop(!1,n.easeId),((n=l.extend({offset:[0,0],duration:500,easing:l.ease},n)).animate===!1||!n.essential&&l.browser.prefersReducedMotion)&&(n.duration=0);var d=this.transform,f=this.getZoom(),x=this.getBearing(),L=this.getPitch(),H=this.getPadding(),gt="zoom"in n?+n.zoom:f,vt="bearing"in n?this._normalizeBearing(n.bearing,x):x,bt="pitch"in n?+n.pitch:L,Ft="padding"in n?n.padding:d.padding,Bt=l.Point.convert(n.offset),Xt=d.centerPoint.add(Bt),Pt=d.pointLocation(Xt),qt=l.LngLat.convert(n.center||Pt);this._normalizeCenter(qt);var Qt,ne,pe=d.project(Pt),ce=d.project(qt).sub(pe),de=d.zoomScale(gt-f);n.around&&(Qt=l.LngLat.convert(n.around),ne=d.locationPoint(Qt));var xe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||gt!==f,this._rotating=this._rotating||x!==vt,this._pitching=this._pitching||bt!==L,this._padding=!d.isPaddingEqual(Ft),this._easeId=n.easeId,this._prepareEase(s,n.noMoveStart,xe),this._ease(function(Ae){if(u._zooming&&(d.zoom=l.number(f,gt,Ae)),u._rotating&&(d.bearing=l.number(x,vt,Ae)),u._pitching&&(d.pitch=l.number(L,bt,Ae)),u._padding&&(d.interpolatePadding(H,Ft,Ae),Xt=d.centerPoint.add(Bt)),Qt)d.setLocationAtPoint(Qt,ne);else{var Ce=d.zoomScale(d.zoom-f),je=gt>f?Math.min(2,de):Math.max(.5,de),Ke=Math.pow(je,1-Ae),ei=d.unproject(pe.add(ce.mult(Ae*Ke)).mult(Ce));d.setLocationAtPoint(d.renderWorldCopies?ei.wrap():ei,Xt)}u._fireMoveEvents(s)},function(Ae){u._afterEase(s,Ae)},n),this},o.prototype._prepareEase=function(n,s,u){u===void 0&&(u={}),this._moving=!0,s||u.moving||this.fire(new l.Event("movestart",n)),this._zooming&&!u.zooming&&this.fire(new l.Event("zoomstart",n)),this._rotating&&!u.rotating&&this.fire(new l.Event("rotatestart",n)),this._pitching&&!u.pitching&&this.fire(new l.Event("pitchstart",n))},o.prototype._fireMoveEvents=function(n){this.fire(new l.Event("move",n)),this._zooming&&this.fire(new l.Event("zoom",n)),this._rotating&&this.fire(new l.Event("rotate",n)),this._pitching&&this.fire(new l.Event("pitch",n))},o.prototype._afterEase=function(n,s){if(!this._easeId||!s||this._easeId!==s){delete this._easeId;var u=this._zooming,d=this._rotating,f=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new l.Event("zoomend",n)),d&&this.fire(new l.Event("rotateend",n)),f&&this.fire(new l.Event("pitchend",n)),this.fire(new l.Event("moveend",n))}},o.prototype.flyTo=function(n,s){var u=this;if(!n.essential&&l.browser.prefersReducedMotion){var d=l.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(d,s)}this.stop(),n=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},n);var f=this.transform,x=this.getZoom(),L=this.getBearing(),H=this.getPitch(),gt=this.getPadding(),vt="zoom"in n?l.clamp(+n.zoom,f.minZoom,f.maxZoom):x,bt="bearing"in n?this._normalizeBearing(n.bearing,L):L,Ft="pitch"in n?+n.pitch:H,Bt="padding"in n?n.padding:f.padding,Xt=f.zoomScale(vt-x),Pt=l.Point.convert(n.offset),qt=f.centerPoint.add(Pt),Qt=f.pointLocation(qt),ne=l.LngLat.convert(n.center||Qt);this._normalizeCenter(ne);var pe=f.project(Qt),ce=f.project(ne).sub(pe),de=n.curve,xe=Math.max(f.width,f.height),Ae=xe/Xt,Ce=ce.mag();if("minZoom"in n){var je=l.clamp(Math.min(n.minZoom,x,vt),f.minZoom,f.maxZoom),Ke=xe/f.zoomScale(je-x);de=Math.sqrt(Ke/Ce*2)}var ei=de*de;function ti(oi){var ri=(Ae*Ae-xe*xe+(oi?-1:1)*ei*ei*Ce*Ce)/(2*(oi?Ae:xe)*ei*Ce);return Math.log(Math.sqrt(ri*ri+1)-ri)}function Mi(oi){return(Math.exp(oi)-Math.exp(-oi))/2}function Ue(oi){return(Math.exp(oi)+Math.exp(-oi))/2}var hi=ti(0),gi=function(oi){return Ue(hi)/Ue(hi+de*oi)},si=function(oi){return xe*((Ue(hi)*(Mi(ri=hi+de*oi)/Ue(ri))-Mi(hi))/ei)/Ce;var ri},ai=(ti(1)-hi)/de;if(Math.abs(Ce)<1e-6||!isFinite(ai)){if(Math.abs(xe-Ae)<1e-6)return this.easeTo(n,s);var mi=Ae<xe?-1:1;ai=Math.abs(Math.log(Ae/xe))/de,si=function(){return 0},gi=function(oi){return Math.exp(mi*de*oi)}}return n.duration="duration"in n?+n.duration:1e3*ai/("screenSpeed"in n?+n.screenSpeed/de:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=L!==bt,this._pitching=Ft!==H,this._padding=!f.isPaddingEqual(Bt),this._prepareEase(s,!1),this._ease(function(oi){var ri=oi*ai,Tr=1/gi(ri);f.zoom=oi===1?vt:x+f.scaleZoom(Tr),u._rotating&&(f.bearing=l.number(L,bt,oi)),u._pitching&&(f.pitch=l.number(H,Ft,oi)),u._padding&&(f.interpolatePadding(gt,Bt,oi),qt=f.centerPoint.add(Pt));var sr=oi===1?ne:f.unproject(pe.add(ce.mult(si(ri))).mult(Tr));f.setLocationAtPoint(f.renderWorldCopies?sr.wrap():sr,qt),u._fireMoveEvents(s)},function(){return u._afterEase(s)},n),this},o.prototype.isEasing=function(){return!!this._easeFrameId},o.prototype.stop=function(){return this._stop()},o.prototype._stop=function(n,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,s)}if(!n){var d=this.handlers;d&&d.stop(!1)}return this},o.prototype._ease=function(n,s,u){u.animate===!1||u.duration===0?(n(1),s()):(this._easeStart=l.browser.now(),this._easeOptions=u,this._onEaseFrame=n,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},o.prototype._renderFrameCallback=function(){var n=Math.min((l.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},o.prototype._normalizeBearing=function(n,s){n=l.wrap(n,-180,180);var u=Math.abs(n-s);return Math.abs(n-360-s)<u&&(n-=360),Math.abs(n+360-s)<u&&(n+=360),n},o.prototype._normalizeCenter=function(n){var s=this.transform;if(s.renderWorldCopies&&!s.lngRange){var u=n.lng-s.center.lng;n.lng+=u>180?-360:u<-180?360:0}},o}(l.Evented),Wr=function(r){r===void 0&&(r={}),this.options=r,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Wr.prototype.getDefaultPosition=function(){return"bottom-right"},Wr.prototype.onAdd=function(r){var o=this.options&&this.options.compact;return this._map=r,this._container=dt.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=dt.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=dt.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),o&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),o===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Wr.prototype.onRemove=function(){dt.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Wr.prototype._setElementTitle=function(r,o){var n=this._map._getUIString("AttributionControl."+o);r.title=n,r.setAttribute("aria-label",n)},Wr.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Wr.prototype._updateEditLink=function(){var r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));var o=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(r){var n=o.reduce(function(s,u,d){return u.value&&(s+=u.key+"="+u.value+(d<o.length-1?"&":"")),s},"?");r.href=l.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),r.rel="noopener nofollow",this._setElementTitle(r,"MapFeedback")}},Wr.prototype._updateData=function(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Wr.prototype._updateAttributions=function(){if(this._map.style){var r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(function(x){return typeof x!="string"?"":x})):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){var o=this._map.style.stylesheet;this.styleOwner=o.owner,this.styleId=o.id}var n=this._map.style.sourceCaches;for(var s in n){var u=n[s];if(u.used){var d=u.getSource();d.attribution&&r.indexOf(d.attribution)<0&&r.push(d.attribution)}}r.sort(function(x,L){return x.length-L.length});var f=(r=r.filter(function(x,L){for(var H=L+1;H<r.length;H++)if(r[H].indexOf(x)>=0)return!1;return!0})).join(" | ");f!==this._attribHTML&&(this._attribHTML=f,r.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Wr.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var zn=function(){l.bindAll(["_updateLogo"],this),l.bindAll(["_updateCompact"],this)};zn.prototype.onAdd=function(r){this._map=r,this._container=dt.create("div","mapboxgl-ctrl");var o=dt.create("a","mapboxgl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://www.mapbox.com/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},zn.prototype.onRemove=function(){dt.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},zn.prototype.getDefaultPosition=function(){return"bottom-left"},zn.prototype._updateLogo=function(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},zn.prototype._logoRequired=function(){if(this._map.style){var r=this._map.style.sourceCaches;for(var o in r)if(r[o].getSource().mapbox_logo)return!0;return!1}},zn.prototype._updateCompact=function(){var r=this._container.children;if(r.length){var o=r[0];this._map.getCanvasContainer().offsetWidth<250?o.classList.add("mapboxgl-compact"):o.classList.remove("mapboxgl-compact")}};var Fr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Fr.prototype.add=function(r){var o=++this._id;return this._queue.push({callback:r,id:o,cancelled:!1}),o},Fr.prototype.remove=function(r){for(var o=this._currentlyRunning,n=0,s=o?this._queue.concat(o):this._queue;n<s.length;n+=1){var u=s[n];if(u.id===r)return void(u.cancelled=!0)}},Fr.prototype.run=function(r){r===void 0&&(r=0);var o=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,s=o;n<s.length;n+=1){var u=s[n];if(!u.cancelled&&(u.callback(r),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Fr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Rn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},nl=l.window.HTMLImageElement,as=l.window.HTMLElement,ji=l.window.ImageBitmap,Pr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ph=function(r){function o(s){var u=this;if((s=l.extend({},Pr,s)).minZoom!=null&&s.maxZoom!=null&&s.minZoom>s.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(s.minPitch!=null&&s.maxPitch!=null&&s.minPitch>s.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(s.minPitch!=null&&s.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(s.maxPitch!=null&&s.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var d=new Ci(s.minZoom,s.maxZoom,s.minPitch,s.maxPitch,s.renderWorldCopies);if(r.call(this,d,s),this._interactive=s.interactive,this._maxTileCacheSize=s.maxTileCacheSize,this._failIfMajorPerformanceCaveat=s.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=s.preserveDrawingBuffer,this._antialias=s.antialias,this._trackResize=s.trackResize,this._bearingSnap=s.bearingSnap,this._refreshExpiredTiles=s.refreshExpiredTiles,this._fadeDuration=s.fadeDuration,this._crossSourceCollisions=s.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=s.collectResourceTiming,this._renderTaskQueue=new Fr,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Rn,s.locale),this._clickTolerance=s.clickTolerance,this._requestManager=new l.RequestManager(s.transformRequest,s.accessToken),typeof s.container=="string"){if(this._container=l.window.document.getElementById(s.container),!this._container)throw new Error("Container '"+s.container+"' not found.")}else{if(!(s.container instanceof as))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=s.container}if(s.maxBounds&&this.setMaxBounds(s.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return u._update(!1)}),this.on("moveend",function(){return u._update(!1)}),this.on("zoom",function(){return u._update(!0)}),l.window!==void 0&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Xe(this,s),this._hash=s.hash&&new fn(typeof s.hash=="string"&&s.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:s.center,zoom:s.zoom,bearing:s.bearing,pitch:s.pitch}),s.bounds&&(this.resize(),this.fitBounds(s.bounds,l.extend({},s.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=s.localIdeographFontFamily,s.style&&this.setStyle(s.style,{localIdeographFontFamily:s.localIdeographFontFamily}),s.attributionControl&&this.addControl(new Wr({customAttribution:s.customAttribution})),this.addControl(new zn,s.logoPosition),this.on("style.load",function(){u.transform.unmodified&&u.jumpTo(u.style.stylesheet)}),this.on("data",function(f){u._update(f.dataType==="style"),u.fire(new l.Event(f.dataType+"data",f))}),this.on("dataloading",function(f){u.fire(new l.Event(f.dataType+"dataloading",f))})}r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return o.prototype._getMapId=function(){return this._mapId},o.prototype.addControl=function(s,u){if(u===void 0&&(u=s.getDefaultPosition?s.getDefaultPosition():"top-right"),!s||!s.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var d=s.onAdd(this);this._controls.push(s);var f=this._controlPositions[u];return u.indexOf("bottom")!==-1?f.insertBefore(d,f.firstChild):f.appendChild(d),this},o.prototype.removeControl=function(s){if(!s||!s.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var u=this._controls.indexOf(s);return u>-1&&this._controls.splice(u,1),s.onRemove(this),this},o.prototype.hasControl=function(s){return this._controls.indexOf(s)>-1},o.prototype.resize=function(s){var u=this._containerDimensions(),d=u[0],f=u[1];if(d===this.transform.width&&f===this.transform.height)return this;this._resizeCanvas(d,f),this.transform.resize(d,f),this.painter.resize(d,f);var x=!this._moving;return x&&this.fire(new l.Event("movestart",s)).fire(new l.Event("move",s)),this.fire(new l.Event("resize",s)),x&&this.fire(new l.Event("moveend",s)),this},o.prototype.getBounds=function(){return this.transform.getBounds()},o.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},o.prototype.setMaxBounds=function(s){return this.transform.setMaxBounds(l.LngLatBounds.convert(s)),this._update()},o.prototype.setMinZoom=function(s){if((s=s??-2)>=-2&&s<=this.transform.maxZoom)return this.transform.minZoom=s,this._update(),this.getZoom()<s&&this.setZoom(s),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},o.prototype.getMinZoom=function(){return this.transform.minZoom},o.prototype.setMaxZoom=function(s){if((s=s??22)>=this.transform.minZoom)return this.transform.maxZoom=s,this._update(),this.getZoom()>s&&this.setZoom(s),this;throw new Error("maxZoom must be greater than the current minZoom")},o.prototype.getMaxZoom=function(){return this.transform.maxZoom},o.prototype.setMinPitch=function(s){if((s=s??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(s>=0&&s<=this.transform.maxPitch)return this.transform.minPitch=s,this._update(),this.getPitch()<s&&this.setPitch(s),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},o.prototype.getMinPitch=function(){return this.transform.minPitch},o.prototype.setMaxPitch=function(s){if((s=s??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(s>=this.transform.minPitch)return this.transform.maxPitch=s,this._update(),this.getPitch()>s&&this.setPitch(s),this;throw new Error("maxPitch must be greater than the current minPitch")},o.prototype.getMaxPitch=function(){return this.transform.maxPitch},o.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},o.prototype.setRenderWorldCopies=function(s){return this.transform.renderWorldCopies=s,this._update()},o.prototype.project=function(s){return this.transform.locationPoint(l.LngLat.convert(s))},o.prototype.unproject=function(s){return this.transform.pointLocation(l.Point.convert(s))},o.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},o.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},o.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},o.prototype._createDelegatedListener=function(s,u,d){var f,x=this;if(s==="mouseenter"||s==="mouseover"){var L=!1;return{layer:u,listener:d,delegates:{mousemove:function(gt){var vt=x.getLayer(u)?x.queryRenderedFeatures(gt.point,{layers:[u]}):[];vt.length?L||(L=!0,d.call(x,new xr(s,x,gt.originalEvent,{features:vt}))):L=!1},mouseout:function(){L=!1}}}}if(s==="mouseleave"||s==="mouseout"){var H=!1;return{layer:u,listener:d,delegates:{mousemove:function(gt){(x.getLayer(u)?x.queryRenderedFeatures(gt.point,{layers:[u]}):[]).length?H=!0:H&&(H=!1,d.call(x,new xr(s,x,gt.originalEvent)))},mouseout:function(gt){H&&(H=!1,d.call(x,new xr(s,x,gt.originalEvent)))}}}}return{layer:u,listener:d,delegates:(f={},f[s]=function(gt){var vt=x.getLayer(u)?x.queryRenderedFeatures(gt.point,{layers:[u]}):[];vt.length&&(gt.features=vt,d.call(x,gt),delete gt.features)},f)}},o.prototype.on=function(s,u,d){if(d===void 0)return r.prototype.on.call(this,s,u);var f=this._createDelegatedListener(s,u,d);for(var x in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[s]=this._delegatedListeners[s]||[],this._delegatedListeners[s].push(f),f.delegates)this.on(x,f.delegates[x]);return this},o.prototype.once=function(s,u,d){if(d===void 0)return r.prototype.once.call(this,s,u);var f=this._createDelegatedListener(s,u,d);for(var x in f.delegates)this.once(x,f.delegates[x]);return this},o.prototype.off=function(s,u,d){var f=this;return d===void 0?r.prototype.off.call(this,s,u):(this._delegatedListeners&&this._delegatedListeners[s]&&function(x){for(var L=x[s],H=0;H<L.length;H++){var gt=L[H];if(gt.layer===u&&gt.listener===d){for(var vt in gt.delegates)f.off(vt,gt.delegates[vt]);return L.splice(H,1),f}}}(this._delegatedListeners),this)},o.prototype.queryRenderedFeatures=function(s,u){if(!this.style)return[];var d;if(u!==void 0||s===void 0||s instanceof l.Point||Array.isArray(s)||(u=s,s=void 0),u=u||{},(s=s||[[0,0],[this.transform.width,this.transform.height]])instanceof l.Point||typeof s[0]=="number")d=[l.Point.convert(s)];else{var f=l.Point.convert(s[0]),x=l.Point.convert(s[1]);d=[f,new l.Point(x.x,f.y),x,new l.Point(f.x,x.y),f]}return this.style.queryRenderedFeatures(d,u,this.transform)},o.prototype.querySourceFeatures=function(s,u){return this.style.querySourceFeatures(s,u)},o.prototype.setStyle=function(s,u){return(u=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},u)).diff!==!1&&u.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&s?(this._diffStyle(s,u),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._updateStyle(s,u))},o.prototype._getUIString=function(s){var u=this._locale[s];if(u==null)throw new Error("Missing UI string '"+s+"'");return u},o.prototype._updateStyle=function(s,u){return this.style&&(this.style.setEventedParent(null),this.style._remove()),s?(this.style=new on(this,u||{}),this.style.setEventedParent(this,{style:this.style}),typeof s=="string"?this.style.loadURL(s):this.style.loadJSON(s),this):(delete this.style,this)},o.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new on(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},o.prototype._diffStyle=function(s,u){var d=this;if(typeof s=="string"){var f=this._requestManager.normalizeStyleURL(s),x=this._requestManager.transformRequest(f,l.ResourceType.Style);l.getJSON(x,function(L,H){L?d.fire(new l.ErrorEvent(L)):H&&d._updateDiff(H,u)})}else typeof s=="object"&&this._updateDiff(s,u)},o.prototype._updateDiff=function(s,u){try{this.style.setState(s)&&this._update(!0)}catch(d){l.warnOnce("Unable to perform style diff: "+(d.message||d.error||d)+".  Rebuilding the style from scratch."),this._updateStyle(s,u)}},o.prototype.getStyle=function(){if(this.style)return this.style.serialize()},o.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")},o.prototype.addSource=function(s,u){return this._lazyInitEmptyStyle(),this.style.addSource(s,u),this._update(!0)},o.prototype.isSourceLoaded=function(s){var u=this.style&&this.style.sourceCaches[s];if(u!==void 0)return u.loaded();this.fire(new l.ErrorEvent(new Error("There is no source with ID '"+s+"'")))},o.prototype.areTilesLoaded=function(){var s=this.style&&this.style.sourceCaches;for(var u in s){var d=s[u]._tiles;for(var f in d){var x=d[f];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0},o.prototype.addSourceType=function(s,u,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(s,u,d)},o.prototype.removeSource=function(s){return this.style.removeSource(s),this._update(!0)},o.prototype.getSource=function(s){return this.style.getSource(s)},o.prototype.addImage=function(s,u,d){d===void 0&&(d={});var f=d.pixelRatio;f===void 0&&(f=1);var x=d.sdf;x===void 0&&(x=!1);var L=d.stretchX,H=d.stretchY,gt=d.content;if(this._lazyInitEmptyStyle(),u instanceof nl||ji&&u instanceof ji){var vt=l.browser.getImageData(u);this.style.addImage(s,{data:new l.RGBAImage({width:vt.width,height:vt.height},vt.data),pixelRatio:f,stretchX:L,stretchY:H,content:gt,sdf:x,version:0})}else{if(u.width===void 0||u.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var bt=u;this.style.addImage(s,{data:new l.RGBAImage({width:u.width,height:u.height},new Uint8Array(u.data)),pixelRatio:f,stretchX:L,stretchY:H,content:gt,sdf:x,version:0,userImage:bt}),bt.onAdd&&bt.onAdd(this,s)}},o.prototype.updateImage=function(s,u){var d=this.style.getImage(s);if(!d)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var f=u instanceof nl||ji&&u instanceof ji?l.browser.getImageData(u):u,x=f.width,L=f.height,H=f.data;return x===void 0||L===void 0?this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):x!==d.data.width||L!==d.data.height?this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(d.data.replace(H,!(u instanceof nl||ji&&u instanceof ji)),void this.style.updateImage(s,d))},o.prototype.hasImage=function(s){return s?!!this.style.getImage(s):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)},o.prototype.removeImage=function(s){this.style.removeImage(s)},o.prototype.loadImage=function(s,u){l.getImage(this._requestManager.transformRequest(s,l.ResourceType.Image),u)},o.prototype.listImages=function(){return this.style.listImages()},o.prototype.addLayer=function(s,u){return this._lazyInitEmptyStyle(),this.style.addLayer(s,u),this._update(!0)},o.prototype.moveLayer=function(s,u){return this.style.moveLayer(s,u),this._update(!0)},o.prototype.removeLayer=function(s){return this.style.removeLayer(s),this._update(!0)},o.prototype.getLayer=function(s){return this.style.getLayer(s)},o.prototype.setLayerZoomRange=function(s,u,d){return this.style.setLayerZoomRange(s,u,d),this._update(!0)},o.prototype.setFilter=function(s,u,d){return d===void 0&&(d={}),this.style.setFilter(s,u,d),this._update(!0)},o.prototype.getFilter=function(s){return this.style.getFilter(s)},o.prototype.setPaintProperty=function(s,u,d,f){return f===void 0&&(f={}),this.style.setPaintProperty(s,u,d,f),this._update(!0)},o.prototype.getPaintProperty=function(s,u){return this.style.getPaintProperty(s,u)},o.prototype.setLayoutProperty=function(s,u,d,f){return f===void 0&&(f={}),this.style.setLayoutProperty(s,u,d,f),this._update(!0)},o.prototype.getLayoutProperty=function(s,u){return this.style.getLayoutProperty(s,u)},o.prototype.setLight=function(s,u){return u===void 0&&(u={}),this._lazyInitEmptyStyle(),this.style.setLight(s,u),this._update(!0)},o.prototype.getLight=function(){return this.style.getLight()},o.prototype.setFeatureState=function(s,u){return this.style.setFeatureState(s,u),this._update()},o.prototype.removeFeatureState=function(s,u){return this.style.removeFeatureState(s,u),this._update()},o.prototype.getFeatureState=function(s){return this.style.getFeatureState(s)},o.prototype.getContainer=function(){return this._container},o.prototype.getCanvasContainer=function(){return this._canvasContainer},o.prototype.getCanvas=function(){return this._canvas},o.prototype._containerDimensions=function(){var s=0,u=0;return this._container&&(s=this._container.clientWidth||400,u=this._container.clientHeight||300),[s,u]},o.prototype._detectMissingCSS=function(){l.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&l.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},o.prototype._setupContainer=function(){var s=this._container;s.classList.add("mapboxgl-map"),(this._missingCSSCanary=dt.create("div","mapboxgl-canary",s)).style.visibility="hidden",this._detectMissingCSS();var u=this._canvasContainer=dt.create("div","mapboxgl-canvas-container",s);this._interactive&&u.classList.add("mapboxgl-interactive"),this._canvas=dt.create("canvas","mapboxgl-canvas",u),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var d=this._containerDimensions();this._resizeCanvas(d[0],d[1]);var f=this._controlContainer=dt.create("div","mapboxgl-control-container",s),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(L){x[L]=dt.create("div","mapboxgl-ctrl-"+L,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},o.prototype._resizeCanvas=function(s,u){var d=l.browser.devicePixelRatio||1;this._canvas.width=d*s,this._canvas.height=d*u,this._canvas.style.width=s+"px",this._canvas.style.height=u+"px"},o.prototype._setupPainter=function(){var s=l.extend({},Zt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),u=this._canvas.getContext("webgl",s)||this._canvas.getContext("experimental-webgl",s);u?(this.painter=new tr(u,this.transform),l.webpSupported.testSupport(u)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))},o.prototype._contextLost=function(s){s.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:s}))},o.prototype._contextRestored=function(s){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:s}))},o.prototype._onMapScroll=function(s){if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},o.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},o.prototype._update=function(s){return this.style?(this._styleDirty=this._styleDirty||s,this._sourcesDirty=!0,this.triggerRepaint(),this):this},o.prototype._requestRenderFrame=function(s){return this._update(),this._renderTaskQueue.add(s)},o.prototype._cancelRenderFrame=function(s){this._renderTaskQueue.remove(s)},o.prototype._render=function(s){var u,d=this,f=0,x=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(u=x.createQueryEXT(),x.beginQueryEXT(x.TIME_ELAPSED_EXT,u),f=l.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(s),!this._removed){var L=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var H=this.transform.zoom,gt=l.browser.now();this.style.zoomHistory.update(H,gt);var vt=new l.EvaluationParameters(H,{now:gt,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),bt=vt.crossFadingFactor();bt===1&&bt===this._crossFadingFactor||(L=!0,this._crossFadingFactor=bt),this.style.update(vt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||L)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ft=l.browser.now()-f;x.endQueryEXT(x.TIME_ELAPSED_EXT,u),setTimeout(function(){var Pt=x.getQueryObjectEXT(u,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(u),d.fire(new l.Event("gpu-timing-frame",{cpuTime:Ft,gpuTime:Pt}))},50)}if(this.listens("gpu-timing-layer")){var Bt=this.painter.collectGpuTimers();setTimeout(function(){var Pt=d.painter.queryGpuTimers(Bt);d.fire(new l.Event("gpu-timing-layer",{layerTimes:Pt}))},50)}var Xt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Xt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||Xt||(this._fullyLoaded=!0),this}},o.prototype.remove=function(){this._hash&&this._hash.remove();for(var s=0,u=this._controls;s<u.length;s+=1)u[s].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),l.window!==void 0&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1));var d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),Fo(this._canvasContainer),Fo(this._controlContainer),Fo(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new l.Event("remove"))},o.prototype.triggerRepaint=function(){var s=this;this.style&&!this._frame&&(this._frame=l.browser.frame(function(u){s._frame=null,s._render(u)}))},o.prototype._onWindowOnline=function(){this._update()},o.prototype._onWindowResize=function(s){this._trackResize&&this.resize({originalEvent:s})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(s){this._showTileBoundaries!==s&&(this._showTileBoundaries=s,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(s){this._showPadding!==s&&(this._showPadding=s,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(s){this._showCollisionBoxes!==s&&(this._showCollisionBoxes=s,s?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(s){this._showOverdrawInspector!==s&&(this._showOverdrawInspector=s,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(s){this._repaint!==s&&(this._repaint=s,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(s){this._vertices=s,this._update()},o.prototype._setCacheLimits=function(s,u){l.setCacheLimits(s,u)},n.version.get=function(){return l.version},Object.defineProperties(o.prototype,n),o}(os);function Fo(r){r.parentNode&&r.parentNode.removeChild(r)}var ol={showCompass:!0,showZoom:!0,visualizePitch:!1},Xn=function(r){var o=this;this.options=l.extend({},ol,r),this._container=dt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(n){return n.preventDefault()}),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(n){return o._map.zoomIn({},{originalEvent:n})}),dt.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(n){return o._map.zoomOut({},{originalEvent:n})}),dt.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(n){o.options.visualizePitch?o._map.resetNorthPitch({},{originalEvent:n}):o._map.resetNorth({},{originalEvent:n})}),this._compassIcon=dt.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Xn.prototype._updateZoomButtons=function(){var r=this._map.getZoom(),o=r===this._map.getMaxZoom(),n=r===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},Xn.prototype._rotateCompassArrow=function(){var r=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=r},Xn.prototype.onAdd=function(r){return this._map=r,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new cn(this._map,this._compass,this.options.visualizePitch)),this._container},Xn.prototype.onRemove=function(){dt.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Xn.prototype._createButton=function(r,o){var n=dt.create("button",r,this._container);return n.type="button",n.addEventListener("click",o),n},Xn.prototype._setButtonTitle=function(r,o){var n=this._map._getUIString("NavigationControl."+o);r.title=n,r.setAttribute("aria-label",n)};var cn=function(r,o,n){n===void 0&&(n=!1),this._clickTolerance=10,this.element=o,this.mouseRotate=new is({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,n&&(this.mousePitch=new el({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),dt.addEventListener(o,"mousedown",this.mousedown),dt.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),dt.addEventListener(o,"touchmove",this.touchmove),dt.addEventListener(o,"touchend",this.touchend),dt.addEventListener(o,"touchcancel",this.reset)};function ia(r,o,n){if(r=new l.LngLat(r.lng,r.lat),o){var s=new l.LngLat(r.lng-360,r.lat),u=new l.LngLat(r.lng+360,r.lat),d=n.locationPoint(r).distSqr(o);n.locationPoint(s).distSqr(o)<d?r=s:n.locationPoint(u).distSqr(o)<d&&(r=u)}for(;Math.abs(r.lng-n.center.lng)>180;){var f=n.locationPoint(r);if(f.x>=0&&f.y>=0&&f.x<=n.width&&f.y<=n.height)break;r.lng>n.center.lng?r.lng-=360:r.lng+=360}return r}cn.prototype.down=function(r,o){this.mouseRotate.mousedown(r,o),this.mousePitch&&this.mousePitch.mousedown(r,o),dt.disableDrag()},cn.prototype.move=function(r,o){var n=this.map,s=this.mouseRotate.mousemoveWindow(r,o);if(s&&s.bearingDelta&&n.setBearing(n.getBearing()+s.bearingDelta),this.mousePitch){var u=this.mousePitch.mousemoveWindow(r,o);u&&u.pitchDelta&&n.setPitch(n.getPitch()+u.pitchDelta)}},cn.prototype.off=function(){var r=this.element;dt.removeEventListener(r,"mousedown",this.mousedown),dt.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),dt.removeEventListener(r,"touchmove",this.touchmove),dt.removeEventListener(r,"touchend",this.touchend),dt.removeEventListener(r,"touchcancel",this.reset),this.offTemp()},cn.prototype.offTemp=function(){dt.enableDrag(),dt.removeEventListener(l.window,"mousemove",this.mousemove),dt.removeEventListener(l.window,"mouseup",this.mouseup)},cn.prototype.mousedown=function(r){this.down(l.extend({},r,{ctrlKey:!0,preventDefault:function(){return r.preventDefault()}}),dt.mousePos(this.element,r)),dt.addEventListener(l.window,"mousemove",this.mousemove),dt.addEventListener(l.window,"mouseup",this.mouseup)},cn.prototype.mousemove=function(r){this.move(r,dt.mousePos(this.element,r))},cn.prototype.mouseup=function(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()},cn.prototype.touchstart=function(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=dt.touchPos(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return r.preventDefault()}},this._startPos))},cn.prototype.touchmove=function(r){r.targetTouches.length!==1?this.reset():(this._lastPos=dt.touchPos(this.element,r.targetTouches)[0],this.move({preventDefault:function(){return r.preventDefault()}},this._lastPos))},cn.prototype.touchend=function(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},cn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Fn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ss(r,o,n){var s=r.classList;for(var u in Fn)s.remove("mapboxgl-"+n+"-anchor-"+u);s.add("mapboxgl-"+n+"-anchor-"+o)}var ra,Pa=function(r){function o(n,s){if(r.call(this),(n instanceof l.window.HTMLElement||s)&&(n=l.extend({element:n},s)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=l.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=dt.create("div"),this._element.setAttribute("aria-label","Map marker");var u=dt.createNS("http://www.w3.org/2000/svg","svg");u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height","41px"),u.setAttributeNS(null,"width","27px"),u.setAttributeNS(null,"viewBox","0 0 27 41");var d=dt.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"stroke","none"),d.setAttributeNS(null,"stroke-width","1"),d.setAttributeNS(null,"fill","none"),d.setAttributeNS(null,"fill-rule","evenodd");var f=dt.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"fill-rule","nonzero");var x=dt.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"transform","translate(3.0, 29.0)"),x.setAttributeNS(null,"fill","#000000");for(var L=0,H=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];L<H.length;L+=1){var gt=H[L],vt=dt.createNS("http://www.w3.org/2000/svg","ellipse");vt.setAttributeNS(null,"opacity","0.04"),vt.setAttributeNS(null,"cx","10.5"),vt.setAttributeNS(null,"cy","5.80029008"),vt.setAttributeNS(null,"rx",gt.rx),vt.setAttributeNS(null,"ry",gt.ry),x.appendChild(vt)}var bt=dt.createNS("http://www.w3.org/2000/svg","g");bt.setAttributeNS(null,"fill",this._color);var Ft=dt.createNS("http://www.w3.org/2000/svg","path");Ft.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),bt.appendChild(Ft);var Bt=dt.createNS("http://www.w3.org/2000/svg","g");Bt.setAttributeNS(null,"opacity","0.25"),Bt.setAttributeNS(null,"fill","#000000");var Xt=dt.createNS("http://www.w3.org/2000/svg","path");Xt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Bt.appendChild(Xt);var Pt=dt.createNS("http://www.w3.org/2000/svg","g");Pt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Pt.setAttributeNS(null,"fill","#FFFFFF");var qt=dt.createNS("http://www.w3.org/2000/svg","g");qt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Qt=dt.createNS("http://www.w3.org/2000/svg","circle");Qt.setAttributeNS(null,"fill","#000000"),Qt.setAttributeNS(null,"opacity","0.25"),Qt.setAttributeNS(null,"cx","5.5"),Qt.setAttributeNS(null,"cy","5.5"),Qt.setAttributeNS(null,"r","5.4999962");var ne=dt.createNS("http://www.w3.org/2000/svg","circle");ne.setAttributeNS(null,"fill","#FFFFFF"),ne.setAttributeNS(null,"cx","5.5"),ne.setAttributeNS(null,"cy","5.5"),ne.setAttributeNS(null,"r","5.4999962"),qt.appendChild(Qt),qt.appendChild(ne),f.appendChild(x),f.appendChild(bt),f.appendChild(Bt),f.appendChild(Pt),f.appendChild(qt),u.appendChild(f),u.setAttributeNS(null,"height",41*this._scale+"px"),u.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(u),this._offset=l.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(pe){pe.preventDefault()}),this._element.addEventListener("mousedown",function(pe){pe.preventDefault()}),ss(this._element,this._anchor,"marker"),this._popup=null}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},o.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),dt.remove(this._element),this._popup&&this._popup.remove(),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(n){return this._lngLat=l.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},o.prototype.getElement=function(){return this._element},o.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var s=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[s,-1*(24.6+s)],"bottom-right":[-s,-1*(24.6+s)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},o.prototype._onKeyPress=function(n){var s=n.code,u=n.charCode||n.keyCode;s!=="Space"&&s!=="Enter"&&u!==32&&u!==13||this.togglePopup()},o.prototype._onMapClick=function(n){var s=n.originalEvent.target,u=this._element;this._popup&&(s===u||u.contains(s))&&this.togglePopup()},o.prototype.getPopup=function(){return this._popup},o.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},o.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ia(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var s="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?s="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(s="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var u="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?u="rotateX(0deg)":this._pitchAlignment==="map"&&(u="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),dt.setTransform(this._element,Fn[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+u+" "+s)}},o.prototype.getOffset=function(){return this._offset},o.prototype.setOffset=function(n){return this._offset=l.Point.convert(n),this._update(),this},o.prototype._onMove=function(n){if(!this._isDragging){var s=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=s}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))},o.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"},o.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},o.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},o.prototype.isDraggable=function(){return this._draggable},o.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},o.prototype.getRotation=function(){return this._rotation},o.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},o.prototype.getRotationAlignment=function(){return this._rotationAlignment},o.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},o.prototype.getPitchAlignment=function(){return this._pitchAlignment},o}(l.Evented),al={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},na=0,jo=!1,sl=function(r){function o(n){r.call(this),this.options=l.extend({},al,n),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.onAdd=function(n){var s;return this._map=n,this._container=dt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),s=this._setupUI,ra!==void 0?s(ra):l.window.navigator.permissions!==void 0?l.window.navigator.permissions.query({name:"geolocation"}).then(function(u){s(ra=u.state!=="denied")}):s(ra=!!l.window.navigator.geolocation),this._container},o.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),dt.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,na=0,jo=!1},o.prototype._isOutOfMapMaxBounds=function(n){var s=this._map.getMaxBounds(),u=n.coords;return s&&(u.longitude<s.getWest()||u.longitude>s.getEast()||u.latitude<s.getSouth()||u.latitude>s.getNorth())},o.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},o.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",n)),this._finish()}},o.prototype._updateCamera=function(n){var s=new l.LngLat(n.coords.longitude,n.coords.latitude),u=n.coords.accuracy,d=this._map.getBearing(),f=l.extend({bearing:d},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(u),f,{geolocateSource:!0})},o.prototype._updateMarker=function(n){if(n){var s=new l.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},o.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,s=this._map.unproject([0,n]),u=this._map.unproject([1,n]),d=s.distanceTo(u),f=Math.ceil(2*this._accuracy/d);this._circleElement.style.width=f+"px",this._circleElement.style.height=f+"px"},o.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},o.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&jo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",n)),this._finish()}},o.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},o.prototype._setupUI=function(n){var s=this;if(this._container.addEventListener("contextmenu",function(f){return f.preventDefault()}),this._geolocateButton=dt.create("button","mapboxgl-ctrl-geolocate",this._container),dt.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{var d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=dt.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Pa(this._dotElement),this._circleElement=dt.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Pa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(f){f.geolocateSource||s._watchState!=="ACTIVE_LOCK"||f.originalEvent&&f.originalEvent.type==="resize"||(s._watchState="BACKGROUND",s._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),s._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),s.fire(new l.Event("trackuserlocationend")))})},o.prototype.trigger=function(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":na--,jo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++na>1?(n={maximumAge:6e5,timeout:0},jo=!0):(n=this.options.positionOptions,jo=!1),this._geolocationWatchID=l.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else l.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},o.prototype._clearWatch=function(){l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},o}(l.Evented),lo={maxWidth:100,unit:"metric"},ho=function(r){this.options=l.extend({},lo,r),l.bindAll(["_onMove","setUnit"],this)};function ls(r,o,n){var s=n&&n.maxWidth||100,u=r._container.clientHeight/2,d=r.unproject([0,u]),f=r.unproject([s,u]),x=d.distanceTo(f);if(n&&n.unit==="imperial"){var L=3.2808*x;L>5280?co(o,s,L/5280,r._getUIString("ScaleControl.Miles")):co(o,s,L,r._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?co(o,s,x/1852,r._getUIString("ScaleControl.NauticalMiles")):x>=1e3?co(o,s,x/1e3,r._getUIString("ScaleControl.Kilometers")):co(o,s,x,r._getUIString("ScaleControl.Meters"))}function co(r,o,n,s){var u,d,f,x=(u=n,(d=Math.pow(10,(""+Math.floor(u)).length-1))*(f=(f=u/d)>=10?10:f>=5?5:f>=3?3:f>=2?2:f>=1?1:function(L){var H=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*H)/H}(f)));r.style.width=o*(x/n)+"px",r.innerHTML=x+"&nbsp;"+s}ho.prototype.getDefaultPosition=function(){return"bottom-left"},ho.prototype._onMove=function(){ls(this._map,this._container,this.options)},ho.prototype.onAdd=function(r){return this._map=r,this._container=dt.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",r.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ho.prototype.onRemove=function(){dt.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ho.prototype.setUnit=function(r){this.options.unit=r,ls(this._map,this._container,this.options)};var Sn=function(r){this._fullscreen=!1,r&&r.container&&(r.container instanceof l.window.HTMLElement?this._container=r.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in l.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in l.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in l.window.document&&(this._fullscreenchange="MSFullscreenChange")};Sn.prototype.onAdd=function(r){return this._map=r,this._container||(this._container=this._map.getContainer()),this._controlContainer=dt.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Sn.prototype.onRemove=function(){dt.remove(this._controlContainer),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Sn.prototype._checkFullscreenSupport=function(){return!!(l.window.document.fullscreenEnabled||l.window.document.mozFullScreenEnabled||l.window.document.msFullscreenEnabled||l.window.document.webkitFullscreenEnabled)},Sn.prototype._setupUI=function(){var r=this._fullscreenButton=dt.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);dt.create("span","mapboxgl-ctrl-icon",r).setAttribute("aria-hidden",!0),r.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Sn.prototype._updateTitle=function(){var r=this._getTitle();this._fullscreenButton.setAttribute("aria-label",r),this._fullscreenButton.title=r},Sn.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Sn.prototype._isFullscreen=function(){return this._fullscreen},Sn.prototype._changeIcon=function(){(l.window.document.fullscreenElement||l.window.document.mozFullScreenElement||l.window.document.webkitFullscreenElement||l.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Sn.prototype._onClickFullscreen=function(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.mozCancelFullScreen?l.window.document.mozCancelFullScreen():l.window.document.msExitFullscreen?l.window.document.msExitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var ll={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ia=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),hl=function(r){function o(n){r.call(this),this.options=l.extend(Object.create(ll),n),l.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o,o.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this},o.prototype.isOpen=function(){return!!this._map},o.prototype.remove=function(){return this._content&&dt.remove(this._content),this._container&&(dt.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(n){return this._lngLat=l.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},o.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},o.prototype.getElement=function(){return this._container},o.prototype.setText=function(n){return this.setDOMContent(l.window.document.createTextNode(n))},o.prototype.setHTML=function(n){var s,u=l.window.document.createDocumentFragment(),d=l.window.document.createElement("body");for(d.innerHTML=n;s=d.firstChild;)u.appendChild(s);return this.setDOMContent(u)},o.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},o.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},o.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=dt.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},o.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},o.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},o.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},o.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},o.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=dt.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},o.prototype._onMouseUp=function(n){this._update(n.point)},o.prototype._onMouseMove=function(n){this._update(n.point)},o.prototype._onDrag=function(n){this._update(n.point)},o.prototype._update=function(n){var s=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=dt.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=dt.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(vt){return s._container.classList.add(vt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ia(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var u=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),d=this.options.anchor,f=function vt(bt){if(bt){if(typeof bt=="number"){var Ft=Math.round(Math.sqrt(.5*Math.pow(bt,2)));return{center:new l.Point(0,0),top:new l.Point(0,bt),"top-left":new l.Point(Ft,Ft),"top-right":new l.Point(-Ft,Ft),bottom:new l.Point(0,-bt),"bottom-left":new l.Point(Ft,-Ft),"bottom-right":new l.Point(-Ft,-Ft),left:new l.Point(bt,0),right:new l.Point(-bt,0)}}if(bt instanceof l.Point||Array.isArray(bt)){var Bt=l.Point.convert(bt);return{center:Bt,top:Bt,"top-left":Bt,"top-right":Bt,bottom:Bt,"bottom-left":Bt,"bottom-right":Bt,left:Bt,right:Bt}}return{center:l.Point.convert(bt.center||[0,0]),top:l.Point.convert(bt.top||[0,0]),"top-left":l.Point.convert(bt["top-left"]||[0,0]),"top-right":l.Point.convert(bt["top-right"]||[0,0]),bottom:l.Point.convert(bt.bottom||[0,0]),"bottom-left":l.Point.convert(bt["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(bt["bottom-right"]||[0,0]),left:l.Point.convert(bt.left||[0,0]),right:l.Point.convert(bt.right||[0,0])}}return vt(new l.Point(0,0))}(this.options.offset);if(!d){var x,L=this._container.offsetWidth,H=this._container.offsetHeight;x=u.y+f.bottom.y<H?["top"]:u.y>this._map.transform.height-H?["bottom"]:[],u.x<L/2?x.push("left"):u.x>this._map.transform.width-L/2&&x.push("right"),d=x.length===0?"bottom":x.join("-")}var gt=u.add(f[d]).round();dt.setTransform(this._container,Fn[d]+" translate("+gt.x+"px,"+gt.y+"px)"),ss(this._container,d,"popup")}},o.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(Ia);n&&n.focus()}},o.prototype._onClose=function(){this.remove()},o}(l.Evented),hs={version:l.version,supported:Zt,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:ph,NavigationControl:Xn,GeolocateControl:sl,AttributionControl:Wr,ScaleControl:ho,FullscreenControl:Sn,Popup:hl,Marker:Pa,Style:on,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,Evented:l.Evented,config:l.config,prewarm:function(){me().acquire(fe)},clearPrewarmedResources:function(){var r=qe;r&&(r.isPreloaded()&&r.numActive()===1?(r.release(fe),qe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(r){l.config.ACCESS_TOKEN=r},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(r){l.config.API_URL=r},get workerCount(){return Se.workerCount},set workerCount(r){Se.workerCount=r},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(r){l.config.MAX_PARALLEL_IMAGE_REQUESTS=r},clearStorage:function(r){l.clearTileCache(r)},workerUrl:""};return hs}),Et})})(jp);var Rf=jp.exports;const Ga=Bp(Rf);function Ip(ve,se,X){const te=ve.slice();return te[1]=se[X].color,te[2]=se[X].label,te}function Lp(ve){let se,X=Hh(ve[0]),te=[];for(let Et=0;Et<X.length;Et+=1)te[Et]=zp(Ip(ve,X,Et));return{c(){for(let Et=0;Et<te.length;Et+=1)te[Et].c();se=mp()},l(Et){for(let At=0;At<te.length;At+=1)te[At].l(Et);se=mp()},m(Et,At){for(let l=0;l<te.length;l+=1)te[l]&&te[l].m(Et,At);Ii(Et,se,At)},p(Et,At){if(At&1){X=Hh(Et[0]);let l;for(l=0;l<X.length;l+=1){const Zt=Ip(Et,X,l);te[l]?te[l].p(Zt,At):(te[l]=zp(Zt),te[l].c(),te[l].m(se.parentNode,se))}for(;l<te.length;l+=1)te[l].d(1);te.length=X.length}},d(Et){Et&&$e(se),Dp(te,Et)}}}function zp(ve){let se,X,te,Et,At=ve[2]+"",l,Zt;return{c(){se=ci("div"),X=ci("span"),te=qi(),Et=ci("span"),l=Gc(At),Zt=qi(),this.h()},l(dt){se=ui(dt,"DIV",{});var Nt=nr(se);X=ui(Nt,"SPAN",{class:!0,style:!0}),nr(X).forEach($e),te=Xi(Nt),Et=ui(Nt,"SPAN",{class:!0});var Lt=nr(Et);l=qc(Lt,At),Lt.forEach($e),Zt=Xi(Nt),Nt.forEach($e),this.h()},h(){pi(X,"class","swatch svelte-86ob8x"),Ol(X,"--color",ve[1]),pi(Et,"class","swatch-label")},m(dt,Nt){Ii(dt,se,Nt),fi(se,X),fi(se,te),fi(se,Et),fi(Et,l),fi(se,Zt)},p(dt,Nt){Nt&1&&Ol(X,"--color",dt[1]),Nt&1&&At!==(At=dt[2]+"")&&Xc(l,At)},d(dt){dt&&$e(se)}}}function Ff(ve){let se,X=ve[0]&&Lp(ve);return{c(){se=ci("div"),X&&X.c(),this.h()},l(te){se=ui(te,"DIV",{class:!0});var Et=nr(se);X&&X.l(Et),Et.forEach($e),this.h()},h(){pi(se,"class","swatches svelte-86ob8x")},m(te,Et){Ii(te,se,Et),X&&X.m(se,null)},p(te,[Et]){te[0]?X?X.p(te,Et):(X=Lp(te),X.c(),X.m(se,null)):X&&(X.d(1),X=null)},i:Wh,o:Wh,d(te){te&&$e(se),X&&X.d()}}}function jf(ve,se,X){let{legend:te}=se;return ve.$$set=Et=>{"legend"in Et&&X(0,te=Et.legend)},[te]}class Uf extends Wc{constructor(se){super(),Hc(this,se,jf,Ff,Nc,{legend:0})}}function Nf(ve){var R;let se,X,te,Et,At,l=ve[0].title+"",Zt,dt,Nt,Lt='<div id="leftMapTitle"></div>',kt,ut,Rt='<div id="rightMapTitle"></div>',Z,lt,at,W,q,$=`<a href="${wp}/" rel="external">← Home</a>`,U,j,et=`<a href="${wp}/indicator_descriptions.pdf" rel="external">Indicator Descriptions</a>`,_t,mt,V,rt,I,C,z,S,g,v,y,T,k,E,w;return document.title=se=ve[0].title,mt=new Lf({props:{options:ve[0].measures||[]}}),mt.$on("submit",ve[5]),rt=new Uf({props:{legend:((R=ve[0].indicators.find(ve[6]))==null?void 0:R.legend)||[]}}),{c(){X=qi(),te=ci("div"),Et=ci("div"),At=ci("div"),Zt=Gc(l),dt=qi(),Nt=ci("div"),Nt.innerHTML=Lt,kt=qi(),ut=ci("div"),ut.innerHTML=Rt,Z=qi(),lt=ci("div"),at=ci("div"),W=ci("div"),q=ci("div"),q.innerHTML=$,U=qi(),j=ci("div"),j.innerHTML=et,_t=qi(),gp(mt.$$.fragment),V=qi(),gp(rt.$$.fragment),I=qi(),C=ci("div"),z=ci("div"),S=ci("div"),g=qi(),v=ci("div"),y=ci("div"),T=ci("div"),k=qi(),E=ci("div"),this.h()},l(J){Sf("svelte-8oibt4",document.head).forEach($e),X=Xi(J),te=ui(J,"DIV",{class:!0});var ot=nr(te);Et=ui(ot,"DIV",{class:!0});var it=nr(Et);At=ui(it,"DIV",{class:!0});var Q=nr(At);Zt=qc(Q,l),Q.forEach($e),it.forEach($e),dt=Xi(ot),Nt=ui(ot,"DIV",{class:!0,"data-svelte-h":!0}),Jr(Nt)!=="svelte-1xo1bro"&&(Nt.innerHTML=Lt),kt=Xi(ot),ut=ui(ot,"DIV",{class:!0,"data-svelte-h":!0}),Jr(ut)!=="svelte-1sdxwc2"&&(ut.innerHTML=Rt),ot.forEach($e),Z=Xi(J),lt=ui(J,"DIV",{class:!0});var A=nr(lt);at=ui(A,"DIV",{class:!0});var B=nr(at);W=ui(B,"DIV",{class:!0});var K=nr(W);q=ui(K,"DIV",{class:!0,"data-svelte-h":!0}),Jr(q)!=="svelte-qaamc1"&&(q.innerHTML=$),U=Xi(K),j=ui(K,"DIV",{class:!0,"data-svelte-h":!0}),Jr(j)!=="svelte-ilw1r5"&&(j.innerHTML=et),_t=Xi(K),yp(mt.$$.fragment,K),V=Xi(K),yp(rt.$$.fragment,K),K.forEach($e),B.forEach($e),I=Xi(A),C=ui(A,"DIV",{class:!0});var pt=nr(C);z=ui(pt,"DIV",{class:!0});var _=nr(z);S=ui(_,"DIV",{style:!0}),nr(S).forEach($e),_.forEach($e),pt.forEach($e),g=Xi(A),v=ui(A,"DIV",{class:!0});var P=nr(v);y=ui(P,"DIV",{class:!0});var D=nr(y);T=ui(D,"DIV",{style:!0}),nr(T).forEach($e),D.forEach($e),P.forEach($e),A.forEach($e),k=Xi(J),E=ui(J,"DIV",{id:!0,class:!0}),nr(E).forEach($e),this.h()},h(){pi(At,"class","title svelte-1huo2zd"),pi(Et,"class","column left svelte-1huo2zd"),pi(Nt,"class","column middle svelte-1huo2zd"),pi(ut,"class","column right svelte-1huo2zd"),pi(te,"class","row svelte-1huo2zd"),pi(q,"class","link svelte-1huo2zd"),pi(j,"class","link svelte-1huo2zd"),pi(W,"class","legend svelte-1huo2zd"),pi(at,"class","column left svelte-1huo2zd"),Ol(S,"height","600px"),pi(z,"class","maps svelte-1huo2zd"),pi(C,"class","column middle svelte-1huo2zd"),Ol(T,"height","600px"),pi(y,"class","maps svelte-1huo2zd"),pi(v,"class","column right svelte-1huo2zd"),pi(lt,"class","row svelte-1huo2zd"),pi(E,"id","chartContainer"),pi(E,"class","svelte-1huo2zd")},m(J,wt){Ii(J,X,wt),Ii(J,te,wt),fi(te,Et),fi(Et,At),fi(At,Zt),fi(te,dt),fi(te,Nt),fi(te,kt),fi(te,ut),Ii(J,Z,wt),Ii(J,lt,wt),fi(lt,at),fi(at,W),fi(W,q),fi(W,U),fi(W,j),fi(W,_t),vp(mt,W,null),fi(W,V),vp(rt,W,null),fi(lt,I),fi(lt,C),fi(C,z),fi(z,S),ve[7](S),fi(lt,g),fi(lt,v),fi(v,y),fi(y,T),ve[8](T),Ii(J,k,wt),Ii(J,E,wt),ve[9](E),w=!0},p(J,[wt]){var Q;(!w||wt&1)&&se!==(se=J[0].title)&&(document.title=se),(!w||wt&1)&&l!==(l=J[0].title+"")&&Xc(Zt,l);const ot={};wt&1&&(ot.options=J[0].measures||[]),mt.$set(ot);const it={};wt&17&&(it.legend=((Q=J[0].indicators.find(J[6]))==null?void 0:Q.legend)||[]),rt.$set(it)},i(J){w||(_p(mt.$$.fragment,J),_p(rt.$$.fragment,J),w=!0)},o(J){xp(mt.$$.fragment,J),xp(rt.$$.fragment,J),w=!1},d(J){J&&($e(X),$e(te),$e(Z),$e(lt),$e(k),$e(E)),bp(mt),bp(rt),ve[7](null),ve[8](null),ve[9](null)}}}function Vf(ve,se,X){let{data:te}=se,Et,At,l,Zt,dt,Nt,Lt,kt="",ut="",Rt;Tf(()=>{at()});let Z="mapbox://styles/furmanuw/cjq5iu4j8amzz2rphvt2mjrxs";async function lt(V,rt){let I="";if(V==="financial"&&(I="mapbox://styles/furmanuw/cjq5iu4j8amzz2rphvt2mjrxs"),V==="human"&&(["popden","min04_","chldpt","presch","white"].includes(rt)?I="mapbox://styles/furmanuw/cjqiiuu1dmrdj2rphozaflwb5":I="mapbox://styles/furmanuw/cjqi9cq8jbl0n2rp3tz46smsu"),V==="manufactured"&&(I="mapbox://styles/furmanuw/cjqi777a2gchm2rthg4qpky2a"),V==="social"&&(I="mapbox://styles/furmanuw/cjzoin2y52p6x1ct8hi1l1p3u"),I===Z)return;const C=new Promise((S,g)=>{Zt.once("styledataloading",function(){Zt.once("styledata",function(){S()})})}),z=new Promise((S,g)=>{dt.once("styledataloading",function(){dt.once("styledata",function(){S()})})});return Zt.setStyle(I),dt.setStyle(I),Z=I,Promise.all([C,z]).then(()=>{})}function at(){Ga.accessToken="pk.eyJ1IjoiZnVybWFudXciLCJhIjoiY2pwbmRiem1uMDF2ZjN3bjI5cHJ1aG16byJ9.WImIW1cOaMvS-DaG-_18Ww",Zt=new Ga.Map({container:Et,style:"mapbox://styles/furmanuw/cjq5iu4j8amzz2rphvt2mjrxs",center:[-82.300316,34.857192],zoom:9}),dt=new Ga.Map({container:At,style:"mapbox://styles/furmanuw/cjq5iu4j8amzz2rphvt2mjrxs",center:[-82.300316,34.857192],zoom:9}),Zt.addControl(new Ga.NavigationControl),dt.addControl(new Ga.NavigationControl),Bf(Zt,dt),Nt=new Ga.Popup({closeOnClick:!1}),Lt=new Ga.Popup({closeOnClick:!1})}function W(V,rt){const I=C=>{var Q,A,B,K,pt,_,P,D,Y,G,xt,Ct,Dt,jt,Kt,ee,le,ht;if(!Rt)return;const z=te.indicators.find(st=>st.name===Rt);if(!z)return;const S=(A=(Q=C.features)==null?void 0:Q[0].properties)==null?void 0:A[V.replace("Yr","")],g=(K=(B=C.features)==null?void 0:B[0].properties)==null?void 0:K[rt.replace("Yr","")];let v=te.helpers.formatNumber(S,z.format),y=te.helpers.formatNumber(g,z.format);v=="0"&&z.format=="dollars"&&(v="Data not available"),y=="0"&&z.format=="dollars"&&(y="Data not available");let T=`<b>${z.description}: </b>${v}`,k=`<b>${z.description}: </b>${y}`;const E=(_=(pt=C.features)==null?void 0:pt[0].properties)==null?void 0:_.Name;E&&(T+=`<br/><b>ID:</b> ${E}`,k+=`<br/><b>ID:</b> ${E}`);const w=(D=(P=C.features)==null?void 0:P[0].properties)==null?void 0:D.Neighborhood;w&&w!=="-"&&(T+=`<br/><b>Neighborhoods Include:</b> ${w}`,k+=`<br/><b>Neighborhoods Include:</b> ${w}`);const R=(G=(Y=C.features)==null?void 0:Y[0].properties)==null?void 0:G[Rt+"1990"],J=(Ct=(xt=C.features)==null?void 0:xt[0].properties)==null?void 0:Ct[Rt+"2000"],wt=(jt=(Dt=C.features)==null?void 0:Dt[0].properties)==null?void 0:jt[Rt+"2010"],ot=(ee=(Kt=C.features)==null?void 0:Kt[0].properties)==null?void 0:ee[Rt+"2016"];Nt.setLngLat(C.lngLat),Nt.setHTML(T),Nt.addTo(Zt),Lt.setLngLat(C.lngLat),Lt.setHTML(k),Lt.addTo(dt);const it=(ht=(le=C.features)==null?void 0:le[0].properties)==null?void 0:ht.County;te.helpers.generateChart(l,Rt,te.type,[{year:1990,value:R},{year:2e3,value:J},{year:2010,value:wt},{year:2016,value:ot}],{name:E,neighborhood:w,county:it})};Zt.on("click",V,I),dt.on("click",rt,I)}function q(V){X(4,Rt=V.detail.indicator),$(V.detail.leftYear,V.detail.rightYear,V.detail.indicator)}async function $(V,rt,I){U(),await lt(te.type,I),kt=I+"Yr"+V,ut=I+"Yr"+rt,Zt.setLayoutProperty(kt,"visibility","visible"),dt.setLayoutProperty(ut,"visibility","visible"),W(kt,ut)}function U(){Zt.getStyle().layers.filter(V=>V.id.includes("Yr")).forEach(V=>{Zt.setLayoutProperty(V.id,"visibility","none"),dt.setLayoutProperty(V.id,"visibility","none")}),Lt.isOpen()&&Lt.remove(),Nt.isOpen()&&Nt.remove()}const j=V=>V.name===Rt;function et(V){Uc[V?"unshift":"push"](()=>{Et=V,X(1,Et)})}function _t(V){Uc[V?"unshift":"push"](()=>{At=V,X(2,At)})}function mt(V){Uc[V?"unshift":"push"](()=>{l=V,X(3,l)})}return ve.$$set=V=>{"data"in V&&X(0,te=V.data)},[te,Et,At,l,Rt,q,j,et,_t,mt]}class Zf extends Wc{constructor(se){super(),Hc(this,se,Vf,Nf,Nc,{data:0})}}export{Zf as component,Hf as universal};
